<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>SeisMan</title><link href="http://seisman.info/" rel="alternate"></link><link href="http://seisman.info/feeds/seisman.atom.xml" rel="self"></link><id>http://seisman.info/</id><updated>2015-05-15T00:00:00+08:00</updated><entry><title>球状模型下的Tau积分</title><link href="http://seisman.info/tau-integral-in-spherical-earth.html" rel="alternate"></link><updated>2015-05-15T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-05-15:tau-integral-in-spherical-earth.html</id><summary type="html">&lt;p&gt;在计算震相走时的过程中，对Tau函数的积分是其中比较重要的一步，具体Tau函数如何使用，在地震学教材里都有介绍。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;基本公式&lt;/h2&gt;
&lt;p&gt;在球状分层模型下，任意一层内的Tau函数的积分可以写成：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\tau(p) = \int_{r_a}^{r_b} \frac{\eta}{r} dr
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(r_a\)&lt;/span&gt;和&lt;span class="math"&gt;\(r_b\)&lt;/span&gt;分别是这一层的上下边界的地球半径。&lt;span class="math"&gt;\(p\)&lt;/span&gt;是射线参数（水平慢度），&lt;span class="math"&gt;\(\eta\)&lt;/span&gt;是垂直慢度，&lt;span class="math"&gt;\(r\)&lt;/span&gt;是地球半径。&lt;/p&gt;
&lt;p&gt;对于常见的地球模型，比如PREM，都是给出了地球内部各个深度的速度值。因而对于每一个球层来说，速度都是半径的函数，进而导致垂直慢度是半径的函数，因而积分会变得复杂起来。&lt;/p&gt;
&lt;p&gt;下面会介绍几种Tau积分的思路。为了更直观起见，现在假设有这一一个球层，上下边界的半径分别为3480 km和3380km，速度分别为8.06 km/s和8.20&amp;nbsp;km/s。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;匀速层积分法&lt;/h2&gt;
&lt;p&gt;最简单的方法是将球层内的速度近似为一个常数。比如这里，可以把这个100km厚的球层当做是一个匀速层。但是这个速度怎么取就是一个问题了。取8.06的话积分结果偏大，取8.20的话积分结果偏小。取均值8.13吧，好像又没有什么道理，毕竟垂直慢度跟速度之间又不是线性关系。所以把整个球层当做匀速有点不靠谱，而且误差会很大。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;线性速度积分法&lt;/h2&gt;
&lt;p&gt;一个比较合理的假设是，在球层内速度线性变化，即&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
v = a + b r
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中a和b的值由上下边界的半径和速度决定。&lt;/p&gt;
&lt;p&gt;在速度线性变化的假定下，Tau函数的积分是没有解析表达式的，只能进行数值积分。&lt;/p&gt;
&lt;p&gt;数值积分的话，一般可以调用库函数，自己写的话也挺简单。比如可以考虑把100km的球层，再细分为1km的子球层，然后用矩形积分公式或梯形积分公式做数值积分。&lt;/p&gt;
&lt;p&gt;理论上，子球层的厚度越小，计算结果越精确，同时也导致计算量越大。而如果子球层的厚度取得不够小，则计算的误差可能稍大。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;指数慢度模型&lt;/h2&gt;
&lt;p&gt;假设每一层的&lt;strong&gt;慢度&lt;/strong&gt;模型的形式为&lt;span class="math"&gt;\(u=a r^b\)&lt;/span&gt;，这种模型一般称为Bullen&amp;nbsp;Type模型。&lt;/p&gt;
&lt;p&gt;将上下边界的半径和慢度带入：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u_1 = a r_1^b
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
u_2 = a r_2^b
\end{equation*}
&lt;/div&gt;
&lt;p&gt;计算得到：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b = \frac{ln u_1/u_2}{ln r_1/r_2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;在这样的近似下，tau函数的积分可以进一步简化。&lt;/p&gt;
&lt;p&gt;将慢度的公式代入射线参数的定义中：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p = u \sin \theta = a r^b \sin \theta
\end{equation*}
&lt;/div&gt;
&lt;p&gt;将上式对半径求导数：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
0 = ab r^{b-1} dr \sin \theta + a r^b \cos \theta d\theta
\end{equation*}
&lt;/div&gt;
&lt;p&gt;整理得到：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{dr}{r} = - \frac{\cos\theta}{b \sin\theta} d\theta
\end{equation*}
&lt;/div&gt;
&lt;p&gt;代入tau函数的积分公式：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\tau(p) = \int_{r_1}^{r_2} \eta \frac{dr}{r}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
        = \int_{r_1}^{r_2} p \frac{\cos \theta}{\sin\theta} \frac{dr}{r}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
        = -\frac{p}{b} \int_{\theta_1}^{\theta_2} \frac{\cos^2\theta}{\sin^2\theta} d\theta
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
        = -\frac{p}{b} \int_{\theta_1}^{\theta_2} (\frac{1}{\sin^2\theta}-1) d\theta
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
        = - \frac{p}{b} (\theta+\frac{\cos\theta}{\sin\theta})|_\theta_1^\theta^2
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="走时"></category></entry><entry><title>CPS330的安装</title><link href="http://seisman.info/install-cps330.html" rel="alternate"></link><updated>2015-05-12T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-05-12:install-cps330.html</id><summary type="html">&lt;p&gt;CPS330全称Computer Programs in&amp;nbsp;Seismology，是圣路易斯大学地震中心开发并维护的一款地震学软件包，其主要关注地震波在地壳和上地幔介质中的传播和解释。&lt;/p&gt;
&lt;p&gt;本文介绍如何在Linux系统下编译安装CPS330。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;解压:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ tar -xvf NP330.Jun-11-2014.tgz
$ cd PROGRAMS.330
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;配置&lt;/p&gt;
&lt;p&gt;如果是32位系统则:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./Setup LINUX40
&lt;/pre&gt;
&lt;p&gt;如果是64位系统则:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./Setup LINUX6440
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;编译:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./C
&lt;/pre&gt;
&lt;p&gt;接下来会编译一段时间，最终在bin目录下应该生成149个可执行文件。当然，不同版本可能可执行文件的数目有差异。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;环境变量&lt;/p&gt;
&lt;p&gt;把bin目录加入到环境变量PATH中，然后重启终端即可。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;说明：编译时使用gcc和gfortran编译器。g77已经是很老旧的版本了，稍微新的Linux发行版中都不再提供了，因而不推荐使用。&lt;/p&gt;
</summary><category term="安装"></category><category term="编译"></category></entry><entry><title>震相走时的计算</title><link href="http://seisman.info/travel-time-calculation.html" rel="alternate"></link><updated>2015-05-02T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-05-02:travel-time-calculation.html</id><summary type="html">
&lt;p&gt;震相走时的计算是地震学的基本问题之一。&lt;/p&gt;
&lt;p&gt;目前，计算一维分层模型下的震相走时，主要使用两个程序包：ttimes和TauP。ttimes相对来说有些古老，所以多数情况下更推荐使用TauP。但TauP不支持PKPab、PKPbc这种震相名，所以偶尔可能还是需要使用ttimes。&lt;/p&gt;
&lt;p&gt;ttimes和TauP都是根据Buland and Chapman（&lt;span class="caps"&gt;BSSA&lt;/span&gt;, 1983）提出的理论框架来实现的，本文是对这篇文章的核心内容的简单总结。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;提出问题&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;给定一维水平分层模型，若震源位于地表，要求计算某一震相（如P波）在特定震中距（如50度）处的震相走时。&lt;/p&gt;
&lt;p&gt;说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;球状分层模型和水平分层模型下的理论公式基本相同，只是个别变量需要做简单替换，这里用更简单的水平分层模型；&lt;/li&gt;
&lt;li&gt;震源位于地表或地下，只会影响到积分的上下限，这里为了简化，将震源放在地表；&lt;/li&gt;
&lt;li&gt;这里以简单的P波为例，理论上是可以算各种复杂路径的震相的；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;基本公式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;对于一个速度仅是深度的函数的一维分层速度模型&lt;span class="math"&gt;\(v(z)\)&lt;/span&gt;，其慢度为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(z) = \frac{1}{v(z)}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;定义射线参数（即水平慢度）为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p = \frac{\sin(i(z))}{v(z)}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(i(z)\)&lt;/span&gt;是射线与垂直方向的夹角。垂直慢度为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\eta(p, z) = (u^2(z)-p^2)^{\frac{1}{2}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;在做了如上定义后，对于从地表发出的任意一条射线参数为&lt;span class="math"&gt;\(p\)&lt;/span&gt;的射线，即可计算出该射线所对应的走时和震中距(Introduction to Seismology, Peter Shearer, 公式4.31-4.32及之间的推导)：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
T(p) = 2\int_0^{z_p} \frac{u^2(z)}{\eta} dz
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
X(p) = 2p\int_0^{z_p}\frac{dz}{\eta}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(z_p\)&lt;/span&gt;是射线的反转点（turning point）的深度。&lt;/p&gt;
&lt;p&gt;另一个重要的公式是：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p = \frac{dT}{dX}
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;基本解法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有了上面的几个公式，基本就可以有一个直观暴力的解法了。&lt;/p&gt;
&lt;p&gt;对于任一射线参数&lt;span class="math"&gt;\(p\)&lt;/span&gt;，都可以找到射线的&lt;span class="math"&gt;\(z_p\)&lt;/span&gt;，然后即可积分计算该射线所对应的震中距&lt;span class="math"&gt;\(X(p)\)&lt;/span&gt;和走时&lt;span class="math"&gt;\(T(p)\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;但是问题中要计算的是特定震中距X0的走时，那么就可以对射线参数进行遍历，每给一个射线参数，就计算一个震中距X(p)，若X(p)&amp;gt;X0，则把射线参数改大一些，若X(p)&amp;lt;X(0)，则把射线参数改小一些。最终，总可以找到一个射线参数，使得X(p)和X0几乎相等。&lt;/p&gt;
&lt;p&gt;这基本就是一个二分查找，实现起来也很简单。但此方法的问题在于，假定了X(p)是p的单调递减函数，而真实地球模型中有低速层和高速不连续面，会出现三叉波和影区，不符合单调递减函数的假设。在同一个震中距处可以有多个射线参数。&lt;/p&gt;
&lt;p&gt;因而这里的思路仅适用于某些简单的震相，比如P、PcP、PKiKP之类。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="tau-p"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;tau(p)&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;定义delay-time函数&lt;span class="math"&gt;\(\tau(p)\)&lt;/span&gt;：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\tau(p) = T(p) - pX(p)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;简单推导可知，tau函数可以用如下公式计算：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\tau(p) = 2\int_0^{z_p} \eta dz
\end{equation*}
&lt;/div&gt;
&lt;p&gt;且其具有如下性质：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d\tau}{dp} = \frac{dT}{dp} - X(p) - p \frac{dX}{dp}
                 = \frac{dT}{dX}\frac{dX}{dp} - X(p) - p \frac{dX}{dp}
                 = -X(p)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;由于X(p)是震中距，为非负值，因而，&lt;span class="math"&gt;\(d\tau/dp\)&lt;/span&gt;是个非正值。即函数&lt;span class="math"&gt;\(\tau(p)\)&lt;/span&gt;的斜率是非正值，因而tau函数是一个单调递减函数，即对任意一个射线参数p，都有唯一的tau。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="theta-p-x"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;theta(p,x)函数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;进一步定义theta函数：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\theta(p,x) = \tau(p) + px
\end{equation*}
&lt;/div&gt;
&lt;p&gt;再看看前面tau函数的定义：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
T(p) = \tau(p) + pX(p)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;theta(p,x)和T(p)看上去很相似，但需要特别注意的是，T(p)是p的函数，而theta是p和x的函数。即在T(p)的定义中，X(p)是射线p所对应的震中距，具有唯一或唯N个值；而theta函数中，x是一个任意的变量，理解这一点很重要。&lt;/p&gt;
&lt;p&gt;theta函数对p求偏导，可得：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \theta}{\partial p} = \frac{d\tau}{dp} + x = x - X(p)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;因而，若在某个p0处，有theta函数对p的偏导为零，则有x=X(p0)，进而有：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
T(p_0) = \tau(p_0) + p_0 X(p_0) = \theta(p_0, X(p_0))
\end{equation*}
&lt;/div&gt;
&lt;p&gt;上面的公式表明：若某个p0处，theta函数对p的偏导为零，则该射线参数p0所对应的theta值就是射线的走时T(p0)。&lt;/p&gt;
&lt;p&gt;下图是一个比较直观的例子（Chapman, 1978, &lt;span class="caps"&gt;GJI&lt;/span&gt;, Figure 12）。对于存在高速区的情况，走时曲线中会出现三叉波，如左上图T(X)曲线所示。左下图中给出了tau(p)曲线，是一个单调递减曲线。对于震中距A、B、C、D，分别计算了其对应的theta曲线，如右边四张图所示。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="2015050201.png" src="/images/2015050201.png" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;对于震中距A，从theta曲线中可以看出，该曲线有三个局部极值，因而在震中距A处，有三条射线参数不同的射线，在不同的时间抵达震中距A；&lt;/li&gt;
&lt;li&gt;对于震中距B，左边有一个明显的局部极值，右边有一小段，theta曲线近似为平的，这意味着，存在某段射线参数，其到震中距B的走时基本是一样的。这一点一般称为caustic，在射线理论中，这里的振幅是无穷大的。&lt;/li&gt;
&lt;li&gt;对于震中距C，有一个局部极值点；&lt;/li&gt;
&lt;li&gt;对于震中距D，无局部极值点；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;总之，对于特定震中距，计算出theta曲线后，从曲线中很容易看出在该震中距处有哪些射线在何时到达，这也是WKBJ理论地震图计算方法的基本原理的一部分。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;高级解法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有了上面的theta函数及其性质作为理论基础，就可以顺畅的解决上面的问题了。&lt;/p&gt;
&lt;p&gt;基本步骤如下：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;读取速度模型，计算得到慢度模型&lt;/li&gt;
&lt;li&gt;对p做遍历，计算得到离散的tau(p)函数&lt;/li&gt;
&lt;li&gt;计算特定震中距X0处的theta(p,x)，即theta(p,X0)，或表示为theta(p)&lt;/li&gt;
&lt;li&gt;寻找theta(p)对p的偏导为零的点，即theta(p)的局部极值点&lt;/li&gt;
&lt;li&gt;每个极值点处射线参数p0即为符合要求的射线参数，而theta(p0)则为要计算的走时&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;其他细节&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;上面总结了计算走时的理论框架，实际数值计算时还甚至到更多的细节，具体参考1983那篇文章的后面部分。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;span class="math"&gt;\(tau(p)\)&lt;/span&gt;积分的计算；&lt;/li&gt;
&lt;li&gt;震源深度的处理；&lt;/li&gt;
&lt;li&gt;极值的寻找；&lt;/li&gt;
&lt;li&gt;…&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;参考文献&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Chapman, &lt;span class="caps"&gt;C. H.&lt;/span&gt;(1978). A new method for computing synthetic seismograms. Geophysical Journal International, 54(3), 481-518.&lt;/li&gt;
&lt;li&gt;Shearer, &lt;span class="caps"&gt;P. M.&lt;/span&gt;(2009). Introduction to seismology. Cambridge University Press.&lt;/li&gt;
&lt;li&gt;Buland, R., and Chapman, &lt;span class="caps"&gt;C. H.&lt;/span&gt;(1983). The computation of seismic travel times. Bulletin of the Seismological Society of America, 73(5), 1271-1302.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="走时"></category><category term="理论"></category></entry><entry><title>调用SAC进行Hilbert变换</title><link href="http://seisman.info/hilbert-transform-in-sac.html" rel="alternate"></link><updated>2015-04-29T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-04-29:hilbert-transform-in-sac.html</id><summary type="html">&lt;p&gt;需要在C程序中对数据做Hilbert变换，自己写显然是不可能的啦，重复造轮子不说，写的还不一定对。找了一些代码，发现都写的好复杂，后来发现SAC在函数库中提供了Hilbert变换的接口，可以直接调用。&lt;/p&gt;
&lt;p&gt;firtrn可以用于对数据进行Hilbert变换，但是官方没有给一个比较直白的例子。下面就贴一个我写的例子啦。&lt;/p&gt;
&lt;p&gt;需要注意，SAC自带的Hilbert变换要求数据至少201个点。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#define NPTS 1000&lt;/span&gt;
&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;hilbert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NPTS&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;hdata&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;// 准备输入数据&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;NPTS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// 进行Hilbert变换，hdata为Hilbert变换的结果&lt;/span&gt;
    &lt;span class="n"&gt;hdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hilbert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;NPTS&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NPTS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// 这里定义了hilbert函数，是对firtrn函数的一个封装&lt;/span&gt;
&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;hilbert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;buffer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;firtrn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;HILBERT&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="C"></category></entry><entry><title>GMT 5.1.1在Windows下的安装</title><link href="http://seisman.info/install-gmt5-under-windows.html" rel="alternate"></link><updated>2015-04-18T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-04-18:install-gmt5-under-windows.html</id><summary type="html">
&lt;p&gt;本文介绍如何在Windows 7下安装GMT5.1.1。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Windows下安装GMT5.1.1需要下载三个文件：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://gmt.soest.hawaii.edu/files/download?name=gmt-5.1.1-win64.exe"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 64位安装包&lt;/a&gt; 或 &lt;a class="reference external" href="http://gmt.soest.hawaii.edu/files/download?name=gmt-5.1.1-win32.exe"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 32位安装包&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://downloads.ghostscript.com/public/gs916w64.exe"&gt;ghostscript 64位安装包&lt;/a&gt; 或 &lt;a class="reference external" href="http://downloads.ghostscript.com/public/gs916w32.exe"&gt;ghostscript 32位安装包&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://pages.cs.wisc.edu/~ghost/gsview/download/gsv50w64.exe"&gt;GSView 64位安装包&lt;/a&gt; 或 &lt;a class="reference external" href="http://pages.cs.wisc.edu/~ghost/gsview/download/gsv50w32.exe"&gt;GSView 32位安装包&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;安装&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;安装GMT&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;跟大多数Windows的程序一样，双击exe就好。几个需要注意的地方如下图：&lt;/p&gt;
&lt;p&gt;GMT5安装文件会自动添加环境变量，如下图所示，三个可选项中选第一个或第二个就好。不要选第三个，除非你知道自己在做什么。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="添加环境变量" src="/images/2015041801.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;GMT5默认的安装目录是&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;c:\programs\gmt5&lt;/span&gt;&lt;/tt&gt;，使用此默认值就好，不建议修改此安装目录。&lt;/p&gt;
&lt;p&gt;尝试安装在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;c:\Program&lt;/span&gt; Files\gmt5&lt;/tt&gt;下，执行命令好像也没问题，但不确定目录名中的空格是否会在什么地方挖个坑。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="安装目录" src="/images/2015041802.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;选择组件那里，Runtime files是必须的，DCW是国界、省界数据，Documentation是官方文件以及官方示例，GSHHG是海岸线数据。所以四个都安装就好。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="选择组件" src="/images/2015041803.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;安装完成之后，启动cmd：“开始”-&amp;gt;“所有程序”-&amp;gt;“附件”-&amp;gt;“命令提示符”，也可以直接在开始那里搜索“cmd”。在cmd窗口中键入&lt;tt class="docutils literal"&gt;gmt&lt;/tt&gt;，效果如下则表明GMT安装成功。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="启动cmd" src="/images/2015041804.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="ghostscript"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;安装ghostscript&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ghostscrip的安装没什么好说的，在安装的最后，第一个复选框一定要选上，这关系到GMT能否支持中文的问题。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="ghostscript CJK" src="/images/2015041805.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gsview"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;安装GSView&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GSView的安装没什么好说的，一直点下去用默认的选项就好。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;测试&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT自带了一些例子，可以把&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;C:\programs\gmt5\share\doc\examples&lt;/span&gt;&lt;/tt&gt;目录下的例子复制一份到自己的目录下。每个例子里包含了bat脚本，以及执行脚本所需的数据文件。&lt;/p&gt;
&lt;p&gt;双击即可直接执行bat脚本，右键编辑即可查看bat脚本的内容。&lt;/p&gt;
&lt;p&gt;双击生成的PS文件即可用GSView打开。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;其他&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;安装完成后，你可以对如下几篇博文感兴趣：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/gmt4-style-guide.html"&gt;GMT4脚本风格指南&lt;/a&gt; ：虽然是针对GMT4的，但是对GMT5也有一定的指导意义&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/how-to-use-gmt-under-windows.html"&gt;Windows下使用GMT的正确姿势&lt;/a&gt; ：教你如何在Windows下更愉快地使用GMT&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/gmt-chinese-support-under-windows.html"&gt;GMT在Windows下的中文支持&lt;/a&gt; ：如何在GMT中添加中文&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="GMT5"></category><category term="Windows"></category><category term="安装"></category></entry><entry><title>一些产品的推广链接</title><link href="http://seisman.info/my-referral-links.html" rel="alternate"></link><updated>2015-04-11T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-04-11:my-referral-links.html</id><summary type="html">&lt;p&gt;本文列出了我在使用的部分产品/服务的推广链接，读者若点击我的推广链接，注册并使用相关的产品/服务，则我可以获取一定的好处。&lt;/p&gt;

&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;七牛云存储&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;七牛云存储一般用于托管博客中的静态资源，比如图片、文件等。目前本博客的静态资源都托管在七牛中。&lt;/p&gt;
&lt;p&gt;推广链接: &lt;a class="reference external" href="https://portal.qiniu.com/signup?code=3ljo5rxaartxu"&gt;https://portal.qiniu.com/signup?code=3ljo5rxaartxu&lt;/a&gt; （0/8）&lt;/p&gt;
&lt;p&gt;点击以上推广链接，注册七牛并称为标准用户，则我将获得每月5GB的下载流量。&lt;/p&gt;
&lt;p&gt;标准用户永久获得以下免费额度：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;10GB永久免费存储空间&lt;/li&gt;
&lt;li&gt;每月10GB下载流量&lt;/li&gt;
&lt;li&gt;每月10万次Put请求&lt;/li&gt;
&lt;li&gt;每月100万次Get请求&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;成为标准用户需要：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;注册账户&lt;/li&gt;
&lt;li&gt;激活邮箱&lt;/li&gt;
&lt;li&gt;绑定手机&lt;/li&gt;
&lt;li&gt;填写身份证号码&lt;/li&gt;
&lt;li&gt;上传身份证持证照&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;考虑到需要提供隐私信息，非坚定用户还是不要注册了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="dropbox"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Dropbox&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Dropbox是知名的网盘服务，与百度云之类的网盘不同，其提供的容量很小，因而主要用于小文件的备份以及同步。&lt;/p&gt;
&lt;p&gt;其特点在于：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;免费用户只有2GB容量，最大可扩容到18GB以上；付费用户容量为1T，对于国内用户稍稍有些贵；&lt;/li&gt;
&lt;li&gt;跨平台，是为数不多的支持Linux的网盘之一（另外一个是坚果云）；&lt;/li&gt;
&lt;li&gt;同步功能强大；&lt;/li&gt;
&lt;li&gt;已被墙；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;邀请链接： &lt;a class="reference external" href="https://db.tt/sC6uCvbu"&gt;https://db.tt/sC6uCvbu&lt;/a&gt; (2/32)&lt;/p&gt;
&lt;p&gt;若点击此链接注册Dropbox，则我和你都会获得500MB的永久容量。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="onedrive"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;OneDrive&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;微软的云服务，新版的Word、Excel、PowerPoint以及Onenote等等都可以直接保存到OneDrive中。初始免费容量15G。&lt;/p&gt;
&lt;p&gt;邀请链接： &lt;a class="reference external" href="https://onedrive.live.com/?invref=7a70adf12890b43a&amp;amp;invsrc=90"&gt;https://onedrive.live.com/?invref=7a70adf12890b43a&amp;amp;invsrc=90&lt;/a&gt; (0/10)&lt;/p&gt;
&lt;p&gt;若点击此链接注册OneDrive，则我和你均可获得500MB容量。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="博客"></category></entry><entry><title>从3D数据中截取剖面</title><link href="http://seisman.info/profile-from-3d-data.html" rel="alternate"></link><updated>2015-04-08T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-04-08:profile-from-3d-data.html</id><summary type="html">&lt;p&gt;本文所说的3D数据是指XYZD数据。常见的情况是数据中包含四列：经度、纬度、深度、值。&lt;/p&gt;
&lt;p&gt;GMT几乎是不可以处理3D数据的，比如与网格相关的命令只支持2D&amp;nbsp;netCDF文件。另外，GMT绘制3D图的效果也很一般，因而通常情况下都需要从3D数据中截取剖面，绘制剖面图。&lt;/p&gt;
&lt;p&gt;本文试着介绍如何从3D数据中截取自己想要的剖面。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;数据准备&lt;/h2&gt;
&lt;p&gt;因为我手头没有真实的数据，所以这里虚构一个3D数据。就示例而言，虚构的数据也许比真实的数据的演示效果更好。&lt;/p&gt;
&lt;p&gt;虚构数据如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;X的范围为0到9，间隔为1；&lt;/li&gt;
&lt;li&gt;Y的范围为10到19，间隔为1；&lt;/li&gt;
&lt;li&gt;Z的范围为20到29，间隔为1；&lt;/li&gt;
&lt;li&gt;D的值由X、Y、Z的值唯一决定；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;生成虚构数据的C代码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d %d %d %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;截取垂直于坐标轴的剖面&lt;/h2&gt;
&lt;p&gt;最简单的情况是从3D速度结构中截取某个深度的速度结构，比如Z=24这个垂直于Z轴的平面。此时直接用&lt;tt class="docutils literal"&gt;gawk&lt;/tt&gt;将3D数据中Z=24的点提取出来:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gawk '$3==24 {print $1,$2,$4}' data.xyzd &amp;gt; Z24.xyd
&lt;/pre&gt;
&lt;p&gt;如果数据的间隔比较小，用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;$3==4&lt;/span&gt;&lt;/tt&gt;去判断可能有些危险，更安全点的方法是:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gawk '$3&amp;gt;23.999 &amp;amp;&amp;amp; $3&amp;lt;24.001 {print $1,$2,$4}' data.xyzd &amp;gt; Z24.xyd
&lt;/pre&gt;
&lt;p&gt;截取了这个剖面之后，下面就是&lt;tt class="docutils literal"&gt;xyz2grd&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;grdimage&lt;/tt&gt;了，不多说。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;截取垂直于坐标平面的平面&lt;/h2&gt;
&lt;p&gt;最常见的情况是，地表有一个测线，需要做一个沿着这个测线的垂直于地表的剖面。&lt;/p&gt;
&lt;p&gt;这里用project命令虚构起点在(2,12)，终点为(5,16)，间距为1的剖面:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
project -C2/12 -E5/16 -G1 &amp;gt; track.data
&lt;/pre&gt;
&lt;p&gt;track.data内容如下，三列数据分别为经度、纬度以及离起点的距离（大圆距离）:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2   12  0
2.59831503664   12.8115096006   1
3.20049364771   13.6216595304   2
3.80680955458   14.4303509263   3
4.41754162203   15.2374825707   4
5   16  4.94662175502
&lt;/pre&gt;
&lt;p&gt;思路其实很简单，如上面那个例子，先用gawk取深度Z=20处的平面，然后将其转换为网格文件，并用grdtrack取该深度在测线上的值；然后取下一个深度，依次处理下去。&lt;/p&gt;
&lt;p&gt;下面给出了一个示例脚本，该脚本可以解决本文的问题，但灵活性不够，所以使用者需要根据自己的情况改写或重写，理解原理最重要。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="c"&gt;# 用于清除上一次执行该脚本时生成的文件&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; -e track.profile &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
    rm track.profile
&lt;span class="k"&gt;fi&lt;/span&gt;

&lt;span class="c"&gt;# 对深度进行循环&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 20&lt;span class="p"&gt;;&lt;/span&gt; i &amp;lt; 30&lt;span class="p"&gt;;&lt;/span&gt; i++&lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="c"&gt;# 取某个深度的剖面&lt;/span&gt;
    gawk -v &lt;span class="nv"&gt;dep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;$3==dep {print $1,$2,$4}&amp;#39;&lt;/span&gt; data.xyzd &amp;gt; &lt;span class="nv"&gt;$i&lt;/span&gt;.xyd
    &lt;span class="c"&gt;# 将数据转换为netCDF格式&lt;/span&gt;
    xyz2grd &lt;span class="nv"&gt;$i&lt;/span&gt;.xyd -R0/10/10/20 -I1/1 -G&lt;span class="nv"&gt;$i&lt;/span&gt;.nc
    &lt;span class="c"&gt;# 在该深度处做grdtrack，最终结果重定向到track.profile中&lt;/span&gt;
    grdtrack track.data -G&lt;span class="nv"&gt;$i&lt;/span&gt;.nc &lt;span class="p"&gt;|&lt;/span&gt; gawk -v &lt;span class="nv"&gt;dep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{print $3, dep, $4}&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; track.profile

    rm &lt;span class="nv"&gt;$i&lt;/span&gt;.xyd &lt;span class="nv"&gt;$i&lt;/span&gt;.nc
&lt;span class="k"&gt;done&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;几点说明:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;使用gawk时，涉及到要向gawk传递一个bash中的变量，需要使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-v&lt;/span&gt;&lt;/tt&gt;选项；&lt;/li&gt;
&lt;li&gt;grdtrack命令的输出有四列，分别是经度、纬度、离起点的距离以及Z；&lt;/li&gt;
&lt;li&gt;绘制剖面时，一般需要离起点的距离，以及深度这两个信息，所以用gawk处理了一下；&lt;/li&gt;
&lt;li&gt;所有的循环的输出都重定向到文件track.profile，最终该文件中有三列，离起点的距离、深度以及值；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;任意一个倾斜剖面&lt;/h2&gt;
&lt;p&gt;这个说难不难，说简单也不简单。首先，如何用一些参数去定义这个剖面就是个问题。假设定义好了，就可以通过某些计算，得到这个剖面与地表的交线以及剖面与各个深度水平面的交线。&lt;/p&gt;
&lt;p&gt;有了这些交线，就可以用与上面的例子类似的方法对每个深度处做grdtrack，然后把结果收集起来即可。&lt;/p&gt;
&lt;p&gt;思路有了，具体的就不写啦。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="GMT技巧"></category></entry><entry><title>全球地形起伏数据：SRTM15_PLUS</title><link href="http://seisman.info/srtm15-plus.html" rel="alternate"></link><updated>2015-04-07T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-04-07:srtm15-plus.html</id><summary type="html">&lt;p&gt;SRTM15_PLUS是&lt;a class="reference external" href="http://seisman.info/srtm30-plus.html"&gt;SRTM30_PLUS&lt;/a&gt;的升级版，其空间分辨率为15弧秒，相当于0.5km。其包含了陆地高程和海洋深度数据，具体信息参考SRTM30_PLUS的介绍。&lt;/p&gt;
&lt;p&gt;数据下载：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm15_plus/README.V1.txt"&gt;&lt;span class="caps"&gt;README&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm15_plus/SRTM15.kmz"&gt;Google &lt;span class="caps"&gt;KMZ&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm15_plus/topo15.grd"&gt;&lt;span class="caps"&gt;14GB&lt;/span&gt;&amp;nbsp;netCDF数据&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;netCDF数据可直接在GMT中使用。&lt;/p&gt;
</summary><category term="地形"></category><category term="网格"></category><category term="高程"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>GMT学习QQ群</title><link href="http://seisman.info/qq-group-for-learning-gmt.html" rel="alternate"></link><updated>2015-03-17T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-03-17:qq-group-for-learning-gmt.html</id><summary type="html">&lt;p&gt;地学GMT学习群是&amp;#64;Leo于2012年9月创建的用于GMT学习与交流的QQ群。目前群成员有500多人，活跃人员有100多人。&lt;/p&gt;
&lt;p&gt;群内活动主要包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GMT学习与讨论；&lt;/li&gt;
&lt;li&gt;绘图技巧；&lt;/li&gt;
&lt;li&gt;数据共享；&lt;/li&gt;
&lt;li&gt;文献求助；&lt;/li&gt;
&lt;li&gt;闲聊；&lt;/li&gt;
&lt;li&gt;其他;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;QQ群号：218905582&lt;/p&gt;
&lt;p&gt;申请入群时请填写验证信息，无验证信息者会被拒绝。&lt;/p&gt;
&lt;p&gt;关于群内求助，我个人有如下几点要求，不代表群内其他人的观点：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;请先阅读《&lt;a class="reference external" href="http://www.beiww.com/doc/oss/smart-questions.html"&gt;提问的智慧&lt;/a&gt;》一文；&lt;/li&gt;
&lt;li&gt;提问之前先自己好好想想，Google找一找，不要遇到问题就在群里问；&lt;/li&gt;
&lt;li&gt;学着付出，即便你是GMT初学者无法回答别人的问题，偶尔帮别人下一两篇文献也是好的；&lt;/li&gt;
&lt;li&gt;文献求助时，应直接给出文献对应的官方链接，这样其他人可以直接点链接而不必再去搜索；&lt;/li&gt;
&lt;li&gt;收到文献后，尽快在群里说明已收到，避免其他人重复下载；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;跟我有关的几点说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;非好友不要直接私信我，有问题在群里问；&lt;/li&gt;
&lt;li&gt;不要随便加我好友，USTC的妹子除外；&lt;/li&gt;
&lt;li&gt;即便是好友，也不要随意私信我，有问题在群里问；&lt;/li&gt;
&lt;li&gt;不要向我要什么GMT模板；&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="GMT"></category></entry><entry><title>修改GMT生成的PS文件的标题</title><link href="http://seisman.info/change-title-of-postscript-files-generated-by-gmt.html" rel="alternate"></link><updated>2015-03-14T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-03-14:change-title-of-postscript-files-generated-by-gmt.html</id><summary type="html">&lt;p&gt;本文整理自：&lt;a class="reference external" href="http://gmt.soest.hawaii.edu/boards/1/topics/1820"&gt;http://gmt.soest.hawaii.edu/boards/1/topics/1820&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;需要说明的一点，本文是要修改PS文件的标题，而不是PS文件的文件名。&lt;/p&gt;
&lt;p&gt;用编辑器打开任意一个GMT生成的PS文件，查看文件的前几行，其中一行大概如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
%%Title: GMT v5.1.1 (r12968) [64-bit] Document from psxy
&lt;/pre&gt;
&lt;p&gt;这就是所谓的PS文件的标题。当用evince或gv打开PS文件时，该标题会在软件的某个位置显示。&lt;/p&gt;
&lt;p&gt;从上面的例子中可以看到，GMT生成的PS文件的标题中几乎没有带有任何有意义的信息。而在看图的时候可能经常需要从几张相似的图中区分哪张图来自哪个数据，当然可以通过定义很复杂的PS文件名来区分不同的数据，但那么大的一个标题不用，似乎有些太浪费了。&lt;/p&gt;
&lt;p&gt;GMT软件自身不能自定义PS文件的标题，只能通过外部程序实现:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sed -i 's/^%%Title:.*/%%Title: '&amp;quot;$NEW_TITLE/&amp;quot; $FILE
&lt;/pre&gt;
&lt;p&gt;其中变量&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;FILE&lt;/span&gt;&lt;/tt&gt;是要修改标题的PS文件名，&lt;tt class="docutils literal"&gt;$NEW_TITLE&lt;/tt&gt;是要修改的新标题。这条命令本质上就是一个简单的字符串替换而已，比如:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sed -i 's/^%%Title:.*/%%Title: '&amp;quot;This is new title/&amp;quot; test.ps
&lt;/pre&gt;
</summary><category term="GMT技巧"></category></entry><entry><title>修改Y轴的坐标标注的方向</title><link href="http://seisman.info/change-orientation-of-y-axis-annotations.html" rel="alternate"></link><updated>2015-03-11T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-03-11:change-orientation-of-y-axis-annotations.html</id><summary type="html">&lt;p&gt;在用GMT绘制底图时，通常Y轴的标注都是水平的，比如如下绘制底图的命令:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt psbasemap -R0/50/-30/30 -JM10c -Bx10 -By10 &amp;gt; test.ps
&lt;/pre&gt;
&lt;p&gt;效果如下图&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure 1" src="/images/2015031101.png" style="width: 400px;" /&gt;
&lt;/div&gt;
&lt;p&gt;有些时候想要让Y轴的标注逆时针旋转90度，即Y轴的标注方向与Y轴平行而不是与X轴平行。想要实现的效果如下图。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure 2" src="/images/2015031102.png" style="width: 400px;" /&gt;
&lt;/div&gt;
&lt;p&gt;想要实现上图所示的效果，很简单，只需要修改GMT的参数&lt;tt class="docutils literal"&gt;MAP_ANNOT_OBLIQUE&lt;/tt&gt;即可，代码如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt set MAP_ANNOT_OBLIQUE 32
gmt psbasemap -R0/50/-30/30 -JM10c -Bx10 -By10 &amp;gt; test.ps
&lt;/pre&gt;
&lt;p&gt;几点说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;GMT4下需要修改&lt;tt class="docutils literal"&gt;OBLIQUE_ANNOTATION&lt;/tt&gt;为32；&lt;/li&gt;
&lt;li&gt;该参数对&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;JX&lt;/span&gt;&lt;/tt&gt;无效，可能只对地理投影有效；&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="GMT技巧"></category></entry><entry><title>征集《SAC参考手册》维护者</title><link href="http://seisman.info/maintainers-for-sac-manual-wanted.html" rel="alternate"></link><updated>2015-03-14T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-03-07:maintainers-for-sac-manual-wanted.html</id><summary type="html">
&lt;p&gt;如题，希望能够征集到至少一人参与《SAC参考手册》的维护。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;手册简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt;（Seismic Analysis Code）是地震学专业常用的数据处理软件之一，《SAC参考手册》是一本详细介绍SAC用法的中文电子书。2011年暑假，我尝试翻译了官方的英文文档，2012年初将其整理为PDF，并放在网络上免费下载，2012年至2015年的三年间，该手册不断更新，目前文档的最新版本为v3.1。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;文档发布页：&lt;a class="reference external" href="http://seisman.info/sac-manual.html"&gt;http://seisman.info/sac-manual.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;项目主页：&lt;a class="reference external" href="https://github.com/seisman/SAC_Docs_zh"&gt;https://github.com/seisman/SAC_Docs_zh&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;我为何不再维护&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;自3.0版发布之后，我就已经有不再维护该手册的想法：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;我对于SAC已经足够熟悉，日常使用过程中，没有阅读手册的需求，也就没有更新的动力；&lt;/li&gt;
&lt;li&gt;进入博士阶段，科研的压力日益繁重，没有足够的时间和精力继续维护；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;为何要征集维护者&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;SAC在接下来的几年之内都不会被淘汰，依然是地震学专业常用的数据处理软件之一；&lt;/li&gt;
&lt;li&gt;当SAC软件更新时，手册也需要及时更新；用着新版的软件却读着旧版的文档，谁也不知道什么时候会遇到一个坑；&lt;/li&gt;
&lt;li&gt;整个文档的主体部分我已经基本做完，维护者的负担不会太大；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;需要维护的内容&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;所谓的维护，主要包括如下几个方面：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;随着SAC软件新版本的发布，新增或更新手册中相应的内容；&lt;/li&gt;
&lt;li&gt;完善未讲清楚或易引起歧义的部分；&lt;/li&gt;
&lt;li&gt;修复错别字；&lt;/li&gt;
&lt;li&gt;增加日常数据处理过程中的一些SAC技巧；&lt;/li&gt;
&lt;li&gt;对于命令及用法，若不同版本间存在不兼容，则以最新版本的SAC为准，并在正文或脚注中适当提及版本间的差异。&lt;/li&gt;
&lt;li&gt;增加你认为值得加入的部分；&lt;/li&gt;
&lt;li&gt;文档整体布局的调整以及LaTeX源码的简化；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;对维护者的最低要求&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;SAC用户（SAC初学者）；&lt;/li&gt;
&lt;li&gt;操作系统以Linux为主；&lt;/li&gt;
&lt;li&gt;有时间和精力；&lt;/li&gt;
&lt;li&gt;了解LaTeX、Git的基础知识（至少愿意学习和了解）；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;维护者可以得到什么&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;维护者完全无偿工作，没有任何经济上的报酬（若是有机会，我可以请吃顿饭）。除此之外，维护者还可以得到如下一些虚无缥缈的东西：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;手册中会将你列为维护者，并留有邮箱；&lt;/li&gt;
&lt;li&gt;结识更多的SAC用户以及地震学同行；&lt;/li&gt;
&lt;li&gt;了解MarkDown和LaTeX的基础语法；&lt;/li&gt;
&lt;li&gt;学会使用Git，参与开源项目；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id24"&gt;如何参与&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;若有意参与到该手册的维护，请参考如下步骤，过程中遇到问题可以在博客中留言或直接邮件联系我。&lt;/p&gt;
&lt;p&gt;简单的说，参与该项目需要如下步骤：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;拥有Linux系统；&lt;/li&gt;
&lt;li&gt;拥有一个GitHub账户；&lt;/li&gt;
&lt;li&gt;安装TexLive以及中英文字体（可选）；&lt;/li&gt;
&lt;li&gt;Fork手册源码，Clone至本地；&lt;/li&gt;
&lt;li&gt;修改源码，提交修改，并Push到自己的Repo里，再提交Pull Request；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;维护者需要了解三个工具：Linux、Git和LaTeX。其中，对于Git的要求较高，其余两者没有太多要求。&lt;/p&gt;
&lt;p&gt;关于如何利用LaTeX编译生成PDF，请参考项目主页里的README。&lt;/p&gt;
&lt;div class="section" id="github"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id25"&gt;了解GitHub&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/join"&gt;注册&lt;/a&gt;GitHub账户；&lt;/li&gt;
&lt;li&gt;向GitHub账户中添加当前机器的SSH秘钥，参考“&lt;a class="reference external" href="https://help.github.com/articles/generating-ssh-keys/"&gt;GitHub官方文档&lt;/a&gt;”。添加秘钥的目的是使得GitHub账户信任当前计算机，并赋予其&lt;strong&gt;写&lt;/strong&gt;权限；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="git"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id26"&gt;安装和配置git&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;git是版本控制工具，gitk是用于查看的图形工具:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install git gitk
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;git全局配置:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
git config --global user.name "Your Name"
git config --global user.email "you@example.com"
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id27"&gt;第一次使用&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;进入该手册的&lt;a class="reference external" href="https://github.com/seisman/SAC_Docs_zh"&gt;项目主页&lt;/a&gt;，点击右上角的fork；该操作会将&lt;tt class="docutils literal"&gt;seisman&lt;/tt&gt;账户下的&lt;tt class="docutils literal"&gt;SAC_Docs_zh&lt;/tt&gt;项目复制到你的账户下。下面均假定你的账户名叫&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;USER&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;在终端执行如下操作:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
# 下载源码至本机
git clone git@github.com:USER/SAC_Docs_zh.git


# 添加seisman账户下的repo作为其中一个远程repo，并命名为seisman
cd SAC_Docs_zh/
git remote add seisman https://github.com/seisman/SAC_Docs_zh.git

# 用编辑器修改文档
#   比如先修改contributor.tex文件，该文件中包括了该手册的维护者的列表
#   参照已有的记录，添加自己的姓名/昵称、邮箱
#   开始时间是你开始维护此手册的时间
#   结束时间是你决定不再维护此手册的时间
# 修改该文档后，按如下操作提交并推送修改
git add contributor.tex           # 将修改的文件添加到缓存区
git commit -m "add contributor"   # 提交修改，-m后接注释信息
git push -u origin master         # 将修改推送到GitHub服务器
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;进入 &lt;a class="reference external" href="https://github.com/USER/SAC_Docs_zh"&gt;https://github.com/&lt;span class="caps"&gt;USER&lt;/span&gt;/SAC_Docs_zh&lt;/a&gt;，点击Pull Request即可；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;提交完Pull Request之后，我会审核修改，并决定是否接受Pull Request；&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="n"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id28"&gt;第n次使用&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;第一次使用的时候有些复杂，第n次使用的时候步骤就简单很多了。&lt;/p&gt;
&lt;p&gt;命令行操作如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
# 从seisman的repo中拉取源码的最新版本
git pull seisman

# 将seisman的repo中的最新版本与本地版本合并
git merge seisman/master

#
# 修改文件 xxx.0 xxx.1 xxx.2
#

# 添加到缓冲区
git add xxx.0 xxx.1 xxx.2

# 提交更改
git commit -m 'commit messages'

# 推送更改到服务器
git push
&lt;/pre&gt;
&lt;p&gt;Push之后，进入GitHub网站，提交Pull Request即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id29"&gt;其他说明&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;我对于Git也只是了解皮毛，上面的步骤也许有更简单的操作；&lt;/li&gt;
&lt;li&gt;使用Git进行协作的方式有好几种，文中说的是比较常用的一种方式；&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.bootcss.com/p/git-guide/"&gt;git简易指南&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000"&gt;廖雪峰的Git教程&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;可以多次&lt;tt class="docutils literal"&gt;add&lt;/tt&gt;多次再&lt;tt class="docutils literal"&gt;commit&lt;/tt&gt;，多次&lt;tt class="docutils literal"&gt;commit&lt;/tt&gt;再&lt;tt class="docutils literal"&gt;push&lt;/tt&gt;，多次&lt;tt class="docutils literal"&gt;push&lt;/tt&gt;之后再pull request；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;总之，希望有人能够参与进来，哪怕只是改几个错别字也是极好的。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id15"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id30"&gt;如何维护&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在前面提到了手册中有哪些东西需要维护，根据工作量的大小大致可以分为两类：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;小工作量维护，比如修复简单的bug和typo、整理部分语句、微调LaTeX模板，可以直接修改并提交Pull Requests；&lt;/li&gt;
&lt;li&gt;大工作量维护，比如新增章节、调整文档整体结构等，为了避免多人重复劳动，请先到&lt;a class="reference external" href="https://github.com/seisman/SAC_Docs_zh"&gt;项目主页&lt;/a&gt;中提交Issues&lt;ul&gt;
&lt;li&gt;若暂时不打算解决该Issue，则设置标签为“Pull Request Welcomed”；&lt;/li&gt;
&lt;li&gt;若正在解决该Issue，则设置标签为“In Progress”；&lt;/li&gt;
&lt;li&gt;Issue列表中所有标签为“Pull Request Welcomed”的Issue均可随意认领；&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id17"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id31"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2015-03-07：初稿；&lt;/li&gt;
&lt;li&gt;2015-03-09：补充了参与维护的具体步骤；&lt;/li&gt;
&lt;li&gt;2015-03-13：置顶本文；&lt;/li&gt;
&lt;li&gt;2015-03-23：取消置顶；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="SAC"></category><category term="文档"></category></entry><entry><title>fk用法笔记</title><link href="http://seisman.info/fk-notes.html" rel="alternate"></link><updated>2015-02-28T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-02-28:fk-notes.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id33"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;fk是Prof. Lupei Zhu写的一个用于计算&lt;strong&gt;水平分层模型&lt;/strong&gt;下的理论格林函数并合成理论地震图的代码包。代码是开源的，可以直接编译使用。&lt;/p&gt;
&lt;p&gt;代码中包含了如下几个重要的命令/脚本：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;：用于计算格林函数的主程序；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;st_fk&lt;/tt&gt;：用于计算静态格林函数的主程序；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;trav&lt;/tt&gt;：用于计算P、S初至到时的辅助程序；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;sachd&lt;/tt&gt;：用于修改SAC头段的辅助程序；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;：对&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;st_fk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;trav&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;sachd&lt;/tt&gt;的封装，一般情况下直接使用&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;脚本即可；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;syn&lt;/tt&gt;：用于将格林函数合成为理论地震图三分量的程序；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因而，实际操作的时候，只需要调用&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;生成格林函数，再调用&lt;tt class="docutils literal"&gt;syn&lt;/tt&gt;将格林函数合成为三分量地震图即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id34"&gt;相关文献&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Haskell (1964), &lt;span class="caps"&gt;BSSA&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Wang and Herrmann (1980), &lt;span class="caps"&gt;BSSA&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Takeuchi and Saito (1972), Methods in Computational Physics&lt;/li&gt;
&lt;li&gt;Zhu and Rivera (2002), &lt;span class="caps"&gt;GJI&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;建议的阅读方式：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;若想了解&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;中每个选项的含义，阅读Zhu and Rivera (2002)以及本文就差不多了；&lt;/li&gt;
&lt;li&gt;若想理解代码的实现细节，则需要在Zhu and Rivera (2002)的基础上，阅读其余三篇文章，至少要阅读Haskell (1964)。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;需要注意的一点是，这几篇文献虽然说的都是同一种方法，但在很多东西的定义上是有区别的，所以在推导代码中的公式时应以Zhu and Rivera (2002)为准。Zhu and Rivera (2002)区别于前面其他文献的地方主要在于，重新定义了与频率无关的传播矩阵，并将静态解与动态解统一到同一个公式中。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id35"&gt;基础原理&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这里不涉及算法的细节，只介绍一些基础的东西。&lt;/p&gt;
&lt;p&gt;根据Zhu and Rivera (2002)，在定义了柱坐标系之后，位移可以表示为：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="displacement" src="/images/2015022801.png" style="width: 500px;"/&gt;
&lt;/div&gt;
&lt;p&gt;公式中涉及到了一个求和与两个积分：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;对频率的积分，本质上就是一个反傅里叶变换，技术上很成熟了，可以不管&lt;/li&gt;
&lt;li&gt;对m的求和，其实是对方位角模数的求和，理论上是要从零求和到无穷的。但是由于震源的简单性，只需要对几项做求和即可，具体的求和数目由震源类型决定：&lt;ul&gt;
&lt;li&gt;爆炸源：m=0&lt;/li&gt;
&lt;li&gt;单力源：m=0, 1&lt;/li&gt;
&lt;li&gt;双力偶：m=0, 1, 2&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;对k的积分是一个难点，只能进行数值积分，由于积分核&lt;span class="math"&gt;\(U_z R_m^k + U_r S_m^k + U_{\theta} T_m^k\)&lt;/span&gt;比较复杂，在做数值积分的时候就需要更多的考虑。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;积分核&lt;span class="math"&gt;\(U_z R_m^k + U_r S_m^k + U_{\theta} T_m^k\)&lt;/span&gt;中R、S、T是柱坐标下的基矢量，由一堆Bessel函数组成，已知。该算法中的一大堆数学推导以及细节都是为了求出Uz、Ur和Ut。具体Uz、Ur和Ut怎么求，不是本文的重点，需要了解的只能自己推公式。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id36"&gt;使用说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;先把用法贴在这里作为参考:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
fk.pl -Mmodel/depth[/f_or_k] [-D] [-Hf1/f2] [-Nnt/dt/smth/dk/taper]
    [-Ppmin/pmax[/kmax]] [-Rrdep] [-SsrcType] [-Uupdn] [-Xcmd] distances
&lt;/pre&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id37"&gt;速度模型&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Mmodel/depth/k_or_f&lt;/span&gt;&lt;/tt&gt;中的&lt;tt class="docutils literal"&gt;model&lt;/tt&gt;为模型文件名，&lt;tt class="docutils literal"&gt;k&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;f&lt;/tt&gt;的作用在下面会解释。&lt;/p&gt;
&lt;div class="section" id="id6"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id38"&gt;格式&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;fk的输入速度模型是一维水平分层速度模型，其格式为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
thickness vs vp/vs [rho Qs Qp]
&lt;/pre&gt;
&lt;p&gt;或:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
thickness vs vp [rho Qs Qp]
&lt;/pre&gt;
&lt;p&gt;其中&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;列1：该层的厚度（km）&lt;/li&gt;
&lt;li&gt;列2：S波速度（km/s）&lt;/li&gt;
&lt;li&gt;列3：波速比或P波速度&lt;/li&gt;
&lt;li&gt;列4：密度（&lt;span class="math"&gt;\(g/cm^3\)&lt;/span&gt;）&lt;/li&gt;
&lt;li&gt;列5：S波的Q值&lt;/li&gt;
&lt;li&gt;列6：P波的Q值&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中前三列是必须的，若未指定密度，则使用经验公式&lt;tt class="docutils literal"&gt;rho=0.77+0.32*vp&lt;/tt&gt;；若未指定Qs，则取Qs=500；若未指定Qp，则取Qp=2*Qs。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="kf"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id39"&gt;关于k和f&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;若命令行中使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Mmodel/depth&lt;/span&gt;&lt;/tt&gt;，则表示输入模型为第二种格式；&lt;/li&gt;
&lt;li&gt;若命令行中使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Mmodel/depth/k&lt;/span&gt;&lt;/tt&gt;，则表示输入模型使用第一种格式，即第三列是波速比；&lt;/li&gt;
&lt;li&gt;若命令行中使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Mmodel/depth/f&lt;/span&gt;&lt;/tt&gt;，则表示需要对速度模型做展平变换，当震中距较大时需要这样做；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id40"&gt;备注&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;的输入模型是先Vs再Vp，而&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;在调用&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;时使用的模型是先Vp后Vs，注意不要搞混；&lt;/li&gt;
&lt;li&gt;若第一层的厚度为零，则该行指定了上半空间的参数；&lt;/li&gt;
&lt;li&gt;若第一层的厚度不为零，则上半空间为真空，该层给出了地表下方第一层的参数；&lt;/li&gt;
&lt;li&gt;最后一层会被自动当做下半无限半空间，并修改其厚度为0；&lt;/li&gt;
&lt;li&gt;对于液态层（如海水和外核）：&lt;ul&gt;
&lt;li&gt;S波速度可以用零表示，程序中用自动用0.0001替换零值；&lt;/li&gt;
&lt;li&gt;Qs值不可以取为零，应取某小值；&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id41"&gt;震源&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id9"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id42"&gt;震源深度&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;震源深度由&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Mmodel/depth/[f_or_k]&lt;/span&gt;&lt;/tt&gt;中的&lt;tt class="docutils literal"&gt;depth&lt;/tt&gt;指定。&lt;/p&gt;
&lt;p&gt;需要注意，震源深度不能位于速度模型的分界面上，即震源的深度必须位于模型某层的内部。&lt;/p&gt;
&lt;p&gt;大多数计算理论地震图的方法都会有这样的限制，因为在计算过程中会用到震源所在层的速度或密度，若震源位于速度模型的分界面上，则会出现参数的间断。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id43"&gt;震源类型&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;fk中用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-SsrcType&lt;/span&gt;&lt;/tt&gt;指定震源类型，其中&lt;tt class="docutils literal"&gt;srcType&lt;/tt&gt;可以取如下三个值：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;0：爆炸源；&lt;/li&gt;
&lt;li&gt;1：单力源；&lt;/li&gt;
&lt;li&gt;2：双力偶源；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id44"&gt;震源时间函数&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Zhu and Rivera (2002)的附录B中给出了不同震源类型以及不同m值所对应的source term。这里的source term代表了震源引起的位移-应力不连续。&lt;/p&gt;
&lt;p&gt;source term是一个与频率无关的常数。由于脉冲函数的频率域表示就是一个常数，故而fk中在频率域加上的常数源，对应于时间域上的脉冲源。&lt;/p&gt;
&lt;p&gt;即，fk计算得到的是脉冲函数所产生的位移场，等效于阶跃函数所产生的速度场。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id45"&gt;台站&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id13"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id46"&gt;台站深度&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Rrdep&lt;/span&gt;&lt;/tt&gt;中&lt;tt class="docutils literal"&gt;rdep&lt;/tt&gt;用于设置receiver的深度，默认值为零，即台站位于地表。&lt;/p&gt;
&lt;p&gt;需要注意，fk中要求震源和台站不能位于同一深度。代码中，会计算震源和台站之间的深度差hs，并将其作为分母。但这一限制的本质原因尚不清楚。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id14"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id47"&gt;台站震中距&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;命令行中可以指定多个震中距，震中距的默认单位为km。&lt;/p&gt;
&lt;p&gt;当震中距较大时，以km做单位很不方便，此时可以使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-D&lt;/span&gt;&lt;/tt&gt;选项，表明震中距的单位为度。同时，由于震中距比较大，此时可能还需要对速度模型做展平变换。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id15"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id48"&gt;时间序列&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;说说&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Nnt/dt/smth/dk/taper&lt;/span&gt;&lt;/tt&gt;中的nt、dt和smth。&lt;/p&gt;
&lt;div class="section" id="id16"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id49"&gt;采样间隔&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;dt&lt;/tt&gt;即生成的格林函数的采样间隔。与此同时，&lt;tt class="docutils literal"&gt;dt&lt;/tt&gt;决定了fk要计算的最高频率，其公式为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
f_{max} = \frac{1}{2 dt}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;即fk生成的格林函数的最高频率是由&lt;tt class="docutils literal"&gt;dt&lt;/tt&gt;决定的Nyquist采样率。&lt;/p&gt;
&lt;p&gt;因而，一般来说，要首先根据自己的实际需求，确定所需要的最高频率，进而决定&lt;tt class="docutils literal"&gt;dt&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id17"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id50"&gt;数据点数&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;nt即数据点数，nt的选择有一些需要注意的地方：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;nt必须为2的n次方，即可以取1、2、256、512、1024等，程序中限制了最大取值为8192；&lt;ul&gt;
&lt;li&gt;nt=1，则调用&lt;tt class="docutils literal"&gt;st_fk&lt;/tt&gt;直接计算静态位移解；&lt;/li&gt;
&lt;li&gt;nt=2，则调用&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;计算零频位移，等效于静态位移解；&lt;/li&gt;
&lt;li&gt;nt必须为2的n次方是因为在FFT时数据点为2的n次方时有快速算法；&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(T=nt*dt\)&lt;/span&gt;确定了最终数据的总长度&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="smooth"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id51"&gt;smooth因子&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;由于dt决定了fk计算的最高频率，所以dt是不能随便取的。比如需要最高频率为2.5Hz，则dt应取0.2s，但是若希望最终生成的数据的采样间隔为0.05s，则需要&lt;tt class="docutils literal"&gt;smth&lt;/tt&gt;这个参数。&lt;/p&gt;
&lt;p&gt;在程序中，smth做了两件事情：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;将dt除以smth；&lt;/li&gt;
&lt;li&gt;将总数据点数乘以smth；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;总的效果应该相当于对计算结果做了一个插值，这也可以通过SAC的插值命令来完成。在程序实现时，实际上就是在反傅里叶变换之前，给数据的高频部分补上更多的零值。&lt;/p&gt;
&lt;p&gt;同样由于快速傅里叶算法的限制，&lt;tt class="docutils literal"&gt;smth&lt;/tt&gt;也必须取2的n次方。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id18"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id52"&gt;频率&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id19"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id53"&gt;最高频率&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;前面已经说到，fk所计算的最高频率由&lt;tt class="docutils literal"&gt;dt&lt;/tt&gt;决定：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
f_{max} = \frac{1}{2 dt}
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id20"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id54"&gt;频率间隔&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;频率域的采样间隔（分辨率）为&lt;span class="math"&gt;\(df=\frac{1}{T}=\frac{1}{nt*dt}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id21"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id55"&gt;高通滤波&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;fk会从零频开始，以&lt;tt class="docutils literal"&gt;df&lt;/tt&gt;为频率间隔，一直到最高频率&lt;tt class="docutils literal"&gt;fmax&lt;/tt&gt;，计算每个离散频率处的值。&lt;/p&gt;
&lt;p&gt;比如，给定参数dt=0.1，npts=1024，则fk计算的最高频率为5 Hz，频率间隔df约等于0.01Hz。因而fk会计算0 Hz、0.01 Hz、0.02 Hz一直到5 Hz的值，共计循环512次。&lt;/p&gt;
&lt;p&gt;有些情况下，比较低频的信息是没有用的，所以可以不必计算，这样循环可以进一步减小，以加速计算。&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Hf1/f2&lt;/span&gt;&lt;/tt&gt;中，&lt;tt class="docutils literal"&gt;f1&lt;/tt&gt;限定了循环过程中频率的下限，即对频率的循环会从&lt;tt class="docutils literal"&gt;f1&lt;/tt&gt;开始计算到&lt;tt class="docutils literal"&gt;fmax&lt;/tt&gt;而不是从零开始，这本质上是一个高通滤波器。&lt;/p&gt;
&lt;p&gt;这样一来，fk会计算频率在f1和fmax之间的值，对于小于f1以及大于fmax的频率段，其值直接设为零。这实际上是在频率域直接截断，似乎会出现一些问题，所以一般都会对频率的两端做尖灭处理，即f2和taper。程序会在f1和f2之间以及(1-taper)*fmax和fmax之间分别加上余弦窗。&lt;/p&gt;
&lt;p&gt;taper的默认值为0.3，所以当dt=0.1s时，fmax=5Hz，则在3.5Hz到5Hz之间会加上余弦窗，此时数据的频段上限是5Hz还是3.5Hz呢？这是个疑问。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="k"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id56"&gt;k积分&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id22"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id57"&gt;k是什么&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;这里的k不是波数，而是水平波数：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
k = k_x = \vec{k}\cdot \vec{x} = \frac{\omega}{v} \sin \theta = \omega p
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(\theta\)&lt;/span&gt;是射线与垂直方向的夹角，&lt;span class="math"&gt;\(p=\frac{\sin \theta}{v}\)&lt;/span&gt;是水平慢度，也就是射线参数。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id23"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id58"&gt;下限和上限&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Ppmin/pmax[/kmax]&lt;/span&gt;&lt;/tt&gt;可以限定k积分的上下限。其中&lt;tt class="docutils literal"&gt;pmin&lt;/tt&gt;确定了k积分的下限：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
k_{min} = \omega pmin
\end{equation*}
&lt;/div&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;pmax&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;kmax&lt;/tt&gt;决定了k积分的上限：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
k_{max} = \sqrt{kmax^2+\omega pmax}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;pmin和pmax的取值范围是0到1，代码中会将pmin和pmax都除以震源处的S波速度。&lt;/li&gt;
&lt;li&gt;程序中&lt;tt class="docutils literal"&gt;kmax=kmax/hs&lt;/tt&gt;，其中hs是震源与台站的深度差；由于积分核在零频处以exp(-k*hs)的速度随着k衰减，因而要求kmax&amp;gt;10，以保证求和足够多。&lt;/li&gt;
&lt;li&gt;指定了pmin和pmax，就相当于指定了射线参数的范围，或射线出射角度的范围，似乎可以用于筛选中特定射线参数范围的射线；&lt;/li&gt;
&lt;li&gt;为什么pmin和pmax在程序中都要除以S波速度呢？这样当给定&lt;span class="math"&gt;\(pmin=\sin 30=0.5\)&lt;/span&gt;时，以30度角出射的S波会被计算，而以30度角出射的P波则不会被计算？这样对吗？&lt;/li&gt;
&lt;li&gt;pmin和pmax的取值为0到1，为什么不是-1到1？也许正负号是由&lt;tt class="docutils literal"&gt;updn&lt;/tt&gt;决定的。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id24"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id59"&gt;上行和下行&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Uupdn&lt;/span&gt;&lt;/tt&gt;选项可以指定是计算全波场还是只计算上行波或下行波。&lt;tt class="docutils literal"&gt;updn&lt;/tt&gt;可以取值如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;0：计算全波场；也是默认值；&lt;/li&gt;
&lt;li&gt;1：仅计算下传波场；&lt;/li&gt;
&lt;li&gt;-1：仅计算下传波场；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;该参数取不同的值，会影响到程序内部的一些公式。具体的原理可能需要推公式才能理解。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="dk"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id60"&gt;dk&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;dk用于控制k积分的积分间隔。程序中&lt;span class="math"&gt;\(dk=dk*&lt;span class="caps"&gt;PI&lt;/span&gt;/max(x,hs)\)&lt;/span&gt;，其中hs为震源与台站的深度差，x为震中距，因而k积分间隔实际上是与要计算的最大震中距有关的。&lt;/p&gt;
&lt;p&gt;由于积分核中J(kx)在大震中距时按2pi/x的周期震荡，因而要求dk小于0.5，以保证每个周期内至少有四个采样点。官方建议取值为0.1到0.4。dk理论上越小越好，当然dk越小计算就会越慢。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id25"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id61"&gt;振幅压制&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这个参数在&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;脚本内部可以修改，但是在命令行里没法修改。&lt;/p&gt;
&lt;p&gt;对于实序列&lt;span class="math"&gt;\(f(t)\)&lt;/span&gt;，其傅里叶变换为:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(\omega) = \int f(t) e^{-i\omega t} dt
\end{equation*}
&lt;/div&gt;
&lt;p&gt;若将该实序列f(t)乘以&lt;span class="math"&gt;\(e^{-\sigma t/T}\)&lt;/span&gt;，即&lt;span class="math"&gt;\(g(t)=f(t)e^{-\sigma t/T}\)&lt;/span&gt;的傅里叶变换为：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(\omega) = \int g(t) e^{-i\omega t} dt = \int f(t) e^{-\sigma t/T} e^{-i\omega t} dt
          = \int f(t) e^{-i(\omega-i\sigma/T)} dt
          = F(\omega-i\sigma/T)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;因而，在频率域将&lt;span class="math"&gt;\(\omega\)&lt;/span&gt;减去&lt;span class="math"&gt;\(i\sigma/T\)&lt;/span&gt;，相当于对实序列乘以&lt;span class="math"&gt;\(e^{-\sigma t/T}\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;其中T为实序列的总时间长度，sigma称为压制因子，用于降低数据尾部的振幅值，而最终反傅里叶变换得到的实序列，会再次乘以&lt;span class="math"&gt;\(e^{+\sigma t/T}\)&lt;/span&gt;，以消除压制因子对振幅的影响。所以，理论上看，sigma没什么实际用途，这样处理的具体目的还不清楚，似乎是出于频率域的稳定性考虑的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="debug"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id62"&gt;&lt;span class="caps"&gt;DEBUG&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;fk提供了&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-X&lt;/span&gt;&lt;/tt&gt;选项用于debug，最常见的用法是&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Xcat&lt;/span&gt;&lt;/tt&gt;，此时fk.pl中&lt;tt class="docutils literal"&gt;cmd&lt;/tt&gt;被替换成&lt;tt class="docutils literal"&gt;cat&lt;/tt&gt;命令，即将所有的输入都传递给&lt;tt class="docutils literal"&gt;cat&lt;/tt&gt;命令，这样可以很清楚地知道要传递的数据是否正确，方便debug。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id26"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id63"&gt;其他说明&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;对于PREM模型，震源深度取15km，震中距为5度，做不做展平变换，震相的走时差大概在0.8s左右&lt;/li&gt;
&lt;li&gt;将PREM模型离散成每层20km或50km，计算出的结果差异不大&lt;/li&gt;
&lt;li&gt;若台站深度大于震源深度，则会对模型做翻转，程序中的部分参数乘以-1；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;fk.f&lt;/tt&gt;中输入的src_layer表示震源位于第src_layer层的顶部，rcv_layer同理；而trav中src_layer表示震源位于第src_layer的底部；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id27"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id64"&gt;格林函数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;fk将生成的格林函数以SAC格式写到磁盘中。&lt;/p&gt;
&lt;div class="section" id="id28"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id65"&gt;爆炸源&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;生成三个分量，命名为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;xxxx.[a-c]&lt;/span&gt;&lt;/tt&gt;，分别是Z、R、T向的格林函数。其单位为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;10^-20&lt;/span&gt; &lt;span class="pre"&gt;cm/(dyne&lt;/span&gt; cm)&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id29"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id66"&gt;单力源&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;生成六个分量，其中：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;xxxx.[0-2]&lt;/span&gt;&lt;/tt&gt;：m=0对应的ZRT格林函数，等效于垂直单力产生的位移三分量；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;xxxx.[3-6]&lt;/span&gt;&lt;/tt&gt;：m=1对应的ZRT格林函数，等效于水平单力产生的位移三分量；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;格林函数的单位为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;10^-15&lt;/span&gt; cm/dyne&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id30"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id67"&gt;双力偶&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;生成九个分量，其中&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;xxx.[0-2]&lt;/span&gt;&lt;/tt&gt;：m=0阶源生成的ZRT格林函数，相当于45-down-dip(&lt;span class="caps"&gt;DD&lt;/span&gt;)双力偶源在45度方位角处产生的位移，并乘以（-2,-2,0）&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;xxx.[3-5]&lt;/span&gt;&lt;/tt&gt;：m=1阶源生成的ZRT格林函数，相当于dip-slip(&lt;span class="caps"&gt;DS&lt;/span&gt;)双力偶源在45度方位角处产生的位移，并乘以&lt;span class="math"&gt;\(-\sqrt 2\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;xxx.[6-8]&lt;/span&gt;&lt;/tt&gt;：m=2阶源生成的ZRT格林函数，相当于strike-slip(&lt;span class="caps"&gt;SS&lt;/span&gt;)双力偶源在22.5度方位角处产生的位移，并乘以&lt;span class="math"&gt;\(-\sqrt 2\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;格林函数的单位为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;10^-20&lt;/span&gt; &lt;span class="pre"&gt;cm/(dyne&lt;/span&gt; cm)&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id31"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id68"&gt;说明&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在大多数教程以及文献中，任意一个双力偶源可以表示为三个基本断层的线性迭加。这三个基本断层分别为DD、DS和SS。有些计算格林函数的代码会计算出三种基本断层的位移解，然后根据文献中给出的辐射花样系数进行合成。而fk计算出的是m=0、1、2时的位移解，虽然这三者分别与DD、&lt;span class="caps"&gt;DS&lt;/span&gt;、SS在某个特定方位角的位移解有关系。因而在对fk生成的格林函数进行合成时，有专门的辐射花样系数，参见Zhu  and Rivera(2002)的附录B10-B12。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id32"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id69"&gt;疑问&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;在考虑衰减时，Aki and Richard(1980)的公式(5.88)中给出的公式中虚数前为负号，而fk代码中为正号。Why？&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="理论地震图"></category></entry><entry><title>慢度与射线参数</title><link href="http://seisman.info/slowness-and-ray-parameter.html" rel="alternate"></link><updated>2015-02-05T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-02-05:slowness-and-ray-parameter.html</id><summary type="html">
&lt;p&gt;本文介绍几个专业名词：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;慢度&lt;/li&gt;
&lt;li&gt;水平慢度/垂直慢度&lt;/li&gt;
&lt;li&gt;射线参数&lt;/li&gt;
&lt;li&gt;视速度/视慢度&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这些名词其实很简单，但是在大三一直到研一的几年间，这几个名词在我脑中的概念是有些混乱的，我把混乱的原因归结于不同课本对同一个专业名词乱用了不同的词汇。故而在这里总结一下。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;慢度&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;速度&lt;span class="math"&gt;\(v\)&lt;/span&gt;是用于衡量波在介质中传播的快慢的物理量，单位一般是km/s。&lt;/p&gt;
&lt;p&gt;慢度是速度的倒数，单位为s/km:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
s = \frac{1}{v}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;所以慢度是一个用于描述介质的物理量。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;慢度矢量&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;对于一个在介质中传播的射线来说，取射线中的任何一段，射线都有一个方向，同时该&lt;strong&gt;段&lt;/strong&gt;射线所在的介质都有一个慢度值。&lt;/p&gt;
&lt;p&gt;介质的慢度值以及射线的方向构成了该&lt;strong&gt;段&lt;/strong&gt;射线的一个属性，即慢度矢量。&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\mathbf{s} = \frac{1}{v} \mathbf{e_s}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;根据慢度矢量的定义可知，慢度矢量是与射线相关的量，且慢度矢量是一个局部量，一条射线中的不同段，其慢度矢量是不同的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;水平慢度和垂直慢度&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;既然是一个矢量，就可以将其分解到水平方向和垂直方向。&lt;/p&gt;
&lt;p&gt;在&lt;strong&gt;水平分层模型&lt;/strong&gt;下，定义射线方向与垂直方向的夹角为&lt;span class="math"&gt;\(\theta\)&lt;/span&gt;，则水平慢度为：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p = s\sin \theta = \frac{\sin \theta}{v}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;垂直慢度为：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\eta = s \cos \theta = \frac{\cos \theta}{v}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;所以实际上水平慢度和垂直慢度，也是一个局部量，同一条射线，不同段的水平慢度和垂直慢度是不同的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;射线参数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;射线在经过两种介质的分界面时，满足Snell定律:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\sin \theta_1}{v_1} = \frac{\sin \theta_2}{v_2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;关于Snell定律，有两点需要注意：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Snell定律不要求介质分界面是水平的，可以是水平分层的、球状分层或任意曲率；&lt;/li&gt;
&lt;li&gt;此处&lt;span class="math"&gt;\(\theta\)&lt;/span&gt;是射线与界面法向的夹角。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因此，对于水平分层介质来说，界面法向与垂直方向是重合的。因而根据Snell定律，有：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p_1 = \frac{\sin \theta_1}{v_1} = \frac{\sin \theta_2}{v_2} = p_2
\end{equation*}
&lt;/div&gt;
&lt;p&gt;即在水平分层模型下，射线在不同层里的水平慢度是不变的，每条射线都有唯一的水平慢度，因而定义水平慢度为射线参数：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p = \frac{\sin \theta}{v}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;需要注意的是，“射线参数不变”这个准则仅在水平分层等特殊的情况下成立，若存在倾斜界面，则该准则不再成立。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;视速度/视慢度&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在水平分层模型下，每条射线对应了唯一的射线参数，因而射线参数是很重要的一个量。&lt;/p&gt;
&lt;p&gt;经过一些简单的推导，可知：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{dT}{dX} = p
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(X\)&lt;/span&gt;为射线传播的水平距离，&lt;span class="math"&gt;\(T\)&lt;/span&gt;为射线传播的时间。&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(\frac{dT}{dX}\)&lt;/span&gt;即波前在经过不同震中距的台站的到时差，即所谓的视慢度，所以平常说的视慢度其实就是射线参数。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;球状分层介质&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;上面的一些概念大都是在水平分层模型下解释的，更常见的模型是球状分层模型。&lt;/p&gt;
&lt;p&gt;在球状分层模型下，射线参数的定义变成：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p = \frac{r \sin \theta}{v}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(r\)&lt;/span&gt;是计算射线参数时所使用的半径，&lt;span class="math"&gt;\(\theta\)&lt;/span&gt;为射线与径向方向的夹角。&lt;/p&gt;
&lt;p&gt;做了这样的定义之后，在水平分层模型下推导的公式基本都可以直接推广到球状分层模型中了。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="射线"></category><category term="名词解释"></category></entry><entry><title>不同比例尺曲线的画法</title><link href="http://seisman.info/plot-multiple-lines-in-different-scales.html" rel="alternate"></link><updated>2015-02-01T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-02-01:plot-multiple-lines-in-different-scales.html</id><summary type="html">&lt;p&gt;本文由Joe Wang（&lt;a class="reference external" href="mailto:cjmuqiao@163.com"&gt;cjmuqiao@163.com&lt;/a&gt;）投稿。&lt;/p&gt;

&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;目标效果图&lt;/a&gt;&lt;/h2&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="final figure" src="/images/2015020101.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;问题的提出&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在地磁场中X、Y、Z三分量幅值两两之间通常相差一两个数量级。如果直接将其画到相同比例尺的一个坐标系下，幅值小的通常就成了一条直线。此时需要将大幅值适当缩小，或者小幅值适当放大，即在一张图中绘制不同比例尺的曲线。在丁鉴海、卢振业、余素荣编著的《地震地磁学概论》中经常会看到不同比例尺的图。&lt;/p&gt;
&lt;p&gt;使用GMT的-Jx选项，绘图时X坐标或Ｙ坐标就会根据数据的范围进行缩放，但这种放大或缩小的显示方式，会带来一个刻度值显示的问题。即：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;若将数据点用线连起来，由于数据点连线的时候不支持-N选项，则-R的范围必须包括整个Y轴的取值范围，Y轴的刻度会完全显示，这样有点啰嗦；&lt;/li&gt;
&lt;li&gt;若使用-S选项，将数据点用某种符号显示，此时再加上-N选项，则可以只显示部分比例尺，同时又可以把数据完整地表示出来，但是这样的散点图看起来断断续续的，无法连接起来；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;解决思路&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;使用psxy将数据点用线连起来，此时不绘制刻度；&lt;/li&gt;
&lt;li&gt;选择要绘制的刻度的范围，并使用psbasemap绘制部分数据的Y轴刻度，在此之前需要仔细计算坐标原点在Y轴的偏移量。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;脚本&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;软件环境：&lt;span class="caps"&gt;GMT5&lt;/span&gt; windows版，gawk&lt;/li&gt;
&lt;li&gt;使用命令：psxy, psbasemap, gmtmath, gawk等&lt;/li&gt;
&lt;/ul&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;sta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CHL
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;day&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;20120101&lt;/span&gt;
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;ps&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;%sta%%day%&lt;/span&gt;.ps
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;Rhour&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/24/0/5&lt;/span&gt;
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;Rsec&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/86400/0/5&lt;/span&gt;
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;Jhour&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;x&lt;span class="m"&gt;0&lt;/span&gt;.&lt;span class="m"&gt;72&lt;/span&gt;&lt;span class="n"&gt;/0.1&lt;/span&gt;
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;Jsec&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;x&lt;span class="m"&gt;0&lt;/span&gt;.&lt;span class="m"&gt;0002&lt;/span&gt;&lt;span class="n"&gt;/0.1&lt;/span&gt;

&lt;span class="c"&gt;REM preparing the input data&lt;/span&gt;
&lt;span class="c"&gt;REM 1. calculate mean value&lt;/span&gt;
&lt;span class="c"&gt;REM 2. subtract mean value from original data&lt;/span&gt;
&lt;span class="c"&gt;REM 3. output line number and data&lt;/span&gt;
gmt gmtmath CHL&lt;span class="m"&gt;2&lt;/span&gt;_&lt;span class="m"&gt;20120101&lt;/span&gt;Hx.dat CHL&lt;span class="m"&gt;2&lt;/span&gt;_&lt;span class="m"&gt;20120101&lt;/span&gt;Hx.dat MEAN SUB &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="n"&gt;gawk&lt;/span&gt; &lt;span class="s2"&gt;"{print NR, $1}"&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;.dat
gmt gmtmath CHL&lt;span class="m"&gt;2&lt;/span&gt;_&lt;span class="m"&gt;20120101&lt;/span&gt;Hy.dat CHL&lt;span class="m"&gt;2&lt;/span&gt;_&lt;span class="m"&gt;20120101&lt;/span&gt;Hy.dat MEAN SUB &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="n"&gt;gawk&lt;/span&gt; &lt;span class="s2"&gt;"{print NR, $1}"&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;.dat
gmt gmtmath CHL&lt;span class="m"&gt;2&lt;/span&gt;_&lt;span class="m"&gt;20120101&lt;/span&gt;Z.dat CHL&lt;span class="m"&gt;2&lt;/span&gt;_&lt;span class="m"&gt;20120101&lt;/span&gt;Z.dat MEAN SUB &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="n"&gt;gawk&lt;/span&gt; &lt;span class="s2"&gt;"{print NR, $1}"&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;.dat

gmt psxy -R&lt;span class="nv"&gt;%Rhour%&lt;/span&gt; -J&lt;span class="nv"&gt;%Jhour%&lt;/span&gt; -T -K -P &amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;

&lt;span class="c"&gt;REM plot x-axis&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;%Rhour%&lt;/span&gt; -J&lt;span class="nv"&gt;%Jhour%&lt;/span&gt; -Bxa&lt;span class="m"&gt;2&lt;/span&gt;f&lt;span class="m"&gt;1&lt;/span&gt;+lTime&lt;span class="n"&gt;/hour&lt;/span&gt; -Bya&lt;span class="m"&gt;5&lt;/span&gt; -BS -K -O &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;%Rsec%&lt;/span&gt; -J&lt;span class="nv"&gt;%Jsec%&lt;/span&gt; -Bxa&lt;span class="m"&gt;7200&lt;/span&gt;f&lt;span class="m"&gt;3600&lt;/span&gt;+lTime&lt;span class="n"&gt;/s&lt;/span&gt; -Bya&lt;span class="m"&gt;5&lt;/span&gt; -BS -Y&lt;span class="m"&gt;2&lt;/span&gt;c -O -K &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;

&lt;span class="c"&gt;REM plot Z&lt;/span&gt;
gmt psxy z.dat -R&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/86400/-20/15&lt;/span&gt; -Jx&lt;span class="m"&gt;0&lt;/span&gt;.&lt;span class="m"&gt;0002&lt;/span&gt;&lt;span class="n"&gt;/0.1&lt;/span&gt; -O -K&amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;
&lt;span class="c"&gt;REM plot scale of z data&lt;/span&gt;
gmt psbasemap -R&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/86400/0/5&lt;/span&gt; -J -Y&lt;span class="m"&gt;2&lt;/span&gt;c -Bya&lt;span class="m"&gt;5&lt;/span&gt; -BW+t&lt;span class="s2"&gt;"@%%12%%\104@%%6%%Z"&lt;/span&gt; -K -O &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;

&lt;span class="c"&gt;REM plot Hy&lt;/span&gt;
gmt psxy y.dat -R&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/86400/-400/400&lt;/span&gt; -Jx&lt;span class="m"&gt;0&lt;/span&gt;.&lt;span class="m"&gt;0002&lt;/span&gt;&lt;span class="n"&gt;/0.005&lt;/span&gt; -Wblue -O -K &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;
gmt psbasemap -R&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/86400/100/200&lt;/span&gt; -J -Y&lt;span class="m"&gt;2&lt;/span&gt;.&lt;span class="m"&gt;5&lt;/span&gt;c -Bya&lt;span class="m"&gt;100&lt;/span&gt;+l&lt;span class="s2"&gt;"nT"&lt;/span&gt; -BW+t&lt;span class="s2"&gt;"@;blue;@%%12%%\104@%%6%%Y"&lt;/span&gt; --FONT&lt;span class="o"&gt;=&lt;/span&gt;blue --MAP_DEFAULT_PEN&lt;span class="o"&gt;=&lt;/span&gt;+blue --MAP_TITLE_OFFSET&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;p -O -K &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;

&lt;span class="c"&gt;REM plot Hx&lt;/span&gt;
gmt psxy x.dat -R&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/86400/-55/30&lt;/span&gt; -Jx&lt;span class="m"&gt;0&lt;/span&gt;.&lt;span class="m"&gt;0002&lt;/span&gt;&lt;span class="n"&gt;/0.05&lt;/span&gt; -Wred -O -K &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;
gmt psbasemap -R&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;/86400/10/20&lt;/span&gt; -J -Y&lt;span class="m"&gt;3&lt;/span&gt;.&lt;span class="m"&gt;25&lt;/span&gt;c -Bya&lt;span class="m"&gt;10&lt;/span&gt; -BW+t&lt;span class="s2"&gt;"@;red;@%%12%%\104@%%6%%X"&lt;/span&gt; --MAP_TITLE_OFFSET&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;p --FONT&lt;span class="o"&gt;=&lt;/span&gt;red --MAP_DEFAULT_PEN&lt;span class="o"&gt;=&lt;/span&gt;+blue -O -K &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;

gmt psxy -R&lt;span class="nv"&gt;%Rhour%&lt;/span&gt; -J&lt;span class="nv"&gt;%Jhour%&lt;/span&gt; -T -O &amp;gt;&amp;gt;&lt;span class="nv"&gt;%ps%&lt;/span&gt;

&lt;span class="k"&gt;del&lt;/span&gt; x.dat y.dat z.dat
&lt;span class="k"&gt;del&lt;/span&gt; gmt.history
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;一些说明：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;gmtmath&lt;/tt&gt;命令实现是一个逆波兰式的计算器，此处其作用在于先计算数据的均值，然后从原始数据中减去，并将计算得到的结果通过管道传送给gawk；&lt;/li&gt;
&lt;li&gt;绘制每个数据时，分别使用了两个命令，其中psxy用于绘制数据，而psbasemap用于绘制比例尺；&lt;/li&gt;
&lt;li&gt;脚本中的参数的选择是有技巧，也是有规律的，下面会说明；&lt;/li&gt;
&lt;li&gt;脚本中大部分数值都是可以从数据中自动计算得到的，因而将脚本改一改就可以实现完全的自动化；本文的脚本中没有对此进一步实现，如数据范围，移动距离等都是硬编码在脚本中；&lt;/li&gt;
&lt;li&gt;命令中使用了一些额外的选项，来达到更好的绘图效果；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;该脚本中某些参数的选取是很有技巧的，以Z分量数据为例：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;psxy命令中&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R0/86400/-20/15&lt;/span&gt;&lt;/tt&gt;是Z数据的范围，其值可以通过&lt;tt class="docutils literal"&gt;gmtinfo&lt;/tt&gt;命令自动获得；&lt;/li&gt;
&lt;li&gt;psxy命令中&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Jx0.0002/0.1&lt;/span&gt;&lt;/tt&gt;，即对于Y轴而言，数据的1，在图上是0.1厘米，则Z数据的35的范围，对应于图上3.5厘米；&lt;/li&gt;
&lt;li&gt;为了在Y轴的0到5处绘制一个比例尺，需要使用psbasemap命令，该命令有两个需要注意的地方：&lt;ul&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R0/86400/0/5&lt;/span&gt;&lt;/tt&gt;设定了Y轴范围为0到5；&lt;/li&gt;
&lt;li&gt;为了在真正的0处绘制比例尺，需要移动坐标系原点，此处的移动距离为&lt;span class="math"&gt;\((0-(-20))*0.1=2cm\)&lt;/span&gt;，即&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Y2c&lt;/span&gt;&lt;/tt&gt;选项；&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2015-02-01：Joe Wang投稿；&lt;/li&gt;
&lt;li&gt;2015-02-01：SeisMan整理语句、优化脚本；&lt;/li&gt;
&lt;li&gt;2015-02-02：使用FONT和MAP_DEFAULT_PEN代替其他参数；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="GMT5"></category></entry><entry><title>强大的跨平台PDF处理工具：cpdf</title><link href="http://seisman.info/coherent-pdf-command-line-tools.html" rel="alternate"></link><updated>2015-01-27T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-01-27:coherent-pdf-command-line-tools.html</id><summary type="html">&lt;p&gt;日常生活中对PDF的最基本的操作大概就是合并和切割了。之前一直在用强大的PDFtk，但是由于一些底层依赖的问题，PDFtk在短时间内是不可能出现在CentOS7下了，只能寻找新的PDF替代工具了。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;简介&lt;/h2&gt;
&lt;p&gt;Coherent &lt;span class="caps"&gt;PDF&lt;/span&gt;，简称cpdf，是个用于处理PDF的命令行工具。该软件支持Windows、Linux和Mac，且对于非商业用途是免费的。&lt;/p&gt;
&lt;p&gt;主页：&lt;a class="reference external" href="http://community.coherentpdf.com/"&gt;http://community.coherentpdf.com/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="linux"&gt;
&lt;h2&gt;Linux的安装&lt;/h2&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="https://github.com/coherentgraphics/cpdf-binaries/archive/master.zip"&gt;https://github.com/coherentgraphics/cpdf-binaries/archive/master.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;cpdf有预编译的二进制文件，直接下载解压，然后把自己的平台对应的二进制文件复制到PATH中即可使用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;常见用法&lt;/h2&gt;
&lt;p&gt;PDF合并:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cpdf input1.pdf input2.pdf -o output.pdf
&lt;/pre&gt;
&lt;p&gt;切割PDF中的1至页以及12页至最后页:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cpdf input.pdf 1-3,12-end -o output.pdf
&lt;/pre&gt;
&lt;p&gt;将PDF分割成单页PDF，编号为&lt;tt class="docutils literal"&gt;page001.pdf&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;page002.pdf&lt;/tt&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cpdf -split in.pdf -o page%%%.pdf
&lt;/pre&gt;
&lt;/div&gt;
</summary><category term="PDF"></category><category term="Linux"></category><category term="Windows"></category></entry><entry><title>用taup_time计算震相走时及射线信息</title><link href="http://seisman.info/calculate-travel-time-using-taup.html" rel="alternate"></link><updated>2015-01-24T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2015-01-24:calculate-travel-time-using-taup.html</id><summary type="html">
&lt;p&gt;&lt;tt class="docutils literal"&gt;taup_time&lt;/tt&gt;是TauP提供的一个工具，其主要用于计算震相理论走时，除此之外，还提供了一些与射线有关的信息。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;基本用法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;计算震源深度为300km，震中距为60度时，P、S、PcP等震相的走时信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_time -mod prem -ph P,S,PcP,ScS,PKiKP -deg 60 -h 300
&lt;/pre&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-mod&lt;/span&gt;&lt;/tt&gt;指定速度模型为TauP内置的prem模型；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-ph&lt;/span&gt;&lt;/tt&gt;后跟一系列震相名；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-h&lt;/span&gt;&lt;/tt&gt;震源深度；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-deg&lt;/span&gt;&lt;/tt&gt;后接震中距，单位为度；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在震中距比较小的情况下，用千米表示震中距更方便，可以使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-km&lt;/span&gt;&lt;/tt&gt;选项。比如计算一个浅源地震在100 km处常见P波震相的走时信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_time -mod prem -ph ttp+ -h 2 -km 100
&lt;/pre&gt;
&lt;p&gt;当然，也可以通过给定地震位置以及台站位置:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_time -mod prem -ph P,PcP -h 100 -sta 20 130 -evt 40 150
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;输出信息&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;以第一个例子的输出为例:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup  taup_time -mod prem -ph P,S,PcP,ScS,PKiKP -deg 60 -h 100

Model: prem
Distance   Depth   Phase   Travel    Ray Param  Takeoff  Incident  Purist    Purist
  (deg)     (km)   Name    Time (s)  p (s/deg)   (deg)    (deg)   Distance   Name
-----------------------------------------------------------------------------------
   60.00   100.0   P        595.39     6.819     30.16    20.83    60.00   = P
   60.00   100.0   PcP      640.10     3.999     17.14    12.04    60.00   = PcP
   60.00   100.0   PKiKP   1017.57     1.242      5.25     3.71    60.00   = PKiKP
   60.00   100.0   S       1081.25    12.786     31.42    21.59    60.00   = S
   60.00   100.0   ScS     1176.81     7.448     17.68    12.38    60.00   = ScS
&lt;/pre&gt;
&lt;p&gt;输出共9列，从左到右分别为：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;震中距（度）；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;震源深度（km）；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;震相名；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;震相走时（秒）；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;射线参数（秒/度）；&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
p = \frac{\sin \theta}{v_s} = \frac{\sin 20.83}{5.8 km/s} = 0.0613 s/km = 6.817 s/deg
\end{equation*}
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;出射角（deg）：即射线与垂直向下方向的夹角。若夹角在0到90度内，则取正值；若夹角在90度到180度内，则先减去90，再取负值。因而，一般情况下，P波出射者为正值，而p出射角为负值；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;入射角（deg）：射线在台站（位于地表）处入射时与垂直向上方向的夹角。应该是恒正的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Purist Distance和Purist Name不知为何物；&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;信息提取&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;上面介绍的输出中包含了很多信息，想要在脚本中提取出想要的信息有些麻烦。所以&lt;tt class="docutils literal"&gt;taup_time&lt;/tt&gt;提供了一些选项，使得在脚本中计算走时什么的更加方便。&lt;/p&gt;
&lt;div class="section" id="time"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;time&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;该选项使得输出中只包含走时信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup  taup_time -mod prem -ph P,S,PcP -deg 60 -h 100 --time
595.3896 640.09875 1081.2472
&lt;/pre&gt;
&lt;p&gt;需要注意的是，输出中走时不是按照&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-ph&lt;/span&gt;&lt;/tt&gt;选项中震相的顺序进行排序的，而是按照走时递增的顺序排序。比如这里，S震相放在震相列表的第二位，而走时1081.2472却放在第三位。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="rayp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;rayp&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;该选项使得输出中只包含射线参数信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup  taup_time -mod prem -ph P,S,PcP -deg 60 -h 100 --rayp
6.8185554 3.9990747 12.785722
&lt;/pre&gt;
&lt;p&gt;这里，射线参数的输出是按照震相进行排序的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="timerayp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;time和rayp&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这两个选项是不能一起用的，也就是说不能同时输出震相走时和射线参数信息。当两个选项同时使用时，会以后出现的选项为准。&lt;/p&gt;
&lt;p&gt;当同时需要走时和射线参数时，只能多次执行命令了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="rel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;rel&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;该选项用于计算震相的相对走时，似乎有bug，无法正常工作。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="射线"></category><category term="TauP"></category></entry><entry><title>GMT中添加注释和标注</title><link href="http://seisman.info/add-annotations-in-gmt.html" rel="alternate"></link><updated>2014-12-28T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-12-28:add-annotations-in-gmt.html</id><summary type="html">&lt;p&gt;在日常绘图时经常会需要在已经画好的图上添加一些注释或标注，比如在某个位置加文字、箭头或者连线。一般情况下，若注释或标注出现在单个底图的内部，则可以很容易通过pstext和psxy来实现；若需要在底图外添加注释或标注，则会复杂一些。本文试图解决这个问题。&lt;/p&gt;
&lt;p&gt;下图展示了绘图时一个常见的需求：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="final figure" src="/images/2014122801.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这里出于演示的目的，用尽可能简单的命令绘制尽可能简单的图形。图中两个底图由psbasemap绘制得到，红色矩形由psxy绘制得到。其命令如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;test.ps

&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10/0/10
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X10c
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制左边的底图&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B2 -BWSen -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="c"&gt;# 绘制红色矩形&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -W1.5p,red -K -O -L &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;6 8&lt;/span&gt;
&lt;span class="s"&gt;8 8&lt;/span&gt;
&lt;span class="s"&gt;8 6&lt;/span&gt;
&lt;span class="s"&gt;6 6&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;6/8/6/8
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X8c
&lt;span class="c"&gt;# 绘制右边的底图&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B0.5 -BwSEn -K -O -X12c -Y1c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

rm -f gmt.conf gmt.history
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;至此，整张图的主体已经绘制完成，下面需要向图中添加蓝色的两条连线。&lt;/p&gt;
&lt;p&gt;这两条连线加起来并不那么容易，因为其游离在两个底图之间，而GMT是无法在底图之外添加注释和标注的，所以两条连线无法通过简单的方式实现。这里有几个反驳点：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;pstext的-N选项是允许在底图之外写文本的。&lt;/p&gt;
&lt;p&gt;这一点我无力反驳，但是要注意文本和注释之间的一点点区别。比如，在左底图中（5,5）处画一个五角星表示地震事件，然后在附近写上“20141228”表示事件的ID，这称之为文本；若想在两个底图的中间添加“middle”这样的文本，姑且称为注释，可以使用pstext在左底图的（11,5）或右底图的（5.8,5）位置添加文本；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;psxy的-N选项允许在底图之外画符号。&lt;/p&gt;
&lt;p&gt;用psxy的-N选项可以将圆、三角之类的符号画在底图之外，但直线无法出现在底图之外。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;为嘛不直接使用其他工具，比如Photoshop、Illustrator、GIMP甚至画图工具来添加？&lt;/p&gt;
&lt;p&gt;的确，用这些工具可以更简单的实现。但若经常需要微调图片，则需要重复使用这些工具，反而失去了用脚本画图的优势。另外，其他软件并不总能很好地兼容GMT做的图，所以有时候无法使用其他软件添加注释和标注。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这里的解决办法是，新增一个覆盖整张纸的辅助底图，在辅助底图中添加注释和标注，如下。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;test.ps
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10/0/10
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X10c

gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制左底图&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B2 -BWSen -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="c"&gt;# 绘制红色矩形&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -W1.5p,red -K -O -L &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;6 8&lt;/span&gt;
&lt;span class="s"&gt;8 8&lt;/span&gt;
&lt;span class="s"&gt;8 6&lt;/span&gt;
&lt;span class="s"&gt;6 6&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;6/8/6/8
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X8c
&lt;span class="c"&gt;# 绘制右底图&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B0.5 -BwSEn -K -O -X12c -Y1c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制辅助底图&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/29.7/0/21
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;x1/1
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;a1g1
gmt &lt;span class="nb"&gt;set &lt;/span&gt;&lt;span class="nv"&gt;MAP_FRAME_TYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inside &lt;span class="nv"&gt;MAP_GRID_PEN_PRIMARY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0p,red,.
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -BWSEN -K -O -Xf0c -Yf0c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

rm -f gmt.conf gmt.history
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;关于辅助底图的几个说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;默认纸张为A4，纸张大小为210x297mm，则对于Landscape模式：&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R0/29.7/0/21&lt;/span&gt;&lt;/tt&gt;；对于Portrait模式，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R0/21/0/29.7&lt;/span&gt;&lt;/tt&gt;。&lt;/li&gt;
&lt;li&gt;投影方式为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Jx1/1&lt;/span&gt;&lt;/tt&gt;，即线性投影，且纸张中的1厘米表示数据中的1；则&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R0/29.7/0/21&lt;/span&gt;&lt;/tt&gt;与&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Jx1/1&lt;/span&gt;&lt;/tt&gt;一起使用的结果是：辅助底图恰好占据整个纸张。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Ba1g1&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;MAP_FRAME_TYPE&lt;/tt&gt;以及&lt;tt class="docutils literal"&gt;MAP_GRID_PEN_PRIMARY&lt;/tt&gt;的设置，都是为了增强辅助底图的实用性；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;psbasemap&lt;/tt&gt;将辅助底图绘制出来，由于需要注意这里-X和-Y的使用；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;最终得到的效果如下图（辅助底图的（0,0）点与纸张左下角重合，（29.7,21）点与纸张右上角重合）：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="auxiliary basemap" src="/images/2014122802.jpg" style="width: 800px;" /&gt;
&lt;/div&gt;
&lt;p&gt;辅助底图的出现，给整个纸张加上了网格，因而我们可以很容易的大概确定出纸张上任意一点的坐标。比如这里需要的四个点的坐标分别为（10.5，10.5）、（14.5,11.5）、（10.5,8.5）和（14.5,3.5）。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;test.ps
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10/0/10
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X10c

gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制左底图&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B2 -BWSen -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="c"&gt;# 绘制红色矩形&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -W1.5p,red -K -O -L &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;6 8&lt;/span&gt;
&lt;span class="s"&gt;8 8&lt;/span&gt;
&lt;span class="s"&gt;8 6&lt;/span&gt;
&lt;span class="s"&gt;6 6&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;6/8/6/8
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X8c
&lt;span class="c"&gt;# 绘制右底图&lt;/span&gt;
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B0.5 -BwSEn -K -O -X12c -Y1c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制辅助底图&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/29.7/0/21
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;x1/1
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;a1g1
gmt &lt;span class="nb"&gt;set &lt;/span&gt;&lt;span class="nv"&gt;MAP_FRAME_TYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inside &lt;span class="nv"&gt;MAP_GRID_PEN_PRIMARY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0p,red,.
gmt psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -BWSEN -K -O -Xf0c -Yf0c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 在辅助底图坐标系中绘制两条连线，注意-Xf0c和-Yf0c&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -W2p,blue -K -O -Xf0c -Yf0c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="s"&gt;10.5 10.5&lt;/span&gt;
&lt;span class="s"&gt;14.5 11.5&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="s"&gt;10.5 8.5&lt;/span&gt;
&lt;span class="s"&gt;14.5 3.5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

rm -f gmt.conf gmt.history
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果图如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="auxiliary basemap" src="/images/2014122803.jpg" style="width: 800px;" /&gt;
&lt;/div&gt;
&lt;p&gt;实际的图件中，肯定是不能有辅助底图以及相关的网格线的，所以在添加注释和标注之后，还需要将辅助底图删除，只需要将上面的脚本中注释或删除掉如下两行即可。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# gmt set MAP_FRAME_TYPE=inside MAP_GRID_PEN_PRIMARY=0p,red,.&lt;/span&gt;
&lt;span class="c"&gt;# gmt psbasemap -R$R -J$J -B$B -BWSEN -K -O -Xf0c -Yf0c &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;需要强调两点：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;绘制连线的时候是使用了辅助底图的，注释掉上面两个命令只是使得辅助底图不显示而已；&lt;/li&gt;
&lt;li&gt;使用辅助底图会修改gmt.conf和gmt.history文件，因而辅助底图的相关命令应放在所有命令的最后，且在脚本结束时要记得删除gmt.conf和gmt.history以保证不会干扰到其他绘图命令的效果。&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="GMT5"></category><category term="GMT技巧"></category></entry><entry><title>Windows下使用GMT的正确姿势</title><link href="http://seisman.info/how-to-use-gmt-under-windows.html" rel="alternate"></link><updated>2015-01-13T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-12-10:how-to-use-gmt-under-windows.html</id><summary type="html">
&lt;p&gt;我几乎是完全在Linux下工作的。有过几次在Windows下使用GMT的经历，个人觉得用户体验是非常糟糕的，Windows自带的工具太简陋，用来画GMT图太繁琐，浪费好多时间。虽然未来我也几乎不会在Windows下写bat脚本，但还是想将自己的一些经验写下来，希望能够提高Windows下GMT的用户体验。&lt;/p&gt;
&lt;p&gt;在正式开始本文之前，首先要认清几个基本的事实。如果你无法认同这几个事实，那么就没有再读下去的必要了：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;GMT最初是在Linux下开发的&lt;strong&gt;纯命令行&lt;/strong&gt;工具。在Linux下使用GMT要比在Windows下方便很多。所以，如果能在Linux下使用，就不要在Windows下使用；&lt;/li&gt;
&lt;li&gt;大多数图都不可能用一个GMT命令就完成，因而需要将一系列GMT命令写到bat脚本中；&lt;/li&gt;
&lt;li&gt;将GMT命令写入bat脚本的目的有两个：首先是记录GMT绘图的过程，其次才是批量绘图；&lt;/li&gt;
&lt;li&gt;写bat脚本的过程，大部分时间和精力都是花在命令的调试和图形的微调上；&lt;/li&gt;
&lt;li&gt;花半个小时时间折腾一下工具，就可以换取更好的用户体验以及更高的调试效率，这是一笔很划算的交易；&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="section" id="cmd"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;不用cmd&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;点击“开始”-&amp;gt;“附件”-&amp;gt;“命令提示符”（或者点击“开始”，然后搜索“cmd”），会出来一个如下图所示的命令提示符窗口，简称为cmd。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="cmd" src="/images/2014121001.png" style="width: 800px;"/&gt;
&lt;/div&gt;
&lt;p&gt;Windows下的GMT用户，尤其是GMT初学者，都会在cmd中敲一系列的GMT命令来画图。我想，用了几次就会体会到cmd的这些让人无法忍受的缺点：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;默认的界面又黑又丑，几乎无法自定义；&lt;/li&gt;
&lt;li&gt;默认字体完全不适合写脚本，难以区分1和l等，写脚本的时候容易被坑；&lt;/li&gt;
&lt;li&gt;复制粘贴比较麻烦，似乎没有简单的办法完成复制操作，这使得将命令复制到脚本中变得很麻烦；&lt;/li&gt;
&lt;li&gt;关闭cmd并重启后，前一次的命令历史都没了；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;有一些与cmd类似的工具，比如console、console 2、ColorConsole、ConEmu等，可以完全替代cmd，同时又有更好看的图形界面以及更丰富的自定义功能。&lt;/p&gt;
&lt;p&gt;但是，不建议使用cmd以及这些类似的工具。&lt;/p&gt;
&lt;p&gt;用GMT画图时，通常需要用多个命令绘制一张图，用cmd之类的工具写这些命令将会非常痛苦。因为一旦其中任意一个命令出现问题，或者想要微调其中某个命令的某个参数，则必须通过各种方式（一般是通过多次按上下方向键）将命令历史一一调出来并一一重新执行。这个过程非常繁琐、非常浪费时间，出错的概率也很高。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;不要使用cmd！！！&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;不要使用cmd！！！&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;不要使用cmd！！！&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;（因为cmd太坑，所以重复三遍。）&lt;/p&gt;
&lt;p&gt;用GMT画图的正确姿势是将绘图所需的GMT命令都写到bat脚本中，即便某个命令出错或者某个命令需要微调也不用怕了，只是重新执行一下bat脚本即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="notepad"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;不要用notepad&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;既然是写脚本，就一定要使用文本编辑器。Windows自带的文本编辑器是notepad，也就是常说的记事本，也就是下面这货：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="notepad" src="/images/2014121002.png" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;因为实在无法忍受notepad那丑陋的默认字体，我把notepad的字体改成了等宽的“Courier New”。&lt;/p&gt;
&lt;p&gt;notepad的缺点实在太多：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;没有语法高亮&lt;/li&gt;
&lt;li&gt;没有行号&lt;/li&gt;
&lt;li&gt;没有智能补全&lt;/li&gt;
&lt;li&gt;用Ctrl+Z只能撤销最近的一个操作历史&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;基本上你需要的功能它都没有。当然优点也是有的，比如“它是系统自带编辑器”以及“它是一款很简约（简陋？）的编辑器”。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;不要用notepad写bat脚本。&lt;/strong&gt;它本来就不是一款用于写脚本或代码的编辑器。有很多功能强大的编辑器值得你去用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;使用notepad++&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;不用notepad，还可以用什么？&lt;/p&gt;
&lt;p&gt;优秀的文本编辑器实在太多。比如notepad++、sublime text、EditPlus、vim、emacs等等。除了vim和emacs学习曲线比较陡峭之外，其余的大多数文本编辑器都是很容易直接上手使用的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;为什么要使用notepad++？&lt;/p&gt;
&lt;p&gt;这里并不是要推荐notepad++，其他的文本编辑器也可以实现类似的功能，或许可以实现的更好更方便，但我没有时间也没有心思去寻找最好的那一款（其实没有最好只有最适合）。&lt;/p&gt;
&lt;p&gt;我只是想借着notepad++来展示下一个合适的文本编辑器是如何提高写脚本/代码的效率的。针对本文的主题，也就是要解释一下，为什么一个好用的文本编辑器可以提高GMT绘图时的效率。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;notepad++和notepad是什么关系？&lt;/p&gt;
&lt;p&gt;这两个编辑器没有关系，只是恰好名字类似而已。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;下载与安装&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;到官方网站下载： &lt;a class="reference external" href="http://notepad-plus-plus.org/"&gt;http://notepad-plus-plus.org/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;安装过程没什么可说的。启动之后的界面如下图，代码高亮、行号显示、自动补全默认都实现了：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="notepad++" src="/images/2014121003.png" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;对于bat脚本，右键，然后“Edit with notepad++”即可用notepad++打开脚本。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;基本的配置&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;“设置”-&amp;gt;“首选项”中提供了一些基本的配置，可以简单配置一下以符合自己的习惯。&lt;/p&gt;
&lt;p&gt;“设置”-&amp;gt;“语言格式设置”中可以设置字体和字号，以及对各种不同语言做各种自定义。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="nppexec"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;安装插件NppExec&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;“插件”-&amp;gt;“Plugin Manager”-&amp;gt;“Show Plugin Manager”会打开插件管理器，在“Available”标签页中可以找到notepad++的各种插件。&lt;/p&gt;
&lt;p&gt;用notepad++写完bat脚本之后，就需要执行bat脚本以检查命令的正确性以及绘图效果。&lt;/p&gt;
&lt;p&gt;最原始也是最常用的做法是鼠标双击bat脚本，然后一个黑框一闪而过。。。此时即便命令执行时有输出错误信息，用户也看不到，所以就开始抱怨自己的脚本画不出来图，但是又不懂得提供出错信息。当然这个问题可以解决，在bat脚本的最后加上一句&lt;tt class="docutils literal"&gt;pause&lt;/tt&gt;，则黑框在脚本执行完毕时不会自动关闭，就可以看到输出信息了，只是又要面对那又黑又丑的cmd，又要面对无法把报错信息复制到google里搜索的尴尬。&lt;/p&gt;
&lt;p&gt;NppExec插件可以解决这个问题。安装该插件后（安装过程中需要从sourceforge下载数据，有时候该网站会被墙，自己想办法解决），并重启，notepad++的界面如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="notepad++ with nppexec" src="/images/2014121004.png" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;直观地可以看到两个变化：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;整个界面被分为上下两个区：文本编辑区和console区&lt;/li&gt;
&lt;li&gt;工具栏上，在倒数第二的位置出现了一个终端的小图标&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;写完GMT脚本后，Ctrl+S保存，然后键入F6，就会出现“Execute”对话框如下图：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="notepad++ with F6" src="/images/2014121005.png" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;在其中输入&lt;tt class="docutils literal"&gt;$(FULL_CURRENT_PATH)&lt;/tt&gt;，然后点击OK，即可执行该bat脚本。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;在执行bat脚本的过程中，可能会出现生成的PS文件被放到notepad++的安装文件夹下，或者因为权限问题“拒绝访问”的错误，解决办法是在“插件”-&amp;gt;“NppExec”中勾选“Follow $(CURRENT_DIRECTORY)”选项，并重启notepad++使其生效。该选项的作用是使得在执行bat之前，先cd到bat所在的路径，再执行bat脚本中的命令。&lt;/p&gt;
&lt;p&gt;执行后的效果如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="notepad++ with console output" src="/images/2014121006.png" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;在console中可以看到bat脚本中的每个命令的执行，当然，如果命令有错误，也会显示报错信息。这样，在编辑器里就既可以编辑bat脚本，也可以执行bat脚本，并可以根据终端的输出来判断命令是否有错误以及警告。&lt;/p&gt;
&lt;p&gt;如果脚本有问题就需要修改，修改完成后保存，再次键入F6，又会出现“Execute”对话框，&lt;tt class="docutils literal"&gt;$(FULL_CURRENT_PATH)&lt;/tt&gt;已经输入好了，再点击一次“&lt;span class="caps"&gt;OK&lt;/span&gt;”即可再次运行修改后的脚本。不过，按F6再点击OK还是有些麻烦：当脚本执行过一次之后，可以用快捷键Ctrl+F6重新运行脚本。&lt;/p&gt;
&lt;p&gt;对于终端，还可以做一些额外的设置，可以在“插件”-&amp;gt;“NppExec”中进一步调整：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;“Change Console font”来挑选一个合适的等宽字体和字号；&lt;/li&gt;
&lt;li&gt;一些系统级别的信息对于我来说没有用，所以勾选“No internal messages”&lt;/li&gt;
&lt;li&gt;Ctrl键和F6键离得有些远，按起来还是不太方便：在“Advanced options”中，把“ToolbarBtn”改成“ExecPre”，则点击工具栏里倒数第二个终端小图标，就相对于执行了Ctrl+F6，好方便；&lt;/li&gt;
&lt;li&gt;“Advanced options”中还可以改console中文本的颜色，这个用默认值就好啦。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;console的输出信息，对于我们测试bat脚本是非常重要的，所以会要求输出信息尽量完整且精简。默认的输出不太满意，在“Console Output Filters”中做一些修改：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;终端的输出信息中有太多空白行，浪费了宝贵的空间，想要把这些空白行都&lt;strong&gt;过滤&lt;/strong&gt;掉，在Filter标签中修改如下图：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="filter" src="/images/2014121007.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;输出信息中每行都有很长的当前路径信息，影响了输出的阅读，而且该路径信息与具体的命令之间没有空格，就更容易混淆了。在Replace标签页中，将当前路径都&lt;strong&gt;替换&lt;/strong&gt;成&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT5&lt;/span&gt;&amp;gt;&lt;/tt&gt;，具体如下图：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="replace" src="/images/2014121008.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;需要注意一下，&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT5&lt;/span&gt;&amp;gt;&lt;/tt&gt;的大于号后面有个空格，使得提示符与命令之间更容易区分。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;输出信息中包含了命令、错误信息、警告信息以及输出，通常希望将错误、警告以及输出跟命令区分一下。这里的处理方式是，先在“Advanced Options”中将设置console的输出文本颜色为蓝色：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="textcolor" src="/images/2014121009.png" style="width: 500px;"/&gt;
&lt;/div&gt;
&lt;p&gt;然后在“Highlight”选项卡中，将以GMT5开头的行设置为黑色：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="textcolor" src="/images/2014121010.png" style="width: 500px;"/&gt;
&lt;/div&gt;
&lt;p&gt;这样设置之后，所有的命令都是黑色显示，所有的输出、错误、警告都用蓝色显示，当然也可以将错误、警告、输出定义不同的颜色，稍稍麻烦一些，这里就不做了。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;经过这么一番配置之后，再次Ctrl+F6执行，效果如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="notepad++ with nppexec" src="/images/2014121011.png" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;这里在命令里加了个输出，并且故意把命令写错了，所以出现了蓝色的输出和报错信息，一眼就可以看到错误信息，看上去更直观。&lt;/p&gt;
&lt;p&gt;需要注意的一点是，每次修改完脚本之后，需要Ctrl+S保存之后，再Ctrl+F6执行脚本。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="ps"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;PS查看器&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;上面已经把编辑器配置得可以方便地编辑、执行脚本，并可以根据输出信息来判断脚本的正误。有些时候脚本是对的，只是绘图的效果不够理想，此时需要不断微调脚本并实时预览PS文件。&lt;/p&gt;
&lt;p&gt;gsview是GMT官方推荐的PS查看器，它可以基本实现PS文件的实时预览。这里说“基本实现”，因为在每次生成PS文件后，总是需要将焦点切换到gsview软件上，gsview才会重新载入PS文件。不喜欢gsview的另一个原因是，gsview是商业软件，需要注册才可以使用，未注册的软件在每次打开PS文件时都会弹出要求注册的对话框，很是烦人。&lt;/p&gt;
&lt;p&gt;推荐使用&lt;a class="reference external" href="http://www.sumatrapdfreader.org/free-pdf-reader.html"&gt;Sumatra&lt;/a&gt;，一个非常精致小巧的阅读器，支持PDF、&lt;span class="caps"&gt;PS&lt;/span&gt;、epub等多种格式。&lt;/p&gt;
&lt;p&gt;在我眼中，Sumatra相对于gsview的优势在于：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;免费软件，不会弹出讨厌的注册对话框&lt;/li&gt;
&lt;li&gt;完全自动重载PS文件，实时预览PS文件，而不是像gsview一样需要将焦点切换到软件上才可重载；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如果觉得sumatra不错，可以将PS文件的默认打开方式设置为Sumatra。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;效果图&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;基于以上的一些配置，定制出来一套Windows下我觉得很友好也很高效的GMT绘图系统（右键查看大图）：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="final" src="/images/2014121012.png" style="width: 750px;"/&gt;
&lt;/div&gt;
&lt;p&gt;屏幕左边是编辑器，右边是PS阅读器（预览区）。编辑器上边为编辑区，下边为终端区。&lt;/p&gt;
&lt;p&gt;试想一下，在编辑区写脚本，写完了Ctrl+S保存，然后Ctrl+F6执行，眼睛移到终端区看看有没有错误和警告，有的话就修改脚本，重复以上动作，没有的话眼睛瞟一眼预览区，看看最终的绘图效果。整个过程都不需要动一下鼠标，比cmd、notepad、gsview之类可高效多了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="tips-or-bugs"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;Tips Or Bugs&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;要使用Sumatra查看PS文件，必须先安装较新版本的ghostscript；&lt;/li&gt;
&lt;li&gt;Sumatra似乎不能打开GMT生成的含中文的PS文件；&lt;/li&gt;
&lt;li&gt;Notepad++默认将文件以UTF-8编码保存，因而若需要在PS文件中添加中文，则可能会导致乱码；&lt;/li&gt;
&lt;li&gt;编辑bat文件时应注意dos里是没有续行符的，一条命令必须在一行写完。不像linux下的, fortran90下的&amp;amp;和matlab下的…续行；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-12-10：初稿；&lt;/li&gt;
&lt;li&gt;2015-01-13：加入了与GMT中文相关的几个注意事项；&lt;/li&gt;
&lt;li&gt;2015-01-17：NppExec插件应勾选“Follow $(CURRENT_DIRECTORY)”选项；Thanks to Joe Wang；&lt;/li&gt;
&lt;li&gt;2015-01-21：Sumatra查看PS文件时依赖于ghostscript；Thanks to Michael Song；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="Windows"></category></entry><entry><title>GMT边框发虚的原因及解决办法</title><link href="http://seisman.info/blurry-frame-in-GMT.rst.html" rel="alternate"></link><updated>2014-12-09T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-12-09:blurry-frame-in-GMT.rst.html</id><summary type="html">&lt;p&gt;GMT绘制的PS格式的图片一向以高精度著称。在画图的时候偶尔会遇到，PS图片中其他地方精度都很高，唯独边框看上去有些发虚，精度比较低。&lt;/p&gt;
&lt;p&gt;上次遇到这个问题的时候，因为着急画图，所以也没细想，直接把边框发虚的图用上了。今天再次遇到这个问题，认真的想了想，找到了原因所在，也找到了解决办法。&lt;/p&gt;
&lt;p&gt;下面的脚本生成的PS文件，边框会存在发虚的现象：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;test.ps
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X14c
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/6/0/6
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0.5/0.5

gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Sa1c -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;1 1&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Sb1c -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;2 2&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Sc1c -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;3 3&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Sd1c -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;4 4&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Ss1c -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Sh1c -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;2 3&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;代码很简单，无非就是多次调用psxy在不同的位置绘制不同的符号。&lt;/p&gt;
&lt;p&gt;由于多次调用了psxy，且每次都使用-B选项，所以在PS代码中实际上会多次重复绘制边框。理论上这些边框以及刻度应该是完全重合的，但实际上却存在或多或少的偏差，进而导致最终画出的图出现边框发虚的现象。&lt;/p&gt;
&lt;p&gt;解决办法也很简单，保留第一个绘图命令中的-B选项，并删除其余命令中的-B选项。这样画出来的图，文件大小要小一些，也不会再出现边框发虚的现象。&lt;/p&gt;
&lt;p&gt;但，有时候会需要在for循环中重复调用类似的绘图命令，例如:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt psxy -R$R -J$J -T -K &amp;gt; $PS

for xxx
do
    gmt psxy filen -R$R -J$J -B$B -Sxxx -K -O &amp;gt;&amp;gt; $PS
done

gmt psxy -R$R -J$J -T -O &amp;gt;&amp;gt; $PS
&lt;/pre&gt;
&lt;p&gt;此时循环中的psxy命令，每次执行时都有-B选项，这也是最容易导致边框发虚的情况。如果把循环里的-B选项去掉，又会导致没有边框。唯一的办法是把循环中的-B去掉，然后在循环之前或之后的某个命令中加上-B选项绘制边框，实在没有绘图命令的话就使用psbasemap专门绘制边框。&lt;/p&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="GMT技巧"></category></entry><entry><title>CentOS 7下的软件安装方法及策略</title><link href="http://seisman.info/how-to-install-softwares-under-centos-7.html" rel="alternate"></link><updated>2014-12-01T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-11-23:how-to-install-softwares-under-centos-7.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;一些废话&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;2010年开始正式接触Linux，入门发行版是Ubuntu 10.10，后来过渡到Ubunu 11.04，这其中也尝试了很多其他主流的发行版。进入实验室之后，开始用CentOS 5，然后是CentOS 6，现在进化到CentOS 7。&lt;/p&gt;
&lt;p&gt;使用了四年的Linux，前三年都是在瞎折腾，浪费了不少时间，也得到了不少经验与教训。现在可能是真的老了，已经不愿意折腾了，只希望配置好一个系统之后，就一直使用下去。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;为什么要写/读这一篇&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用Linux尤其是CentOS会遇到一些坑，或是一些有洁癖的人不能忍的事情：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;官方源中的软件包版本太老，在功能上无法满足需求；&lt;/li&gt;
&lt;li&gt;多个源的软件包存在版本冲突；&lt;/li&gt;
&lt;li&gt;手动编译软件，默认会将不同文件放置在&lt;tt class="docutils literal"&gt;/usr/local&lt;/tt&gt;下不同的子目录下，使得软件的更新和删除变得麻烦。&lt;/li&gt;
&lt;li&gt;等等…&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在经历了几次重装CentOS之后，特总结出如下几条软件安装的方法与原则，以尽可能保证当前系统的稳定、整洁，尽可能降低系统洁癖引起的重装冲动。&lt;/p&gt;
&lt;p&gt;以下所说，仅限于CentOS7，对其他发行版，或许有借鉴意义。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;官方源&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;CentOS自带的四个官方源中，默认打开的有base、updates、extras，这三个源中包含了约9000个软件包，是最稳定、也是最值得信赖的源。&lt;/p&gt;
&lt;p&gt;因而若一个软件包在官方源内，则应通过官方源安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install PackageName
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;第三方源&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;官方源虽然包含了很多软件包，但无法满足日常需求。幸好有第三方源，可以作为官方源的补充。&lt;/p&gt;
&lt;p&gt;在使用第三方源的过程中，最怕遇到这两个问题：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;第三方源和官方源中有相同的包，导致官方源的包被第三方源替代；&lt;/li&gt;
&lt;li&gt;多个第三方源中存在同一个软件包，且版本不一致，存在冲突；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这两个问题经常是致命的，出现各种预料不到的后果，因而选择第三方源要遵循如下原则：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;只选择可靠的第三方源，要确保第三方源不会替换官方源中的包；&lt;/li&gt;
&lt;li&gt;使用尽量少的第三方源，以保证第三方源之间不会冲突；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;就CentOS而言，根据以上的原则，使用如下第三方源：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;大型第三方源，已确认不会替换官方源的包，且相互之间无冲突&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;span class="caps"&gt;EPEL&lt;/span&gt;：包含6500多个软件，科研必备&lt;/li&gt;
&lt;li&gt;ELRepo：包含几十个各种硬件的驱动程序&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;有些小型第三方源，仅包含了几个软件，确认与官方源和EPEL源不会冲突，也可以添加&lt;ol class="arabic"&gt;
&lt;li&gt;Google Chrome：包含了Google Chrome，不会与官方源和EPEL源冲突；&lt;/li&gt;
&lt;li&gt;Adobe：仅包含flash插件，已确认不会冲突；&lt;/li&gt;
&lt;li&gt;dropbox：仅包含dropbox一个软件，已确认不会冲突；&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因而，若一个软件包位于EPEL、ELRepo中，或一些小型的第三方源中，则添加该第三方源，并用&lt;tt class="docutils literal"&gt;yum&lt;/tt&gt;命令安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install PackageName
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="rpm"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;官方rpm包&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;大部分非开源的软件，在CentOS官方源或EPEL中是没有的。有些软件的官方网站会提供官方rpm包。此时可以从官方网站下载与当前系统对应的rpm包，直接用如下命令安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo rpm -i PackageName.rpm
&lt;/pre&gt;
&lt;p&gt;比如，&lt;span class="caps"&gt;WPS&lt;/span&gt; for Linux就是其中一个。在安装的过程中rpm命令会自动检查依赖关系，若该软件所依赖的包在官方源和EPEL源中可以找到，则自动安装。&lt;/p&gt;
&lt;p&gt;直接安装rpm包的做法相当省事，但该软件不能由yum更新，稍稍麻烦一点。有些软件，比如前面提到的Google、Dropbox和Adobe其实也可以通过这种方法安装，在安装的同时会给系统添加源，对于这类软件依然可以很方便的更新与删除。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;解压即用&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有些软件，官方提供了压缩包，解压之后即可直接运行其中的二进制文件，比如很多Java写的软件。这类软件没有给源代码，而是给了可以在当前平台下直接执行的二进制文件。大多数非开源的商业软件都采取这种办法。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;比如sublime_text、pycharm、mendeley、TauP、sac等，直接解压，然后将解压后的文件夹复制到&lt;tt class="docutils literal"&gt;/opt&lt;/tt&gt;目录下，然后将该软件的bin目录加入到PATH中即可。&lt;/li&gt;
&lt;li&gt;比如Mathematics、Matlab、intel studio，软件包中提供安装脚本，执行该脚本即可安装；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Linux下的习惯是，商业软件或第三方软件都安装到&lt;tt class="docutils literal"&gt;/opt&lt;/tt&gt;目录下，这也是大多数商业软件包的默认安装路径，尽量遵循该习惯。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;第三方rpm包&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有些软件，CentOS源和EPEL源中找不到，官方又没有提供rpm包，但是其他第三方源提供了rpm包。分情况讨论：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;若该第三方源只包含了很少量的包，且确定这些包与官方源以及其他已使用的第三方源不冲突，则可以添加该第三方源。&lt;/li&gt;
&lt;li&gt;若该第三方源包含了很多软件，很可能与官方源或EPEL源有冲突，则不添加该源&lt;ul&gt;
&lt;li&gt;若该软件包没有复杂的依赖关系，则直接安装该源中的rpm包；&lt;/li&gt;
&lt;li&gt;若该软件包依赖于该第三方源中的其他包，则放弃，寻找其他方法；&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;第三方包管理器&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;不同的发行版使用不同的软件包管理器，CentOS使用yum，Ubuntu使用apt-get。近些年又出现了一些与发行版无关的第三方包管理器，比如Linuxbrew、Gentoo Prefix、pkgsrc。&lt;/p&gt;
&lt;div class="section" id="linuxbrew"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;Linuxbrew&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Linuxbrew是由OS X平台下非常流行的Homebrew移植到Linux下的。Linuxbrew可以作为系统自带的包管理器的一个补充。其特色在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;所有软件都安装在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;${&lt;span class="caps"&gt;HOME&lt;/span&gt;}/.linuxbrew&lt;/span&gt;&lt;/tt&gt;目录下；&lt;/li&gt;
&lt;li&gt;软件的版本相对很新；&lt;/li&gt;
&lt;li&gt;install、uninstall、info、list、update、upgrade等功能&lt;/li&gt;
&lt;li&gt;若库中没有需要的软件包，可以很简单地自己创建formulae&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;试用了一下，一个比较坑的地方是，linuxbrew会自己内部解决依赖问题。比如，我试着通过linuxbrew安装terminator，然后发现terminator依赖于python，尽管系统已经安装了python，linuxbrew还是会安装一份python，又由于python依赖于更多的东西，导致又安装了更多软件包在home下。而且，linuxbrew是从源码编译软件的，所以相对来说速度较慢。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id24"&gt;编译源码&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;大部分软件用前面的几种方法应该都能安装上了。如果没安装上，那就得问问自己，真的需要安装这个软件么。如果不是非常必要的话就不要安装啦。如果是必须的软件，那就必须要手动编译了。&lt;/p&gt;
&lt;p&gt;常见的源码编译，一般也就是如下几步。当然，具体情况具体对待:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
tar -xvf xxxx.tgz
./configure --prefix=/opt/xxxx
make
sudo make install
&lt;/pre&gt;
&lt;p&gt;一般来说，这类软件的默认安装目录都是&lt;tt class="docutils literal"&gt;/usr/local&lt;/tt&gt;，最终文件会被分别放在&lt;tt class="docutils literal"&gt;/usr/local&lt;/tt&gt;的bin、lib、share、man目录下。&lt;/p&gt;
&lt;p&gt;我个人非常不喜欢这种方式，因为作为一个通过源码编译的软件来说，意味着编译者要完全负起管理该软件的义务，这样的放置方式会来更新或卸载软件带来很多麻烦。所以我总是会在configure的时候加上prefix手动指定安装路径。要卸载该软件就直接删除/opt下对应的目录，要更新的话，也可以先删除，再重新编译一遍。这样做稍微麻烦的一点是，需要手动将该软件的bin目录加入到PATH中，还有可能需要修改LD_LIBRARY_PATH。但是一般来说，需要编译源码的软件很少，所以不会造成太大的麻烦。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id25"&gt;编译代码&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;好吧，其实我不知道该怎么起标题了。。&lt;/p&gt;
&lt;p&gt;前一节“编译源码”主要针对的是一些大型软件包，这一节“编译代码”指的是对一些专业性很强的小代码包的处理方式。比如有些软件包编译之后实际需要的只是一个二进制文件，这个时候就没有必要安装到&lt;tt class="docutils literal"&gt;/opt&lt;/tt&gt;了，合适的方式是在自己的HOME下建立bin目录，并将其路径加入到&lt;tt class="docutils literal"&gt;.bashrc&lt;/tt&gt; 中，然后将编译生成的二进制文件复制到该目录下即可:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mkdir ${HOME}/bin
echo 'export PATH=${HOME}/bin:$PATH' &amp;gt;&amp;gt; ~/.bashrc
&lt;/pre&gt;
&lt;p&gt;比如我的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;${&lt;span class="caps"&gt;HOME&lt;/span&gt;}/bin&lt;/span&gt;&lt;/tt&gt;目录下有如下文件：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;distaz&lt;/tt&gt;：给出地球上两点经纬度，计算震中距和方位角&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;pssac&lt;/tt&gt;：在GMT中绘制SAC文件&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;rdseed&lt;/tt&gt;：SEED格式转SAC格式&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;win2sac_32&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;：Hi-net网站提供的用于处理Hi-net数据的程序&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;st&lt;/tt&gt;：sublime_text被安装到&lt;tt class="docutils literal"&gt;/opt&lt;/tt&gt;目录下，在此建立一个软链接，方便在命令行调用sublime text&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;wlt.pl&lt;/tt&gt;：校内用于登陆网络通的脚本，在命令行修改网络端口，好happy&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;syn&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;trav&lt;/tt&gt;：Prof. Lupei Zhu的用于计算合成地震图的程序，源代码有不少，实际需要用的也就这三个可执行文件和一个perl脚本。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;matlab&lt;/tt&gt;：指向matlab的一个软连接；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不要随便什么二进制文件都往bin里放，这里只应放一些常用的命令或很通用的工具。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id26"&gt;自成系统的软件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有一类软件，其拥有众多模块或包，为了管理这众多的模块，就需要拥有一个自己的模块/包管理器。这其中以TeX、Perl和Python为代表。对于这一类软件，其众多的模块是最大的优势，也是最值得利用的资源，因而我通常会选择手动安装它们，原因如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;系统的源中不可能包含该软件的所有模块；&lt;/li&gt;
&lt;li&gt;系统的源中该软件的模块的更新要远远滞后于最新版本；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当然，即便是使用系统自带的版本，也依然可以用该软件自带的包管理器来安装模块。但将导致：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;部分模块用系统的yum管理，部分模块用软件自带的包管理器管理；&lt;/li&gt;
&lt;li&gt;yum安装的模块一般版本较老，软件的包管理器要安装的大多是最新版本；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这一方面会导致模块管理的混乱，另一方面用软件自带的包管理其安装模块时，可能会依赖于其他模块的最新版本，若该模块是通过系统yum安装的较旧的版本，则可能导致模块的安装失败。&lt;/p&gt;
&lt;p&gt;因而，对于这类软件，一般单独安装，并用各自的包管理器管理模块：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;TeXLive：通过TeXLive iso镜像文件安装，使用其自带的tlmgr管理包&lt;/li&gt;
&lt;li&gt;Perl：通过plenv安装最新版本的Perl，使用plenv自带的cpanm安装模块&lt;/li&gt;
&lt;li&gt;Python：通过pyenv安装最新版本的Python，使用Python自带的pip安装模块&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id27"&gt;例外&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有规则总有例外。&lt;/p&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id28"&gt;第三方源&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;mosquito-myrepo是一个私人维护的源，其中包含了中文输入法、&lt;span class="caps"&gt;QQ&lt;/span&gt;、飞信、为知笔记、有道词典、百度云以及若干音频、视频播放器。我对这个源的态度是又爱又恨，其提供了很多中国人需要的软件，但因为其依赖于除EPEL外的其他第三方软件源，进而可能导致包冲突。所以对该源的使用，要保持谨慎。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id29"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;简单总结一下:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;为系统添加EPEL源、ELRepo源和个别其他小型第三方源&lt;/li&gt;
&lt;li&gt;能够从源中安装的就从源中安装&lt;/li&gt;
&lt;li&gt;不能从源中安装的尽量找rpm包安装&lt;/li&gt;
&lt;li&gt;找不到rpm包的就试试linuxbrew&lt;/li&gt;
&lt;li&gt;能不手动编译的就不要手动编译&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id14"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id30"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;2014-11-23：初稿；&lt;/li&gt;
&lt;li&gt;2014-12-01：第三方源中加入ELRepo源；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="CentOS"></category></entry><entry><title>阅读博文的历史版本</title><link href="http://seisman.info/historical-versions-of-posts.html" rel="alternate"></link><updated>2014-11-20T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-11-20:historical-versions-of-posts.html</id><summary type="html">&lt;p&gt;最近博客的更新频率降低了很多，一方面是比较忙，另一方面主要是在更新前面写的一些博文。&lt;/p&gt;
&lt;p&gt;有些人写完博客就再也不看了，也不会再修改；有些人修改的时候，会在原文的基础上加上各种标注。我不喜欢看到各种增删的痕迹，所以我总是会直接在博文上修改。这就导致了新的读者看不到原博文。&lt;/p&gt;
&lt;p&gt;大多数情况下，旧版本的博文是没有意义的，但也许有时候对某些人是有用的。所以这里加入了阅读历史版本的功能。&lt;/p&gt;
&lt;p&gt;在每篇博文的右侧，有&lt;strong&gt;Features&lt;/strong&gt;一项，其中第一个图标用于下载当前博文的PDF，第二个图标是指向GitHub的链接，包含了当前博文的修订历史。熟悉GitHub和diff工具的读者应该可以很容易从中看到博文每次的修订情况。&lt;/p&gt;
&lt;p&gt;实现这个功能时，修改了pelican的源码。在&lt;tt class="docutils literal"&gt;contents.py&lt;/tt&gt;第103行，加入如下语句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
self.relative_source_path = self.get_relative_source_path()
&lt;/pre&gt;
</summary><category term="博客"></category></entry><entry><title>利用TauP为SAC文件标记理论到时</title><link href="http://seisman.info/mark-travel-time-using-taup.html" rel="alternate"></link><updated>2014-11-10T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-11-10:mark-travel-time-using-taup.html</id><summary type="html">&lt;p&gt;TauP的&lt;tt class="docutils literal"&gt;taup_time&lt;/tt&gt;命令可以计算各震相的理论走时，但是不能帮我们把到时信息标记到SAC文件中，因而就需要写脚本处理&lt;tt class="docutils literal"&gt;taup_time&lt;/tt&gt;的输出，并修改SAC头段。&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;taup_setsac&lt;/tt&gt;帮我们完成了这一点，可以直接计算理论到时并将到时信息写入到SAC文件中。&lt;/p&gt;
&lt;p&gt;其用法很简单，示例如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_setsac -mod prem -ph P-0,S-1,PcP-8,ScS-9 -evdpkm *.U
&lt;/pre&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-mod&lt;/span&gt; prem&lt;/tt&gt; ：指定地球模型为PREM模型；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-ph&lt;/span&gt; &lt;span class="pre"&gt;P-0,S-1,PcP-8,ScS-9&lt;/span&gt;&lt;/tt&gt; ：将P波到时标记到T0中，S到时标记到T1中，PcP标记到T8，ScS标记到T9。与此同时，该命令还会修改相应的KTn。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-evdpkm&lt;/span&gt;&lt;/tt&gt; ：由于历史的原因，该命令默认SAC文件中的震源深度单位为米，而现在的SAC文件中的震源深度单位为千米。该选项设置深度的单位为&lt;tt class="docutils literal"&gt;km&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;*.U&lt;/tt&gt; :&amp;nbsp;需要标记理论到时的SAC文件&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;需要注意的是，执行命令时经常会忘记&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-evdpkm&lt;/span&gt;&lt;/tt&gt;选项，此时该命令会给出警告。需要注意，一定不要按&lt;tt class="docutils literal"&gt;Ctrl+C&lt;/tt&gt;终止此次命令。因为&lt;tt class="docutils literal"&gt;taup_setsac&lt;/tt&gt;需要读入并修改SAC文件，然后将SAC文件写回磁盘覆盖原文件，用&lt;tt class="docutils literal"&gt;Ctrl+C&lt;/tt&gt;终止命令，会导致文件写回磁盘失败，进而导致部分SAC文件损坏。正确的做法是不要理会这些警告，待程序执行完毕之后再加上&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-evdpkm&lt;/span&gt;&lt;/tt&gt;选项重新执行。&lt;/p&gt;
</summary><category term="TauP"></category><category term="走时"></category></entry><entry><title>利用TauP计算射线穿透点</title><link href="http://seisman.info/calculate-pierce-points-using-taup.html" rel="alternate"></link><updated>2014-11-08T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-11-08:calculate-pierce-points-using-taup.html</id><summary type="html">
&lt;p&gt;&lt;tt class="docutils literal"&gt;taup_pierce&lt;/tt&gt;是TauP提供的一个命令行工具，用于计算各种震相在不同深度的穿透点信息。本文通过几个例子介绍一个&lt;tt class="docutils literal"&gt;taup_pierce&lt;/tt&gt;的使用方法。&lt;/p&gt;
&lt;p&gt;下面的所有例子使用如下参数：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;地球模型：PREM模型&lt;/li&gt;
&lt;li&gt;震源深度：200 km&lt;/li&gt;
&lt;li&gt;地震位置为（0,0）&lt;/li&gt;
&lt;li&gt;台站位置为（15,15）&lt;/li&gt;
&lt;li&gt;震中距为21.025度&lt;/li&gt;
&lt;li&gt;方位角为44.199；&lt;/li&gt;
&lt;li&gt;反方位角为226.172&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在已知如上参数的前提下，计算内核边界的反射波PKiKP震相在不同深度的穿透点信息；&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;震相在不同深度穿透对应的震中距&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;本例中使用了地震深度和震中距信息，其输出有三列，分别为不同深度处的&lt;tt class="docutils literal"&gt;震中距&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;深度&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;震相走时&lt;/tt&gt;，这里的深度是地球模型的主要间断面，比如常见到的410间断、660间断、&lt;span class="caps"&gt;CMB&lt;/span&gt;（2891）和ICB（5150）。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup_pierce -ph PKiKP -mod prem -h 200 -deg 21.024
&amp;gt; PKiKP at 971.23 seconds at 21.02 degrees for a 200.0 km deep source in the prem model with rayParam 0.469 s/deg.
    0.00   200.0     0.0
    0.01   220.0     2.5
    0.07   400.0    23.1
    0.19   670.0    50.8
    2.39  2891.0   230.0
   10.48  5149.5   472.7
   18.57  2891.0   715.5
   20.77   670.0   894.7
   20.89   400.0   922.3
   20.96   220.0   942.9
   20.96   200.0   945.4
   21.02    24.4   967.3
   21.02    15.0   968.6
   21.02     0.0   971.2
&lt;/pre&gt;
&lt;p&gt;从输出中可以看到，PKiKP震相在2.39度处穿过核幔边界进入外核，在10.48度处于内核边界处反射，并于18.57度时再次穿过核幔边界回到地幔。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;震相在不同深度处的穿透点位置&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有时候不仅仅想要知道震相在某个深度穿透所走过的距离，还想精确的知道是在哪个位置穿透点的。&lt;/p&gt;
&lt;p&gt;本例使用事件和台站的经纬度信息，输出为&lt;tt class="docutils literal"&gt;震中距&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;深度&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;走时&lt;/tt&gt;以及穿透点的&lt;tt class="docutils literal"&gt;纬度&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;经度&lt;/tt&gt;。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup_pierce -ph PKiKP -mod prem -h 200 -evt 0 0 -sta 15 15
&amp;gt; PKiKP at 971.26 seconds at 21.09 degrees for a 200.0 km deep source in the prem model with rayParam 0.470 s/deg.
    0.00   200.0     0.0      0.00      0.00
    0.01   220.0     2.5      0.00      0.00
    0.07   400.0    23.1      0.05      0.05
    0.19   670.0    50.8      0.14      0.13
    2.40  2891.0   230.0      1.72      1.67
   10.51  5149.5   472.7      7.54      7.35
   18.63  2891.0   715.5     13.29     13.18
   20.84   670.0   894.7     14.82     14.81
   20.96   400.0   922.3     14.91     14.90
   21.02   220.0   943.0     14.95     14.95
   21.03   200.0   945.5     14.96     14.95
   21.08    24.4   967.3     15.00     15.00
   21.09    15.0   968.7     15.00     15.00
   21.09     0.0   971.3     15.00     15.00
&lt;/pre&gt;
&lt;p&gt;从输出可以看到，PKiKP震相在CMB的入射点位于(1.67, 1.72)处，出射点位于(13.18, 13.29)处，在ICB的反射点位于(7.35, 7.54)处。&lt;/p&gt;
&lt;p&gt;还可以用事件位置、震中距和方位角得到同样的结果:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_pierce -ph PKiKP -mod prem -h 200 -evt 0 0 -deg 21.025 -az 44.199
&lt;/pre&gt;
&lt;p&gt;或者用台站位置、震中距、反方位角得到同样的结果:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_pierce -ph PKiKP -mod prem -h 200 -sta 15 15 -deg 21.025 -baz 226.172
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;获取反射点&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;穿透点分为两种，一种是反射点，另一种是真正意义上的穿透点。比如PKiKP震相在ICB上是反射点，在CMB上只能称为穿透点。&lt;/p&gt;
&lt;p&gt;反射点又分为两种，bottom turning points和underside reflection points，可以形象的表示为&lt;tt class="docutils literal"&gt;v&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;^&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;获取bottom turing points:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup_pierce -ph PKiKP -mod prem -h 200 -evt 0 0 -sta 15 15 -turn
&amp;gt; PKiKP at 971.26 seconds at 21.09 degrees for a 200.0 km deep source in the prem model with rayParam 0.470 s/deg.
   10.51  5149.5   472.7      7.54      7.35
&lt;/pre&gt;
&lt;p&gt;获取underside reflection points（这里以sScS为例）:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup_pierce -ph sScS -mod prem -h 200 -evt 0 0 -sta 15 15 -under
&amp;gt; sScS at  1020.00 seconds at    21.09 degrees for a    200.0 km deep source in the prem model with rayParam    3.495 s/deg.
    0.26     0.0    46.9      0.18      0.18
   21.09     0.0  1020.0     15.00     15.00
&lt;/pre&gt;
&lt;p&gt;当然也可以用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-rev&lt;/span&gt;&lt;/tt&gt;选项获取所有反射点。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;获取特定深度的穿透点位置&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;默认只输出地球模型主要间断面处的穿透点信息，有些时候会需要震相在特定深度处的穿透点信息，比如深度为5000km处:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup_pierce -ph PKiKP -mod prem -h 200 -evt 0 0 -sta 15 15 -pierce 5000
    &amp;gt; PKiKP at   971.26 seconds at    21.09 degrees for a    200.0 km deep source in the prem model with rayParam    0.470 s/deg.
        0.00   200.0     0.0      0.00      0.00
        0.01   220.0     2.5      0.00      0.00
        0.07   400.0    23.1      0.05      0.05
        0.19   670.0    50.8      0.14      0.13
        2.40  2891.0   230.0      1.72      1.67
        9.06  5000.0   457.9      6.50      6.32
       10.51  5149.5   472.7      7.54      7.35
       11.97  5000.0   487.6      8.58      8.38
       18.63  2891.0   715.5     13.29     13.18
       20.84   670.0   894.7     14.82     14.81
       20.96   400.0   922.3     14.91     14.90
       21.02   220.0   943.0     14.95     14.95
       21.03   200.0   945.5     14.96     14.95
       21.08    24.4   967.3     15.00     15.00
       21.09    15.0   968.7     15.00     15.00
       21.09     0.0   971.3     15.00     15.00
&lt;/pre&gt;
&lt;p&gt;在输出中多了两个5000km处的穿透点信息，有时候只想要这个深度的信息，而不需要其他深度的穿透点信息，此时可以使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-nodiscon&lt;/span&gt;&lt;/tt&gt;选项:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ taup_pierce -ph PKiKP -mod prem -h 200 -evt 0 0 -sta 15 15 -pierce 5000 -nodiscon
&amp;gt; PKiKP at   971.26 seconds at    21.09 degrees for a    200.0 km deep source in the prem model with rayParam    0.470 s/deg.
    9.06  5000.0   457.9      6.50      6.32
   11.97  5000.0   487.6      8.58      8.38
&lt;/pre&gt;
&lt;/div&gt;
</summary><category term="射线"></category><category term="TauP"></category></entry><entry><title>建站日志</title><link href="http://seisman.info/sitelog.html" rel="alternate"></link><updated>2015-03-01T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-11-07:sitelog.html</id><summary type="html">&lt;ul class="simple"&gt;
&lt;li&gt;2011-07-25：注册新浪博客，开始写博客之路；&lt;/li&gt;
&lt;li&gt;2013-01-03：停止更新新浪博客，启用USTC&amp;nbsp;WordPress博客；&lt;/li&gt;
&lt;li&gt;2013-06-13：&lt;span class="caps"&gt;USTC&lt;/span&gt;&amp;nbsp;WP博客出现致命错误，无法修复；&lt;/li&gt;
&lt;li&gt;2013-06-16：于&lt;a class="reference external" href="https://www.godaddy.com"&gt;GoDaddy&lt;/a&gt; 购买独立域名&lt;tt class="docutils literal"&gt;seisman.info&lt;/tt&gt;，有效期为2013年6月至2018年6月；&lt;/li&gt;
&lt;li&gt;2013-06-16：于&lt;a class="reference external" href="http://www.hengtian.cc"&gt;衡天主机&lt;/a&gt;购买国外主机；使用WordPress；&lt;/li&gt;
&lt;li&gt;2014-02-20：从WordPress转换到&lt;a class="reference external" href="https://github.com/getpelican/pelican"&gt;Pelican&lt;/a&gt;；采用&lt;a class="reference external" href="https://github.com/talha131/pelican-elegant"&gt;Elegant&lt;/a&gt;主题；源码及内容托管在&lt;a class="reference external" href="https://github.com"&gt;GitHub&lt;/a&gt;；&lt;/li&gt;
&lt;li&gt;2014-04-30：收到第一笔捐赠￥500 &lt;span class="caps"&gt;RMB&lt;/span&gt;；&lt;/li&gt;
&lt;li&gt;2014-07-17：博客托管在两个地方，国内用户访问&lt;a class="reference external" href="https://gitcafe.com"&gt;GitCafe&lt;/a&gt;，国外用户访问&lt;a class="reference external" href="https://github.com"&gt;GitHub&lt;/a&gt;；&lt;/li&gt;
&lt;li&gt;2014-09-14：支持全文PDF导出；&lt;/li&gt;
&lt;li&gt;2014-10-04：PDF托管在&lt;a class="reference external" href="http://www.qiniu.com/"&gt;七牛&lt;/a&gt;；&lt;/li&gt;
&lt;li&gt;2014-11-20：支持阅读博文的历史版本；&lt;/li&gt;
&lt;li&gt;2015-03-01：增加了“回到顶部”按钮；&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- todo --&gt;
&lt;!-- 寻找Disqus评论系统的替代品 --&gt;
&lt;!-- 寻找更好的站内搜索工具 --&gt;
</summary><category term="博客"></category></entry><entry><title>TauP的安装</title><link href="http://seisman.info/install-taup.html" rel="alternate"></link><updated>2014-10-08T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-10-08:install-taup.html</id><summary type="html">&lt;p&gt;TauP是用Java写的一个用来计算震相走时的软件。&lt;/p&gt;
&lt;p&gt;官方主页: &lt;a class="reference external" href="http://www.seis.sc.edu/taup/index.html"&gt;http://www.seis.sc.edu/taup/index.html&lt;/a&gt;&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;确认Java运行环境已安装&lt;/p&gt;
&lt;p&gt;在终端中键入&lt;tt class="docutils literal"&gt;java &lt;span class="pre"&gt;-version&lt;/span&gt;&lt;/tt&gt;，若显示版本信息，则表示Java运行环境已安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ java -version
java version &amp;quot;1.7.0_65&amp;quot;
OpenJDK Runtime Environment (rhel-2.5.1.2.el7_0-x86_64 u65-b17)
OpenJDK 64-Bit Server VM (build 24.65-b04, mixed mode)
&lt;/pre&gt;
&lt;p&gt;否则则需要先安装Java运行环境，在CentOS&amp;nbsp;7下用如下命令:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sudo yum install java
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;下载TauP:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
wget http://www.seis.sc.edu/downloads/TauP/TauP-2.1.2.tgz
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;解压:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
tar -xvf TauP-2.1.2.tgz
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo mv TauP-2.1.2 /opt
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改环境变量:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
echo 'export TAUPHOME=/opt/TauP-2.1.2' &amp;gt;&amp;gt; ~/.bashrc
echo 'export PATH=${TAUPHOME}/bin:${PATH}' &amp;gt;&amp;gt; ~/.bashrc
source ~/.bashrc
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;执行测试&lt;/p&gt;
&lt;p&gt;终端键入&lt;tt class="docutils literal"&gt;taup&lt;/tt&gt;若出现TauP图形界面则表示安装成功。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="Java"></category><category term="走时"></category></entry><entry><title>rdseed的安装</title><link href="http://seisman.info/install-rdseed.html" rel="alternate"></link><updated>2014-10-07T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-10-07:install-rdseed.html</id><summary type="html">&lt;p&gt;rdseed用于将SEED格式的数据转换为SAC格式。&lt;/p&gt;
&lt;p&gt;rdseed的安装很简单，简单到其实没什么值得写的。既然有人问起了，我便再写写。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;软件申请与下载&lt;/h2&gt;
&lt;p&gt;申请地址： &lt;a class="reference external" href="http://www.iris.edu/forms/rdseed_request.htm"&gt;http://www.iris.edu/forms/rdseed_request.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;简单填写申请信息后，无需等待即可直接下载，目前的最新版本为&lt;tt class="docutils literal"&gt;rdseedv5.3.1.tar.gz&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;解压&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ tar -zxvf rdseedv5.3.1.tar.gz
$ cd rdseedv5.3.1
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;安装&lt;/h2&gt;
&lt;p&gt;rdseed提供了源代码，也提供了在不同平台下编译好的二进制文件。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;如果是Linux 64位系统，则使用&lt;tt class="docutils literal"&gt;rdseed.rh6.linux_64&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;如果是Mac 64位系统，则使用&lt;tt class="docutils literal"&gt;rdseed.mac.x86_64&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;如果是运行在Sun/Sparc平台上的Solaris，则使用&lt;tt class="docutils literal"&gt;rdseed.solaris.sparc_64&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;如果是运行在Sun/Intel平台上的Solaris，则使用&lt;tt class="docutils literal"&gt;rdseed.solaris.x86_64&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;如果是在32位Windows 7下运行Cygwin，则使用&lt;tt class="docutils literal"&gt;rdseed.windows.cygwin_32.exe&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以64位Linux为例，应选择二进制文件&lt;tt class="docutils literal"&gt;rdseed.rh6.linux_64&lt;/tt&gt;，直接执行:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./rdseed.rh6.linux_64
&lt;/pre&gt;
&lt;p&gt;若输出如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
&amp;lt;&amp;lt; IRIS SEED Reader, Release 5.3.1 &amp;gt;&amp;gt;
Input  File (/dev/nrst0) or 'Quit' to Exit:
&lt;/pre&gt;
&lt;p&gt;则表示该二进制在当前系统可以直接使用，将其重命名，并放置到PATH中即可:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mv rdseed.rh6.linux_64 ~/bin/rdseed
&lt;/pre&gt;
&lt;p&gt;若你的Linux系统为32位，或者其他一些特殊的原因，该二进制可能无法执行，则需要自己手动编译。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;编译&lt;/h2&gt;
&lt;p&gt;若二进制文件可以直接使用，则可以忽略这一步。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;tt class="docutils literal"&gt;make clean&lt;/tt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改Makefile&lt;/p&gt;
&lt;p&gt;Makefile中默认的CFLAGS为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;-m64&lt;/span&gt; &lt;span class="pre"&gt;-g&lt;/span&gt;&lt;/tt&gt;，若为32位系统，则应设置CFLAGS的值&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;-m32&lt;/span&gt; &lt;span class="pre"&gt;-g&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;tt class="docutils literal"&gt;make&lt;/tt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;此时生成了可执行文件&lt;tt class="docutils literal"&gt;rdseed&lt;/tt&gt;，将其复制到PATH中即可:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mv rdseed ~/bin/
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="jrdseed"&gt;
&lt;h2&gt;Jrdseed&lt;/h2&gt;
&lt;p&gt;rdseed还有一个Java版本，即&lt;a class="reference external" href="http://www.iris.edu/forms/jrdseed_request.htm"&gt;Jrdseed&lt;/a&gt;&amp;nbsp;。&lt;/p&gt;
&lt;p&gt;由于是Java写的，所以具有很好的跨平台特性，直接下载解压即可使用。&lt;/p&gt;
&lt;p&gt;执行方法为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
java -jar JrdseedVer0.10.1.jar
&lt;/pre&gt;
&lt;p&gt;用法与rdseed类似。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="SAC"></category><category term="格式转换"></category></entry><entry><title>CentOS 7下安装WPS Office</title><link href="http://seisman.info/wps-office-for-centos7.html" rel="alternate"></link><updated>2014-11-03T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-10-01:wps-office-for-centos7.html</id><summary type="html">&lt;p&gt;在Microsoft&amp;nbsp;Office盛行的今日，Linux下一直没有一个能与之完美兼容的Office套件。大多数发行版默认安装的OpenOffice或LibreOffice，也只是刚刚达到能用的地步，界面以及功能的差异还是很明显的。&lt;/p&gt;
&lt;p&gt;或许WPS Office for&amp;nbsp;Linux是个不错的选择。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;中文官网： &lt;a class="reference external" href="http://linux.wps.cn/"&gt;http://linux.wps.cn/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;英文官网： &lt;a class="reference external" href="http://www.wps.com/linux/"&gt;http://www.wps.com/linux/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;目前WPS Office for Linux尚处在测试阶段。根据惯例，alpha版为内测版本，beta版为公测版本。这里选择Alpha&amp;nbsp;16。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;安装包： &lt;a class="reference external" href="http://kdl.cc.ksosoft.com/wps-community/download/a16/wps-office-9.1.0.4909-1.a16p1.i686.rpm"&gt;wps-office-9.1.0.4909-1.a16p1.i686.rpm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;字体包： &lt;a class="reference external" href="http://kdl.cc.ksosoft.com/wps-community/download/a15/wps-office-fonts-1.0-1.noarch.rpm"&gt;wps-office-fonts-1.0-1.noarch.rpm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class="caps"&gt;WPS&lt;/span&gt; Office提供的rpm包为32位版本，对于64位系统需要安装相应的32位依赖包方可使用，幸好&lt;tt class="docutils literal"&gt;yum&lt;/tt&gt;可以自动判断并解决包的依赖关系，所以安装很简单。&lt;/p&gt;
&lt;p&gt;首先&lt;tt class="docutils literal"&gt;cd&lt;/tt&gt;到下载的RPM包所在的文件夹下，然后执行如下&lt;tt class="docutils literal"&gt;yum&lt;/tt&gt;命令。注意，这里用的是&lt;tt class="docutils literal"&gt;yum&lt;/tt&gt;而不是&lt;tt class="docutils literal"&gt;rpm &lt;span class="pre"&gt;-i&lt;/span&gt;&lt;/tt&gt;，因为&lt;tt class="docutils literal"&gt;rpm&lt;/tt&gt;似乎无法自动解决32位库的依赖问题。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sudo yum install wps-office-9.1.0.4909-1.a16p1.i686.rpm
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo yum install wps-office-fonts-1.0-1.noarch.rpm
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;安装完成后，即可在“Application”中找到相关项。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;参考&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://community.wps.cn/download/"&gt;WPS下载地址&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://community.wps.cn/wiki/%E9%A6%96%E9%A1%B5"&gt;WPS社区Wiki&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://bbs.wps.cn/thread-22371203-1-1.html"&gt;原生对话框问题&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://community.wps.cn/wiki/%E9%83%A8%E5%88%86%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F%E6%98%BE%E7%A4%BA%E6%94%AF%E6%8C%81"&gt;部分数学公式显示支持&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-10-01：初稿；&lt;/li&gt;
&lt;li&gt;2014-10-23：更新至Alpha16；此版本中不再有&lt;tt class="docutils literal"&gt;mui&lt;/tt&gt;语言包；&lt;/li&gt;
&lt;li&gt;2014-11-03：更新至Alpha16&amp;nbsp;Patch1；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="CentOS"></category></entry><entry><title>CentOS 7安装fcitx中文输入法</title><link href="http://seisman.info/fcitx-for-centos-7.html" rel="alternate"></link><updated>2015-03-09T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-20:fcitx-for-centos-7.html</id><summary type="html">
&lt;p&gt;前面&lt;a class="reference external" href="http://seisman.info/install-yong-chinese-input-method-under-centos-7.html"&gt;CentOS 7.0下安装小小输入法&lt;/a&gt;一文中已经介绍了如何在CentOS 7下安装小小输入法来输入中文，实际用起来还是有不少不如意的地方。&lt;/p&gt;
&lt;p&gt;今天恰好发现了CentOS 7下安装fcitx输入法的简单方法，如下。&lt;/p&gt;
&lt;div class="section" id="epel"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;加入EPEL源&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;EPEL7几乎是CentOS必备的源:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sudo yum install epel-release
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="mosquito-myrepo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;添加mosquito-myrepo源&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;mosquito-myrepo是一个私人制作的第三方源，其中包含了fcitx输入法。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;项目地址： &lt;a class="reference external" href="https://github.com/1dot75cm/myrepo"&gt;https://github.com/1dot75cm/myrepo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;支持的发行版： Fedora 19/20/21/rawhide 以及RHEL/CentOS 7&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="literal-block"&gt;
$ sudo yum-config-manager --add-repo=https://copr.fedoraproject.org/coprs/mosquito/myrepo/repo/epel-7/mosquito-myrepo-epel-7.repo
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;安装输入法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;可以选择下面的各种输入法中的某一个或多个:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ yum install fcitx-googlepinyin fcitx-cloudpinyin # 谷歌拼音输入法
$ yum install fcitx-rime fcitx-cloudpinyin # 中州韵输入法
$ yum install fcitx-libpinyin fcitx-cloudpinyin # libpinyin输入法
$ yum install fcitx-sunpinyin sunpinyin-data fcitx-cloudpinyin # sunpinyin输入法
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;清理工作&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;mosquito-myrepo在不断地支持更多的软件，这也进一步造成该repo中的软件与base、EPEL中的软件存在版本冲突，在该repo的项目主页中建议安装yum的优先级插件&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;yum-plugin-priorities&lt;/span&gt;&lt;/tt&gt;，这在一定程度上会缓解版本冲突问题，但无法从根本上避免。&lt;/p&gt;
&lt;p&gt;鉴于多个repo的版本冲突会造成一些麻烦，最好的办法还是在安装完需要的软件之后就禁用该repo，需要的时候再启用。&lt;/p&gt;
&lt;p&gt;编辑&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/etc/yum.repos.d/mosquito-myrepo-epel-7.repo&lt;/span&gt;&lt;/tt&gt;，将其中的&lt;tt class="docutils literal"&gt;enable=1&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;enable=0&lt;/tt&gt;即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://copr.fedoraproject.org/coprs/mosquito/myrepo/"&gt;https://copr.fedoraproject.org/coprs/mosquito/myrepo/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-09-20：初稿；&lt;/li&gt;
&lt;li&gt;2014-09-29：安装完成之后建议禁用该repo以避免任何可能的版本冲突；&lt;/li&gt;
&lt;li&gt;2014-12-27：更新sogou的配置；&lt;/li&gt;
&lt;li&gt;2015-03-09：由于搜狗输入法是私有软件，违反了copr的相关规定，因而目前该源中已不再包含搜狗输入法。故删除本文中搜狗输入法相关部分；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="CentOS"></category><category term="中文"></category></entry><entry><title>Linux下合并PDF</title><link href="http://seisman.info/merge-multiple-pdfs.html" rel="alternate"></link><updated>2015-01-27T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-18:merge-multiple-pdfs.html</id><summary type="html">
&lt;p&gt;经常需要将多个PDF合并为一个文件，这里收集了网上给出的一些方案，并总结一下。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推荐使用cpdf&lt;/strong&gt;&lt;/p&gt;
&lt;div class="section" id="cpdf"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;cpdf&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://community.coherentpdf.com/"&gt;cpdf&lt;/a&gt;全称是Coherent &lt;span class="caps"&gt;PDF&lt;/span&gt; Command Line Tools，是一个强大的PDF处理工具。PDF合并只是它的一个功能之一。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cpdf input1.pdf input2.pdf -o output.pdf
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="pdfunite"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;pdfunite&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;pdfunite&lt;/tt&gt;是&lt;a class="reference external" href="http://poppler.freedesktop.org"&gt;Poppler&lt;/a&gt;提供的一个工具，一般系统都已经安装了Poppler，所以这个工具在Linux下是很常见的。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdfunite input1.pdf input2.pdf input3.pdf output.pdf
&lt;/pre&gt;
&lt;p&gt;该命令用法简单，没有多余的选项，需要注意的是该命令的最后一个PDF文件为输出文件名。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pdfjam"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;pdfjam&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;如果你安装了TeXLive，并且安装了&lt;a class="reference external" href="http://www.ctan.org/tex-archive/macros/latex/contrib/pdfpages/"&gt;pdfpage&lt;/a&gt;包，则其中包含了&lt;tt class="docutils literal"&gt;pdfjam&lt;/tt&gt;工具。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdfjam input1.pdf input2.pdf input3.pdf -o output.pdf
&lt;/pre&gt;
&lt;p&gt;该命令的选项很多，可以通过&lt;tt class="docutils literal"&gt;pdfjam &lt;span class="pre"&gt;--help&lt;/span&gt;&lt;/tt&gt;查看。&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;pdfjoin&lt;/tt&gt;是&lt;tt class="docutils literal"&gt;pdfjam&lt;/tt&gt;的一个封装，也可以直接使用:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdfjoin a.pdf b.pdf
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="pdftk"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;pdftk&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/"&gt;pdftk&lt;/a&gt;是专门用于处理PDF文档的一套工具。在大多数发行版中都可以直接安装使用。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk input1.pdf input2.pdf input3.pdf cat output output.pdf
&lt;/pre&gt;
&lt;p&gt;pdftk的选项很多，用法复杂，可以参考&lt;a class="reference external" href="http://seisman.info/introduction-to-pdftk.html"&gt;PDF合并和分割工具—PDFtk&lt;/a&gt; 。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gs"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;gs&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.ghostscript.com"&gt;GhostScript&lt;/a&gt;不仅可以用于处理PS，也可以用于处理PDF文档。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOutputFile=out.pdf in1.pdf in2.pdf
&lt;/pre&gt;
&lt;pre class="literal-block"&gt;
gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -dPDFSETTINGS=/prepress -sOutputFile=out.pdf in1.pdf in2.pdf
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://blog.dbrgn.ch/2013/8/14/merge-multiple-pdfs/"&gt;https://blog.dbrgn.ch/2013/8/14/merge-multiple-pdfs/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://stackoverflow.com/questions/2507766/merge-convert-multiple-pdf-files-into-one-pdf"&gt;http://stackoverflow.com/questions/2507766/merge-convert-multiple-pdf-files-into-one-pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-09-18：初稿；&lt;/li&gt;
&lt;li&gt;2015-01-27：新增cpdf；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="PDF"></category><category term="Linux"></category></entry><entry><title>博客现已支持全文PDF导出</title><link href="http://seisman.info/export-posts-as-pdf.html" rel="alternate"></link><updated>2014-09-14T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-14:export-posts-as-pdf.html</id><summary type="html">&lt;p&gt;近几日对博客进行了一些调整，加入了PDF全文输出的功能。在每篇博文的右侧，都会有“&lt;strong&gt;Export&lt;/strong&gt;”一项，点击下面的PDF图标，即可将当前博文以PDF格式导出。&lt;/p&gt;
&lt;p&gt;好吧，被你识破了。所谓的PDF导出，实际上是我自己将每篇博文转换为PDF并上传到服务器，供读者点击下载。&lt;/p&gt;
&lt;p&gt;转换过程中的一些细节如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;利用&lt;a class="reference external" href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt;实现从rST源码到PDF的转换&lt;/li&gt;
&lt;li&gt;之所以采用Pandoc而不是rst2pdf是因为rst2pdf的安装一直有问题&lt;/li&gt;
&lt;li&gt;转换脚本为&lt;a class="reference external" href="https://github.com/seisman/seisman.info/blob/master/makepdf.py"&gt;makepdf.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;转换为PDF时使用了xelatex，其中LaTeX模板为&lt;a class="reference external" href="https://github.com/seisman/seisman.info/blob/master/seisman.latex"&gt;seisman.latex&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;只转换博文，不转换其他页面&lt;/li&gt;
&lt;li&gt;自动更新，保证PDF与博文内容的一致性&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注意事项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;生成的PDF仅供读者离线阅读使用，请勿用作其他用途；&lt;/li&gt;
&lt;li&gt;PDF版直接由网页版转换得到，我没有人工检查PDF版的效果，若有影响阅读效果的地方，可以告诉我，我尽量保证网页版和PDF版同时有比较好的效果；&lt;/li&gt;
&lt;li&gt;请勿批量下载本博客的PDF，流量也是要花钱的。如果需要本博客的全部PDF，我可以打包发给你；&lt;/li&gt;
&lt;li&gt;目前设置了只能通过点击本博客的链接来下载PDF，直接把PDF的链接粘贴到浏览器中下载会被拒绝，这样做的主要原因是为了防盗链；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;总的来说，生成的PDF效果还是不错的。其中还有一些不够理想的细节，会在将来不断改进。&lt;/p&gt;
&lt;p&gt;待解决的问题：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;无论博文本身有没有目录，PDF中都会显示“Contents”&lt;/li&gt;
&lt;li&gt;目录与正文之间的分界不够明显&lt;/li&gt;
&lt;li&gt;若单行代码过长，网页显示时可以使用水平滚动条，PDF显示时则会将一行代码分两行或多行显示，稍稍影响阅读效果；个别过长的行在显示时会超过纸张边界；&lt;/li&gt;
&lt;li&gt;部分公式太麻烦，直接使用的截图，在PDF中效果较差&lt;/li&gt;
&lt;li&gt;部分URL没有以链接的形式显示&lt;/li&gt;
&lt;li&gt;图片不能为GIF格式，否则无法生成PDF&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="博客"></category><category term="PDF"></category><category term="Pandoc"></category></entry><entry><title>Hi-net生成仪器响应SAC PZ文件</title><link href="http://seisman.info/hinet-convert-channel-table-to-sac-pz-file.html" rel="alternate"></link><updated>2014-09-13T01:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-13:hinet-convert-channel-table-to-sac-pz-file.html</id><summary type="html">&lt;p&gt;前文&lt;a class="reference external" href="http://seisman.info/hinet-instrumental-response.html"&gt;Hinet仪器响应&lt;/a&gt;中介绍了Hi-net的仪器响应的详细信息。据此，用Python写了一个脚本，将Hi-net的Channel Table文件转换为常用的SAC&amp;nbsp;PZ文件。&lt;/p&gt;
&lt;p&gt;脚本位于：&lt;a class="reference external" href="https://github.com/seisman/HinetScripts/blob/master/ch2pz.py"&gt;ch2pz.py&lt;/a&gt;。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;用法&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
Convert Hi-net Channel Table file to SAC PZ files

Usage:
    ch2pz.py CHFILE [-C &amp;lt;comps&amp;gt;] [-D &amp;lt;outdir&amp;gt;] [-S &amp;lt;suffix&amp;gt;]

Options:
    -C &amp;lt;comps&amp;gt;      Channel Components to convert. Choose from U,N,E,X,Y.
                    Default to convert all components.
    -D &amp;lt;outdir&amp;gt;     Output directory of SAC PZ files. Use the directory of
                    Channel Table file as default.
    -S &amp;lt;suffix&amp;gt;     Suffix for SAC PZ files. [default: SAC_PZ]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;说明&lt;/h2&gt;
&lt;p&gt;参考&lt;a class="reference external" href="http://seisman.info/hinet-convert-win32-files-to-sac.html"&gt;Hi-net WIN32转SAC&lt;/a&gt;一文中对选项的解释。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="仪器响应"></category><category term="Python"></category></entry><entry><title>Hi-net WIN32转SAC脚本</title><link href="http://seisman.info/hinet-convert-win32-files-to-sac.html" rel="alternate"></link><updated>2014-11-04T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-12:hinet-convert-win32-files-to-sac.html</id><summary type="html">
&lt;p&gt;该脚本用于实现Hinet WIN32格式到SAC格式的转换，脚本位于&lt;a class="reference external" href="https://github.com/seisman/HinetScripts/blob/master/rdhinet.py"&gt;rdhinet.py&lt;/a&gt;。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;用法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ python rdhinet.py -h
Extract SAC data files from Hi-net WIN32 files

Usage:
    rdhinet.py DIRNAME [-C &amp;lt;comps&amp;gt;] [-D &amp;lt;outdir&amp;gt;] [-S &amp;lt;suffix&amp;gt;] [-P &amp;lt;procs&amp;gt;]
    rdhinet.py -h

Options:
    -h          Show this help.
    -C &amp;lt;comps&amp;gt;  Components to extract, delimited using commas.
                Avaiable components are U, N, E, X, Y et. al.
                Default to extract all components.
    -D &amp;lt;outdir&amp;gt; Output directory for SAC files.
    -S &amp;lt;suffix&amp;gt; Suffix of output SAC files. Default: no suffix.
    -P &amp;lt;procs&amp;gt;  Parallel using multiple processes.
                Set number of cpus to &amp;lt;procs&amp;gt; if &amp;lt;procs&amp;gt; equals 0. [default: 0]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;参数说明&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DIRNAME&lt;/span&gt;&lt;/tt&gt;为必须参数，即要处理的文件夹。该文件夹中包含了两个文件：&lt;tt class="docutils literal"&gt;CODE_YYYYMMDDHHMM_SPAN.cnt&lt;/tt&gt;格式的cnt文件和&lt;tt class="docutils literal"&gt;CODE_YYYYMMDD.ch&lt;/tt&gt;格式的channel table文件；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-C&lt;/span&gt; &amp;lt;comps&amp;gt;&lt;/tt&gt;为可选参数，表示要提取哪些分量的波形，可选的值为U、E、N、X、Y等，各分量间用逗号分隔，默认值为空，即提取全部分量；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-D&lt;/span&gt; &amp;lt;outdir&amp;gt;&lt;/tt&gt;为可选参数，表示SAC文件的输出目录。可以是绝对路径，也可以是相对于当前目录的相对路径，默认解压到文件夹&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DIRNAME&lt;/span&gt;&lt;/tt&gt;下；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-S&lt;/span&gt; &amp;lt;suffix&amp;gt;&lt;/tt&gt;输出SAC文件的扩展名，默认无扩展名&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-P&lt;/span&gt; &amp;lt;procs&amp;gt;&lt;/tt&gt;为可选参数，表示用多个进程并行提取数据；默认值为0，即设置进程数与CPU数目相同；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;额外的一点说明：更通用的处理方式应该是参数为文件名而不是目录名，但从实际数据处理的角度看，以目录名作为参数用起来更加方便，现在的选择是在通用性与易用性之间权衡的结果。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;脚本说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;脚本的数据处理流程如下：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;进入目录&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DIRNAME&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;生成参数文件&lt;tt class="docutils literal"&gt;win.prm&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;从channel table文件中获取channle列表；&lt;/li&gt;
&lt;li&gt;根据channel列表，提取不同channel的数据；&lt;/li&gt;
&lt;li&gt;修改所有SAC文件的扩展名；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;示例&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;处理目录201201010101下的WIN32文件，其他参数使用默认值:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python rdhinet.py 201201010101
&lt;/pre&gt;
&lt;p&gt;仅提取水平分量:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python rdhinet.py 201201010101 -C E,N
&lt;/pre&gt;
&lt;p&gt;输出SAC文件到&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;RAW&lt;/span&gt;&lt;/tt&gt;目录中:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python rdhinet.py 201201010101 -D RAW
&lt;/pre&gt;
&lt;p&gt;输出到&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;RAW&lt;/span&gt;&lt;/tt&gt;目录下，并指定文件扩展名为&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python rdhinet.py 201201010101 -D RAW -S SAC
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-09-12：初稿；&lt;/li&gt;
&lt;li&gt;2014-10-05：实际使用中发现，分量名不只是UNEXY，因为修改代码，默认提取全部分量；&lt;/li&gt;
&lt;li&gt;2014-11-04：脚本更新；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="Python"></category><category term="数据"></category></entry><entry><title>Hi-net win32tools</title><link href="http://seisman.info/hinet-win32tools.html" rel="alternate"></link><updated>2014-12-01T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-07:hinet-win32tools.html</id><summary type="html">
&lt;p&gt;从Hi-net获取的波形数据为不常见/用的WIN32格式，Hi-net提供了win32tools来实现波形数据的基本处理和转换。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/manual/dlDialogue.php?r=win32tools"&gt;http://www.hinet.bosai.go.jp/&lt;span class="caps"&gt;REGS&lt;/span&gt;/manual/dlDialogue.php?r=win32tools&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;直接解压编译即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="tools"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;Tools&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;win32tools中包含了一系列用于数据处理的命令。&lt;/p&gt;
&lt;div class="section" id="catwin32"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;catwin32&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;可以合并两个或多个WIN32文件，一般用于将&lt;strong&gt;多个一分钟&lt;/strong&gt;的文件合并&lt;strong&gt;一个多分钟&lt;/strong&gt;的文件。&lt;/p&gt;
&lt;p&gt;用法:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
catwin32 File_1 File_2 ... File_n [-oOutFile | -o OutFile] [-s] [-h]
      File_n        : Input WIN32 file name
                    : You may use a wild word character.
      OutFile       : Output WIN32 file name
      -s            : Sort by date
      -h            : This usage print
&lt;/pre&gt;
&lt;p&gt;示例:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
catwin32 20140830000*.cnt -o 2014083001.cnt
&lt;/pre&gt;
&lt;p&gt;上面的示例中，会将201408300000*.cnt文件合并成2014083001.cnt文件。若数据存在缺失，比如，缺少某些分钟的数据，或者某分钟内缺失若干秒的数据，则在使用win2sac_32将WIN32数据转换为SAC格式时，会自动对缺失的数据进行补领，因而不必担心数据缺失的问题。&lt;/p&gt;
&lt;p&gt;关于&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-s&lt;/span&gt;&lt;/tt&gt;选项，需要注意一下的用法：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;无&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-s&lt;/span&gt;&lt;/tt&gt;的情况下，&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;会将所有的WIN32文件，按照&lt;strong&gt;文件在参数列表中的顺序&lt;/strong&gt;合并在一起。&lt;/li&gt;
&lt;li&gt;有&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-s&lt;/span&gt;&lt;/tt&gt;的情况下，&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;会检查所有WIN32文件的起始时间，按照&lt;strong&gt;文件的起始时间的顺序&lt;/strong&gt;合并在一起。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;比如:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
catwin32 201408300001.cnt 201408300002.cnt -o 2014083001_2.cnt
catwin32 201408300002.cnt 201408300001.cnt -o 2014083001_2.cnt
catwin32 201408300002.cnt 201408300001.cnt -o 2014083001_2.cnt -s
&lt;/pre&gt;
&lt;p&gt;该例中，第一种方法是对的；第二种方法是错误的；第三种方法加上了“-s”选项是对的；&lt;/p&gt;
&lt;p&gt;在bash下，形如&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;20140830000*.cnt&lt;/span&gt;&lt;/tt&gt;这样的通配符，会将当前目录下符合的所有文件按照文件名的顺序排序，并作为catwin32的参数，在默认的情况下，按文件名排序与按文件起始时间排序是等效的，但存在一些特殊的情况：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;自定义了cnt文件的文件名，此时在bash下用通配符得到的文件顺序不一定是按照时间排序的；&lt;/li&gt;
&lt;li&gt;python中的&lt;tt class="docutils literal"&gt;glob.glob()&lt;/tt&gt;函数，默认返回的文件顺序是乱序的，需要使用&lt;tt class="docutils literal"&gt;sorted()&lt;/tt&gt; 函数；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因而，在确保参数列表中文件顺序正确的前提下，不需要使用“-s”选项；反之，则必须使用“-s”选项，否则在执行win2sac_32命令时会出现“The time is not sort.”的错误。但，加入了“-s”选项后，由于需要检查每个cnt文件的起始时间，并按起始时间对数据进行排序，因而会影响到数据合并的速度，尤其是在需要合并大量cnt文件的时候。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="win2sac-32"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;win2sac_32&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;win2sac_32&lt;/tt&gt;：主要用于将WIN32格式转换为SAC格式。除此之外，还可以对数据进行重采样，以二进制或ASCII形式输出&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id13"&gt;用法&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="literal-block"&gt;
win2sac_32 winfile ch_no sacfile [outdir] [-p(prmfile)]
    [-e] [-b[BIN]] [-a[ASC]] [-r(RATIO)] [-m(PMAX)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id14"&gt;对选项的说明&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;winfile：WIN32格式的数据文件&lt;/li&gt;
&lt;li&gt;ch_no：通道号列表，多个通道号之间以逗号分隔，也可以使一个包含一系列通道号的文件名；比如&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;4CC4&lt;/span&gt;&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;4CC4&lt;/span&gt;,4F73&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;chno.file&lt;/tt&gt;。&lt;/li&gt;
&lt;li&gt;sacfile：SAC输出文件的扩展名&lt;/li&gt;
&lt;li&gt;outdir：SAC文件的输出目录。若未指定或指定为“-”，则输出到当前目录&lt;/li&gt;
&lt;li&gt;p选项：指定参数文件名prmfile；若未使用该选项，则参数文件名默认为“win.prm”。关于参数文件的格式，在下面会介绍。&lt;/li&gt;
&lt;li&gt;e选项：设定输出SAC二进制文件的字节序，若不指定该选项，则输出的SAC二进制文件总是big endian；若指定该选项，则输出SAC二进制文件的字节序由当前机器的字节序决定；&lt;/li&gt;
&lt;li&gt;b选项：将数据以二进制形式输出，BIN为文件扩展名，在不指定的情况下，默认为“bin”&lt;/li&gt;
&lt;li&gt;a选项：将数据以ASCII形式输出（即单列数据），ASC为文件扩展名，在不指定的情况下，默认为“asc”&lt;/li&gt;
&lt;li&gt;r选项：对输出文件的数值乘以某常数RATIO，在不指定的情况下，默认值为1.0（？）&lt;/li&gt;
&lt;li&gt;m选项：指定最大数据点数，默认值为200万；若win32文件中包含的数据点数超过该值，则报错。比如，一个win32数据中包含了所有台站一天的数据，即每个通道分别有24*60*60*100=8640000个点，超过默认最大点数2000000，则此时需要使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-m&lt;/span&gt;&lt;/tt&gt;选项增大最大数据点数。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id15"&gt;输出文件名格式&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;输出文件名格式为&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;XXXX&lt;/span&gt;.Y.&lt;span class="caps"&gt;ZZZ&lt;/span&gt;&lt;/tt&gt;，其中&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;XXXX&lt;/span&gt;&lt;/tt&gt;为台站代码，&lt;tt class="docutils literal"&gt;Y&lt;/tt&gt;为分量代码，&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ZZZ&lt;/span&gt;&lt;/tt&gt;为BIN或ASC或sacfile所指定的值。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sac"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id16"&gt;输出文件的SAC的头段信息&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;该命令在生成SAC文件的同时会将相关信息写入SAC头段中，具体如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;npts, b&lt;/li&gt;
&lt;li&gt;leven&lt;/li&gt;
&lt;li&gt;ievtyp, idep&lt;/li&gt;
&lt;li&gt;nzyear, nzjday, nzhour, nzmin, nzsec, nzmsec&lt;/li&gt;
&lt;li&gt;kstnm, kcmpnm, knetwk, cmpaz, cmpinc, stla, stlo, stel&lt;/li&gt;
&lt;li&gt;kevnm&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：生成的SAC文件中头段e为未定义值。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="prmfile"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id17"&gt;参数文件prmfile格式&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;在标准的prmfile中，有16个记录行。但win2sac_32程序仅使用第二行和（至？）第四行；&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;行1：数据文件winfile所在目录&lt;/li&gt;
&lt;li&gt;行2：channel table文件&lt;/li&gt;
&lt;li&gt;行3：台站组文件名&lt;/li&gt;
&lt;li&gt;行4：pick文件所在目录&lt;/li&gt;
&lt;li&gt;行5：hypomh程序&lt;/li&gt;
&lt;li&gt;行6：hypomh所使用的速度结构&lt;/li&gt;
&lt;li&gt;行7：map data file&lt;/li&gt;
&lt;li&gt;行8：cut-out wave data输出目录&lt;/li&gt;
&lt;li&gt;行9：数据格式（B4/B2/L4/L2）&lt;/li&gt;
&lt;li&gt;行10：滤波设置文件&lt;/li&gt;
&lt;li&gt;行11：打印机…&lt;/li&gt;
&lt;li&gt;行12：upper/lower 半球投影&lt;/li&gt;
&lt;li&gt;行13：&lt;span class="caps"&gt;NOISE&lt;/span&gt;, &lt;span class="caps"&gt;FAR&lt;/span&gt;…&lt;/li&gt;
&lt;li&gt;行14：hypocenter数据所在目录&lt;/li&gt;
&lt;li&gt;行15：打印机DPI&lt;/li&gt;
&lt;li&gt;行16：临时工作目录&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因而一般来说，在使用win2sac_32时需要创建文件“win.prm”，其内容为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
.
./01_01_20140830.euc.ch
.
.
&lt;/pre&gt;
&lt;p&gt;其中第二列为数据对应的channel table文件。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id18"&gt;示例&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="literal-block"&gt;
win2sac_32 2000082404000101VM.cnt 4c55,4c65 sac ./sacdir -pwin.aaa.prm 1&amp;gt;ww.tmp
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="dewin-32"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;dewin_32&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;dewin_32&lt;/tt&gt;从WIN32格式文件中取出指定通道的数据。&lt;/p&gt;
&lt;p&gt;用法:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
usage: dewin_32 [-m] [-s samp] [-c] [-a] [-n] [-e extend] [-f filter_file] ch_no [input_file]
        -m  Win file is minutes file.
        -s  [samp] sampling number.
        -c  character output
        -a  audio format (u-law) output
        -n  not fill absent part
        -e  [extend] file extend name
        -f  [filter_file] filter paramter file
     ch_no  channel no.(in hex.) or channel no. file name
     input_file  input win file(default=stdin)
&lt;/pre&gt;
&lt;p&gt;下面解释一下几个比较重要的选项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;input_file：输入文件，为WIN32格式；&lt;/li&gt;
&lt;li&gt;ch_no：要提取的通道号列表，多个通道号之间以逗号分隔，也可以是一个包含一系列通道号的文件名；比如&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;4CC4&lt;/span&gt;&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;4cc4,4f73&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;chno.file&lt;/tt&gt;。&lt;/li&gt;
&lt;li&gt;c选项：表示将数据以字符形式输出，即单列数据；&lt;/li&gt;
&lt;li&gt;e选项：默认情况下，输出到标准输出；当指定多个通道时，标准输出会比较混乱，因而需要输出到文件中，该选项指定输出文件的扩展名；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;几个不重要的选项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;a选项：表示将数据以音频格式输入（参见&lt;a class="reference external" href="http://www.wikiwand.com/en/%CE%9C-law_algorithm"&gt;u-law&lt;/a&gt;）&lt;/li&gt;
&lt;li&gt;n选项：若数据存在缺失，默认情况下补零输出，该选项不对缺失部分补零。&lt;/li&gt;
&lt;li&gt;m、s选项：不是太理解，似乎都是用于数据缺失时，应该不重要；&lt;/li&gt;
&lt;li&gt;f选项：后接滤波参数文件，以对输出的数据进行滤波，一般用不到；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;示例:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
dewin_32 -e dwn -c 4CC4,5B35 -m 2003070507400101VM.cnt
dewin_32 -e dwn -c -n ch.lst &amp;lt; 2003070507400101VMs.cnt
dewin_32 -c -n 5b35 &amp;lt; 2003070507400101VMs.cnt &amp;gt; ww5b35.dat
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;其他&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;下面的一些工具应该是很少用到的：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;wadd_32&lt;/tt&gt;：合并两个WIN32数据，与catwin32有些类似，但在细节上有区别。具体不知。一般用不到。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;wch_32&lt;/tt&gt;：从WIN32文件中提取指定通道号的数据并写入到新的WIN32文件中&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;wck_32&lt;/tt&gt;：似乎是用于检查WIN32文件的。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;w32tow1&lt;/tt&gt;：WIN32格式转换为WIN格式（WIN32格式是根据WIN格式修改得到的）&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;wed_32&lt;/tt&gt;：用于编辑WIN32文件&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;wchch_32&lt;/tt&gt;：修改通道号&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在win32tools提供的9个工具中，最常用的有两个：&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;win2sac_32&lt;/tt&gt;，其中前者用于合并数据，后者用于格式转换。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-09-07：初稿；&lt;/li&gt;
&lt;li&gt;2014-11-03：&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;命令要使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-s&lt;/span&gt;&lt;/tt&gt;选项；&lt;/li&gt;
&lt;li&gt;2014-11-14：加入了“生成的SAC文件的头段信息”一节；&lt;/li&gt;
&lt;li&gt;2014-12-01：对&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-s&lt;/span&gt;&lt;/tt&gt;选项的理解错误，该选项只会对文件按照起始时间排序，不会影响到数据的补零；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="格式转换"></category></entry><entry><title>Hi-net的仪器响应</title><link href="http://seisman.info/hinet-instrumental-response.html" rel="alternate"></link><updated>2014-09-06T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-06:hinet-instrumental-response.html</id><summary type="html">
&lt;p&gt;前文介绍了channel table文件的格式以及每一列的含义，其中7-13列记录了channel的仪器信息。由于Hi-net并没有像IRIS那样提供RESP或SAC_PZ文件，因而需要用户根据7-13列的信息手动推导仪器响应。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;警告&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;本文是在Hi-net官方网站内容、Hi-net官方回复邮件内容以及个人对于仪器响应的理解的基础上完成的。&lt;/p&gt;
&lt;p&gt;本人无法保证本文的内容是完全正确的，望读者带着批判的眼光阅读本文！&lt;/p&gt;
&lt;p&gt;若因阅读本文内容而造成数据处理的任何偏差以及由此带来的任何后果，由用户自己承担。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;回顾&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;先回顾一下7-13列的含义：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;[7]：Quantization bit rate of A/D conversion&lt;/li&gt;
&lt;li&gt;[8]：Sensor sensitivity (in V/unit_of_input)&lt;/li&gt;
&lt;li&gt;[9]：Unit of input&lt;/li&gt;
&lt;li&gt;[10]：Nature period of the sensor&lt;/li&gt;
&lt;li&gt;[11]：Damping constant of the sensor&lt;/li&gt;
&lt;li&gt;[12]：Amplification factor applied to sensor output prior to A/D conversion (in dB)&lt;/li&gt;
&lt;li&gt;[13]：&lt;span class="caps"&gt;LSB&lt;/span&gt; value of A/D conversion&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;流程&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;根据&lt;a class="reference external" href="http://seisman.info/physical-details-of-instrumental-response.html"&gt;《仪器响应的物理细节》&lt;/a&gt;一文的分析，将7-13列按照仪器响应的过程再细分一下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;输入：波场振幅（[9]）&lt;/li&gt;
&lt;li&gt;输入增强：对输入波场进行放大（[12]）&lt;/li&gt;
&lt;li&gt;Analog Stage：将连续的波场振幅转换为连续电压信号（[10]、[11]、[8]）&lt;/li&gt;
&lt;li&gt;Analog-Digital Conversion：将连续电压信号转换为离散电压信号（[7]、[13]）&lt;/li&gt;
&lt;li&gt;Digital Stage：对离散数据进行处理&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;输入&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;[9]给出了输入波场振幅&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;的单位，一般来说，其值为&lt;tt class="docutils literal"&gt;m/s&lt;/tt&gt;，即Hi-net是速度地震仪。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;输入增强&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这一步对输入的波场振幅进行放大，[12]给出了放大系数&lt;span class="math"&gt;\(L_{dB}\)&lt;/span&gt;，单位为dB。&lt;/p&gt;
&lt;p&gt;根据维基百科中对&lt;a class="reference external" href="http://en.wikipedia.org/wiki/Decibel#Field_quantities"&gt;场量分贝&lt;/a&gt;的定义可知：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
L_{dB} = 20 \log_{10}\left(\frac{A_1}{A_0}\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;因而，本步骤的输出波场振幅&lt;span class="math"&gt;\(A_1\)&lt;/span&gt;为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A_1 = A_0 10^{\frac{L_{dB}}{20}}
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="analog-stage"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;Analog Stage&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在Hi-net的官方回复邮件中提到，Hi-net统一使用的是”moving coil velocity type seismometer“，此种地震仪的transfer函数在Laplace域表示为：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G \frac{s^2}{s^2+2 h \omega s + \omega^2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="math"&gt;\(G\)&lt;/span&gt;：Sensor sensitivity，即&lt;span class="math"&gt;\(G\)&lt;/span&gt;= [8]&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(h\)&lt;/span&gt;：damping constant， 即&lt;span class="math"&gt;\(h\)&lt;/span&gt;= [11]&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\omega\)&lt;/span&gt;： natural angular frequency，即&lt;span class="math"&gt;\(\omega=\frac{2\pi}{[10]}\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;从channel table即可计算出这三个量，代入transfer函数，根据&lt;a class="reference external" href="http://seisman.info/deep-analysis-of-response.html"&gt;仪器响应实例分析&lt;/a&gt;中的类似步骤，即可计算出零点和极点，以及归一化因子&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：对于速度场而言，可以推导得到&lt;span class="math"&gt;\(A_0 = 2*[11]\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="analog-digital-conversion"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;Analog-Digital Conversion&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;首先需要理解两个概念，bit rate和LSB value。&lt;/p&gt;
&lt;p&gt;模数转换器（&lt;span class="caps"&gt;ADC&lt;/span&gt;）的作用是将连续的模拟信号（电压，单位V）转换为离散的数字信号（单位为counts）。如果一个ADC的bit rate为8，则该ADC可以将模拟信号编码为&lt;span class="math"&gt;\(2^8=256\)&lt;/span&gt;个不同的离散值，从0至255或从-128到127。&lt;/p&gt;
&lt;p&gt;若该ADC的电压测量范围为&lt;span class="math"&gt;\(\pm 20 V\)&lt;/span&gt;，则该ADC可以将40V的电压测量范围转换为256种离散值，因而该ADC的电压分辨率为40/256 V/counts。这一电压分辨率也称为最低有效位（&lt;span class="caps"&gt;LSB&lt;/span&gt;）电压，即“使得输出离散信号产生一个变化所需的最小输入电压的差值”。&lt;/p&gt;
&lt;p&gt;bit rate与LSB value之间的关系如下：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{V_{high}-V_{low}}{2^{bitrate}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(V_{high}\)&lt;/span&gt;和&lt;span class="math"&gt;\(V_{low}\)&lt;/span&gt;分别为ADC的测量电压上下限。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;LSB&lt;/span&gt; value的倒数&lt;span class="math"&gt;\(\frac{1}{[13]}\)&lt;/span&gt;，其单位为&lt;span class="math"&gt;\(counts/V\)&lt;/span&gt;，即单位电压所对应的离散值得变化量，也就是这一阶段的增益&lt;span class="math"&gt;\(S_d=\frac{1}{[13]}\)&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="digital-stage"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;Digital Stage&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这一阶段，对离散信号进行处理，需要考虑这个过程中的增益。&lt;/p&gt;
&lt;p&gt;在Hi-net官方的&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/seed/?LANG=en"&gt;Response of Observation Equipment&lt;/a&gt;说明中，给出了三种仪器响应RESP文件，并指出&lt;/p&gt;
&lt;blockquote&gt;
In all response files for Hi-net data, sensor sensitivity is set to the case of 200 V/(cm/s).
Actual sensitivity of each channel is shown at the 8th column of the channel table file.
This means that the values at 37th line from the top and 4th line from the bottom
should be modified from the response file in this web page, considering this point.&lt;/blockquote&gt;
&lt;p&gt;即&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/seed/?LANG=en"&gt;Response of Observation Equipment&lt;/a&gt;中给出的三种仪器响应RESP文件，仅仅只是示例，每个RESP文件的前37行和后4行（&lt;span class="caps"&gt;PS&lt;/span&gt;：此处行号并不包括注释行）必须根据channel table中的值进行修改，而其余行则不需要修改。看看RESP文件的内容可知，不需要修改的行恰好对应Digital Stage（stage number为3或4），这暗示着&lt;strong&gt;Hi-net的所有channel的Digital Stage部分是完全相同的&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;从RESP文件中可以看出，stage 3和stage 4虽然看上去很复杂，但实际上其振幅增益&lt;span class="math"&gt;\(S_d=1.0\)&lt;/span&gt;。换句话说，也就是不必过多考虑这一阶段。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;检查[9]确认输入波场为速度场&lt;/li&gt;
&lt;li&gt;由[12]计算波场放大系数&lt;/li&gt;
&lt;li&gt;由[10]、[11]构造增益为1的transfer函数，计算其零点和极点，并计算transfer函数在自然频率处的振幅，以得到归一化因子&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;[8]为增益，可直接使用&lt;/li&gt;
&lt;li&gt;对[13]列取倒数得到增益（[7]没有用）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由此，可根据channel table完整构建每个channel的仪器响应文件，RESP格式或SAC_PZ格式均可，一般用SAC_PZ格式即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;附录&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;官方回复邮件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Question1: Apr 24, 2014 09:32 (&lt;span class="caps"&gt;UT&lt;/span&gt;) +0900(&lt;span class="caps"&gt;JST&lt;/span&gt;)&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Hi,

I am using Hi-net data and am confused with the instrumental response
even after I have looked through all pages of Hi-net website.

In the page of 'For Registered Users' -&amp;gt; 'Response of Observation Equipment',
only three RESP files are given. It seems that I have to rewrite a new RESP
or SAC_PZ file for each channel.

So I have to confirm that I understand details of response, which are very
important for correct data processing.

1. Do all channels have the same zeroes and poles?
2. At line 19, do all channels have the same A0 Normalization factor (0.999953)?
3. In the FAQ Q08, one equation is given to convert the A/D value from an WIN32
   file to the corresponding physical quantity. It is

        v = I * [13] / ( [8] * 10 ^ ( [12] / 20 ) )

   If I want to generate a SAC PZ file, the CONSTANT will be

    CONSTANT = [8]*10^([12]/20) / [13] * A0 ?

I am looking forward to your reply.

Best Regards.
&lt;/pre&gt;
&lt;p&gt;Answer1:  May 07, 2014 08:30 (&lt;span class="caps"&gt;UT&lt;/span&gt;) +0900(&lt;span class="caps"&gt;JST&lt;/span&gt;)&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Thank you for accessing our website.
This is the NIED Hi-net/F-net/V-net administrator.

In the "Response of Observation Equipment" page, sample RESP files are
provided and you need to modify them according to your purposes, as you
wrote. The explanation in this page assumes that the parameters of the
seismometer other than the gain factor do not change. Strictly speaking,
the zeros, the poles, and the A0 normalization factor can change
depending on the parameters of the seismometer. The moving coil velocity
type seismometer is used in Hi-net and its transfer function in the
Laplace domain is given as:

    Gs^2/(s^2 + 2hws + w^2)

where G, h and w are the gain factor, the damping constant, and the
natural angular frequency, respectively. Roots of the numerator and the
denominator correspond to the zeros and the poles, respectively, and the
A0 normalization factor is the inverse of the absolute value of the
above equation except G at the normalization frequency. Detailed
explanation about this type of seismometer is available in many
literature, such as,

Scherbaum, F., Of Poles and Zeros: Fundamentals of Digital Seismology,
Kluwer Academic Publishers, 1996.
#see chapter 4

The gain factor, the damping constant, and the natural period are
provided in the channels table file as explained in the Q&amp;amp;A08.
Note that the gain factor is measured at its natural frequency.
http://www.hinet.bosai.go.jp/faq/?LANG=en#Q08

Please read the SEED manual about further details and SAC manual about
SAC PZ file.

- SEED: http://www.fdsn.org/publications.htm
- SAC: http://www.iris.edu/files/sac-manual/

Sincerely,
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="仪器响应"></category></entry><entry><title>Hi-net Channel Table文件</title><link href="http://seisman.info/hinet-channel-table.html" rel="alternate"></link><updated>2014-09-09T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-05:hinet-channel-table.html</id><summary type="html">
&lt;p&gt;从Hi-net下载连续波形数据会得到ZIP压缩文件，其中包含了两个后缀为&lt;tt class="docutils literal"&gt;ch&lt;/tt&gt;的文件，即Channel Table文件。两个文件内容是相同的，区别在于一个是&lt;tt class="docutils literal"&gt;euc&lt;/tt&gt;编码，一个是&lt;tt class="docutils literal"&gt;sjis&lt;/tt&gt;编码。只需要用其中一个即可，这里选择&lt;tt class="docutils literal"&gt;euc&lt;/tt&gt;编码的文件。&lt;/p&gt;
&lt;p&gt;Channel Table文件描述了每个channel的仪器信息。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;规律分析&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;看一看Channel Table文件的内容，很容易总结出如下规律：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;每个台站的信息需要四行；&lt;/li&gt;
&lt;li&gt;第一行以“#”开头，描述了台站名称及其他信息，可以认为是注释行；&lt;/li&gt;
&lt;li&gt;第二至四行，分别为U、N、E三个分量的仪器信息；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;但细细看看文件内容会发现，存在很多不符合上述规律的特例，比如：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;有些台站只有一个或两个分量，而不是三个；&lt;/li&gt;
&lt;li&gt;有些台站不包含N、E分量，而包含X、Y分量；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因而，若按照上面总结出的规律去做文本处理，会出现很多问题。更严谨的处理方式应该是：将所有以“#”开头的行当作注释行，其余行平等对待，即最小单位是channel或分量，而不是台站。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;一个channel包含了如下以&lt;strong&gt;空格&lt;/strong&gt;分隔的19列信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2903 1 0 N.AGWH U 6 27 154.30 m/s 0.96 0.70 0 1.023e-07 43.0842 140.8199 -77 0 0 Akaigawa
&lt;/pre&gt;
&lt;p&gt;每列的具体含义如下（后加问号则表示不那么确定）：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Channle &lt;span class="caps"&gt;ID&lt;/span&gt;：16-bit，用四位的16进制数表示，用于唯一标识一个channel；&lt;/li&gt;
&lt;li&gt;Recording flag：若为1则表示该channel正常记录数据，值一般为1（？）&lt;/li&gt;
&lt;li&gt;Delay time on a circuit：电路中的时间延迟，值一般为0&lt;/li&gt;
&lt;li&gt;Station code：台站代码，Hi-net的台站代码格式为&lt;tt class="docutils literal"&gt;N.xxxH&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;Motion component code：分量名，可以取值包括U、N、E、X、Y，除此之外，还有wU、wE、wN等奇怪的分量；&lt;/li&gt;
&lt;li&gt;Reduction ratio of monitor waveform amplitude：显示器上的显示振幅与实际振幅之间的比例，其值为2的指数（？）&lt;/li&gt;
&lt;li&gt;Quantization bit rate in A/D conversion：模数转换器的量化分辨率，一般值为27，个别值为20或24；&lt;/li&gt;
&lt;li&gt;Sensor sensitivity：每单位输入所产生的输出为多少V；&lt;/li&gt;
&lt;li&gt;Unit of input：输入的单位，一般为&lt;tt class="docutils literal"&gt;m/s&lt;/tt&gt;，即输入为速度；&lt;/li&gt;
&lt;li&gt;Natural period of the seismometer：传感器的自然周期；&lt;/li&gt;
&lt;li&gt;Damping constant of the seismometer：传感器的衰减常数；&lt;/li&gt;
&lt;li&gt;Amplification factor applied to sensor output prior to A/D conversion：在对连续波形使用ADC之前，传感器的放大因子；单位dB&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;LSB&lt;/span&gt; value：模数转换器的LSB值；&lt;/li&gt;
&lt;li&gt;Latitude：台站纬度&lt;/li&gt;
&lt;li&gt;Longitude：台站经度&lt;/li&gt;
&lt;li&gt;Altitude：台站高程（单位为m）&lt;/li&gt;
&lt;li&gt;P波台站校正：一般为0&lt;/li&gt;
&lt;li&gt;S波台站校正：一般为0&lt;/li&gt;
&lt;li&gt;台站名称&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;补充说明&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="channel-id"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;Channel &lt;span class="caps"&gt;ID&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;常见的Channel ID为四位16进制数，实际上有另一类ID称为宽Channel &lt;span class="caps"&gt;ID&lt;/span&gt;，其用八位16进制表示。一般用不到，所以在本文以及后面都不会再提到。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="motion-component-code"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;Motion component code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Channel Table中仅给出了分量代码，可以取值为U、N、E、X、Y以及其他。其中U表示分量为垂直方向。N、E表示分量指向北向和东向。X、Y以及其他分量代码的含义未知。&lt;/p&gt;
&lt;p&gt;由于传感器安装在borehole的底部，所以很难精确知道传感器的真实方位。以分量代码为N的传感器为例，该传感器并不一定严格指向正北方向。一般而言，其与正北方向的夹角在5度以内，个别传感器的方向甚至与北向相差几十度。每个传感器的方位信息位于该&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/direc/?subject=kekka"&gt;页面&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;在Channel Table中，只给出了分量代码而没有给出具体的方位信息。因而只能根据分量代码做一些可靠的假设。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;U向分量：&lt;tt class="docutils literal"&gt;cmpaz=0&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;cmpinc=0&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;N向分量：&lt;tt class="docutils literal"&gt;cmpaz=0&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;cmpinc=90&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;E向分量：&lt;tt class="docutils literal"&gt;cmpaz=90&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;cmpinc=90&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;其他分量：未知；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="units-of-input"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;Units of input&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Hi-net使用的是短周期速度地震仪，输入为速度场，单位为&lt;tt class="docutils literal"&gt;m/s&lt;/tt&gt;，而部分channel的输入单位为&lt;tt class="docutils literal"&gt;m/s/s&lt;/tt&gt;，即输入为加速度场。&lt;/p&gt;
&lt;p&gt;输入单位为&lt;tt class="docutils literal"&gt;m/s/s&lt;/tt&gt;的channel，与输入单位为&lt;tt class="docutils literal"&gt;m/s&lt;/tt&gt;的channel相比，在后期的数据处理上差别很多，因而不建议提取输入单位为&lt;tt class="docutils literal"&gt;m/s/s&lt;/tt&gt;的通道数据。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="natural-period-of-the-seismometer"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;Natural period of the seismometer&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;截至2014年09月08日，对于这一列的含义有两种互相矛盾的说法：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;readme.txt&lt;/tt&gt;中对该列解释为&lt;strong&gt;Eigen frequency of the sensor&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/faq/?LANG=en#Q08"&gt;Hi-net &lt;span class="caps"&gt;FAQ&lt;/span&gt; 08&lt;/a&gt;中该列解释为&lt;strong&gt;Natural period of the seismometer&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi-net官方回复指出，FAQ08中的解释是正确的，即第10列为“Natural period of the seismometer”。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;19列信息：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Channel标识为：1&lt;/li&gt;
&lt;li&gt;含义很明显，可以直接使用的有：4、5、14、15、16、19；&lt;/li&gt;
&lt;li&gt;基本没用途，可以不必关心的有一：2、3、6、17、18；&lt;/li&gt;
&lt;li&gt;与仪器有关的为7、8、9、10、11、12、13；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;接下来会有专门的博文介绍如何根据7-13列确定该channel的仪器响应。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;从Hi-net下载连续波形数据得到的ZIP文件中的&lt;tt class="docutils literal"&gt;readme.txt&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/faq/?LANG=en#Q08"&gt;Hi-net &lt;span class="caps"&gt;FAQ&lt;/span&gt; 08&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/direc/?LANG=en"&gt;Azimuth information of the Hi-net borehole sensors&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-09-05：初稿；&lt;/li&gt;
&lt;li&gt;2014-09-09：Hi-net官方确定了第10列的含义；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="仪器响应"></category></entry><entry><title>Hi-net WIN32 格式</title><link href="http://seisman.info/hinet-win32-format.html" rel="alternate"></link><updated>2014-09-04T00:01:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-04:hinet-win32-format.html</id><summary type="html">&lt;p&gt;对于连续波形数据而言，从Hi-net下载的文件为zip压缩文件，其中包含了多个后缀为&lt;tt class="docutils literal"&gt;cnt&lt;/tt&gt;的文件。每个cnt文件中包含了多台站多分量的一分钟的波形数据。&lt;/p&gt;
&lt;p&gt;这些cnt文件即为WIN32格式。WIN32格式是在WIN格式上修改得到的，而WIN格式是日本某机构自行设计的一种数据格式，主要用于一套称为”&lt;span class="caps"&gt;WIN&lt;/span&gt;&amp;nbsp;System“的软件中。&lt;/p&gt;
&lt;p&gt;WIN32格式官方文档: &lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/manual/dlDialogue.php?r=win32format&amp;amp;LANG=en"&gt;http://www.hinet.bosai.go.jp/&lt;span class="caps"&gt;REGS&lt;/span&gt;/manual/dlDialogue.php?r=win32format&amp;amp;&lt;span class="caps"&gt;LANG&lt;/span&gt;=en&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;WIN32格式是很线性的，如果需要的话很容易自己写程序实现win32格式数据的合并、转换的。Hi-net提供了win32tools，可以实现一些基本的功能。&lt;/p&gt;
</summary><category term="Hinet"></category><category term="格式"></category><category term="数据"></category></entry><entry><title>Hi-net事件波形数据</title><link href="http://seisman.info/hinet-event-waveform-data.html" rel="alternate"></link><updated>2014-09-03T00:01:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-03:hinet-event-waveform-data.html</id><summary type="html">&lt;p&gt;Hi-net基于JMA Unified Hypocenter&amp;nbsp;Catalog提供的事件信息，提供了事件波形数据。&lt;/p&gt;
&lt;p&gt;事件波形申请地址：&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/download/event/"&gt;http://www.hinet.bosai.go.jp/&lt;span class="caps"&gt;REGS&lt;/span&gt;/download/event/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;事件波形下载地址：&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/download/event/event_status.php"&gt;http://www.hinet.bosai.go.jp/&lt;span class="caps"&gt;REGS&lt;/span&gt;/download/event/event_status.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;查看网页源代码可以发现，申请的实质是调用另一个&lt;tt class="docutils literal"&gt;openRequest&lt;/tt&gt;函数，其中最关键的参数是事件ID，该ID的命名规则尚不清楚，因而想要脚本实现还有些困难。&lt;/p&gt;
&lt;p&gt;本文暂停于此&amp;#8230;&lt;/p&gt;
</summary><category term="Hinet"></category><category term="数据"></category></entry><entry><title>Hi-net走时和震源机制数据</title><link href="http://seisman.info/hinet-arrival-time-and-focal-mechanism-catalog.html" rel="alternate"></link><updated>2014-09-02T02:20:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-02:hinet-arrival-time-and-focal-mechanism-catalog.html</id><summary type="html">&lt;p&gt;Hi-net基于JMA Unified Hypocenter&amp;nbsp;Catalog，提供了到时数据以及震源机制解目录。&lt;/p&gt;
&lt;p&gt;数据下载地址：&lt;a class="reference external" href="https://hinetwww11.bosai.go.jp/auth/JMA/?LANG=en"&gt;https://hinetwww11.bosai.go.jp/auth/&lt;span class="caps"&gt;JMA&lt;/span&gt;/?&lt;span class="caps"&gt;LANG&lt;/span&gt;=en&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;数据格式官方文档：&lt;a class="reference external" href="https://hinetwww11.bosai.go.jp/auth/manual/dlDialogue.php?r=jmaformat&amp;amp;LANG=en"&gt;https://hinetwww11.bosai.go.jp/auth/manual/dlDialogue.php?r=jmaformat&amp;amp;&lt;span class="caps"&gt;LANG&lt;/span&gt;=en&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文不谈数据格式，只讨论数据的下载问题。&lt;/p&gt;
&lt;p&gt;走时和震源机制数据不需要申请可以直接下载。因为省略了申请的步骤，实现下载也更简单一些。&lt;/p&gt;
&lt;div class="section" id="hinetjmadownload"&gt;
&lt;h2&gt;HinetJMADownload&lt;/h2&gt;
&lt;p&gt;数据下载Python脚本位于&lt;a class="reference external" href="https://github.com/seisman/HinetScripts/blob/master/HinetJMADownload.py"&gt;HinetJMADownload.py&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;用法&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
Download arrival time data or focal mechanism catalog from Hi-net.

Usage:
    HinetJMADownload.py (--measure | --mecha) &amp;lt;yyyymmdd&amp;gt; &amp;lt;span&amp;gt; [--os=OS]
    HinetJMADownload.py -h

Options:
    -h --help     Show this help.
    --measure     Request arrival time data.
    --mecha       Request focal mechanism catalog.
    --os=OS       Line break format, choose from DOS or UNIX. [default: DOS]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;示例&lt;/h3&gt;
&lt;p&gt;下载走时数据:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
HinetJMADownload.py --measure 20120101 5
&lt;/pre&gt;
&lt;p&gt;下载震源机制数据:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
HinetJMADownload.py --mecha 20120101 1
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="走时"></category><category term="地震目录"></category><category term="Python"></category></entry><entry><title>JMA统一地震目录</title><link href="http://seisman.info/jma-unified-hypocenter-catalog.html" rel="alternate"></link><updated>2014-09-01T13:10:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-09-01:jma-unified-hypocenter-catalog.html</id><summary type="html">&lt;p&gt;JMA对JMA、&lt;span class="caps"&gt;NIED&lt;/span&gt;、各大学以及机构收集的地震数据进行处理，形成了一个统一的地震目录。该地震目录只是初级的结果，JMA会不定期修改该地震目录。&lt;/p&gt;
&lt;p&gt;该地震目录仅供参考，Hi-net网站中提供的事件波形数据、到时数据以及震源机制数据，均基于此地震目录。但在实际科研中，建议使用JMA提供的最终版地震目录（未找到具体地址&amp;#8230;）。&lt;/p&gt;
&lt;p&gt;该地震目录的输出包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;发震时刻及其误差&lt;/li&gt;
&lt;li&gt;经纬度及其误差&lt;/li&gt;
&lt;li&gt;深度及其误差&lt;/li&gt;
&lt;li&gt;震级&lt;/li&gt;
&lt;li&gt;区域&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;该页面的请求原理与连续波形数据的请求原理类似，本质上就是向某个url添加query&amp;nbsp;string，如下例:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
https://hinetwww11.bosai.go.jp/auth/jmalist.php?LANG=en&amp;amp;list_span=1&amp;amp;list_year=2014&amp;amp;list_month=08&amp;amp;list_day=29
&lt;/pre&gt;
&lt;p&gt;因而该请求可以很容易地用脚本实现。但由于该请求返回的是HMTL，因而还需要对HTML文本进行处理才能提取出地震目录。实现起来不难，但是意义不大。&lt;/p&gt;
</summary><category term="Hinet"></category><category term="地震目录"></category></entry><entry><title>Hinet连续波形数据申请及下载的脚本实现</title><link href="http://seisman.info/hinet-continuous-waveform-data-request-script.html" rel="alternate"></link><updated>2015-01-17T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-08-30:hinet-continuous-waveform-data-request-script.html</id><summary type="html">
&lt;p&gt;前文已经说到，Hi-net连续波形数据申请的本质可以简化为如下几步：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;指定参数，构建query string&lt;/li&gt;
&lt;li&gt;向Hi-net发送数据请求&lt;/li&gt;
&lt;li&gt;等待数据准备&lt;/li&gt;
&lt;li&gt;下载数据&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="section" id="hinetcontrequest-py"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;HinetContRequest.py&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/seisman/HinetScripts/blob/master/HinetContRequest.py"&gt;HinetContRequest.py&lt;/a&gt;是用Python实现的用于申请与下载Hi-net连续波形数据的脚本。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;配置文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;要执行HinetContRequest.py，需要先修改配置文件&lt;a class="reference external" href="https://github.com/seisman/HinetScripts/blob/master/Hinet.cfg"&gt;Hinet.cfg&lt;/a&gt;，其内容如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
[Account]
User = xxxxxx
Password = xxxxxxxx

[Cont]
Net = 0101
MaxSpan = 5

[Tools]
catwin32 = catwin32
&lt;/pre&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;User&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;Password&lt;/tt&gt;为Hi-net网站的用户名和密码；&lt;/li&gt;
&lt;li&gt;由于不同台网的数据不能一起申请，因而需要指定要申请的台网的台网代码；&lt;tt class="docutils literal"&gt;Net&lt;/tt&gt;为默认的台站代码；比如&lt;tt class="docutils literal"&gt;0101&lt;/tt&gt;即代码Hi-net台网；&lt;/li&gt;
&lt;li&gt;Hi-net对于数据申请存在诸多限制，比如若申请Hi-net所有台站的数据，则单次申请的数据最大长度不得超过5分钟；若仅申请50个台站的数据，则单次申请的数据最大长度可以取为60分钟；由于具体的台站数目是保存中Hi-net账户中的，难以获取，只能通过&lt;tt class="docutils literal"&gt;MaxSpan&lt;/tt&gt;人为指定；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;是Hi-net提供的用于合并WIN32数据的工具，这里需要指定该二进制文件的文件名&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;或是其绝对路径&lt;tt class="docutils literal"&gt;/home/seisman/bin/catwin32&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;用法&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
$ python HinetContRequest.py -h
Request continuous waveform data from NIED Hi-net.

Usage:
    HinetContRequest.py &amp;lt;year&amp;gt; &amp;lt;month&amp;gt; &amp;lt;day&amp;gt; &amp;lt;hour&amp;gt; &amp;lt;min&amp;gt; &amp;lt;span&amp;gt; [options]
    HinetContRequest.py -h

Options:
    -h, --help              Show this help.
    -c CODE --code=CODE     Select code for organization and network.
    -d DIR --directory=DIR  Output directory. Default: current directory.
    -o FILE --output=FILE   Output filename.
                            Default: CODE_YYYYMMDDHHMM_SPAN.cnt
    -t FILE --ctable=FILE   Channel table filename. Default: CODE_YYYYMMDD.ch
&lt;/pre&gt;
&lt;p&gt;该脚本的参数及选项比较简单：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;year、month、day、hour、min为要申请的连续波形的起始时间；&lt;/li&gt;
&lt;li&gt;span为要申请的连续波形的持续时间；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-c&lt;/span&gt;&lt;/tt&gt;用于指定台网代码；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-d&lt;/span&gt;&lt;/tt&gt;用于指定输出目录，默认为当前目录；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-o&lt;/span&gt;&lt;/tt&gt;用于指定输出文件名，默认文件名为&lt;tt class="docutils literal"&gt;CODE_YYYYMMDDHHMM_SPAN.cnt&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-t&lt;/span&gt;&lt;/tt&gt;用于指定channel table的文件名，默认文件名为&lt;tt class="docutils literal"&gt;CODE_YYYYMMDD.ch&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;申请流程&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;从配置文件中读取配置信息&lt;/li&gt;
&lt;li&gt;从参数列表中读入要申请的连续波形数据的起始时间和持续时间&lt;/li&gt;
&lt;li&gt;确定要申请的台网代码，并检测该时间段内是否有可用数据&lt;/li&gt;
&lt;li&gt;若要申请的数据持续时间&lt;tt class="docutils literal"&gt;span&lt;/tt&gt;大于&lt;tt class="docutils literal"&gt;MaxSpan&lt;/tt&gt;，则将整个申请分为几次子申请；每次子申请会检测申请状态，待上次子申请完成后再进行下次子申请；&lt;/li&gt;
&lt;li&gt;待所有子申请完成后，并行下载全部数据；&lt;/li&gt;
&lt;li&gt;解压全部ZIP文件，并调用&lt;tt class="docutils literal"&gt;catwin32&lt;/tt&gt;合并所有解压出的cnt文件；&lt;/li&gt;
&lt;li&gt;对cnt和ch文件重命名；&lt;/li&gt;
&lt;li&gt;清理不必要的文件；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;示例&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;最简单的例子:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python HinetContRequest.py 2012 01 01 10 30 20
&lt;/pre&gt;
&lt;p&gt;申请其他台网的数据:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python HinetContRequest.py 2012 01 01 10 30 20 -c 0103
&lt;/pre&gt;
&lt;p&gt;自定义输出信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python HinetContRequest.py 2012 01 01 10 30 20 -d abc -o xxx.cnt -t xxx.ch
&lt;/pre&gt;
&lt;p&gt;建议的用法是:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python HinetContRequest.py 2012 01 01 10 30 20 -d 201201010130
&lt;/pre&gt;
&lt;p&gt;即指定输出目录，输出文件名使用默认设置。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-08-30：初稿；&lt;/li&gt;
&lt;li&gt;2014-09-12：账号及密码位于配置文件中；&lt;/li&gt;
&lt;li&gt;2014-11-04：将数据申请与数据下载合并在一起；&lt;/li&gt;
&lt;li&gt;2014-12-03：由于Hinet网址的更新，原Python脚本失效，现已修正；&lt;/li&gt;
&lt;li&gt;2015-01-17：Hinet网址改动比较大，脚本实现需要更多的技巧，因而把原来的示例脚本删除；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="数据"></category><category term="申请"></category><category term="Python"></category></entry><entry><title>Hi-net连续数据申请的源码分析</title><link href="http://seisman.info/hinet-continuous-waveform-data-source-code.html" rel="alternate"></link><updated>2014-11-03T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-08-29:hinet-continuous-waveform-data-source-code.html</id><summary type="html">
&lt;p&gt;上一篇博文介绍了Hi-net数据申请的流程以及其中的一些限制。从表面上看，数据申请的过程其实就是鼠标点点点。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;为什么要分析网页源码&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;简单的算一笔账，假设有25个地震事件，每个地震事件需要30分钟的连续波形。根据前一篇博文中介绍的第二种方法，需要将30分钟的时间段分为5分钟的6小段，因而总共需要30/5*25=150次申请。&lt;/p&gt;
&lt;p&gt;估算一下每次申请所需要的时间：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;选择机构和台网：对于Hi-net而言，不需要修改，点击=0，耗时=0；&lt;/li&gt;
&lt;li&gt;选择开始时间：“年月日时分”共5个选项，每次申请需要修改1~5个选项，平均一下，姑且认为每次申请需要修改2.5个选项。修改每个选项时需要点击下拉选项，再点击相应的值，因而需要平均点击=5次，耗时约5s以上；若5分钟数据恰好跨越一个小时或一天，则需要更长的时间来思考，以保证申请的正确；&lt;/li&gt;
&lt;li&gt;数据长度：设定为5分钟，点击=0，耗时=0；&lt;/li&gt;
&lt;li&gt;Search：点击=1，至显示结果耗时=1s；&lt;/li&gt;
&lt;li&gt;Package Download：点击一次，耗时为0；&lt;/li&gt;
&lt;li&gt;数据准备：由于数据准备期间无法再次申请，因而用户必须等待，时间约30-60s，假设为30s。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;30s的等待时间很尴尬，这个时间除了背单词外几乎无法有效利用。因而25个地震事件需要不间断地花费两个多小时的时间才能申请完，效率极其低下。&lt;/p&gt;
&lt;p&gt;再说说下载，由于某个未知的原因，似乎同时最多只能下载5个文件。假设以正常网速下载一个文件需要5分钟，则同时下载5个文件，不间断地下载完全部文件需要2个小时以上，而且这个过程中人必须要监视文件是否下载完成，以决定是否下载新文件。&lt;/p&gt;
&lt;p&gt;总之，Hi-net的数据申请和下载流程是非常反人类的。因而希望可以通过分析网页源代码以了解申请流程的细节，以实现用脚本来申请和下载数据。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;源码分析&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;接下来，会按照数据申请的步骤尽量细致地分析每一步所涉及到的网页源码。到最后会发现，前面的很多分析是没有用的，但因为其也是分析的一部分，这里也保留了下来。&lt;/p&gt;
&lt;div class="section" id="select"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;Select&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;机构、台网、开始时间以及数据长度，本质上都是下拉列表，也就是&lt;tt class="docutils literal"&gt;select&lt;/tt&gt;标签。脚本语言中可以很容易选取下拉列表中的某一项。&lt;/p&gt;
&lt;p&gt;开始时间与数据长度这两个下拉列表很简单，不多说。机构和台网下拉列表中涉及到一些额外的细节，如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class="ni"&gt;&amp;amp;#9608;&lt;/span&gt; Organization&lt;span class="nt"&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;td&lt;/span&gt; &lt;span class="na"&gt;colspan=&lt;/span&gt;&lt;span class="s"&gt;"2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;select&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"org"&lt;/span&gt; &lt;span class="na"&gt;onChange=&lt;/span&gt;&lt;span class="s"&gt;"netInit('');volcInit('');changeVolc()"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;option&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;"NIED"&lt;/span&gt; &lt;span class="na"&gt;selected&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;NIED&lt;span class="nt"&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;option&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;"JMA"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;JMA&lt;span class="nt"&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;option&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;"UNIV"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Universities&lt;span class="nt"&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;option&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;"LOCAL"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Local governments&lt;span class="nt"&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;option&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;"JAMSTEC"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;JAMSTEC&lt;span class="nt"&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;option&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;"OTHER"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Other Organizations&lt;span class="nt"&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class="ni"&gt;&amp;amp;#9608;&lt;/span&gt; Network&lt;span class="nt"&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;td&lt;/span&gt; &lt;span class="na"&gt;colspan=&lt;/span&gt;&lt;span class="s"&gt;"2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;select&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"net"&lt;/span&gt; &lt;span class="na"&gt;onChange=&lt;/span&gt;&lt;span class="s"&gt;"volcInit(''); changeVolc()"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;tr&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"volc_hide"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;td&amp;gt;&lt;/span&gt;&lt;span class="ni"&gt;&amp;amp;#9608;&lt;/span&gt; Volcano&lt;span class="nt"&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;td&lt;/span&gt; &lt;span class="na"&gt;colspan=&lt;/span&gt;&lt;span class="s"&gt;"2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;select&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"volc"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;在Organization的select标签的onChange属性中调用了&lt;tt class="docutils literal"&gt;netInit()&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;volcInit&lt;/tt&gt;函数。这两个函数的定义位于&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/download/cont/js/cont.js?140825"&gt;cont.js&lt;/a&gt;中，当选定org之后，该函数会根据org的值对net和volc进行初始化，具体代码不再列出。&lt;/p&gt;
&lt;p&gt;其中涉及到两个数组/词典：networks和volcanos。每一个台网均对应一个唯一的key：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="nx"&gt;networks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'0101'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'NIED:NIED Hi-net'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;networks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'0103'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'NIED:NIED F-net (broadband)'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;networks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'0103A'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'NIED:NIED F-net (strong motion)'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;...&lt;/span&gt;
&lt;span class="nx"&gt;volcanos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'010503'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'0105:Usuzan'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;volcanos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'010505'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'0105:Iwatesan'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;volcanos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'010507'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'0105:Asamayama'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;volcanos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'010509'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'0105:Fujisan'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;比如&lt;tt class="docutils literal"&gt;0101&lt;/tt&gt;对应Hi-net，&lt;tt class="docutils literal"&gt;010503&lt;/tt&gt;对应Usuzan火山台网。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="submit"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;Submit&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在各个下拉列表都选好之后，需要点击“Search”按钮，其源码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;td&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"right"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"hidden"&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"LANG"&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"LANG"&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"en"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"submit"&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"Search"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/td&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;可以看到“Search”按钮，本质上是一个submit的input标签，其将org、net、year、month、day、hour、min、span提交给服务器，服务器在处理后再返回给用户。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="openrequest"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;openRequest&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;点击“Search”之后，页面中会出现一分钟文件的下载链接以及打包下载的链接。一分钟文件的链接代码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"javascript:openRequest('01','01','2014','08','30','00','00','1','18736','en');"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Download&lt;span class="nt"&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;文件打包下载的链接代码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#"&lt;/span&gt; &lt;span class="na"&gt;onClick=&lt;/span&gt;&lt;span class="s"&gt;"javascript:openRequest('01','01','2014','08','30','00','00','5','93680','en');return false;"&lt;/span&gt; &lt;span class="na"&gt;onmouseover=&lt;/span&gt;&lt;span class="s"&gt;"changeImg('1')"&lt;/span&gt; &lt;span class="na"&gt;onmouseout=&lt;/span&gt;&lt;span class="s"&gt;"changeImg('0')"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;"./image/fulldl1_e.png"&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"fulldl"&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"img_border0"&lt;/span&gt; &lt;span class="na"&gt;alt=&lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt; &lt;span class="na"&gt;title=&lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;可以看到，两种下载方式本质上没有区别，都是调用了&lt;tt class="docutils literal"&gt;openRequest&lt;/tt&gt;函数。该函数的定义位于&lt;a class="reference external" href="https://hinetwww11.bosai.go.jp/auth/download/cont/js/cont.js?141201"&gt;js/cont.js?141201&lt;/a&gt;中，如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;openRequest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;org1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;org2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;volc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
   &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;arc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;arc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;checked&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
         &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;arc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;arc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
   &lt;span class="p"&gt;}&lt;/span&gt;

   &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;rand&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;round&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nb"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getTime&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
   &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'./cont_request.php?org1='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;org1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;org2='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;org2&lt;/span&gt;
           &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;year='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;year&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;month='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;month&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;day='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;day&lt;/span&gt;
           &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;hour='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;hour&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;min='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;min&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;span='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;span&lt;/span&gt;
           &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;arc='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;arc&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;size='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;size&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;LANG='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;lang&lt;/span&gt;
           &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;volc='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;volc&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;amp;rn='&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

   &lt;span class="nx"&gt;contDLWin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"contStatus"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
   &lt;span class="nx"&gt;contDLWin&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;focus&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;该函数需要10个参数：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;org1&lt;/tt&gt;为机构代码（NIED取值为01）&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;org2&lt;/tt&gt;为台网代码（Hi-net取值为01）&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;year&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;month&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;day&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;hour&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;min&lt;/tt&gt;为数据开始时间&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;span&lt;/tt&gt;为数据长度（取值为5）&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;size&lt;/tt&gt;为文件大小，单位为KB（Hi-net所有台站5分钟数据的size大概为93680，该值为估计值不那么重要）&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;lang&lt;/tt&gt;为语言（默认取为en）&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;volc&lt;/tt&gt;为火山代码，比如Usuzan火山台网的代码为&lt;tt class="docutils literal"&gt;010503&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;除此之外，函数中还遍历了&lt;tt class="docutils literal"&gt;arc[]&lt;/tt&gt;数组，找到了数据文件的压缩格式arc；根据当前时间生成“随机数”&lt;tt class="docutils literal"&gt;rand&lt;/tt&gt;。最后将这些key/value对构成了&lt;tt class="docutils literal"&gt;cont_request.php&lt;/tt&gt;的query string，然后打开了该url。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;结论&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;源码看到这里，结果就已经很显然了，数据申请的关键是调用&lt;tt class="docutils literal"&gt;openRequest&lt;/tt&gt;函数，而调用&lt;tt class="docutils literal"&gt;openRequest&lt;/tt&gt;函数的本质是向&lt;tt class="docutils literal"&gt;cont_request.php&lt;/tt&gt;添加一系列请求字串（query string）。&lt;/p&gt;
&lt;p&gt;比如，在已登录Hi-net的前提下，将如下url直接复制粘贴到浏览器中，即可完成数据的申请:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
https://hinetwww11.bosai.go.jp/auth/download/cont/cont_request.php?org1=01&amp;amp;org2=01&amp;amp;year=2014&amp;amp;month=06&amp;amp;day=14&amp;amp;hour=00&amp;amp;min=00&amp;amp;span=5&amp;amp;arc=ZIP&amp;amp;size=93680&amp;amp;LANG=en&amp;amp;rn=1402728298194
&lt;/pre&gt;
&lt;p&gt;其中rn以及size的取值没有太多实际意义。&lt;/p&gt;
&lt;p&gt;因而数据的申请，就变成了简单的几步：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;构建如上所示url&lt;/li&gt;
&lt;li&gt;向Hi-net服务器发送请求&lt;/li&gt;
&lt;li&gt;等待数据准备&lt;/li&gt;
&lt;li&gt;进行下一次申请或下载已准备好的数据&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这几步都可以很容易的通过脚本实现，因而用户可以在不点击鼠标、不等待的情况下完成数据的自动申请，大大提高了生产力。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;后记&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;最初接触Hi-net数据的时候，需要下几百个地震事件，每个地震事件数据长度大概在30分钟左右，花了一周的时间，下了不到100个事件，每天重复的点点点以及等等等。&lt;/p&gt;
&lt;p&gt;后来，终于受不了了，单单下数据就得1个月，这得无聊死啊。于是就想着先停下来，好好分析一下整个网页的结构，希望可以通过脚本来实现数据申请。&lt;/p&gt;
&lt;p&gt;那个时候，对web还没有太多的了解，只知道简单的HTML，从图书馆借了HTML、&lt;span class="caps"&gt;CSS&lt;/span&gt;、JavaScript方面的书，一边看书一边折腾。尝试了写JS脚本、写Chrome/Firefox扩展，以及直接在浏览器的控制台中操作。当时，只知道&lt;tt class="docutils literal"&gt;openRequest&lt;/tt&gt;函数，没有进一步去研究函数的具体定义。最后还是实现了在控制台中申请数据以及通过JS脚本申请数据，当然这两者都需要一些人工操作，不够自动化。&lt;/p&gt;
&lt;p&gt;当时只会Perl脚本，因而通过Perl以及Mechanize模块实现了“打开浏览器”、“选择下拉列表”、“点击search”、“点击Package Download”的功能。这个脚本算是相当成功且自动化的，因而剩下的400个地震事件在几天内就申请并下载完毕了。这个Perl脚本完全模拟了人工鼠标点击的操作，在速度上和人工点击差不多，不过明显解放了一个劳动力。脚本的一个缺点在于，Mecahnize模块的依赖太多，且要求Perl版本尽可能新，稍显繁琐。&lt;/p&gt;
&lt;p&gt;在写完Perl脚本的一年间，因为写博客的缘故，对于网页以及脚本都有了更多的了解。一次偶然的机会，再次看了Hi-net源代码，找到了&lt;tt class="docutils literal"&gt;openRequest&lt;/tt&gt;的定义，了解了数据申请的本质，也就是这篇博文的全部。&lt;/p&gt;
&lt;p&gt;根据本文的分析结果，用Python重新实现了新的数据申请方法，更加简单、聪明、快速。Python脚本留在下文再说。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-08-29：初稿；&lt;/li&gt;
&lt;li&gt;2014-11-03：更新了火山台网；&lt;/li&gt;
&lt;li&gt;2014-12-03：更新了连续数据申请链接；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="数据"></category><category term="申请"></category></entry><entry><title>Hi-net连续波形数据</title><link href="http://seisman.info/hinet-continuous-waveform-data.html" rel="alternate"></link><updated>2014-12-03T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-08-27:hinet-continuous-waveform-data.html</id><summary type="html">
&lt;p&gt;本文将介绍如何从Hi-net申请并下载连续波形数据，并介绍Hi-net数据的一些细节。&lt;/p&gt;
&lt;p&gt;连续波形数据申请地址：&lt;a class="reference external" href="https://hinetwww11.bosai.go.jp/auth/download/cont/?LANG=en"&gt;https://hinetwww11.bosai.go.jp/auth/download/cont/?&lt;span class="caps"&gt;LANG&lt;/span&gt;=en&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;第一印象&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下图是数据申请页面的具体样子，看上去还是相当直观的。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="download-continous-waveform-data" src="/images/2014082701.jpg" style="width: 800px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;申请流程&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;选择机构和台网&lt;/p&gt;
&lt;p&gt;Hi-net网站提供了多个机构和台网的波形数据的下载，可选的机构名和台网名可以在相应的下拉列表中看到。对于Hi-net数据而言，Organization处选择NIED，Network处选择NIED Hi-net。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;台站选择&lt;/p&gt;
&lt;p&gt;目前仅支持对Hi-net和F-net这两个台网进行台站筛选。其他台网，必须下载全部台站的数据才能筛选。&lt;/p&gt;
&lt;p&gt;点击“Hi-net/F-net Station selection is here”会打开台站选择页面，可以通过“点击”或“拖曳”的方式选取台站。该页面的台站选择功能使用起来不太方便，一般情况下，选择全部台站，将所有数据下载下来再写脚本对台站进行筛选。&lt;/p&gt;
&lt;p&gt;点击“Check the current configure for user”可以看到用户的台站选择情况，默认情况下选择的台站数为0，即下载全部台站的波形数据。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;连续波形数据的时间范围&lt;/p&gt;
&lt;p&gt;确定要申请的波形数据的起始时刻（精确到分）以及数据长度（1-60分钟），然后点击“Search”。比如选择开始时间为“Year:2014”、“Month:08”、“Day:29”、“00:”、“00”，数据长度为“5min”。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;一大堆说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;点击“Search”之后显示如下，可以看到，连续波形数据被分割成一分钟的小段，每段数据都有一个“Download”链接，所有数据还有一个“Package Download”链接：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="hinet-search-result" src="/images/2014082702.png" style="width: 800px;"/&gt;
&lt;/div&gt;
&lt;p&gt;之所有要介绍Hi-net数据申请流程，就是因为这其中涉及到太多规则和例外，下面一一说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;连续波形数据范围：&lt;/p&gt;
&lt;p&gt;不同台网提供的波形数据的起始日期不同，具体如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;NIED&lt;/span&gt; Hi-net : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;NIED&lt;/span&gt; F-net : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;NIED&lt;/span&gt; V-net : 2010/04/01 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;JMA&lt;/span&gt; Seismometer Network : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;JMA&lt;/span&gt; Volcanic Seismometer Network : 2010/12/01 00:00&lt;/li&gt;
&lt;li&gt;Universities : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;Tokyo Metropolitan Government : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;Hot Spring Research Institute of Kanagawa Prefecture : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;Aomori Prefectural Government : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;Shizuoka Prefectural Government : 2004/06/15 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;JAMSTEC&lt;/span&gt; Realtime Data from the Deep Sea Floor Observatory : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;JAMSTEC&lt;/span&gt; &lt;span class="caps"&gt;DONET1&lt;/span&gt; : 2014/10/01 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;AIST&lt;/span&gt; : 2004/04/01 00:00&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GSI&lt;/span&gt; : 2004/04/01 00:00&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所有台网的波形数据的结束时间均相同，即&lt;strong&gt;此刻前两小时&lt;/strong&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;该网站中的所有时间均为&lt;strong&gt;&lt;span class="caps"&gt;JST&lt;/span&gt;&lt;/strong&gt;时间，即东九区时间。比如，假设中国现在是22点，则GMT时间为22-8=14点，而日本时间为14+9=23点。在数据申请以及数据处理时都必须将这点考虑进去。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Hi-net将连续波形数据切割成一分钟长度的数据段，即&lt;strong&gt;每个文件仅包含一分钟的波形数据&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由于Hi-net将连续波形数据切割成一分钟长度的数据段，因而：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;若申请时数据长度为30分钟，则会生成30段数据，每段数据提供一个“Download”链接，30段数据意味着需要点击30次链接，需要下载30个文件；&lt;/li&gt;
&lt;li&gt;Hi-net提供了打包下载的功能，但对数据量有所限制。若Number of Channels * Record Length (min) &amp;lt;= 12000 min，且Record Length &amp;lt; 60min，则可以将多段数据打包下载，即“Package Download”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以Hi-net为例，Hi-net共计约800个台站（经统计为785个），每个台站三个channel（个别台站有两个或四个），即约800*3=2400个channel。因而在选择全部Hi-net台站的前提下，若想要使用打包下载功能，则数据的Record Length不得超过12000/2400=5 min。若只选择了其中50个台站，则12000/150=80 min&amp;gt;60 min，则Record length最大可以取为60 min。&lt;/p&gt;
&lt;p&gt;下面简单算个账，对于一个地震事件，假设需要申请Hi-net所有台站30分钟的连续波形数据，有两种做法：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;数据长度设置为30min，会生成30段数据，然后点击30次“Download”链接，并下载30个文件；&lt;/li&gt;
&lt;li&gt;数据长度设置成5min，将30分钟连续波形分为6次申请，每次均可使用打包下载“Package Download”，点击6次链接，并下载6个文件；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;无论是点击“Download”还是“Package Download”，每次点击均称为一次“申请”。每次申请过程的耗时大概如下：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;发送申请：主要由当前网络状况以及Hi-net服务器繁忙程度决定，根据经验需要3-5s；&lt;/li&gt;
&lt;li&gt;数据准备：由Hi-net服务器的繁忙程度、处理速度以及该次申请的数据大小决定。若申请所有台站一分钟的连续波形，约需要10s；若申请所有台站5分钟的连续波形，约需要20-40s；&lt;/li&gt;
&lt;li&gt;获取数据状态：在Hi-net服务器准备数据时，是不能再次申请新数据的，否则会出现错误。因而必须等待Hi-net网站更新数据申请的状态，待确认无误之后方可再次申请。因而获取数据状态大概需要3-10s。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在确认单次申请的数据准备完成后，即可下载此次申请的数据或继续下一次申请。需要注意，&lt;strong&gt;Hi-net只保留最近150次申请的数据&lt;/strong&gt;，并且会在数据申请之后一段时间（可能是几天）&lt;strong&gt;删除数据&lt;/strong&gt;，因而应及时下载。&lt;/p&gt;
&lt;p&gt;了解了Hi-net的游戏规则之后，可知，第二种申请方法要更实用一些，申请的次数更少，耗时更短，下载的文件也更少。唯一的不方便是需要将数据手动分成几次申请，但很容易用脚本实现。后面将只使用第二种方法申请数据。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;数据下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在申请数据之后，会自动打开”Status/Download“页面。如下图所示：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="status and donwload page" src="/images/2014082703.png" style="width: 800px;"/&gt;
&lt;/div&gt;
&lt;p&gt;图中的每行代表一次申请，具有唯一的ID。黄色背景的行表示该数据尚未被下载过，白色背景的行表示该数据已经下载过，还可以再次下载（数据超过一定天数后会无法下载），申请时若出现错误会显示为灰色行。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：下载数据时似乎同时只能下载5个数据，再点击其他数据的下载链接没有反应。目前不确定是浏览器的限制、带宽的限制还是Hi-net服务器的限制。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;对数据的说明&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;下载得到的为压缩文件，默认压缩格式为ZIP格式（推荐使用ZIP格式）。文件名格式为：&lt;ul&gt;
&lt;li&gt;一般台网： &lt;tt class="docutils literal"&gt;[OrgID]_[NetID]_[Start time yyyymmddHHMM (in &lt;span class="pre"&gt;&lt;span class="caps"&gt;JST&lt;/span&gt;)]_[Record&lt;/span&gt; length &lt;span class="pre"&gt;(min)].zip&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;火山台网： &lt;tt class="docutils literal"&gt;[OrgID]_[NetID]_[VolcID]_[Start time yyyymmddHHMM (in &lt;span class="pre"&gt;&lt;span class="caps"&gt;JST&lt;/span&gt;)]_[Record&lt;/span&gt; length &lt;span class="pre"&gt;(min)].zip&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;每个ZIP文件中包含了若干个cnt文件、两个ch文件以及一个readme文件；&lt;/li&gt;
&lt;li&gt;cnt文件中包含了一分钟的地震波形数据，为win32格式。win32格式是日本某机构自定义的一种地震数据格式，可以通过Hi-net提供的win32tools转换成SAC格式；&lt;/li&gt;
&lt;li&gt;cnt文件的文件名中包含了波形的时间信息以及台网信息，但对于一般台网和火山台网，文件名的长度是不同的；&lt;/li&gt;
&lt;li&gt;ch文件即channels table，其包含了每个台站的经纬度以及每个channel的仪器响应信息，两个channel table文件内容相同，只是一个使用euc编码，一个使用sjis编码；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;关于数据格式、数据转换以及channel table文件的具体使用，放在后面的篇章再细说。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-08-27：初稿；&lt;/li&gt;
&lt;li&gt;2014-11-02：修订了部分内容，并加入了对火山台网的说明；&lt;/li&gt;
&lt;li&gt;2014-12-03：连续波形的申请网址发生变化；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="数据"></category><category term="申请"></category><category term="下载"></category></entry><entry><title>Hi-net简介</title><link href="http://seisman.info/introduction-to-hinet.html" rel="alternate"></link><updated>2014-08-26T17:20:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-08-26:introduction-to-hinet.html</id><summary type="html">&lt;p&gt;Hi-net，全称为High Sensitivity Seismograph&amp;nbsp;Network，是NIED下的一个覆盖日本全境的高密度地震台网。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;网址&lt;/h2&gt;
&lt;p&gt;以前的网站只有日文版，从2012年左右建立了英文版网站，目前英文版网站尚为beta版。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;官网网址：&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/"&gt;http://www.hinet.bosai.go.jp/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;台站分布图下载：&lt;a class="reference external" href="http://www.hinet.bosai.go.jp/st_info/detail/dataset.php?LANG=en"&gt;http://www.hinet.bosai.go.jp/st_info/detail/dataset.php?&lt;span class="caps"&gt;LANG&lt;/span&gt;=en&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;用户注册：&lt;a class="reference external" href="https://hinetwww11.bosai.go.jp/nied/registration/?LANG=en"&gt;https://hinetwww11.bosai.go.jp/nied/registration/?&lt;span class="caps"&gt;LANG&lt;/span&gt;=en&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;基本情况&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2000年10月开始部署Hi-net台网；&lt;/li&gt;
&lt;li&gt;Hi-net台站均匀分布于整个日本境内，台站间距约为20km，预计约1000个台站（目前共计近800个台站）；&lt;/li&gt;
&lt;li&gt;每个Hi-net台站都包含了一个用于安装地震仪的钻孔（borehole）以及一个用于放置数据记录器和其他数据传输设备的观测小屋；&lt;/li&gt;
&lt;li&gt;在每个钻孔的底部（深度大于100m），安装了短周期三分量速度地震仪、三分量强震加速度仪。同时在每个台站的地表也安装了三分量强震加速度仪；其中Hi-net只收集短周期三分量速度地震仪的数据，两对强震加速度仪的数据则由KiK-net收集；&lt;/li&gt;
&lt;li&gt;位于钻孔底部的传感器没有用水泥覆盖，因而当传感器出现问题时很容易将传感器取出，进行维修或更换；&lt;/li&gt;
&lt;li&gt;钻孔的深度不一，最浅的位于地表，最深的深度超过3.5km，大多数钻孔的深度在100-300m之间；&lt;/li&gt;
&lt;li&gt;地震仪的运动首先被转化成弱电信号，经过模数转换器转换成每秒1000个采样点的数字信号，经过减采样后，得到采样率为100Hz、27位精度的数字信号，再将数据以一秒为最小单位打包传送给数据中心；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;数据&lt;/h2&gt;
&lt;p&gt;数据使用的注意事项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;在文章、会议摘要中使用了NIED的数据，应将数据使用情况报告给NIED；&lt;/li&gt;
&lt;li&gt;NIED拥有数据的版权，严禁用户自行分发数据；&lt;/li&gt;
&lt;li&gt;发表文章时要致谢数据来源；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;数据种类：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;JMA&lt;/span&gt; Unified earthquake&amp;nbsp;catalog（日本境内及附近区域的地震目录）&lt;/li&gt;
&lt;li&gt;Arrival-time data（基于JMA unified&amp;nbsp;catalog）&lt;/li&gt;
&lt;li&gt;Focal mechanism catalog（基于JMA unified&amp;nbsp;catalog）&lt;/li&gt;
&lt;li&gt;Event waveform data（仅JMA unified&amp;nbsp;catalog中的事件）&lt;/li&gt;
&lt;li&gt;Continuous waveform&amp;nbsp;data（2004年4月1日至今的连续波形数据）&lt;/li&gt;
&lt;li&gt;Old waveform&amp;nbsp;data（2004年4月之前的数据）&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Hinet"></category><category term="数据"></category><category term="台网"></category></entry><entry><title>Hi-net系列博文合集</title><link href="http://seisman.info/hinet-things.html" rel="alternate"></link><updated>2014-11-03T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-08-25:hinet-things.html</id><summary type="html">&lt;p&gt;Hi-net是日本境内的一个高质量、高密度的短周期地震台网，接下来的几篇博文将介绍Hi-net相关的一些点。&lt;/p&gt;
&lt;p&gt;本文是系列博文的目录页。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/introduction-to-hinet.html"&gt;Hi-net简介&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-continuous-waveform-data.html"&gt;Hi-net连续波形数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-continuous-waveform-data-source-code.html"&gt;Hi-net连续波形数据申请的源码分析&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-continuous-waveform-data-request-script.html"&gt;Hi-net连续波形数据申请脚本&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/jma-unified-hypocenter-catalog.html"&gt;JMA统一地震目录&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-arrival-time-and-focal-mechanism-catalog.html"&gt;Hi-net走时与震源机制数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-event-waveform-data.html"&gt;Hi-net事件波形数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-win32-format.html"&gt;win32格式&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-channel-table.html"&gt;Hi-net的channel&amp;nbsp;table文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-instrumental-response.html"&gt;Hi-net的仪器响应&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-win32tools.html"&gt;Hi-net&amp;nbsp;win32tools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-convert-win32-files-to-sac.html"&gt;Hi-net&amp;nbsp;WIN32转SAC脚本&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/hinet-convert-channel-table-to-sac-pz-file.html"&gt;Hi-net 生成仪器响应SAC&amp;nbsp;PZ文件&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="Hinet"></category></entry><entry><title>Python发送邮件到BREA_FAST</title><link href="http://seisman.info/send-email-in-python.html" rel="alternate"></link><updated>2014-08-23T16:51:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-08-23:send-email-in-python.html</id><summary type="html">
&lt;p&gt;前面的一篇博文&lt;a class="reference external" href="http://seisman.info/send-email-in-perl.html"&gt;《Perl发送邮件》&lt;/a&gt;中用Perl实现了向BREQ_FAST发送邮件申请数据的功能。&lt;/p&gt;
&lt;p&gt;这篇博文用Python重新实现了这一功能，相比于Perl脚本而言，Python的面向对象特性使得脚本更简单、简短。&lt;/p&gt;
&lt;div class="section" id="python"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Python脚本&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该脚本使用了Python标准库smtplib实现邮件的发送，在Python 2.7及3.4下测试通过。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;#  Send multiple emails to BREQ_FAST for waveform datas&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;#  Author:  Dongdong Tian @ USTC&lt;/span&gt;
&lt;span class="c"&gt;#  Date:    2014-08-23&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SMTP&lt;/span&gt;

&lt;span class="n"&gt;sender&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"xxxxxxx@163.com"&lt;/span&gt;
&lt;span class="n"&gt;passwd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"xxxxxxx"&lt;/span&gt;
&lt;span class="c"&gt;# host and port for 163 mail&lt;/span&gt;
&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"smtp.163.com"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;
&lt;span class="c"&gt;# BREQ_FAST mail address&lt;/span&gt;
&lt;span class="n"&gt;recipient&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'breq_fast@iris.washington.edu'&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Usage:"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"  python &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt; mailfile ..."&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;head&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"From: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;To: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\r\n\r\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sender&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;recipient&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Total &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s"&gt; mails to send!"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:])))&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;mail&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Sending &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt; ..."&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;head&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;smtp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;smtp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_debuglevel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;smtp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sender&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;smtp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sender&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;recipient&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;smtp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;其中&lt;tt class="docutils literal"&gt;host&lt;/tt&gt;为邮件服务器的ip或域名， &lt;tt class="docutils literal"&gt;sender&lt;/tt&gt;为用户邮箱名， &lt;tt class="docutils literal"&gt;passwd&lt;/tt&gt;为明文密码。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="host"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Host列表&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;163和USTC mail测试通过，Gmail测试失败。&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="20%"&gt;&lt;/col&gt;
&lt;col width="60%"&gt;&lt;/col&gt;
&lt;col width="20%"&gt;&lt;/col&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head"&gt;服务商&lt;/th&gt;
&lt;th class="head"&gt;Host&lt;/th&gt;
&lt;th class="head"&gt;Port&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;163&lt;/td&gt;
&lt;td&gt;smtp.163.com&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;span class="caps"&gt;USTC&lt;/span&gt; mail&lt;/td&gt;
&lt;td&gt;mail.ustc.edu.cn&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;功能及限制&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;支持一次性发送多封邮件。（单次登录可发送的邮件数是有限制的，因而采取多次登录的方式；频繁发送邮件可能会导致ip被封，因而每封邮件之间等待5s）；&lt;/li&gt;
&lt;li&gt;密码明文存储，不太安全；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="breq_fast"></category><category term="邮件"></category><category term="Python"></category></entry><entry><title>个人偏好列表</title><link href="http://seisman.info/personal-preferences.html" rel="alternate"></link><updated>2014-08-05T20:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-08-05:personal-preferences.html</id><summary type="html">&lt;p&gt;本文记录我个人目前在使用的一些软件、工具、App，以及一些偏好。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;操作系统：Linux &amp;gt; iOS &amp;gt; Android &amp;gt;&amp;nbsp;Windows&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Linux发行版：CentOS&amp;nbsp;7.0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;浏览器： Google&amp;nbsp;Chrome&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;科学上网： &lt;a class="reference external" href="https://hosts.huhamhire.com"&gt;huhamhire-hosts&lt;/a&gt; &amp;gt; &lt;a class="reference external" href="https://vpn.lug.ustc.edu.cn/"&gt;&lt;span class="caps"&gt;USTC&lt;/span&gt; &lt;span class="caps"&gt;LUG&lt;/span&gt;&amp;nbsp;OpenVPN&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;输入法：&amp;nbsp;搜狗（Linux）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;密码管理：LastPass（Linux版+Chrome插件+iOS客户端）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;文件/目录比较工具： &lt;a class="reference external" href="http://meldmerge.org/"&gt;meld&lt;/a&gt; &amp;gt; &lt;a class="reference external" href="http://www.syntevo.com/smartsynchronize"&gt;smartsynchronize&lt;/a&gt; &amp;gt; vimdiff &amp;gt;&amp;nbsp;diff&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;文献管理： &lt;a class="reference external" href="http://www.mendeley.com/"&gt;Mendeley&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;配色方案： &lt;a class="reference external" href="http://ethanschoonover.com/solarized"&gt;Solarized&lt;/a&gt; （vim, terminal, PyCharm,&amp;nbsp;Gedit）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;音乐：&amp;nbsp;网易云音乐&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;SSH客户端: &lt;a class="reference external" href="http://www.netsarang.com/products/xsh_overview.html"&gt;Xshell&amp;nbsp;Home/School&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;span class="caps"&gt;IDE&lt;/span&gt;： &lt;a class="reference external" href="http://www.visualstudio.com/downloads/download-visual-studio-vs"&gt;Visual Studio Community 2013 with update&amp;nbsp;4&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;RSS阅读器： &lt;a class="reference external" href="http://feedly.com/"&gt;feedly&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;稍后阅读： &lt;a class="reference external" href="http://getpocket.com/"&gt;Pocket&lt;/a&gt; +&amp;nbsp;Chrome书签&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;笔记类工具：&amp;nbsp;OneNote&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;清单管理： &lt;a class="reference external" href="https://www.wunderlist.com/zh/"&gt;Wunderlist&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;高级编程语言： C &amp;gt;&amp;nbsp;Fortran&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;脚本语言： Python3 &amp;gt; Perl &amp;gt;&amp;nbsp;Bash&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;其他语言：LaTeX, reStructureText,&amp;nbsp;Markdown&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Shell：zsh &amp;gt;&amp;nbsp;bash&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;PDF阅读器： evince &amp;gt; &lt;a class="reference external" href="http://pwmt.org/projects/zathura"&gt;zathura&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;PS阅读器： &lt;a class="reference external" href="http://pwmt.org/projects/zathura"&gt;zathura&lt;/a&gt; &amp;gt; gs &amp;gt; gv &amp;gt;&amp;nbsp;evince&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;同步网盘： &lt;a class="reference external" href="https://jianguoyun.com"&gt;坚果云&lt;/a&gt;和&lt;cite&gt;Dropbox&lt;/cite&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;资源类网盘：&amp;nbsp;百度云、360云盘和115网盘。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;文本编辑器：Vim &amp;gt; Gedit &amp;gt; Sublime Text&amp;nbsp;3&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Python &lt;span class="caps"&gt;IDE&lt;/span&gt;： &lt;a class="reference external" href="http://www.jetbrains.com/pycharm/"&gt;PyCharm Communitu&amp;nbsp;Edition&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Git服务：使用Git作为版本控制工具，svn之类的未接触过，也不打算接触。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/"&gt;GitHub&lt;/a&gt;&amp;nbsp;：博客源码以及可公开的代码&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://gitlab.lug.ustc.edu.cn/"&gt;&lt;span class="caps"&gt;USTC&lt;/span&gt; GitLab&lt;/a&gt;&amp;nbsp;：托管私有项目&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://gitcafe.com"&gt;GitCafe&lt;/a&gt;&amp;nbsp;：仅用于托管博客，用于国内用户的访问&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;编程字体&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="https://github.com/adobe-fonts/source-code-pro"&gt;Source Code Pro&lt;/a&gt;：试用中。各字符之间很容易区分，字体稍扁，正在适应中。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="https://www.google.com/fonts/specimen/Droid+Sans+Mono"&gt;Droid Sans Mono&lt;/a&gt;：Droid Sans&amp;nbsp;Mono是很好看的等宽字体，用了很长一段时间后发现了几个比较严重的问题。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;难以数字0（zero）和大写字母O（oh）&lt;/li&gt;
&lt;li&gt;中文的左引号（“）和右引号（”）无法区分&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;虽然有修改版，将零修改为dotted版和dashed版，但使用过程中明显看到数字0的尺寸与其他数字尺寸有差，影响美观，故放弃该字体。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;未分类&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;astyle&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="Linux"></category><category term="Perl"></category><category term="Python"></category></entry><entry><title>Python相关资源</title><link href="http://seisman.info/learning-python.html" rel="alternate"></link><updated>2014-11-18T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-30:learning-python.html</id><summary type="html">
&lt;p&gt;本文主要收集Python的学习资源，以Python3为主。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;Python入门教程&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Learn Python The Hard Way, 3rd Edition （基于Python 2）&lt;ul&gt;
&lt;li&gt;&lt;a class="reference external" href="http://learnpythonthehardway.org/book/"&gt;官方英文在线版&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://liam0205.me/attachment/Python/PyHardWay/Learn_Python_The_Hard_Way_zh-cn.pdf"&gt;中文PDF版&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://sebug.net/paper/books/LearnPythonTheHardWay/index.html"&gt;中文在线版&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The Python Tutorial （Python 3官方教程）&lt;ul&gt;
&lt;li&gt;&lt;a class="reference external" href="https://docs.python.org/3/tutorial/index.html"&gt;官方英文版&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://docspy3zh.readthedocs.org/en/latest/tutorial/index.html"&gt;docspy3zh中文译本&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.pythondoc.com/pythontutorial3/index.html"&gt;pythondoc中文译本&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000"&gt;廖雪峰的Python教程&lt;/a&gt; （Python2）&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/qyuhen/book"&gt;Python学习笔记第二版&lt;/a&gt; ：作者qyuhen@GitHub （本书基于Python2）&lt;/li&gt;
&lt;li&gt;Think Python&lt;ul&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.greenteapress.com/thinkpython/thinkpython.html"&gt;官方网站&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.greenteapress.com/thinkpython/thinkpython.pdf"&gt;&lt;span class="caps"&gt;PDF&lt;/span&gt; for Python2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://faculty.stedwards.edu/mikek/python/thinkpython.pdf"&gt;&lt;span class="caps"&gt;PDF&lt;/span&gt; for Python3&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;Python模块教程&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="scipy-numpy-matplotlib"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;SciPy, Numpy &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Matplotlib&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://scipy-lectures.github.io/"&gt;Python Scientific Lecture Notes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://hyry.dip.jp/tech/book/page/scipy/index.html"&gt;用Python做科学计算-基础篇&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://hyry.dip.jp/tech/book/page/scipynew/index.html"&gt;Python科学计算 第二版&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="matplotlib"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;Matplotlib&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.loria.fr/~rougier/teaching/matplotlib/"&gt;Matplotlib tutorial&lt;/a&gt; ：Matplotlib入门教程&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://liam0205.me/2014/09/11/matplotlib-tutorial-zh-cn/"&gt;Matplotlib 教程&lt;/a&gt; : Matplotlib tutorial中文翻译&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="regular-expression"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id22"&gt;Regular Expression&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://docs.python.org/3.4/howto/regex.html"&gt;Regular Expression &lt;span class="caps"&gt;HOWTO&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;Python模块&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id13"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id24"&gt;标准库&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://docs.python.org/3.4/library/ftplib.html"&gt;ftplib&lt;/a&gt; ：Python内置FTP模块&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id14"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id25"&gt;第三方模块&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/kennethreitz/requests"&gt;requests&lt;/a&gt; ：非常好用的网页请求模块&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://docopt.org/"&gt;docopt&lt;/a&gt; ：利用docstring生成命令行接口&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://openopt.org/"&gt;OpenOpt&lt;/a&gt; ：数值优化方法&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://matplotlib.org/"&gt;matplotlib&lt;/a&gt; ：二维绘图库&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/python-excel/xlrd"&gt;python-xlrd&lt;/a&gt; ：读取Excel文档&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id16"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id26"&gt;工具类&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;用Python写的包，但是主要目的不是为了用户调用，而是直接提供了用户界面或可执行文件。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://hosts.huhamhire.com/"&gt;huhamhire-hosts&lt;/a&gt; ：Host更新与发布&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://sourceforge.net/p/retext/home/ReText/"&gt;ReText&lt;/a&gt; : Markdown和reStructuredText文本编辑器&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/soimort/you-get"&gt;you-get&lt;/a&gt; ：国内外视频网站下载工具&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="pep"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id27"&gt;&lt;span class="caps"&gt;PEP&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://legacy.python.org/dev/peps/pep-0008/"&gt;&lt;span class="caps"&gt;PEP&lt;/span&gt; 8&lt;/a&gt; : Style Guide for Python Code&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="ide"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id28"&gt;&lt;span class="caps"&gt;IDE&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://www.jetbrains.com/pycharm/"&gt;PyCharm&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id17"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id29"&gt;列表&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://pyzh.readthedocs.org/en/latest/"&gt;Pyzh&lt;/a&gt; :&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://pymotw.com/2/"&gt;Python 2 Module of the Week&lt;/a&gt; : 每周介绍一个模块&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://pymotw.com/3/index.html"&gt;Python 3 Module of the Week&lt;/a&gt; : 每周介绍一个模块&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://docs.python-guide.org/en/latest/"&gt;The Hitchhiker’s Guide to Python!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/vinta/awesome-python"&gt;Awesome Python&lt;/a&gt; ：Python优秀模块列表&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="Python"></category><category term="书籍"></category><category term="模块"></category></entry><entry><title>地球科学百科全书</title><link href="http://seisman.info/encyclopedia-of-earth-sciences.html" rel="alternate"></link><updated>2014-07-20T17:25:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-20:encyclopedia-of-earth-sciences.html</id><summary type="html">&lt;p&gt;地球科学百科全书是Springer的一个系列，目前为止已经出版了31卷，具体书籍列表参见该&lt;a class="reference external" href="http://link.springer.com/search?facet-series=%225898%22&amp;amp;facet-content-type=%22Book%22"&gt;网页&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;下面列出感兴趣的一些：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://link.springer.com/referencework/10.1007/978-0-387-36699-9"&gt;Encyclopedia of Remote&amp;nbsp;Sensing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://link.springer.com/referencework/10.1007/978-1-4020-4399-4"&gt;Encyclopedia of Natural&amp;nbsp;Hazards&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://link.springer.com/referencework/10.1007/978-90-481-8702-7"&gt;Encyclopedia of Solid Earth&amp;nbsp;Geophysics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://link.springer.com/referencework/10.1007/1-4020-4496-8"&gt;Encyclopedia of&amp;nbsp;Geochemistry&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;若购买了Springer的数据库则可下载全书。&lt;/p&gt;
</summary><category term="书籍"></category></entry><entry><title>固体地球物理百科全书</title><link href="http://seisman.info/encyclopedia-of-solid-earth-geophysics.html" rel="alternate"></link><updated>2014-07-20T17:10:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-20:encyclopedia-of-solid-earth-geophysics.html</id><summary type="html">&lt;p&gt;Encyclopedia of Solid Earth&amp;nbsp;Geophysics，即固体地球物理百科全书。&lt;/p&gt;
&lt;p&gt;这本书应该算是一本参考书，介绍了与固体地球物理相关的概念。既然是百科全书，其中的东西应该算是相当权威的，适合在需要的时候查找。&lt;/p&gt;
&lt;p&gt;下载地址： &lt;a class="reference external" href="http://pan.baidu.com/s/1pJAw3m7"&gt;http://pan.baidu.com/s/1pJAw3m7&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其中FrontMatter中包含了全书的目录，BackMatter为作者和名词索引。所有词条按照首字母排序没，分别位于A-Z的PDF中。由于书的内容过多，将PDF合并起来导致单个文件太大，且不易于查找，故而没有合并。&lt;/p&gt;
&lt;p&gt;官方链接：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.springer.com/earth+sciences+and+geography/geophysics/book/978-90-481-8701-0"&gt;http://www.springer.com/earth+sciences+and+geography/geophysics/book/978-90-481-8701-0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://link.springer.com/referencework/10.1007/978-90-481-8702-7"&gt;http://link.springer.com/referencework/10.1007/978-90-481-8702-7&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="书籍"></category></entry><entry><title>震相命名规则及标准震相列表</title><link href="http://seisman.info/iaspei-standard-phase-list.html" rel="alternate"></link><updated>2014-07-20T14:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-20:iaspei-standard-phase-list.html</id><summary type="html">&lt;p&gt;地震学里经常接触震相，比如P、pP、PcP、PKiKP、SKS等等。&lt;/p&gt;
&lt;p&gt;震相的命名是一个相对复杂的问题，需要定义一系列的规则，使得从震相名即可确定波的传播路径。&lt;/p&gt;
&lt;p&gt;本文暂时不打算介绍震相的命名规则，仅给出相关文章，其中已经说的很清楚。&lt;/p&gt;
&lt;p&gt;Storchak et al.(2003)：&lt;a class="reference external" href="ftp://isc-mirror.iris.washington.edu/pub/docs/srl_sspl.pdf"&gt;PDF下载&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;网页版：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;英文版：&lt;a class="reference external" href="http://www.isc.ac.uk/standards/phases/"&gt;http://www.isc.ac.uk/standards/phases/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;中文版：&lt;a class="reference external" href="http://www.csndmc.ac.cn/newweb/doc/IASPEI_phase.htm"&gt;http://www.csndmc.ac.cn/newweb/doc/IASPEI_phase.htm&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;推荐顺序为：PDF版本&amp;gt;英文网页版&amp;gt;中文网页版。&lt;/p&gt;
</summary><category term="震相"></category></entry><entry><title>博客托管的一些调整</title><link href="http://seisman.info/blog-hosts.html" rel="alternate"></link><updated>2014-07-17T10:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-17:blog-hosts.html</id><summary type="html">&lt;p&gt;博客托管一直是一个比较头疼的问题。作为一个中文博客，访问者必然主要来自于国内，也有少量访问者来自于美国、加拿大等国家的中国人。如果将博客托管在国内主机，可以保证国内大部分人的访问速度，但是托管在国内服务器上的网站必须进行备案，想想就觉得很麻烦；如果将博客托管在国外主机，则大部分国内读者访问网站的速度会很慢，甚至可能由于墙的问题而完全无法访问。&lt;/p&gt;
&lt;p&gt;刚使用静态博客的时候，一直将博客托管在国外的GitHub上，我自己测试的ping值大概是300ms左右，相对来说还是有些慢的。后来发现了GitCafe，其可以用于免费托管博客，且主机位于国内所以国内读者访问速度很快，最重要的一点是虽然其主机在国内但却不要求进行备案。（一直无法理解这一点，但是现在的情况的确是这样，不知道能用多久。）将博客托管在GitCafe后，我测试的ping值大概是20ms，速度的增长还是很明显的。也遇到个别国内的读者说不能正常访问，这个我就没办法了。&lt;/p&gt;
&lt;p&gt;今天，对博客的托管进行了一些改进，同时将博客的静态HTML文件托管在GitHub和GitCafe上，国内读者访问时使用GitCafe，国外读者访问时使用GitHub，这样一来国内和国外的大部分读者都可以有比较好的访问速度了。&lt;/p&gt;
&lt;p&gt;目前博客的一些细节记录如下：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;博客源码（Pelican配置以及rst源文件）托管在&lt;a class="reference external" href="https://github.com/seisman/seisman.info"&gt;GitHub&lt;/a&gt;上；&lt;/li&gt;
&lt;li&gt;生成的HTML文件push到GitHub上项目seisman.github.io的master分支，并使用CNAME设置别名；&lt;/li&gt;
&lt;li&gt;生成的HTML文件push到GitCafe上项目seisman的gitcafe-pages分支，并设置别名。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因而，实际上本博客有多个访问地址：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info"&gt;http://seisman.info&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.github.io"&gt;http://seisman.github.io&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.gitcafe.io"&gt;http://seisman.gitcafe.io&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;DNSPod的具体设置如下图，这样的设置使得联通、电信、移动线路的用户（即大部分国内用户）走GitCafe，其他用户走GitHub。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="DNSPod settings" src="/images/2014071701.png" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;用&lt;a class="reference external" href="http://tool.17mon.cn/"&gt;&lt;span class="caps"&gt;17MON&lt;/span&gt;&lt;/a&gt;测试了修改前后全球各地的ping值。&lt;/p&gt;
&lt;p&gt;修改前ping值汇总如下图。国内最快的仅需要1.4ms，国内平均需要50ms。国外的话亚洲其他地区ping值在150ms左右，其他洲基本都在300ms以上。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="ping0" src="/images/2014071702.png" style="width: 750px;" /&gt;
&lt;/div&gt;
&lt;p&gt;修改后ping值汇总如下图。国内访问的是GitCafe所以依然保持着50ms左右的ping值，北美洲访问的是GitHub，均值也大概在60ms上下。港澳台以及亚洲其他国家现在走GitHub所以速度稍慢，其他洲的速度变化不明显。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="ping1" src="/images/2014071703.png" style="width: 750px;" /&gt;
&lt;/div&gt;
&lt;p&gt;就目前的测试结果来看，国内大部分地区以及美国地区的访问者应该都可以有理想的访问速度了。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-07-17：初稿；&lt;/li&gt;
&lt;li&gt;2014-12-26：GitCafe的博客托管服务有所调整，gitcafe.com改成gitcafe.io，需要在DNS中设置CNAME；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary></entry><entry><title>如何彻底卸载Intel Parallel Studio</title><link href="http://seisman.info/uninstall-intel-parallel-studio-completely.html" rel="alternate"></link><updated>2014-07-16T10:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-16:uninstall-intel-parallel-studio-completely.html</id><summary type="html">&lt;p&gt;Intel的开发工具默认安装在&lt;tt class="docutils literal"&gt;/opt/intel&lt;/tt&gt;目录下，由于一时手贱，用&lt;tt class="docutils literal"&gt;sudo rm &lt;span class="pre"&gt;-rf&lt;/span&gt; /opt/intel&lt;/tt&gt;把整个intel文件夹给删除了。&lt;/p&gt;
&lt;p&gt;在重新安装Intel Parallel&amp;nbsp;Studio的时候一直提示“已安装该产品”，进而导致无法再次安装。实际上是因为在上一次安装的时候，安装了一大堆rpm文件，并将文件的信息写入了rpm数据库中，而在删除的时候数据库没有被更新。再次安装的时候，会在数据库中检测到，继而出现“已安装该产品”的提示。&lt;/p&gt;
&lt;p&gt;解决办法很简单，找到所有已安装的intel相关的包，然后删除。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
rpm -qa | grep intel | awk '{print &amp;quot;yum remove -y&amp;quot;,$1}' &amp;gt; uninstall.sh
&lt;/pre&gt;
&lt;p&gt;查看&lt;tt class="docutils literal"&gt;uninstall.sh&lt;/tt&gt;文件，删除其中不以intel开头的包。然后用root权限执行该脚本即可。&lt;/p&gt;
</summary><category term="CentOS"></category><category term="Intel"></category></entry><entry><title>用CentOS 7打造合适的科研环境</title><link href="http://seisman.info/linux-environment-for-seismology-research.html" rel="alternate"></link><updated>2015-05-11T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-15:linux-environment-for-seismology-research.html</id><summary type="html">&lt;p&gt;这篇博文记录了我用CentOS 7搭建&lt;strong&gt;地震学科研环境&lt;/strong&gt;的过程，供我个人在未来重装系统时参考。对于其他地震学科研人员，也许有借鉴意义。&lt;/p&gt;
&lt;p&gt;阅读须知：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;本文适用于个人电脑，不适用于服务器；&lt;/li&gt;
&lt;li&gt;不推荐刚接触Linux的人使用CentOS发行版；&lt;/li&gt;
&lt;li&gt;本文尽量写的浅显易懂，但要求读者掌握Linux基础知识；&lt;/li&gt;
&lt;li&gt;本文所有操作均在CentOS 7下完成，其他发行版或多或少与CentOS 7不同，因而仅供参考；&lt;/li&gt;
&lt;li&gt;本文所安装的软件纯粹出于个人习惯及喜好，读者应自己判断，按需安装；&lt;/li&gt;
&lt;/ol&gt;

&lt;div class="section" id="centos"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id46"&gt;安装CentOS&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;CentOS 7的安装与其他Linux发行版的安装差不多，个别地方稍有不同。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id47"&gt;准备工作&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;准备材料&lt;ul&gt;
&lt;li&gt;U盘：容量700M以上，用于制作U盘启动盘，因为在制作启动盘时会格式化U盘，所以U盘内不要包含重要资料&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://mirrors.ustc.edu.cn/centos/7.1.1503/isos/x86_64/CentOS-7-x86_64-LiveCD-1503.iso"&gt;CentOS 7.1 LiveCD ISO镜像文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/"&gt;Universal &lt;span class="caps"&gt;USB&lt;/span&gt; installer&lt;/a&gt;：Windows下的U盘启动盘制作工具&lt;/li&gt;
&lt;li&gt;一个已安装Windows的电脑：用于制作U盘启动盘&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;运行Universal &lt;span class="caps"&gt;USB&lt;/span&gt; installer并制作U盘启动盘&lt;/li&gt;
&lt;li&gt;将U盘插入计算机，重启，进入BIOS选择从U盘启动，即可进入CentOS的LiveCD&lt;/li&gt;
&lt;li&gt;进入LiveCD后，点击桌面的“Install to Hard Drive”即可安装&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;注：Linux下可以通过&lt;tt class="docutils literal"&gt;dd&lt;/tt&gt;命令制作启动盘，但由于对原理不够了解，偶尔会导致制作失败，或制作成功后U盘容量有问题，还是用Windows下的Universal &lt;span class="caps"&gt;USB&lt;/span&gt; installer比较靠谱。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id48"&gt;安装过程&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;选择安装过程中使用的语言，这里应&lt;strong&gt;使用英语，不要使用汉语&lt;/strong&gt;。若安装界面使用汉语，最终安装的系统中会出现两个比较麻烦的问题：&lt;ol class="arabic"&gt;
&lt;li&gt;家目录下的系统文件夹，比如Downloads、Desktop等会以中文表示，这使得在命令行cd变得很麻烦；&lt;/li&gt;
&lt;li&gt;终端中某些字符用英文字体，某些字符用中文字体，效果非常差，需要自己修改终端字体方可；&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;选择区域和城市：Asia和Shanghai&lt;/li&gt;
&lt;li&gt;键盘使用English(&lt;span class="caps"&gt;US&lt;/span&gt;)而不是English(&lt;span class="caps"&gt;UK&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;Hostname可以改也可以不改，我用&lt;tt class="docutils literal"&gt;saturn.geolab&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;安装的目的地，选择要使用的硬盘，在“Other Storage Options”处选择“I will configure partioning”，即手动分区&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id49"&gt;分区&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;CentOS 7的分区似乎比较特别，自认为经验很丰富的我在第一次安装CentOS7时还是在分区上耽误了很多时间。后来找到比较合适的分区方法，如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;点击“Click here to create them automatically”，即让安装程序帮忙分区&lt;/li&gt;
&lt;li&gt;默认的分区方案是使用LVM，其好处在于“当机器有多块硬盘时，在使用的时候看上去只有一块”&lt;/li&gt;
&lt;li&gt;默认的文件系统为XFS而不是以前常用的EXT4；&lt;/li&gt;
&lt;li&gt;自动分区完成后，再根据自己的需求，手动修改分区细节&lt;ul&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;/boot&lt;/tt&gt;：CentOS自动分配，一定不要乱改；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;/&lt;/tt&gt;：根目录，合理使用并及时清理的话15G就够了，不过建议30G以上；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;swap&lt;/tt&gt;：与物理内存大小一致即可&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;/opt&lt;/tt&gt;：个人习惯是将第三方软件都安装在&lt;tt class="docutils literal"&gt;/opt&lt;/tt&gt;下，所以分了70G&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;/home&lt;/tt&gt;：余下的全部空间&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;点击“Begin to Install”开始安装&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id50"&gt;真正的安装&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;设置root密码&lt;/li&gt;
&lt;li&gt;创建一般用户&lt;/li&gt;
&lt;li&gt;等待安装完成&lt;/li&gt;
&lt;li&gt;安装完成，重启&lt;/li&gt;
&lt;li&gt;重启后，同意License即可&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id51"&gt;对系统的若干修改&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id52"&gt;若干原则&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;为了搭建一个稳定的系统，尽量避免因为各种瞎折腾而导致的系统问题，特订立了一些软件安装的原则。具体参见《&lt;a class="reference external" href="http://seisman.info/how-to-install-softwares-under-centos-7.html"&gt;CentOS 7下的软件安装方法与策略&lt;/a&gt;》。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="root"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id53"&gt;给一般账号root权限&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;默认情况下，一般账号是没有root权限的。为什么不直接用root账号，而是要给一般账号root权限呢？&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;日常工作中使用root账号，是非常糟糕且危险的习惯！无论是服务器还是个人电脑都是如此。&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;安装软件时需要root权限，只能&lt;tt class="docutils literal"&gt;su&lt;/tt&gt;切换到root账户再安装。对于习惯使用&lt;tt class="docutils literal"&gt;sudo&lt;/tt&gt;的人来说，还是有些麻烦。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;假设账户名为seisman，要授予他root权限，则要修改配置文件&lt;tt class="docutils literal"&gt;/etc/sudoers&lt;/tt&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ su
# echo 'seisman ALL=(ALL) ALL' &amp;gt;&amp;gt; /etc/sudoers # 向配置文件中加入语句
# tail -1 /etc/sudoers  # 检查一下是否正确
seisman ALL=(ALL) ALL
&lt;/pre&gt;
&lt;p&gt;其中seisman为当前用户名。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id54"&gt;添加第三方源&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;CentOS由于很追求稳定性，所以官方源中自带的软件不多，因而需要一些第三方源，比如EPEL、ATrpms、ELRepo、Nux Dextop、RepoForge等。根据上面提到的软件安装原则，为了尽可能保证系统的稳定性，此处大型第三方源只添加EPEL源和ELRepo源。&lt;/p&gt;
&lt;div class="section" id="epel"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id55"&gt;&lt;span class="caps"&gt;EPEL&lt;/span&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a class="reference external" href="https://fedoraproject.org/wiki/EPEL"&gt;&lt;span class="caps"&gt;EPEL&lt;/span&gt;&lt;/a&gt;即Extra Packages for Enterprise Linux，为CentOS提供了额外的10000多个软件包，而且在不替换系统组件方面下了很多功夫，因而可以放心使用。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;sudo yum install epel-release
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;执行完该命令后，在&lt;tt class="docutils literal"&gt;/etc/yum.repos.d&lt;/tt&gt;目录下会多一个&lt;tt class="docutils literal"&gt;epel.repo&lt;/tt&gt;文件。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="elrepo"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id56"&gt;ELRepo&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;cite&gt;ELRepo&lt;/cite&gt;包含了一些硬件相关的驱动程序，比如显卡、声卡驱动。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
sudo rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm
&lt;/pre&gt;
&lt;p&gt;完成该命令后，在&lt;tt class="docutils literal"&gt;/etc/yum.repos.d&lt;/tt&gt;目录下会多一个&lt;tt class="docutils literal"&gt;elrepo.repo&lt;/tt&gt;文件。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="yum-axelget"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id57"&gt;安装yum-axelget&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://dl.fedoraproject.org/pub/epel/7/x86_64/repoview/yum-axelget.html"&gt;yum-axelget&lt;/a&gt;是EPEL提供的一个yum插件。使用该插件后用yum安装软件时可以并行下载，大大提高了软件的下载速度，减少了下载的等待时间:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install yum-axelget
&lt;/pre&gt;
&lt;p&gt;安装该插件的同时会安装另一个软件axel。axel是一个并行下载工具，在下载http、ftp等简单协议的文件时非常好用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id58"&gt;第一次全面更新&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在进一步操作之前，先把已经安装的软件包都升级到最新版:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum update
&lt;/pre&gt;
&lt;p&gt;要更新的软件包有些多，可能需要一段时间。不过有了yum-axelget插件，速度已经快了很多啦。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id59"&gt;重启&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;此处建议重启。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="kernel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id60"&gt;删除多余的kernel&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在前面的&lt;tt class="docutils literal"&gt;yum update&lt;/tt&gt;执行之后，可能会将kernel也一起更新，则在启动CentOS时启动项中会有很多项。&lt;/p&gt;
&lt;p&gt;确认当前使用的kernel版本号:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ uname -r
3.10.0-123.9.3.el7.x86_64
&lt;/pre&gt;
&lt;p&gt;查找当前系统安装的所有kernel:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ rpm -qa | grep kernel
kernel-3.10.0-123.8.1.el7.x86_64
kernel-3.10.0-123.9.3.el7.x86_64
kernel-devel-3.10.0-123.9.2.el7.x86_64
kernel-tools-3.10.0-123.9.3.el7.x86_64
kernel-headers-3.10.0-123.9.3.el7.x86_64
kernel-3.10.0-123.9.2.el7.x86_64
kernel-tools-libs-3.10.0-123.9.3.el7.x86_64
kernel-devel-3.10.0-123.8.1.el7.x86_64
kernel-devel-3.10.0-123.9.3.el7.x86_64
&lt;/pre&gt;
&lt;p&gt;可以看出有三个版本的kernel，123.8.1、123.9.2和123.9.3。除了最新的kernel外，建议多保留一个旧kernel，以免新kernel出现问题时可以通过旧kernel进入系统。因而此处删除123.8.1版本的kernel:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum remove kernel-3.10.0-123.8.1.el7.x86_64
sudo yum remove kernel-devel-3.10.0-123.8.1.el7.x86_64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id61"&gt;基础开发环境&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="gcc"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id62"&gt;GCC系列&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
sudo yum install gcc                     # C编译器
sudo yum install gcc-c++                 # C++编译器
sudo yum install gcc-gfortran            # Fortran编译器
sudo yum install compat-gcc-44           # 兼容gcc 4.4
sudo yum install compat-gcc-44-c++       # 兼容gcc-c++ 4.4
sudo yum install compat-gcc-44-gfortran  # 兼容gcc-fortran 4.4
sudo yum install compat-libf2c-34        # g77 3.4.x兼容库
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id63"&gt;软件开发辅助工具&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
sudo yum install make
sudo yum install gdb     # 代码调试器
sudo yum install cmake   # Cmake
sudo yum install git     # 版本控制
sudo yum install git-svn # git的svn插件
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id64"&gt;驱动程序&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id14"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id65"&gt;显卡驱动&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Linux默认只使用开源的显卡驱动，就目前的情况来看，开源驱动的效果还是不错的，但跟官方的闭源驱动相比还是有一定差距。最明显的区别是，在使用SAC的ppk功能放大波形时，使用开源驱动会出现延迟，而使用官方闭源则整个过程非常顺畅。&lt;/p&gt;
&lt;p&gt;安装显卡检测程序:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install nvidia-detect
&lt;/pre&gt;
&lt;p&gt;检测显卡型号以及对应的驱动:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ nvidia-detect
Probing for supported NVIDIA devices...
[10de:06dd] NVIDIA Corporation GF100GL [Quadro 4000]
This device requires the current 340.58 NVIDIA driver kmod-nvidia
&lt;/pre&gt;
&lt;p&gt;此处提示需要安装340.58版的显卡驱动:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
# 安装显卡驱动及其32位库文件
sudo yum install nvidia-x11-drv nvidia-x11-drv-32bit
# 卸载与官方驱动冲突的开源驱动
sudo yum remove xorg-x11-glamor
&lt;/pre&gt;
&lt;p&gt;安装完显卡驱动后可以重启一下。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ntfs"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id66"&gt;NTFS驱动&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;CentOS下默认无法挂载NTFS格式的硬盘。需安装nfts-3g即可实现即插即用:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install ntfs-3g
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id15"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id67"&gt;进阶开发环境&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="java"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id68"&gt;Java环境&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Java的一大特色在于跨平台，只有安装了Java运行环境，即可运行Java程序:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install java                        # java运行环境
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="clang"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id69"&gt;Clang系列&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Clang可以认为是GCC的替代品，可以用于编译C、C++、Objective-C和Objective-C++。其提供了更友好的报错信息，在有些方面比GCC更友好，同时其提供了一个代码静态分析器，可以用于分析代码中可能出现的bug和内存溢出问题。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install clang             # clang编译器
sudo yum install clang-analyzer    # clang静态分析器
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="intel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id70"&gt;Intel系列&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Intel的大部分软件都是非开源且收费的，但同时部分软件也提供了Linux下的非商业免费版。比如icc、mkl数学库以及代码性能分析工具等。&lt;/p&gt;
&lt;p&gt;Intel软件的申请以及安装参考《&lt;a class="reference external" href="http://seisman.info/intel-non-commercial-software.html"&gt;Intel非商业免费开发工具&lt;/a&gt;》。&lt;/p&gt;
&lt;p&gt;还有一点需要注意的是，Intel也提供了并行相关的几个命令，比如mpicc、mpirun。所以openmpi、mpich和intel三者，在并行时只能用其中一个。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id17"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id71"&gt;并行计算&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;并行可以用openmpi，也可以用mpich，二者应该是并列的。但是由于二者提供了几乎一样的命令，所以二者可以同时安装，但是不可以同时处于使用状态。&lt;/p&gt;
&lt;div class="section" id="openmpi"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id72"&gt;openmpi&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;安装openmpi:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install openmpi openmpi-devel
&lt;/pre&gt;
&lt;p&gt;安装后，二进制文件位于&lt;tt class="docutils literal"&gt;/usr/lib64/openmpi/bin&lt;/tt&gt;下，动态库文件位于&lt;tt class="docutils literal"&gt;/usr/lib64/openmpi/lib&lt;/tt&gt;下，因而实际使用的话还需要额外的配置，在&lt;tt class="docutils literal"&gt;.bashrc&lt;/tt&gt;中加入如下语句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
export PATH=/usr/lib64/openmpi/bin/:${PATH}
module load mpi/openmpi-x86_64
&lt;/pre&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：要使用&lt;tt class="docutils literal"&gt;module&lt;/tt&gt;命令需要先安装&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;environment-modules&lt;/span&gt;&lt;/tt&gt;包。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="mpich"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id73"&gt;mpich&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;安装mpich:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install mpich mpich-devel
&lt;/pre&gt;
&lt;p&gt;安装后，二进制文件位于&lt;tt class="docutils literal"&gt;/usr/lib64/mpich/bin&lt;/tt&gt;下，动态库文件位于&lt;tt class="docutils literal"&gt;/usr/lib64/mpich/lib&lt;/tt&gt;下，因而实际使用的话还需要额外的配置，在&lt;tt class="docutils literal"&gt;.bashrc&lt;/tt&gt;中加入如下语句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
export PATH=/usr/lib64/mpich/bin/:${PATH}
module load mpi/mpich-x86_64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id18"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id74"&gt;脚本语言环境&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="perl"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id75"&gt;Perl&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;CentOS 7.0自带了Perl 5.16.3（2013年03月11日发布），目前的最新版本为5.20.1（2014年09月14日发布）。&lt;/p&gt;
&lt;div class="section" id="id19"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id76"&gt;系统自带Perl&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;系统自带Perl，就目前来看，版本不算老，基本够用。官方源和EPEL源中提供了1000多个模块，可以直接用yum安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install perl-Parallel-ForkManager  # 并行模块
&lt;/pre&gt;
&lt;p&gt;若源中没有已打包好的模块，也可以使用perl自带的cpan来安装模块。&lt;/p&gt;
&lt;p&gt;优先级：yum &amp;gt; cpan。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="plenv"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id77"&gt;plenv管理新版本&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;若需要使用最新版本的perl，可以使用&lt;a class="reference external" href="http://seisman.info/perl-plenv.html"&gt;plenv&lt;/a&gt;安装新版本的perl，并使用plenv提供的cpanm命令安装模块:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cpanm install Parallel::ForkManager # 并行模块
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="python"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id78"&gt;Python&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;CentOS 7.0自带Python 2.7.5，目前Python 2的最新版本为2.7.8，Python 3的最新版本为3.4.2。&lt;/p&gt;
&lt;div class="section" id="id21"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id79"&gt;系统自带Python&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;系统自带的Python 2.7.5，基本已经够用，Python 2常用的模块在官方源或EPEL源中也有有编译好的包，因而直接通过yum安装即可:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install python-matplotlib  # 2D绘图库
sudo yum install PyQt4  # Qt4的Python绑定
sudo yum install numpy  # 数组操作库
sudo yum install scipy  # 科学计算库
sudo yum install python-requests  # 网页请求
sudo yum install python-docopt  # 命令行参数分析器
sudo yum install gdal-python    # gdal的Python绑定
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="pyenvpython3"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id80"&gt;pyenv管理Python3&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Python2与Python3之间是不完全兼容的，而我以Python3为主，所以需要安装一个Python3。&lt;/p&gt;
&lt;p&gt;首先，安装&lt;a class="reference external" href="http://seisman.info/python-pyenv.html"&gt;pyenv&lt;/a&gt;来管理多个Python版本，然后利用pyenv安装anaconda3（即Python 3.4）。anaconda自带了众多科学计算所需的包，免去了安装的麻烦，对于其他包，则可以利用Python自带的pip安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pip install requests
pip install docopt
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id22"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id81"&gt;编程相关软件&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id23"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id82"&gt;编辑器&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;vim&lt;/li&gt;
&lt;li&gt;sublime text 3&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="ide"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id83"&gt;&lt;span class="caps"&gt;IDE&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Python &lt;span class="caps"&gt;IDE&lt;/span&gt;：&lt;a class="reference external" href="https://www.jetbrains.com/pycharm/"&gt;PyCharm Community Edition&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id24"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id84"&gt;日常软件&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="office"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id85"&gt;Office套件&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="libreoffice"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id86"&gt;LibreOffice&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;大多数Linux发行版都自带LibreOffice:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install libreoffice
&lt;/pre&gt;
&lt;p&gt;LibreOffice与Microsoft Office的兼容性不太好，操作界面与MS Office也有较大差异，让人不太习惯。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="wps-office"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id87"&gt;&lt;span class="caps"&gt;WPS&lt;/span&gt; Office&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;若在Linux下对于文档处理有更高一些的要求，可以尝试目前还处于测试版的WPS Office for Linux。&lt;span class="caps"&gt;WPS&lt;/span&gt; Office的兼容性以及界面都比LibreOffice要好很多，值得期待，当然还是不能做到完全兼容MS Office。&lt;/p&gt;
&lt;p&gt;安装过程参考&lt;a class="reference external" href="http://seisman.info/wps-office-for-centos7.html"&gt;CentOS下安装WPS Office&lt;/a&gt;一文。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="texlive-2014"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id88"&gt;TeXLive 2014&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;系统是自带了TeXLive，版本较老，还是安装最新版比较好。&lt;/p&gt;
&lt;p&gt;根据&lt;a class="reference external" href="http://seisman.info/install-texlive-under-linux.html"&gt;Linux下安装TeXLive&lt;/a&gt;一文，从ISO文件中安装TeXLive。&lt;/p&gt;
&lt;p&gt;安装完成后，更新所有模块:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
tlmgr update --all
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="mendeley"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id89"&gt;Mendeley&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Mendeley是一个跨平台的文献管理软件，其内部自带了一个可以添加注释的PDF阅读器。&lt;/p&gt;
&lt;p&gt;下载Generic Linux (64 bits) ：&lt;a class="reference external" href="http://www.mendeley.com/download-mendeley-desktop"&gt;http://www.mendeley.com/download-mendeley-desktop&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
tar -xvf mendeleydesktop-1.12.3-linux-x86_64.tar.bz2  # 解压
sudo mv mendeleydesktop /opt  # 复制到/opt下
cd /opt/mendeleydesktop/bin   # cd进去
./install-mendeley-link-handler.sh /opt/mendeleydesktop/bin/mendeleydesktop
sudo yum install qtwebkit  # 安装依赖包
&lt;/pre&gt;
&lt;p&gt;注销重新登陆，在Application-&amp;gt;Education下即可看到mendeley的相关项目。不过是没有软件的图标的，强迫症不能忍，用下面的命令解决:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cp /opt/mendeleydesktop/share/icons/hicolor/128x128/apps/mendeleydesktop.png ~/.local/share/icons/
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="google-chrome"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id90"&gt;Google Chrome浏览器&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;默认的浏览器是Firefox，还是更喜欢Chrome浏览器。&lt;/p&gt;
&lt;p&gt;在&lt;tt class="docutils literal"&gt;/etc/yum.repos.d/&lt;/tt&gt;目录下新建文件&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;google-chrome.repo&lt;/span&gt;&lt;/tt&gt;，向其中添加如下内容:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
[google-chrome]
name=google-chrome
baseurl=http://dl.google.com/linux/chrome/rpm/stable/$basearch
enabled=1
gpgcheck=1
gpgkey=https://dl-ssl.google.com/linux/linux_signing_key.pub
&lt;/pre&gt;
&lt;p&gt;安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install google-chrome-stable
&lt;/pre&gt;
&lt;p&gt;由于Google的官方源在国内可能无法正常访问，导致安装失败或安装后无法正常更新。有人在国内服务器上做了Google官方源的镜像，若你相信该镜像是安全的，则可使用此国内镜像代替Google官方源，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;google-chrome.repo&lt;/span&gt;&lt;/tt&gt;的内容改为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
[google-chrome]
name=google-chrome
#baseurl=http://dl.google.com/linux/chrome/rpm/stable/$basearch
#gpgkey=https://dl-ssl.google.com/linux/linux_signing_key.pub
mirrorlist=http://1dot75cm.tk/mirrorlist
gpgkey=http://1dot75cm.tk/src/linux_signing_key.pub
gpgcheck=1
enabled=1
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="opera"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id91"&gt;Opera浏览器&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;也可以选择Opera浏览器。&lt;/p&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://www.opera.com/download/guide/?os=linux"&gt;http://www.opera.com/download/guide/?os=linux&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;选择CentOS &lt;span class="caps"&gt;RPM&lt;/span&gt; package进行下载。下载完成后，执行:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum localinstall opera-12.16-1860.x86_64.rpm
&lt;/pre&gt;
&lt;p&gt;想要卸载的话，就执行:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum remove opera
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="flash"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id92"&gt;Flash插件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Flash插件主要是看在线视频的时候要用。Google浏览器自带了Flash插件，所以这里安装的flash插件主要是为了firefox。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo rpm -ivh http://linuxdownload.adobe.com/adobe-release/adobe-release-x86_64-1.0-1.noarch.rpm
sudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-adobe-linux
sudo yum install flash-plugin
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id25"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id93"&gt;解压软件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;解压7z或zip格式需要p7zip，由EPEL提供:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install p7zip
&lt;/pre&gt;
&lt;p&gt;解压rar格式需要unrar，该软件由Nux Dextop提供，但该源与EPEL源有冲突，所以直接下载该rpm进行安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum localinstall http://li.nux.ro/download/nux/dextop/el7/x86_64/unrar-5.0.12-2.el7.nux.x86_64.rpm
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="ftp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id94"&gt;FTP客户端&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;FTP客户端，还是有界面的filezilla比较方便些。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install filezilla
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id26"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id95"&gt;效率类软件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这一类工具能够在不同方面提高科研的效率，也提高了使用者的体验。&lt;/p&gt;
&lt;div class="section" id="id27"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id96"&gt;终端模拟器&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Gnome自带的终端模拟器是gnome-terminal。经常会需要开十几个终端，切换和管理起来比较麻烦。&lt;/p&gt;
&lt;div class="section" id="terminator"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id97"&gt;terminator&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;terminator有很多功能，我只用到了终端分割的功能。&lt;tt class="docutils literal"&gt;Ctrl+Shift+O&lt;/tt&gt;对终端水平分隔，&lt;tt class="docutils literal"&gt;Ctrl+Shift+E&lt;/tt&gt;对终端垂直分隔，&lt;tt class="docutils literal"&gt;Alt+上下左右&lt;/tt&gt;可以在各子终端中切换。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum localinstall http://li.nux.ro/download/nux/dextop/el7/x86_64/terminator-0.97-6.el7.nux.noarch.rpm
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="guake"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id98"&gt;guake&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;有些时候需要临时执行一两个命令，但是又不想额外启动一个终端的情况下，guake是个不错的选择。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum localinstall http://li.nux.ro/download/nux/dextop/el7/x86_64/guake-0.4.4-11.el7.nux.x86_64.rpm
&lt;/pre&gt;
&lt;p&gt;安装完成后，在Application-&amp;gt;System Tools里找到guake Terminal即可启动。按下F12即可呼出guake，再次按下F12即可隐藏。也可在终端执行&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;guake-prefs&lt;/span&gt;&lt;/tt&gt;对gauke进行配置。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="zshoh-my-zsh"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id99"&gt;zsh与oh my zsh&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Linux下有很多shell，比如最常见的bash，除此之外还有csh、ksh。zsh也是一个shell。&lt;/p&gt;
&lt;p&gt;zsh的特点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语法基本完全兼容于bash，一般用户完全体会不到其区别&lt;/li&gt;
&lt;li&gt;zsh提供命令补全特性，比bash的补全要更好用&lt;/li&gt;
&lt;li&gt;可配置性强&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;完全不经配置的zsh已经很好用了，一般用户也没必要花时间研究配置。&lt;a class="reference external" href="https://github.com/robbyrussell/oh-my-zsh"&gt;oh my zsh&lt;/a&gt;是一群人一起维护的一套zsh配置文件。直接用这个配置文件，稍稍了解一点会有更好的体验。&lt;/p&gt;
&lt;p&gt;安装zsh:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install zsh
&lt;/pre&gt;
&lt;p&gt;安装oh my zsh:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
curl -L http://install.ohmyz.sh | sh
&lt;/pre&gt;
&lt;p&gt;上面的命令，做了如下几件事情：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;下载&lt;tt class="docutils literal"&gt;oh my zsh&lt;/tt&gt;到&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.oh-my-zsh&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;备份已有的zsh配置文件&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.zshrc&lt;/span&gt;&lt;/tt&gt;，并复制新的&lt;tt class="docutils literal"&gt;.zshrc&lt;/tt&gt;文件&lt;/li&gt;
&lt;li&gt;将当前用户的默认shell由bash改成zsh&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;第三步中，会报错如下：&lt;tt class="docutils literal"&gt;chsh: "/usr/bin/zsh" is not listed in /etc/shells.&lt;/tt&gt;，需要手动修改默认shell:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
chsh -s /bin/zsh
&lt;/pre&gt;
&lt;p&gt;chsh命令修改的是login shell，因而需要退出当前用户并重新登陆，以后用户的默认shell就从bash变成了zsh，所有的配置都不用写到&lt;tt class="docutils literal"&gt;.bashrc&lt;/tt&gt;而要写到&lt;tt class="docutils literal"&gt;.zshrc&lt;/tt&gt;中。&lt;/p&gt;
&lt;p&gt;在&lt;tt class="docutils literal"&gt;.zshrc&lt;/tt&gt;中可以选择喜欢的主题，以及适当数量的插件。下面列出我在用的插件:&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;git&lt;/p&gt;
&lt;p&gt;该插件为git的众多常用命令提供了更简单的别名，比如&lt;tt class="docutils literal"&gt;git status&lt;/tt&gt;的别名是&lt;tt class="docutils literal"&gt;gst&lt;/tt&gt;，大大简写了击键数。但该插件中&lt;tt class="docutils literal"&gt;git mergetool &lt;span class="pre"&gt;--no-prompt&lt;/span&gt;&lt;/tt&gt;的别名是&lt;tt class="docutils literal"&gt;gmt&lt;/tt&gt;，与GMT软件冲突，需要将该插件的目录git复制到custom/plugins下，然后删除其中的gmt别名；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;命令补全插件: pip, pyenv&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;sudo：按两下&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ESC&lt;/span&gt;&lt;/tt&gt;即可在当前命令前加上&lt;tt class="docutils literal"&gt;sudo&lt;/tt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;yum：为常见的yum命令提供别名&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="autojump"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id100"&gt;autojump&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/joelthelion/autojump"&gt;autojump&lt;/a&gt;是一个非常智能的目录快速切换的工具。简单演示如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ pwd
/home/seisman
$ cd Desktop
$ cd /opt
$ cd /usr/local

# 用j命令迅速从/usr/local跳转到与des匹配的目录，这里只有Desktop可以匹配
$ j des
$ pwd
/home/seisman/Desktop
&lt;/pre&gt;
&lt;p&gt;用法差不多就这样，具体看项目主页。&lt;/p&gt;
&lt;p&gt;安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install autojump
sudo yum install autojump-zsh
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id29"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id101"&gt;中文输入法&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;刚安装的系统可能是没有中文输入法的，源中带的中文输入法应该是ibus，使用效果一般。fcitx是更好的选择，基于fcitx框架的搜狗输入法或许是更好的选择。&lt;/p&gt;
&lt;p&gt;参考&lt;a class="reference external" href="http://seisman.info/fcitx-for-centos-7.html"&gt;CentOS7安装fcitx中文输入法&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="hosttool"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id102"&gt;HostTool&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;科学上网几乎已经成为每个搞科研的人的必备技能。&lt;/p&gt;
&lt;p&gt;科学上网的方式有很多，这里只说HostTool：&lt;a class="reference external" href="https://hosts.huhamhire.com/"&gt;https://hosts.huhamhire.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;HostTool科学上网本质上就是用最新的host文件替代了系统自带的host文件。&lt;/p&gt;
&lt;p&gt;下载解压后，进入目录，直接&lt;tt class="docutils literal"&gt;sudo python2 hoststool.py&lt;/tt&gt;即可运行，具体的用法自己研究一下。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="virtualbox"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id103"&gt;VirtualBox虚拟机&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;有时候可能需要在Windows下做一些操作，如果机器性能足够好的话，可以安装VirtualBox虚拟机。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
wget http://download.virtualbox.org/virtualbox/rpm/rhel/virtualbox.repo
sudo mv virtualbox.repo /etc/yum.repos.d/
sudo yum install VirtualBox-4.3
&lt;/pre&gt;
&lt;p&gt;这样就可以在Linux下虚拟一个Windows啦，好开心。&lt;/p&gt;
&lt;p&gt;需要注意两点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;若机器性能不够，虚拟机的使用体验会非常差，所以不建议在老机器上使用；&lt;/li&gt;
&lt;li&gt;更新kernel之后需要执行&lt;tt class="docutils literal"&gt;sudo /etc/init.d/vboxdrv setup&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id30"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id104"&gt;等宽字体&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;编程要用等宽字体，这点是常识了。一款适合编程的等宽字体，至少要满足如下几个要求：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;易于区分“1”、“i”和“l”&lt;/li&gt;
&lt;li&gt;易于区分“0”、“o”和“O”&lt;/li&gt;
&lt;li&gt;易于区分中文下的左引号和右引号&lt;/li&gt;
&lt;li&gt;美观&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;目前选择的Source Code Pro。将解压后的字体文件放在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.fonts&lt;/span&gt;&lt;/tt&gt;目录下，并修改终端、gedit以及其他编辑器、IDE等的默认字体。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id31"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id105"&gt;同步网盘&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;网盘根据功能大概可以分为两类：同步网盘和备份网盘。既然是同步网盘，Linux下的客户端必不可少。就目前已知的情况来看，CentOS7下能使用的同步网盘只有三个：Dropbox、MEGA和坚果云。&lt;/p&gt;
&lt;p&gt;我主要用同步网盘将Linux机器上的PDF文献同步到iPad上。&lt;/p&gt;
&lt;div class="section" id="dropbox"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id106"&gt;Dropbox&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;又是一个被墙的工具，熟练掌握科学上网技巧的人可以使用，一般人还是不要用了。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
wget https://www.dropbox.com/download?dl=packages/fedora/nautilus-dropbox-1.6.2-1.fedora.x86_64.rpm
sudo rpm -i nautilus-dropbox-1.6.2-1.fedora.x86_64.rpm
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="mega"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id107"&gt;&lt;span class="caps"&gt;MEGA&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span class="caps"&gt;MEGA&lt;/span&gt;： &lt;a class="reference external" href="https://mega.co.nz/"&gt;https://mega.co.nz/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;免费容量50G，作为同步盘来说基本是够用了。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
# 下载主程序
wget https://mega.nz/linux/MEGAsync/CentOS_7/x86_64/megasync-CentOS_7.x86_64.rpm
# 下载文件管理器扩展（可选）
wget https://mega.nz/linux/MEGAsync/CentOS_7/x86_64/nautilus-megasync-CentOS_7.x86_64.rpm
sudo yum localinstall megasync-CentOS_7.x86_64.rpm
sudo yum localinstall nautilus-megasync-CentOS_7.x86_64.rpm
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id32"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id108"&gt;坚果云&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;国内的全平台同步网盘，不限空间，但限制每月上传流量1G，下载流量3G。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
# 坚果云依赖于notify-python，该包位于Nux Dextop源中
sudo yum localinstall http://li.nux.ro/download/nux/dextop/el7/x86_64/notify-python-0.1.1-25.el7.nux.x86_64.rpm
# 下载
wget https://jianguoyun.com/static/exe/installer/fedora/nautilus_nutstore_amd64.rpm
sudo rpm -i nautilus_nutstore_amd64.rpm
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id33"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id109"&gt;工具软件&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id34"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id110"&gt;视频下载工具&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/soimort/you-get"&gt;you-get&lt;/a&gt;和&lt;cite&gt;youtube-dl &amp;lt;https://github.com/rg3/youtube-dl&amp;gt;&lt;/cite&gt;是两个用于从视频网站上下载视频文件的工具。其中，后者支持的网站更多，但前者对国内的视频网站支持更好。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pip install you-get
pip install youtube-dl
# EPEL中提供了youtube-dl包，因而也可以使用yum安装。一般来说，pip安装的版本更新一些
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="pdf"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id111"&gt;PDF处理工具&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="http://community.coherentpdf.com/"&gt;cpdf&lt;/a&gt;是一个跨平台的PDF处理工具，可以完成常见的PDF合并、切割、加密解密、书签、水印等功能。&lt;/p&gt;
&lt;p&gt;下载已编译好的&lt;a class="reference external" href="https://github.com/coherentgraphics/cpdf-binaries/archive/master.zip"&gt;二进制包&lt;/a&gt;，解压，并将与自己的平台对应的二进制文件复制到&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;${&lt;span class="caps"&gt;HOME&lt;/span&gt;}/bin&lt;/span&gt;&lt;/tt&gt;目录下即可使用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id112"&gt;BT软件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;transmission是Linux下常用的Torrent下载软件:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install transmission
&lt;/pre&gt;
&lt;p&gt;在“Application”-&amp;gt;“Internet”-&amp;gt;中可以启动transmission。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id36"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id113"&gt;其他工具&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
sudo yum install nfs-utils     # 挂载NFS文件系统所必须
sudo yum install xclip         # 终端的文本复制工具
sudo yum install ImageMagick   # 其中的import和convert命令很有用
sudo yum install dos2unix unix2dos  # Windows和Linux换行符互相转换
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id37"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id114"&gt;地球物理相关&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;参考《&lt;a class="reference external" href="http://seisman.info/sac-manual.html"&gt;SAC参考手册&lt;/a&gt;》中的相关章节。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/install-gmt4-under-linux.html"&gt;安装GMT4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/install-gmt5-under-linux.html"&gt;安装GMT5&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="http://seisman.info/install-taup.html"&gt;TauP&lt;/a&gt;：走时计算工具&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="http://seisman.info/install-rdseed.html"&gt;rdseed&lt;/a&gt;：SEED转SAC的工具&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;win32tools：Hinet自定义的win32格式转SAC格式&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="http://seisman.info/install-pssac.html"&gt;pssac&lt;/a&gt;：用GMT绘制SAC文件&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="http://seisman.info/calculate-dist-az-baz.html"&gt;distaz&lt;/a&gt;：根据两点经纬度计算震中距和方位角&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id38"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id115"&gt;娱乐&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
sudo yum install 2048-cli   # 2048命令行版
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id39"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id116"&gt;未完成&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="google-earth"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id117"&gt;Google Earth&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;理论上Google Earth应该可以跟Google Chrome用类似的方法来安装的，但是由于Google Earth的rpm包存在bug，导致无法通过上面的方法安装。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ cd -
$ wget https://dl.google.com/dl/earth/client/current/google-earth-stable_current_x86_64.rpm
$ rpm2cpio google-earth-stable_current_x86_64.rpm | cpio -div
$ sudo cp -r opt/google/earth /opt/google/
$ sudo cp etc/cron.daily/google-earth /etc/cron.daily/
$ rm -rf usr opt etc
$ sudo ln -s /opt/google/earth/free/googleearth /usr/bin/google-earth
&lt;/pre&gt;
&lt;p&gt;安装完成后，启动后奔溃。。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id40"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id118"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://elrepo.org/tiki/tiki-index.php"&gt;ELRepo官方网站&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://elrepo.org/tiki/kmod-nvidia"&gt;ELRepo kmod-nvidia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://wiki.centos.org/zh/AdditionalResources/Repositories/GoogleYumRepos"&gt;CentOS Yum软件库样例&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id42"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id119"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-07-15：初稿；&lt;/li&gt;
&lt;li&gt;2014-09-05：EPEL已经发布正式版；修改了epel-release的下载链接；修订了import步骤的错误；&lt;/li&gt;
&lt;li&gt;2014-09-20：将小小输入法改为搜狗输入法；&lt;/li&gt;
&lt;li&gt;2014-11-20：使用zsh；&lt;/li&gt;
&lt;li&gt;2014-11-24：加入了VirtualBox虚拟机；&lt;/li&gt;
&lt;li&gt;2014-12-01：从ELRepo源中安装显卡驱动；&lt;/li&gt;
&lt;li&gt;2014-12-02：新增Opera浏览器和unrar；&lt;/li&gt;
&lt;li&gt;2014-12-27：新增pointdownload下载工具；google chrome采用非官方源镜像；&lt;/li&gt;
&lt;li&gt;2014-12-28：修订unrar的rpm文件链接；&lt;/li&gt;
&lt;li&gt;2015-01-03：新增同步网盘Dropbox和坚果云；删除pointdownload；&lt;/li&gt;
&lt;li&gt;2015-01-05：autojump直接从epel中安装；新增youtube-dl、you-get和2048-cli；&lt;/li&gt;
&lt;li&gt;2015-01-07：新增terminator和guake；&lt;/li&gt;
&lt;li&gt;2015-01-27：新增cpdf；&lt;/li&gt;
&lt;li&gt;2015-03-03：新增filezilla和transmission；&lt;/li&gt;
&lt;li&gt;2015-03-26：安装过程中不应使用中文安装界面；&lt;/li&gt;
&lt;li&gt;2015-05-11：新增MEGA同步网盘；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="CentOS"></category><category term="Perl"></category><category term="Python"></category></entry><entry><title>Linux下安装NVIDIA显卡驱动</title><link href="http://seisman.info/install-nvidia-drivers-under-linux.html" rel="alternate"></link><updated>2014-12-01T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-13:install-nvidia-drivers-under-linux.html</id><summary type="html">&lt;p&gt;大部分Linux发行版都使用开源的显卡驱动nouveau，对于nvidia显卡来说，还是闭源的官方驱动的效果更好。最明显的一点是，在使用SAC拾取震相的时候，使用官方显卡驱动在刷新界面的时候要快很多。&lt;/p&gt;
&lt;p&gt;对于CentOS用户而言，有两种安装NVIDIA显卡驱动的方法，从ELRepo源中安装或从源码编译驱动。对于一般的CentOS用户，建议使用第一种方法。&lt;/p&gt;

&lt;div class="section" id="elrepo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;从ELRepo源中安装驱动&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ELRepo源中包含了一系列驱动程序。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;添加ELRepo源:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
sudo rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装显卡检查程序:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install nvidia-detect
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;检测显卡型号，并选择对应的驱动:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ nvidia-detect -v
Probing for supported NVIDIA devices...
[10de:06dd] NVIDIA Corporation GF100GL [Quadro 4000]
This device requires the current 346.47 NVIDIA driver kmod-nvidia
&lt;/pre&gt;
&lt;p&gt;根据&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;nvidia-detect&lt;/span&gt;&lt;/tt&gt;的输出信息，可以知道显卡的型号，以及要使用的驱动版本&lt;tt class="docutils literal"&gt;346.47&lt;/tt&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装显卡驱动&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;若驱动版本为304.xx，则安装304xx版本:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install nvidia-x11-drv-304xx nvidia-x11-drv-304xx-32bit
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;若驱动版本为340.xx，则安装340xx版本:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install nvidia-x11-drv-340xx nvidia-x11-drv-340xx-32bit
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;对于大多数比较新的显卡来说，直接安装最新版的驱动即可:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install nvidia-x11-drv nvidia-x11-drv-32bit
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装过程中可能会给出软件冲突的警告，需要卸载以下软件包及其依赖:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum remove xorg-x11-glamor
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;重启&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;手动编译显卡驱动&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;准备工作&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;查看显卡型号&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ lspci | grep VGA
03:00.0 VGA compatible controller: NVIDIA Corporation GF100GL [Quadro 4000] (rev a1)
&lt;/pre&gt;
&lt;p&gt;从这里可以得出显卡型号为Quadro 4000。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;驱动下载&lt;/p&gt;
&lt;p&gt;下载地址为：&lt;a class="reference external" href="http://www.nvidia.com/Download/index.aspx?lang=en-us"&gt;http://www.nvidia.com/Download/index.aspx?lang=en-us&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;安装显卡驱动&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;安装kernel-devel&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install kernel-devel
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;将nouveau驱动加入黑名单，在&lt;tt class="docutils literal"&gt;/etc/modprobe.d/blacklist.conf&lt;/tt&gt;（CentOS 7下为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/usr/lib/modprobe.d/dist-blacklist.conf&lt;/span&gt;&lt;/tt&gt;）中加入&lt;tt class="docutils literal"&gt;blacklist nouveau&lt;/tt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;备份initramfs文件&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;重建initramfs文件&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo dracut -v /boot/initramfs-$(uname -r).img $(uname -r)
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;关机重启。由于此时nouveau驱动已经被禁用，桌面的显示效果非常差。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;进入文本界面&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo init 3
&lt;/pre&gt;
&lt;p&gt;会直接进入文本界面。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;在文本界面登录后直接安装&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sh NVIDIAxxx --kernel-source-path=/usr/src/kernels/x.xx.x-xxxxx
&lt;/pre&gt;
&lt;p&gt;其中&lt;tt class="docutils literal"&gt;NVIDIAxxx&lt;/tt&gt;为nvidia驱动脚本文件，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;x.xx.x-xxxx&lt;/span&gt;&lt;/tt&gt;为kernel版本号。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="kernel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;更新kernel后重装驱动&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;手动编译显卡驱动的一个麻烦之处在于，每次更新kernel之后，都会出现无法进入图形界面的情况，此时需要重新安装显卡驱动。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;更新kernel，重启，发现无法进入图形界面；&lt;/li&gt;
&lt;li&gt;按下&lt;tt class="docutils literal"&gt;Alt+F2&lt;/tt&gt;，进入文本界面，以root身份登陆；&lt;/li&gt;
&lt;li&gt;备份initramfs文件&lt;/li&gt;
&lt;li&gt;重建initramfs文件&lt;/li&gt;
&lt;li&gt;重启，按下&lt;tt class="docutils literal"&gt;Alt+F2&lt;/tt&gt;，进入文本界面，以root身份登陆；&lt;/li&gt;
&lt;li&gt;执行第七步；再重启；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;卸载显卡驱动&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
sh ./NVIDIA-Linux-xxxxx --uninstall
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;更新历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-07-13：初稿；&lt;/li&gt;
&lt;li&gt;2014-11-01：加入了更新kernel之后的操作；&lt;/li&gt;
&lt;li&gt;2014-12-01：添加“从ELRepo源中安装显卡驱动”一节，且不建议手动编译驱动；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="CentOS"></category></entry><entry><title>CentOS 7.0下安装小小输入法</title><link href="http://seisman.info/install-yong-chinese-input-method-under-centos-7.html" rel="alternate"></link><updated>2014-07-12T16:01:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-12:install-yong-chinese-input-method-under-centos-7.html</id><summary type="html">&lt;p&gt;另一篇博文： &lt;a class="reference external" href="http://seisman.info/fcitx-for-centos-7.html"&gt;CentOS&amp;nbsp;7.0下安装搜狗输入法&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;小小输入法也叫yong输入法，是一个免费但不开源的中文输入法，其作者为dgod，2008年发布第一个版本，至今六年时间依然在不断的更新。以一人之力默默维护一个项目6年时间，不得不让人佩服。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;官方网址： &lt;a class="reference external" href="http://yong.dgod.net/"&gt;http://yong.dgod.net/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;下载地址： &lt;a class="reference external" href="http://yongim.ys168.com/"&gt;http://yongim.ys168.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;曾经试图在CentOS 6.5下安装该输入法，无奈CentOS 6.5的库版本太低，一直安不上。下面记录一下在CentOS&amp;nbsp;7.0下的安装过程。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;从官方网站下载Linux下的最新版本&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;yong-lin-2.2.0-1.7z&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;解压。7z格式的压缩文件需要安装&lt;tt class="docutils literal"&gt;p7zip&lt;/tt&gt;方可解压，在EPEL源中有提供该软件。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;yong
&lt;span class="nv"&gt;$ &lt;/span&gt;su
&lt;span class="c"&gt;# ./yong-tool.sh --install64   # 安装&lt;/span&gt;
&lt;span class="c"&gt;# ./yong-tool.sh --select      # 设置为默认输入法&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;想要卸载yong&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# ./yong-tool.sh --uninstall&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;系统启用中文输入源&lt;/p&gt;
&lt;p&gt;在“Application”-&amp;gt;“System Tools”-&amp;gt;“Region&amp;amp;Language”-&amp;gt;“Input Source”中添加中文输入源“Chinese(yong)”。也可以考虑删除&lt;tt class="docutils literal"&gt;English(&lt;span class="caps"&gt;US&lt;/span&gt;)&lt;/tt&gt;输入法，直接使用yong自带的功能切换中英文输入法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;似乎需要关机重启。重启之后，在桌面右上角即出现了中英文输入法的图标。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;需要注意的是，yong的安装其实只是在&lt;tt class="docutils literal"&gt;/usr/bin&lt;/tt&gt;下建立了两个软链接&lt;tt class="docutils literal"&gt;yong&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;yong-config&lt;/span&gt;&lt;/tt&gt;，并且在&lt;tt class="docutils literal"&gt;${&lt;span class="caps"&gt;HOME&lt;/span&gt;}&lt;/tt&gt;下建立了文件夹&lt;tt class="docutils literal"&gt;.yong&lt;/tt&gt;，其中包含了yong的配置文件。因而在第二步中解压的yong文件夹不可删除。&lt;/p&gt;
&lt;p&gt;yong的配置文件位于&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.yong/yong.ini&lt;/span&gt;&lt;/tt&gt;，可以根据需要修改，或者也可以直接用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;yong-config&lt;/span&gt;&lt;/tt&gt;命令调出图形界面来修改。&lt;/p&gt;
&lt;p&gt;我的配置如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;输入法状态栏主窗口位于左下角。由于使用了双显示器，默认的窗口位于右下角会使得状态栏位于另一个显示器。（使用过程中发现，在终端全屏的情况下，状态栏位于左下角会挡住部分终端的命令，目前没有合适的解决办法。或许可以考虑顶部居中。）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;在系统输入源中删除英文输入，只留下中文的yong作为唯一输入源。使用默认的&lt;tt class="docutils literal"&gt;Ctrl+LShift&lt;/tt&gt;作为切换输入法的快捷键。中英文切换快捷键设置为&lt;tt class="docutils literal"&gt;Ctrl+Space&lt;/tt&gt;。默认的中英文切换键是&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;LSHIFT&lt;/span&gt;&lt;/tt&gt;，但是由于我习惯使用&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;LSHIFT&lt;/span&gt;+字母&lt;/tt&gt;的方式来临时输入大写字母，所以如果使用&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;LSHIFT&lt;/span&gt;&lt;/tt&gt;进行中英文切换的话很容易导致误操作。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;yong自带了七种输入法，我只有拼音输入法，因而删除其他输入法，只留下pinyin输入法，并设其为默认值；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;小小输入法支持百度、google、微软、QQ和搜狗等云输入法，可以自行配置。配置如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
1=BaiduCloud

[cloud]
name=百度云
engine=libcloud.so
arg=baidu
&lt;/pre&gt;
&lt;p&gt;其他云输入法类似，其中arg可以取baidu、google、qq、sogou、microsoft等（似乎sogou和microsoft都不支持了？）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;默认使用QQ云输入法，特殊情况切换到百度云或谷歌云。由于国内连接的问题，使用谷歌云的时候有很明显的时间延迟，不建议使用。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;yong输入法还支持自定义皮肤或使用别人设计的皮肤，将下载的皮肤文件放在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.yong/skin&lt;/span&gt;&lt;/tt&gt;下即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;一个不太方便的一点是状态栏貌似无法显示当前正在使用的中文输入法是哪一个。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;在配置文件中的&lt;tt class="docutils literal"&gt;[&lt;span class="caps"&gt;IM&lt;/span&gt;]&lt;/tt&gt;里加入&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ABCD&lt;/span&gt;=1&lt;/tt&gt;，这样在中文输入法的情况下按下SHIFT以及字母会直接将相应的大写字母输出出来，不必再经过中文输入法。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;参考:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.mintos.org/software/xiaoxiao-input.html"&gt;http://www.mintos.org/software/xiaoxiao-input.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://yong.dgod.net/read.php?tid=5&amp;amp;fid=7"&gt;http://yong.dgod.net/read.php?tid=5&amp;amp;fid=7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://yong.dgod.net/read.php?tid=25&amp;amp;fid=7"&gt;http://yong.dgod.net/read.php?tid=25&amp;amp;fid=7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://yong.dgod.net/read.php?tid=18&amp;amp;fid=7"&gt;http://yong.dgod.net/read.php?tid=18&amp;amp;fid=7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="CentOS"></category><category term="中文"></category></entry><entry><title>SAC的Bug汇总</title><link href="http://seisman.info/sac-bugs.html" rel="alternate"></link><updated>2014-07-09T10:25:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-07-09:sac-bugs.html</id><summary type="html">
&lt;p&gt;本文收集了在使用SAC时遇到的一些Bug，望SAC用户在使用时一定要当心。需要注意的是，这不是官方Bug列表，仅是我个人在日常使用中发现的问题。&lt;/p&gt;
&lt;div class="section" id="sac-v101-6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt; v101.6&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="sort"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id3"&gt;sort&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Bug描述&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;读入一个或若干个SAC文件后，使用&lt;tt class="docutils literal"&gt;sort&lt;/tt&gt;命令对内存中的文件进行排序，经过&lt;tt class="docutils literal"&gt;sort&lt;/tt&gt;后的文件的台站位置信息丢失。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决办法&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;目前还不清楚产生该Bug的具体原因，解决办法是设置环境变量&lt;tt class="docutils literal"&gt;SAC_USE_DATABASE&lt;/tt&gt;值为0，即:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
export SAC_USE_DATABASE=0
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="sac-v101-6a"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt; v101.6a&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="rtrend"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;rtrend&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Bug描述&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在对等间隔时间数据使用&lt;tt class="docutils literal"&gt;rtrend&lt;/tt&gt;命令时，会调用子函数&lt;tt class="docutils literal"&gt;lifite&lt;/tt&gt;计算数据的最小二乘线性拟合。源码位于&lt;tt class="docutils literal"&gt;sac/src/scm/lifite.c&lt;/tt&gt;中，错误的部分如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="n"&gt;yi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;sumx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;sumy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumy&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;sumxy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumxy&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;sumx2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumx2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;sumy2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumy2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;yi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;解决办法&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;修改代码为：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="n"&gt;yi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt; &lt;span class="c1"&gt;// 少了一对括号&lt;/span&gt;
    &lt;span class="n"&gt;sumx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;sumy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumy&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;sumxy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumxy&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;sumx2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumx2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;sumy2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sumy2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;yi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个Bug导致，当采样间隔dx不为1的情况下，线性拟合得到的截距出现错误，但不影响斜率。最终在被rtrend调用时，生成的波形数据中线性趋势被正确去除，但其均值不为0，这可能会影响到后续数据处理的正确性。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="change"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;字符串函数change&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;字符串函数&lt;tt class="docutils literal"&gt;change&lt;/tt&gt;的标准语法为&lt;tt class="docutils literal"&gt;(cha s1 s2 s3)&lt;/tt&gt;，即在字符串&lt;tt class="docutils literal"&gt;s3&lt;/tt&gt;中用&lt;tt class="docutils literal"&gt;s1&lt;/tt&gt;代替&lt;tt class="docutils literal"&gt;s2&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;正常情况下如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; echo on
SAC&amp;gt; setbb tmp (cha short long "This is short")
 setbb tmp (cha short long "This is short")
 ==&amp;gt;  setbb tmp This is long
&lt;/pre&gt;
&lt;p&gt;当用于替换的字符串&lt;tt class="docutils literal"&gt;s2&lt;/tt&gt;中包含了要被替换的字符串&lt;tt class="docutils literal"&gt;s1&lt;/tt&gt;时，则出现死循环:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; echo on
SAC&amp;gt; setbb tmp (cha cd abcde abcdefg)
 setbb tmp (cha cd abcde abcdefg)
&lt;/pre&gt;
&lt;p&gt;解决办法未知。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;第1000个文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在使用通配符读取某一类SAC文件时，若文件个数超过1000个，则SAC只读取前1000个，并给出警告。但读入内存的1000个文件中，第1000个文件的振幅总是有错误的，这在有些情况下会造成误判。&lt;/p&gt;
&lt;p&gt;解决办法未知。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="Bug"></category></entry><entry><title>USTC网络通登录脚本Python版</title><link href="http://seisman.info/python-ustc-wlt-login.html" rel="alternate"></link><updated>2014-06-15T21:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-06-15:python-ustc-wlt-login.html</id><summary type="html">&lt;p&gt;最近几日在学Python以及相关的网页请求模块，练习着重写了USTC网络通的登录脚本，比之前的Perl版要简短了很多，其中使用了&lt;tt class="docutils literal"&gt;Requests&lt;/tt&gt;模块。&lt;/p&gt;
&lt;p&gt;最新版本位于：&lt;a class="reference external" href="https://gist.github.com/seisman/2d04d52c6415d283dac8"&gt;https://gist.github.com/seisman/2d04d52c6415d283dac8&lt;/a&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# Python Script to login wlt @ USTC&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# Author: Dongdong Tian @ USTC&lt;/span&gt;
&lt;span class="c"&gt;# Date  : 2014/06/15&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;

&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;xxxxxxx&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;passwd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;xxxxxxxxx&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;http://wlt.ustc.edu.cn/cgi-bin/ip&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="s"&gt;请选择出口：&lt;/span&gt;
&lt;span class="s"&gt;        1: 教育网出口(国际,仅用教育网访问,适合看文献)&lt;/span&gt;
&lt;span class="s"&gt;        2: 电信网出口(国际,到教育网走教育网)&lt;/span&gt;
&lt;span class="s"&gt;        3: 联通网出口(国际,到教育网走教育网)&lt;/span&gt;
&lt;span class="s"&gt;        4: 电信网出口2(国际,到教育网免费地址走教育网)&lt;/span&gt;
&lt;span class="s"&gt;        5: 联通网出口2(国际,到教育网免费地址走教育网)&lt;/span&gt;
&lt;span class="s"&gt;        6: 电信网出口3(国际,到教育网走教育网,到联通走联通)&lt;/span&gt;
&lt;span class="s"&gt;        7: 联通网出口3(国际,到教育网走教育网,到电信走电信)&lt;/span&gt;
&lt;span class="s"&gt;        8: 教育网国际出口(国际,国内使用电信和联通,国际使用教育网)&lt;/span&gt;
&lt;span class="s"&gt;        9: 移动测试国际出口(国际,无P2P或带宽限制)&lt;/span&gt;
&lt;span class="s"&gt;注：选择出口2、3无法使用的某些电子资源，使用出口4、5、6可能可以正常使用&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;[1-9] &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;break&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s"&gt;使用时限：&lt;/span&gt;
&lt;span class="s"&gt;        1: 0s, 永久&lt;/span&gt;
&lt;span class="s"&gt;        2: 3600s, 1小时&lt;/span&gt;
&lt;span class="s"&gt;        3: 14400s, 4小时&lt;/span&gt;
&lt;span class="s"&gt;        4: 39600s, 11小时&lt;/span&gt;
&lt;span class="s"&gt;        5: 50400s, 14小时&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;expire&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;     &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;2&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="mi"&gt;3600&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;3&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;14400&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;4&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;39600&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;5&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;50400&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;exp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;[1-6] &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;exp&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;exp&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;exp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;expire&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
        &lt;span class="k"&gt;break&lt;/span&gt;

&lt;span class="n"&gt;payload&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;      &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;set&amp;#39;&lt;/span&gt;  &lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;     &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;   &lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;password&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;passwd&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;type&amp;#39;&lt;/span&gt;     &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;   &lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;exp&amp;#39;&lt;/span&gt;      &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;exp&lt;/span&gt;    &lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;payload&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status_code&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ok&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;request error with status code: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status_code&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;代码就60行左右，其中真正必要的代码才10行。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-06-16：初稿；&lt;/li&gt;
&lt;li&gt;2014-06-24：修改已兼容Python 2.7和Python&amp;nbsp;3.4。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary></entry><entry><title>SAC修改绘图窗口的背景色</title><link href="http://seisman.info/change-background-color-of-window-in-sac.html" rel="alternate"></link><updated>2014-06-15T11:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-06-15:change-background-color-of-window-in-sac.html</id><summary type="html">&lt;p&gt;SAC在绘图时默认使用白色作为背景色、用黑色绘制波形数据。这样的配色对比很明显，看起来也很清晰。&lt;/p&gt;
&lt;p&gt;但是在需要长期查看波形、拾取震相时，黑底白线这种强烈的颜色对比，对眼睛很不友好，经常看着看着就花了。&lt;/p&gt;
&lt;p&gt;SAC的color命令可以修改绘图窗口的背景色。SAC目前只支持几种简单的颜色：red、green、blue、yellow、cyan、magenta、black、white。其中cyan作为背景色是不错的选择。&lt;/p&gt;
&lt;p&gt;因而，在绘图之前，使用color命令将窗口背景色修改为cyan:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
color black background cyan
&lt;/pre&gt;
&lt;p&gt;每次绘图之前都执行这个命令显然比较麻烦，可以设置让SAC在启动时自带执行该命令。&lt;/p&gt;
&lt;p&gt;在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;中加入如下&lt;tt class="docutils literal"&gt;alias&lt;/tt&gt;语句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
alias sac=&amp;quot;${SACHOME}/bin/sac ${SACAUX}/init.m&amp;quot;
&lt;/pre&gt;
&lt;p&gt;并在&lt;tt class="docutils literal"&gt;${&lt;span class="caps"&gt;SACAUX&lt;/span&gt;}&lt;/tt&gt;目录下（一般是&lt;tt class="docutils literal"&gt;/usr/local/sac/aux&lt;/tt&gt;）新建文件&lt;tt class="docutils literal"&gt;init.m&lt;/tt&gt;，其内容为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
color black background cyan
&lt;/pre&gt;
&lt;p&gt;即可。&lt;/p&gt;
</summary><category term="SAC技巧"></category><category term="图像"></category></entry><entry><title>gCAP的安装</title><link href="http://seisman.info/compile-gcap.html" rel="alternate"></link><updated>2015-05-11T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-06-13:compile-gcap.html</id><summary type="html">&lt;p&gt;gCAP是Prof. Lupei&amp;nbsp;Zhu发展的一种反演震源机制解的一种方法。目前该代码已经公开。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;下载gCAP源码&lt;/p&gt;
&lt;p&gt;下载地址： &lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/downloads/gcap1.0.tar"&gt;http://www.eas.slu.edu/People/LZhu/downloads/gcap1.0.tar&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;解压&lt;/p&gt;
&lt;pre class="literal-block"&gt;
tar -xvf gcap1.0.tar
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;清除垃圾文件&lt;/p&gt;
&lt;p&gt;软件包在发布的时候，没有做一些清理，遗留了一些没有用的临时文件，看起来很碍眼。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
rm junk.ps junk.out .gmtcommands
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;下载辅助代码&lt;/p&gt;
&lt;p&gt;gCAP使用了Numerical&amp;nbsp;Recipes（简称NR）中的一些函数，包括matrix、free_matrix、free_convert_matrix、jacobi、eigsrt。由于NR是非开源非免费的软件，所以gCAP并没有将NR相关的代码放在包里。&lt;/p&gt;
&lt;p&gt;网络上可以下载到NR的完整代码，这里仅给出gCAP所需的代码。下载该压缩包，解压，并将解压后的源代码放到gCAP的目录中。&lt;/p&gt;
&lt;p&gt;gCAP_util下载：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/gcap_utils.tar.gz"&gt;http://seisman.qiniudn.com/downloads/gcap_utils.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;新的Makefile&lt;/p&gt;
&lt;p&gt;Makefile的修改幅度稍大，几乎算是重写了。下载之后，将其重命名为&lt;cite&gt;Makefile&lt;/cite&gt;，替换原目录中的同名文件。并根据自身情况修改SACHOME、&lt;span class="caps"&gt;FC&lt;/span&gt;、&lt;span class="caps"&gt;CC&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;Makefile下载地址： &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/Makefile.gCAP"&gt;http://seisman.qiniudn.com/downloads/Makefile.gCAP&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;编译&lt;/p&gt;
&lt;pre class="literal-block"&gt;
make
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;其它&lt;/p&gt;
&lt;p&gt;&lt;cite&gt;cap.pl&lt;/cite&gt;中第15行与第19行包含了两个绝对路径，分别包含了绘图脚本&lt;cite&gt;cap_plt.pl&lt;/cite&gt;和Green函数库&lt;cite&gt;Glib&lt;/cite&gt;的路径，需要根据自身情况修改。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="震源机制解"></category></entry><entry><title>GMT绘制双Y轴</title><link href="http://seisman.info/double-y-axis-plot.html" rel="alternate"></link><updated>2014-06-12T20:20:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-06-12:double-y-axis-plot.html</id><summary type="html">&lt;p&gt;所谓双Y轴，指的是在一张图中同时使用两个完全不同的Y轴。这种类型的图在某些情况下会用到。&lt;/p&gt;
&lt;p&gt;这样一张图的绘制其实很简单，只需要绘制两个basemap即可。第一个basemap只绘制X轴和左Y轴；第二个只绘制右Y轴。&lt;/p&gt;
&lt;p&gt;GMT的-B选项中，WESN分别表示在四个坐标轴上显示坐标轴及标注文字、刻度；小写news表示在四个坐标轴上只显示坐标轴和刻度，不标注文字；若某个坐标轴上没有相关参数，则什么都不画。因而第一个basemap使用SW，第二个basemap使用E。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="double-Y-axis-plot" src="/images/2014061201.jpg" style="width: 800px;" /&gt;
&lt;/div&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;Rx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10
&lt;span class="nv"&gt;R1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$Rx&lt;/span&gt;/0/1000
&lt;span class="nv"&gt;R2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$Rx&lt;/span&gt;/0/1
&lt;span class="nv"&gt;Jx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;15c
&lt;span class="nv"&gt;J1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X&lt;span class="nv"&gt;$Jx&lt;/span&gt;/10c
&lt;span class="nv"&gt;J2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X&lt;span class="nv"&gt;$Jx&lt;/span&gt;/6c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;doubleAxis.ps

&lt;span class="c"&gt;# 写入PS头，这里的J和R可以任意&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J1&lt;/span&gt; -R&lt;span class="nv"&gt;$R1&lt;/span&gt; -T -K -Xc -Yc &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制左Y轴&lt;/span&gt;
psbasemap -J&lt;span class="nv"&gt;$J1&lt;/span&gt; -R&lt;span class="nv"&gt;$R1&lt;/span&gt; -Ba2f1:X:/a100f50:&lt;span class="s2"&gt;&amp;quot;Left   Y&amp;quot;&lt;/span&gt;:WS -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制一堆与左Y轴相关的数据&lt;/span&gt;
&lt;span class="c"&gt;# ...&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J1&lt;/span&gt; -R&lt;span class="nv"&gt;$R1&lt;/span&gt; -Sc0.2c -Gred -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;span class="s"&gt;1 100&lt;/span&gt;
&lt;span class="s"&gt;3 300&lt;/span&gt;
&lt;span class="s"&gt;5 500&lt;/span&gt;
&lt;span class="s"&gt;7 700&lt;/span&gt;
&lt;span class="s"&gt;9 800&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="c"&gt;# 绘制右Y轴&lt;/span&gt;
psbasemap -J&lt;span class="nv"&gt;$J2&lt;/span&gt; -R&lt;span class="nv"&gt;$R2&lt;/span&gt; -Ba2f1/a0.2f0.1:&lt;span class="s2"&gt;&amp;quot;Right    Y&amp;quot;&lt;/span&gt;:E -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制一堆与右Y轴相关的数据&lt;/span&gt;
&lt;span class="c"&gt;# ...&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J2&lt;/span&gt; -R&lt;span class="nv"&gt;$R2&lt;/span&gt; -Sa0.2c -Gblue -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;span class="s"&gt;1 0.5&lt;/span&gt;
&lt;span class="s"&gt;3 0.3&lt;/span&gt;
&lt;span class="s"&gt;5 0.7&lt;/span&gt;
&lt;span class="s"&gt;7 0.2&lt;/span&gt;
&lt;span class="s"&gt;9 0.6&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="c"&gt;# 写入PS尾，这里的J和R可以任意&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J1&lt;/span&gt; -R&lt;span class="nv"&gt;$R1&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="GMT4"></category></entry><entry><title>New Manual of Seismological Observatory Practice</title><link href="http://seisman.info/nmsop.html" rel="alternate"></link><updated>2014-06-05T21:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-06-05:nmsop.html</id><summary type="html">&lt;p&gt;虽然我还没有来得及细看，但是我觉得这是一本真正意义上的好书。这本书讲述了地震学中一些非常基础的知识，基础到目前的大多数地震学教材中都不会提的知识。个人认为，了解这些极其基础的知识非常重要。&lt;/p&gt;
&lt;p&gt;本书的第一个版本出版于1979年；2002年发布了新版本，2009年进行了少许更新并实现了网页版；2002年的版本后来被翻译成中文，即《地震观测实践手册》，但中译本翻译质量一般，不建议阅读。&lt;/p&gt;
&lt;p&gt;这里给出的是2012年发布的最新版。&lt;/p&gt;
&lt;p&gt;目录：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;History, Aim and&amp;nbsp;Scope&lt;/li&gt;
&lt;li&gt;Seismic Wave Propagation and Earth&amp;nbsp;Models&lt;/li&gt;
&lt;li&gt;Seismic Sources and Source&amp;nbsp;Parameters&lt;/li&gt;
&lt;li&gt;Seismic Signals and&amp;nbsp;Noise&lt;/li&gt;
&lt;li&gt;Seismic Sensors and their&amp;nbsp;Calibration&lt;/li&gt;
&lt;li&gt;Seismic Data Acquisition&amp;nbsp;Systems&lt;/li&gt;
&lt;li&gt;Site Selection, Preparation and Installation of Seismic&amp;nbsp;Stations&lt;/li&gt;
&lt;li&gt;Seismic&amp;nbsp;Networks&lt;/li&gt;
&lt;li&gt;Seismic&amp;nbsp;Arrays&lt;/li&gt;
&lt;li&gt;Seismic Data Formats, Archival and&amp;nbsp;Exchange&lt;/li&gt;
&lt;li&gt;Data Analysis and Seismogram&amp;nbsp;Interpretation&lt;/li&gt;
&lt;li&gt;Intensity and Intensity&amp;nbsp;Scales&lt;/li&gt;
&lt;li&gt;Volcano&amp;nbsp;Seismology&lt;/li&gt;
&lt;li&gt;Investigation of Site Response in Urban Areas by using Earthquake Data and Seismic&amp;nbsp;Noise&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;CTBTO&lt;/span&gt;: Goal, Networks, Data Analysis and Data&amp;nbsp;Availability&lt;/li&gt;
&lt;li&gt;Automated Event and Phase&amp;nbsp;Identification&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;官方网站：&lt;a class="reference external" href="http://bib.telegrafenberg.de/en/publishing/distribution/nmsop/"&gt;http://bib.telegrafenberg.de/en/publishing/distribution/nmsop/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;官方的电子版是每个章节一个单独的文件，每个章节都会不定期更新。我将所有PDF下载下来，合并成了一个PDF文件，并加入了简单的书签。整本书合计2200页以上，大小约100MB。&lt;/p&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://pan.baidu.com/s/1gdkT0SN"&gt;http://pan.baidu.com/s/1gdkT0SN&lt;/a&gt;&lt;/p&gt;
</summary><category term="书籍"></category></entry><entry><title>二维柱坐标系下交错网格的绘制</title><link href="http://seisman.info/plot-staggered-grid-of-2d-cylindrical-coordinate-system.html" rel="alternate"></link><updated>2014-06-04T20:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-06-04:plot-staggered-grid-of-2d-cylindrical-coordinate-system.html</id><summary type="html">
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这篇博文给出了一个利用GMT绘制示意图的实例。该实例由王桥完成并投稿至本博客。总的来说，该图看上去画起来不难，实际在画的过程中还是需要经过一些设计的。这其中也涉及到一些具体的处理技巧。其实GMT并不是特别适合绘制这种示意图，但是目前没有想到更高效且精确的绘图方法。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;背景介绍&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在柱坐标系&lt;span class="math"&gt;\((r,\theta,z)\)&lt;/span&gt;中，若假定所有的物理场在z方向均保存不变，则P-SV系统的一阶速度-应力形式的波动方程可以表示如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="momentum conservation" src="/images/2014060401.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;div class="figure"&gt;
&lt;img alt="constitutive relations" src="/images/2014060402.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;p&gt;将这样的一组方程进行离散，很容易通过有限差分方法进行波场的模拟。对于有限差分方法，一般有同位网格和交错网格两种网格布局，目前最常用的应该是交错网格布局。关于交错网格布局最早的两篇文章是Virieux于1984和1986年于Geophysics上发表，分别介绍了笛卡尔坐标系下SH系统和P-SV系统的波动方程如何使用交错网格布局。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;绘图效果&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;想要绘制如下交错网格布局：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="staggered-grid-layout" src="/images/2014060403.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;绘图脚本&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;脚本如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/sh&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/0/1.2
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;P6i
&lt;span class="nv"&gt;S1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;t0.45    &lt;span class="c"&gt;# 三角&lt;/span&gt;
&lt;span class="nv"&gt;S2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;c0.4     &lt;span class="c"&gt;# 圆&lt;/span&gt;
&lt;span class="nv"&gt;S3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;s0.5     &lt;span class="c"&gt;# 方&lt;/span&gt;
&lt;span class="nv"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1p,0/0/0  &lt;span class="c"&gt;# black&lt;/span&gt;
&lt;span class="nv"&gt;W1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1p,255/0/0   &lt;span class="c"&gt;# red&lt;/span&gt;
&lt;span class="nv"&gt;G1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;black
&lt;span class="nv"&gt;G2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;white
&lt;span class="nv"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;PSVpolar.ps
&lt;span class="nv"&gt;indata&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;circle.dat

gmtmath -T0/360/1 -N1 &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$indata&lt;/span&gt;

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#画不同半径的圆弧&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; r in  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
&lt;span class="k"&gt;do&lt;/span&gt;
awk -v &lt;span class="nv"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$r&lt;/span&gt; &lt;span class="s1"&gt;'$1&amp;lt;=45 {print $1,r}'&lt;/span&gt; &lt;span class="nv"&gt;$indata&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt;  -W&lt;span class="nv"&gt;$W&lt;/span&gt;  -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;
awk -v &lt;span class="nv"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$r&lt;/span&gt; &lt;span class="s1"&gt;'$1&amp;gt;=90 &amp;amp;&amp;amp; $1&amp;lt;=135 {print $1,r}'&lt;/span&gt; &lt;span class="nv"&gt;$indata&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -J -W&lt;span class="nv"&gt;$W&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;
awk -v &lt;span class="nv"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$r&lt;/span&gt; &lt;span class="s1"&gt;'$1&amp;gt;=180 &amp;amp;&amp;amp; $1&amp;lt;=225 {print $1,r}'&lt;/span&gt; &lt;span class="nv"&gt;$indata&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -J -W&lt;span class="nv"&gt;$W&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;
awk -v &lt;span class="nv"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$r&lt;/span&gt; &lt;span class="s1"&gt;'$1&amp;gt;=270 &amp;amp;&amp;amp; $1&amp;lt;=315 {print $1,r}'&lt;/span&gt; &lt;span class="nv"&gt;$indata&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -J -W&lt;span class="nv"&gt;$W&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;

&lt;span class="c"&gt;#突显某个半径的弧度&lt;/span&gt;
awk &lt;span class="s1"&gt;'$1&amp;lt;=45 {print $1,0.5}'&lt;/span&gt; &lt;span class="nv"&gt;$indata&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -J -W&lt;span class="nv"&gt;$W1&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;
awk &lt;span class="s1"&gt;'$1&amp;lt;=45 {print $1,0.6}'&lt;/span&gt; &lt;span class="nv"&gt;$indata&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -J -W&lt;span class="nv"&gt;$W1&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;

&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#画半径&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; theta in &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;45&lt;/span&gt; &lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;135&lt;/span&gt; &lt;span class="m"&gt;180&lt;/span&gt; &lt;span class="m"&gt;225&lt;/span&gt; &lt;span class="m"&gt;270&lt;/span&gt; 315&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; r in 0.1 0.3 0.5 0.7 0.9&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nv"&gt;r1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;awk -v &lt;span class="nv"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$r&lt;/span&gt; &lt;span class="s1"&gt;'BEGIN{ printf("%0.1f", r+0.1);}'&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
psxy  -R -J  -W&lt;span class="nv"&gt;$W&lt;/span&gt; -N -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;$theta $r&lt;/span&gt;
&lt;span class="s"&gt;$theta $r1&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;

&lt;span class="c"&gt;#突显某个半径&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; theta in &lt;span class="m"&gt;0&lt;/span&gt; 45&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; r in 0.5&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nv"&gt;r1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;awk -v &lt;span class="nv"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$r&lt;/span&gt; &lt;span class="s1"&gt;'BEGIN{ printf("%0.1f", r+0.1);}'&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
psxy -R -J -W&lt;span class="nv"&gt;$W1&lt;/span&gt; -N -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;$theta $r&lt;/span&gt;
&lt;span class="s"&gt;$theta $r1&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;

&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;# Plot shadow&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; angle in &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt; &lt;span class="m"&gt;15&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="m"&gt;25&lt;/span&gt; &lt;span class="m"&gt;30&lt;/span&gt; &lt;span class="m"&gt;35&lt;/span&gt; 40&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nv"&gt;a1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;awk -v &lt;span class="nv"&gt;angle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$angle&lt;/span&gt; &lt;span class="s1"&gt;'BEGIN{printf("%0.1f",angle-0.1);}'&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="nv"&gt;a2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;awk -v &lt;span class="nv"&gt;angle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$angle&lt;/span&gt; &lt;span class="s1"&gt;'BEGIN{printf("%0.1f",angle+5);}'&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
psxy -J -R  -Gred -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;$a1  0.5&lt;/span&gt;
&lt;span class="s"&gt;$a1  0.6&lt;/span&gt;
&lt;span class="s"&gt;$a2  0.6&lt;/span&gt;
&lt;span class="s"&gt;$a2  0.5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;

&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;# Plot Symbols&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;#白色三角形&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; r in 0.1 0.3 0.5 0.7 0.9&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
psxy -R -J -S&lt;span class="nv"&gt;$S1&lt;/span&gt; -W&lt;span class="nv"&gt;$W&lt;/span&gt; -G&lt;span class="nv"&gt;$G2&lt;/span&gt; -K -O   &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0 $r&lt;/span&gt;
&lt;span class="s"&gt;90 $r&lt;/span&gt;
&lt;span class="s"&gt;180 $r&lt;/span&gt;
&lt;span class="s"&gt;270 $r&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;

&lt;span class="c"&gt;#白色圆圈&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; r in 0.2 0.4 0.6 0.8 1&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
psxy -R -J -S&lt;span class="nv"&gt;$S2&lt;/span&gt; -W&lt;span class="nv"&gt;$W&lt;/span&gt; -G&lt;span class="nv"&gt;$G2&lt;/span&gt;  -N -K -O  &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;45 $r&lt;/span&gt;
&lt;span class="s"&gt;135 $r&lt;/span&gt;
&lt;span class="s"&gt;225 $r&lt;/span&gt;
&lt;span class="s"&gt;315 $r&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="c"&gt;#黑色方块&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; r in 0.2 0.4 0.6 0.8 1&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
psxy -R -J -S&lt;span class="nv"&gt;$S3&lt;/span&gt; -W -G&lt;span class="nv"&gt;$G1&lt;/span&gt;  -N -K -O  &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0 $r&lt;/span&gt;
&lt;span class="s"&gt;90 $r&lt;/span&gt;
&lt;span class="s"&gt;180 $r&lt;/span&gt;
&lt;span class="s"&gt;270 $r&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="c"&gt;#黑色实心圆&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; r in 0.1 0.3 0.5 0.7 0.9&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
psxy -R -J -S&lt;span class="nv"&gt;$S2&lt;/span&gt; -W -G&lt;span class="nv"&gt;$G1&lt;/span&gt;  -N -K -O  &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;45 $r&lt;/span&gt;
&lt;span class="s"&gt;135 $r&lt;/span&gt;
&lt;span class="s"&gt;225 $r&lt;/span&gt;
&lt;span class="s"&gt;315 $r&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;

&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;# 添加图例&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-1/1/-1/1
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6i
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -S&lt;span class="nv"&gt;$S3&lt;/span&gt; -W&lt;span class="nv"&gt;$W&lt;/span&gt; -G&lt;span class="nv"&gt;$G1&lt;/span&gt; -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.4 -0.16&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -R -J -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.45 -0.17 15 0  4  BL @%6%v@%12%@-q&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psxy -R -J -S&lt;span class="nv"&gt;$S2&lt;/span&gt; -W&lt;span class="nv"&gt;$W&lt;/span&gt; -G&lt;span class="nv"&gt;$G1&lt;/span&gt; -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.65 -0.16&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -R -J -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.7 -0.17 15 0  4  BL @%6%v@%6%@-r&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psxy -R -JX -S&lt;span class="nv"&gt;$S1&lt;/span&gt; -W&lt;span class="nv"&gt;$W&lt;/span&gt; -G&lt;span class="nv"&gt;$G2&lt;/span&gt; -K -O   &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.4 -0.26&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -R -J -K  -O   &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.45 -0.27 15 0 4 BL @%12%\163@%6%@-r@%12%q&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psxy -R -J -S&lt;span class="nv"&gt;$S2&lt;/span&gt; -W&lt;span class="nv"&gt;$W&lt;/span&gt; -G&lt;span class="nv"&gt;$G2&lt;/span&gt;  -N -K -O  &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.65 -0.26&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -R -J -K  -O   &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.7 -0.27 15 0 4 BL @%12%\163@%6%@-rr\040@-,@-\040@-@%12%\163@-qq&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
psxy -R -J -W&lt;span class="nv"&gt;$W&lt;/span&gt; -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.35 -0.12&lt;/span&gt;
&lt;span class="s"&gt;0.35 -0.3&lt;/span&gt;
&lt;span class="s"&gt;0.95 -0.3&lt;/span&gt;
&lt;span class="s"&gt;0.95 -0.12&lt;/span&gt;
&lt;span class="s"&gt;0.35 -0.12&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;# Plot Arrows&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
gmtset VECTOR_SHAPE 1
psxy -R -J -W&lt;span class="nv"&gt;$W&lt;/span&gt; -G&lt;span class="nv"&gt;$G1&lt;/span&gt; -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.25 -0.05&lt;/span&gt;
&lt;span class="s"&gt;0.81  -0.05&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -R -J -K  -O   &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.8 -0.06 7 0 34 BL \344&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -R -J -K  -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.5 -0.1 15 0 6 BL r@%4%(@%%j@%4%)&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
psxy -R-1/1/-1/1 -J -Sml14c -W&lt;span class="nv"&gt;$W&lt;/span&gt; -K  -O   &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0 0  0  40&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -R -J -N -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $fig&lt;/span&gt;
&lt;span class="s"&gt;0.87 0.3 15 0 12 BL q@%4%(@%6%i@%%)&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$fig&lt;/span&gt;

&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;# Remove useless data or files&lt;/span&gt;
&lt;span class="c"&gt;#&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
rm &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;indata&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;代码说明&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;先按照seisman建议的GMT代码风格定义变量&lt;/li&gt;
&lt;li&gt;gmtmath生成1到360间隔为1的一列数据&lt;/li&gt;
&lt;li&gt;通过循环绘制不同半径的圆弧以及半径。其中涉及到在awk里面使用bash变量的问题，这里使用&lt;cite&gt;-v&lt;/cite&gt;选项将bash的变量传递给awk。&lt;/li&gt;
&lt;li&gt;最有意思的是绘制红色阴影部分。由于是极坐标-&lt;span class="caps"&gt;JP&lt;/span&gt;, 所以我用了9段矩形，每段5度填充了45度的一个弧形区域。如果在GMT5.1里面用透明-t60的话，可以看出有一小部分重叠的区域。GMT4里没有透明，就掩盖了重叠的部分。&lt;/li&gt;
&lt;li&gt;画图例时改用了直角坐标-&lt;span class="caps"&gt;JX&lt;/span&gt;. 特别之处在于应力分量的希腊字母不能用简体。想到的一个解决办法是将它旋转负15度，试过了，非常麻烦。&lt;/li&gt;
&lt;li&gt;画坐标弧形箭头的时候，seisman给出了解决方法：使用-Sm选项。对于直线箭头，默认的我认为不是很好看，就用了34号字体里面344号箭头加上一个直线组合起来的。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;致谢&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;画图我用MATALAB用得比较多，都是一些简单的图，还没有涉及到地图、地形图等。直到前年，要用到地图，从我一个统计地震学师弟JK那里学到了GMT作图。从那以后，都是麻烦师弟JK帮忙。我给他描述图件，他给我写一个GMT画图的开头和底板，然后我在上面修改，中间不停地问他命令，都快把他弄烦了。这张图也不例外。借此机会多谢JK师弟了。非常感谢seisman的博客内容，非常好，我几乎都看完了，给我非常在的帮助。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-05-27：王桥投稿；&lt;/li&gt;
&lt;li&gt;2014-06-05：SeisMan对部分代码进行简化；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT脚本"></category></entry><entry><title>等震中距线的绘制</title><link href="http://seisman.info/plot-equal-distance-lines.html" rel="alternate"></link><updated>2015-02-26T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-21:plot-equal-distance-lines.html</id><summary type="html">
&lt;p&gt;这里给出两个绘制等震中距线的方法，两种方法各有利弊，按需选取。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;等值线法&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# This script works for GMT 4.5.13 only!&lt;/span&gt;
&lt;span class="c"&gt;# You need to modify it if you use other versions of GMT.&lt;/span&gt;
&lt;span class="c"&gt;# You should read notes below before you go.&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;g
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;H25c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps
&lt;span class="nv"&gt;evlo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;160
&lt;span class="nv"&gt;evla&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;20

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="c"&gt;# 绘制底图&lt;/span&gt;
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Dc -A10000 -Glightblue -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="c"&gt;# 绘制震中位置&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$evlo&lt;/span&gt; &lt;span class="nv"&gt;$evla&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Sa1c -Gred -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 计算全球每点到震中的距离&lt;/span&gt;
gmtset ELLIPSOID Sphere
grdmath -R&lt;span class="nv"&gt;$R&lt;/span&gt; -I1 &lt;span class="nv"&gt;$evlo&lt;/span&gt; &lt;span class="nv"&gt;$evla&lt;/span&gt; SDIST &lt;span class="nv"&gt;KM2DEG&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; dist.nc
&lt;span class="c"&gt;# 绘制等值线&lt;/span&gt;
grdcontour dist.nc -J&lt;span class="nv"&gt;$J&lt;/span&gt; -A15 -L0/60 -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

rm dist.nc
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;grdmath命令首先将全球（-Rg）划分为间隔为1度（-I1）的网格，并计算每个网格点到固定点evlo、evla的距离（单位为km），然后将KM转换为度。则最终生成的dist.nc中包含了每个网格点到固定点的距离。最好使用grdcontour命令绘制等值线，即等震中距线。grdcontour命令的众多选项可以对具体的等值线效果做微调。&lt;/p&gt;
&lt;p&gt;对grdmath的若干说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 4.5.11及之前的版本中，SDIST的返回值单位为度；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 4.5.12及之后的版本中，SDIST的返回值单位为km；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 5中，SDIST的返回值单位为km；&lt;/li&gt;
&lt;li&gt;从GMT 4.5.12开始，新增了KM2DEG操作，但4.5.12版本的KM2DEG有问题；&lt;/li&gt;
&lt;li&gt;KM2DEG操作仅适用于球状地球，因而要设置ELLIPSOID为Sphere；&lt;/li&gt;
&lt;li&gt;KM2DEG近似等效于&lt;tt class="docutils literal"&gt;111.19 &lt;span class="caps"&gt;DIV&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="figure"&gt;
&lt;img alt="equal-distance-with-contour" src="/images/2014052101.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;椭圆法&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;g
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;H25c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map2.ps
&lt;span class="nv"&gt;evlo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;160
&lt;span class="nv"&gt;evla&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;20

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Dc -A10000 -Glightblue -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$evlo&lt;/span&gt; &lt;span class="nv"&gt;$evla&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Sa1c -Gred -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 15度等值线&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$evlo&lt;/span&gt; &lt;span class="nv"&gt;$evla&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; 3335.8 3335.8 &lt;span class="p"&gt;|&lt;/span&gt; psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -SE -K -O -W1p,red &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="c"&gt;# 37.5度等值线&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$evlo&lt;/span&gt; &lt;span class="nv"&gt;$evla&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; 8339.6 8339.6 &lt;span class="p"&gt;|&lt;/span&gt; psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -SE -K -O -W1p,blue &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;该方法使用了&lt;tt class="docutils literal"&gt;psxy&lt;/tt&gt;的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&lt;span class="caps"&gt;SE&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;选项。-SE本是用于绘制椭圆的，这里被用来绘制圆以表示等震中距线。&lt;/p&gt;
&lt;p&gt;该命令需要的输入数据有5个，分别是椭圆的中心经度、中心纬度、短轴的方位角、短轴长度（km）、长轴长度（km）。此处另短轴长度与长轴长度相等，即得到特殊的椭圆—-圆。&lt;/p&gt;
&lt;p&gt;想要绘制一条震中距为15度的等震中距线，需要注意如下几点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;对于圆来说，其长轴=短轴=直径=30度；&lt;/li&gt;
&lt;li&gt;长轴和短轴的单位是km，因而需要将震中距乘以111.19转换为km。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="figure"&gt;
&lt;img alt="equal-distance-with-ellipses" src="/images/2014052102.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-05-21：初稿；&lt;/li&gt;
&lt;li&gt;2015-02-26：grdmath在不同GMT版本下表现不同；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT脚本"></category></entry><entry><title>地球模型数据</title><link href="http://seisman.info/earth-models.html" rel="alternate"></link><updated>2014-05-19T13:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-19:earth-models.html</id><summary type="html">&lt;p&gt;地球的速度结构究竟怎样，谁也不知道，所以就有不同作者提出了不同的地球模型。&lt;/p&gt;
&lt;p&gt;IRIS的&lt;a class="reference external" href="http://www.iris.edu/dms/products/emc/"&gt;&lt;span class="caps"&gt;EMC&lt;/span&gt;&lt;/a&gt;（Model Earth Model&amp;nbsp;Collaboration）收集了很多地球一维和三维模型。&lt;/p&gt;
&lt;p&gt;用户可以在&lt;a class="reference external" href="http://www.iris.edu/spud/earthmodel"&gt;&lt;span class="caps"&gt;SPUD&lt;/span&gt;&lt;/a&gt;上搜索需要的地球模型，查看模型的具体信息，下载模型数据。&lt;/p&gt;
&lt;p&gt;同时还提供了几个在线的绘图工具，以绘制不同模型的不同切面，使得用户在数据下载前更直观地看到模型的细节。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Horizontal&amp;nbsp;Slice&lt;/li&gt;
&lt;li&gt;Slice&amp;nbsp;Stack&lt;/li&gt;
&lt;li&gt;Generalized&amp;nbsp;X-section&lt;/li&gt;
&lt;li&gt;Cross-section&amp;nbsp;Stack&lt;/li&gt;
&lt;li&gt;Velocity&amp;nbsp;Trend&lt;/li&gt;
&lt;li&gt;Depth&amp;nbsp;Profile&lt;/li&gt;
&lt;li&gt;Desktop&amp;nbsp;Tools&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;相关链接:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.iris.edu/dms/products/emc/"&gt;http://www.iris.edu/dms/products/emc/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.iris.edu/dms/products/emc-referencemodels/"&gt;http://www.iris.edu/dms/products/emc-referencemodels/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.iris.edu/dms/products/emc-earthmodels/"&gt;http://www.iris.edu/dms/products/emc-earthmodels/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.iris.edu/spud/earthmodel/"&gt;http://www.iris.edu/spud/earthmodel/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="参考模型"></category><category term="IRIS"></category></entry><entry><title>板块边界数据集</title><link href="http://seisman.info/plate-boundary-datasets.html" rel="alternate"></link><updated>2014-05-18T10:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-18:plate-boundary-datasets.html</id><summary type="html">
&lt;div class="section" id="nuvel"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;NUVEL板块边界数据&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://jules.unavco.org/GMT/"&gt;http://jules.unavco.org/&lt;span class="caps"&gt;GMT&lt;/span&gt;/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;该数据集包含了15个主要的板块边界数据。其中：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;nuvel_1_plates.orig&lt;/tt&gt;：最原始的数据，来自于NUVEL-1A包；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;nuvel_1_plates&lt;/tt&gt;：在原始数据的基础上修正了一些小的错误；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;plate-name&amp;gt;_plate&lt;/span&gt;&lt;/tt&gt;：给出了板块plate-name与其它板块的分界线，即多段数据。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;plate-name&amp;gt;.txt&lt;/span&gt;&lt;/tt&gt;：给出了板块plate-name的轮廓，即相当于将&amp;lt;plate-name&amp;gt;_plate的数据进行整理使其成为一个封闭的曲线。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因而&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;plate-name&amp;gt;_plate&lt;/span&gt;&lt;/tt&gt;文件中包含了最丰富的信息。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：数据文件中似乎是多段数据，以&lt;tt class="docutils literal"&gt;:&lt;/tt&gt;作为每段分割标识，似乎在绘图时应该使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-m:&lt;/span&gt;&lt;/tt&gt;选项，但实际上不使用也可以正常绘制（&lt;span class="caps"&gt;GMT&lt;/span&gt; 4.5.12），不确定其它版本是否需要&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-m:&lt;/span&gt;&lt;/tt&gt;选项。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;绘制全部边界&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;g
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;W20c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;plate.ps

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Glightblue -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy nuvel_1_plates -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -W1p,red -m: -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="nuvel-plate-boundary" src="/images/2014051801.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;绘制单个板块轮廓&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;以绘制太平洋板块为例，将上面的脚本中&lt;tt class="docutils literal"&gt;nuvel_1_plates&lt;/tt&gt;修改为&lt;tt class="docutils literal"&gt;Pacific.txt&lt;/tt&gt;即可。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Pacific-plate-boundary" src="/images/2014051802.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="pb2003"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;PB2003板块数据集&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该数据集在NUVEL数据的基础上加入了38个更小的板块。&lt;/p&gt;
&lt;p&gt;主页：&lt;a class="reference external" href="http://peterbird.name/publications/2003_PB2002/2003_PB2002.htm"&gt;http://peterbird.name/publications/2003_PB2002/2003_PB2002.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://peterbird.name/oldFTP/PB2002/"&gt;http://peterbird.name/oldFTP/&lt;span class="caps"&gt;PB2002&lt;/span&gt;/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其包含如下数据：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;PB2002_boundaries.dig：给出了每两个相邻板块的交界数据；&lt;/li&gt;
&lt;li&gt;PB2002_plates.dig：给出每个板块的边界数据；&lt;/li&gt;
&lt;li&gt;PB2002_orogens.dig：造山带边界数据；&lt;/li&gt;
&lt;li&gt;PB2002_steps.dat：两个相邻板块交界处任一点的信息，包括边界类型，运动速度等信息。数据较复杂，需要仔细研究才能知道每列的含义。&lt;/li&gt;
&lt;li&gt;PB2002_poles.dat：每个板块的Poles。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：前三个数据都是多段数据，而且其数据格式相对来说也很复杂。直观上看似乎需要对数据先做一些格式上的转换才能使用GMT进行绘图，但实际操作中（&lt;span class="caps"&gt;GMT4&lt;/span&gt;.5.12），使用上面的脚本即可绘图，无法保证在其它版本也可行。&lt;/p&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;绘图&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;板块边界图（使用PB2002_boundaries.dig或PB2002_plates.dig均可）&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="pb2002-boundary" src="/images/2014051803.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;造山带边界&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="PB2002_orogens" src="/images/2014051804.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;板块边界与洋壳年龄&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;将边界数据与洋壳年龄放在一起：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;d
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;W20c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;age.ps
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
grdimage -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Cage.cpt age.3.6.nc2 -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Glightblue -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy PB2002_boundaries.dig.txt -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -W1p,black -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psscale -Ba20 -Cage.cpt -D10.5c/-1c/15c/.35ch -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="plate-boundary-and-ocean-age" src="/images/2014051805.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="板块"></category><category term="数据"></category></entry><entry><title>洋壳年龄数据</title><link href="http://seisman.info/images-of-crustal-age-of-the-ocean-floor.html" rel="alternate"></link><updated>2014-05-17T22:05:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-17:images-of-crustal-age-of-the-ocean-floor.html</id><summary type="html">&lt;div class="section" id="id2"&gt;
&lt;h2&gt;简介&lt;/h2&gt;
&lt;p&gt;官方网站：&lt;a class="reference external" href="http://www.earthbyte.org/Resources/agegrid2008.html"&gt;http://www.earthbyte.org/Resources/agegrid2008.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;该数据集包含四类数据：洋壳年龄（age）、年龄不确定度（ageerror）、扩张速度（rate）、扩张非对称性（asym）。数据最高精度为2弧分。&lt;/p&gt;
&lt;p&gt;数据下载地址：&lt;a class="reference external" href="ftp://ftp.earthbyte.org/earthbyte/agegrid/2008/Grids/"&gt;ftp://ftp.earthbyte.org/earthbyte/agegrid/2008/Grids/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;数据文件名的命名方式为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
数据类型.数据版本.数据分辨率.数据格式.bz2
&lt;/pre&gt;
&lt;p&gt;比如&lt;tt class="docutils literal"&gt;age.3.2.nc.bz2&lt;/tt&gt;表示洋壳年龄数据，版本号为3，数据精度为2弧分，格式为netCDF格式。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;数据的使用&lt;/h2&gt;
&lt;p&gt;官方提供了三种格式的数据，img格式、netCDF格式以及XYZ格式。综合各种情况，这里只用netCDF格式，其它格式的使用请参考&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;README&lt;/span&gt;.txt&lt;/tt&gt;。&lt;/p&gt;
&lt;div class="section" id="netcdf"&gt;
&lt;h3&gt;netCDF格式&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;短整型netCDF格式&lt;/li&gt;
&lt;li&gt;年龄单位为百万年，扩展速率单位为mm/yr。并对数据乘以100以使得其可以用短整型保存。&lt;/li&gt;
&lt;li&gt;经度范围为0到360度，纬度范围为-90到90。&lt;/li&gt;
&lt;li&gt;数据精度为2弧分；&lt;/li&gt;
&lt;li&gt;网格线配准&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;数据解压&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
bzip2 -d age.3.2.nc.bz2
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;数据转换&lt;/h3&gt;
&lt;p&gt;由于真实数据被乘以100以使得数据可以用短整型表示，所以在使用之前要将数据乘以因子0.01。可以通过如下命令进行转换:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
grdmath age.3.2.nc=ns 0.01 MUL = age.3.2.nc2=nf -V
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;绘图&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;d
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;W20c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;age.ps
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
grdimage -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Cage.cpt age.3.2.nc2 -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Glightblue -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psscale -Ba20 -Cage.cpt -D10.5c/-1c/15c/.35ch -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;绘图效果&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="crustal-age-of-ocean-floor" src="/images/2014051701.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="网格"></category><category term="GMT5"></category><category term="GMT4"></category></entry><entry><title>Python科学计算发行版—Anaconda</title><link href="http://seisman.info/anaconda-scientific-python-distribution.html" rel="alternate"></link><updated>2014-05-14T13:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-14:anaconda-scientific-python-distribution.html</id><summary type="html">&lt;p&gt;Python是一种强大的编程语言，其提供了很多用于科学计算的模块，常见的包括numpy、scipy和matplotlib。要利用Python进行科学计算，就需要一一安装所需的模块，而这些模块可能又依赖于其它的软件包或库，因而安装和使用起来相对麻烦。幸好有人专门在做这一类事情，将科学计算所需要的模块都编译好，然后打包以发行版的形式供用户使用，Anaconda就是其中一个常用的科学计算发行版。&lt;/p&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="https://store.continuum.io/cshop/anaconda/"&gt;https://store.continuum.io/cshop/anaconda/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Anaconda的特点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;包含了众多流行的科学、数学、工程、数据分析的Python包 &lt;a class="reference external" href="http://docs.continuum.io/anaconda/pkgs.html"&gt;http://docs.continuum.io/anaconda/pkgs.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;完全开源和免费&lt;/li&gt;
&lt;li&gt;额外的加速、优化是收费的，但对于学术用途可以申请免费的License&lt;/li&gt;
&lt;li&gt;全平台支持：Linux、Windows、Mac&lt;/li&gt;
&lt;li&gt;支持Python&amp;nbsp;2.6、2.7、3.3、3.4，可自由切换&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;安装&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;安装pyenv&lt;/p&gt;
&lt;p&gt;安装anaconda之后，系统内就会存在两个版本的Python：anaconda以及系统自带的Python。&lt;/p&gt;
&lt;p&gt;为了保证两个Python版本之间不相互干扰，需要使用专门的工具来管理多个Python版本。这里选择的工具是pyenv。&lt;/p&gt;
&lt;p&gt;pyenv的安装可以参考《&lt;a class="reference external" href="/Python/2013-10-04_python-pyenv.rst"&gt;Python多版本共存之pyenv&lt;/a&gt;》。&lt;/p&gt;
&lt;p&gt;当然，也可以不使用pyenv，而直接从其官方网站下载： &lt;a class="reference external" href="http://continuum.io/downloads"&gt;http://continuum.io/downloads&lt;/a&gt;&amp;nbsp;。此时用户需自行承担可能的版本冲突。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装anaconda&lt;/p&gt;
&lt;p&gt;Anaconda支持Python 2和Python 3，但二者是分开的，用户需要自己选择使用Python 2还是Python&amp;nbsp;3。当然，借助于pyenv的版本管理功能，同时装两个版本也是没问题的。&lt;/p&gt;
&lt;p&gt;安装支持Python&amp;nbsp;2.7的Anaconda:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ pyenv install anaconda-2.0.1
&lt;/pre&gt;
&lt;p&gt;安装支持Python&amp;nbsp;3.4的Anaconda:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ pyenv install anaconda3-2.0.1
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;申请免费的学术License&lt;/p&gt;
&lt;p&gt;对于学生来说，可以申请免费的学术License，以安装额外的功能包，以实现计算过程的加速。&lt;/p&gt;
&lt;p&gt;申请地址： &lt;a class="reference external" href="https://store.continuum.io/cshop/academicanaconda"&gt;https://store.continuum.io/cshop/academicanaconda&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;申请后，会得到一个license文件，将其放在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.continuum&lt;/span&gt;&lt;/tt&gt;目录下即可。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装额外的功能包&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;conda update conda
&lt;span class="nv"&gt;$ &lt;/span&gt;conda install accelerate
&lt;span class="nv"&gt;$ &lt;/span&gt;conda install iopro
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;安装模块&lt;/h2&gt;
&lt;p&gt;Anaconda已经自带了大量科学计算中的常用模块，可以直接使用。有时需要安装一些其他python模块。&lt;/p&gt;
&lt;div class="section" id="conda"&gt;
&lt;h3&gt;conda&lt;/h3&gt;
&lt;p&gt;anaconda自带了conda命令用于安装与更新模块，比如:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
conda install scipy
conda update scipy
&lt;/pre&gt;
&lt;p&gt;不过conda能安装的模块很有限。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pip"&gt;
&lt;h3&gt;pip&lt;/h3&gt;
&lt;p&gt;pip是Python自带的模块安装工具，比如:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pip install requests
pip install requests --upgrade
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="anaconda"&gt;
&lt;h3&gt;升级Anaconda&lt;/h3&gt;
&lt;p&gt;新版本发布之后，可以使用pyenv安装Anaconda的最新版本，也可以用Anaconda的自带更新工具升级:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
conda update conda
conda update anaconda
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="版本"></category><category term="Python"></category></entry><entry><title>GMT4脚本风格指南</title><link href="http://seisman.info/gmt4-style-guide.html" rel="alternate"></link><updated>2015-03-17T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-13:gmt4-style-guide.html</id><summary type="html">&lt;p&gt;这篇博文会介绍写GMT脚本时需要遵循的一些风格与习惯。本文的目的是，希望遵循本风格指南的GMT脚本能够更易读、易改、更健壮、可移植性更高。&lt;/p&gt;

&lt;div class="section" id="gmt"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;使用脚本来执行GMT命令&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT遵循了UNIX的设计思想，将不同的功能分别放在不同的命令中，因而在绘图时需要执行一系列命令。&lt;/p&gt;
&lt;p&gt;若使用命令行来执行一系列命令，很容易弄混前一个命令是什么。将所有的绘图命令放在脚本中可以很方便地重复执行一系列命令，以对绘图的细节进行微调。&lt;/p&gt;
&lt;p&gt;除非是一两个命令就可以解决的图，否则应一律使用脚本而非命令行。&lt;/p&gt;
&lt;p&gt;Windows下常用的脚本是bat，Linux常用的是Bash、Perl和Python。使用什么脚本语言完全依赖于用户个人的需求与喜好，这里以Bash脚本为例。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

psxy ...
pscoast ...
grdraster ...
grdimage ...
psxy ...
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;不要跨平台写脚本&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;不要在Windows下写脚本然后在Linux下运行；也不要在Linux下写脚本放在Windows下运行。这其中会遇到很多坑，包括但不限于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;默认编码不同，Windows用GBK，Linux用UTF8；&lt;/li&gt;
&lt;li&gt;换行符不同，Windows用&lt;tt class="docutils literal"&gt;\r\n&lt;/tt&gt;，Linux用&lt;tt class="docutils literal"&gt;\n&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果你真的跨平台写了脚本并遇到各种奇怪的问题时，尝试着新建一个文件，然后把脚本重新手敲一遍。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;使用变量&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;脚本不仅仅只是将一系列命令放在一个文件而已。绘图时有很多需要在多个命令中重复使用的东西，比如设置投影方式的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-J&lt;/span&gt;&lt;/tt&gt;、设置绘图范围的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R&lt;/span&gt;&lt;/tt&gt;、文件名&lt;tt class="docutils literal"&gt;xxx.ps&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;关于如何使用变量，一般有两种定义方式，这两种方法各有利弊，尚待权衡：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;将参数作为变量的值&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J -R -Sa0.5c -Gred -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;160 20&lt;/span&gt;
&lt;span class="s"&gt;150 30&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;将选项和参数作为变量的值&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-JM6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-R0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-B60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

pscoast &lt;span class="nv"&gt;$J&lt;/span&gt; &lt;span class="nv"&gt;$R&lt;/span&gt; &lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J -R -Sa0.5c -Gred -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;160 20&lt;/span&gt;
&lt;span class="s"&gt;150 30&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;不要省略参数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT的一个特性是后面的命令可以继承前面命令的一些参数，比如前面的命令中指定了&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-JM10c&lt;/span&gt; &lt;span class="pre"&gt;-R0/360/-60/60&lt;/span&gt;&lt;/tt&gt;，后面的命令可以直接使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-J&lt;/span&gt; &lt;span class="pre"&gt;-R&lt;/span&gt;&lt;/tt&gt;而不用重复给出更多的参数。这样的设计减少了用户的键入。&lt;/p&gt;
&lt;p&gt;但使用GMT绘图时经常需要修改、增添命令或调整各个命令之间的顺序。在省略了部分参数的情况下，调整各个命令之间的顺序就变成一个必须要小心的动作了，有时会造成意想不到的错误。因而要尽量避免。&lt;/p&gt;
&lt;p&gt;相同的参数在多个命令里要写很多遍，这样也很烦，这就更需要使用变量啦。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Sa0.5c -Gred -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;160 20&lt;/span&gt;
&lt;span class="s"&gt;150 30&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;开始与结束&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;多个绘图命令会将PS代码依次写入到一个PS文件中。绘图命令的顺序有时会影响到成图的效果，最常见的例子就是，如果先pscoast再grdimage，则grdimage的效果就会覆盖pscoast的效果。因而在绘制一张稍复杂的图时，经常需要在原有的代码中增添、删除或修改已有命令的顺序，这个时候尤其需要注意&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;以及重定向符号的使用。&lt;/p&gt;
&lt;p&gt;下面的代码解决了这个问题：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

&lt;span class="c"&gt;# 写入PS文件头&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 一系列绘图命令&lt;/span&gt;
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 写入PS文件尾&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;使用专门的两个命令来开始和结束一个PS绘图，这样做的好处在于：中间的所有绘图命令都使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt; &lt;span class="pre"&gt;-O&lt;/span&gt; &amp;gt;&amp;gt;&lt;/tt&gt;，不必再考虑这个命令是第一个还是最后一个了，也可以随意删除或修改任何一个命令而不必担心造成其它效果。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="si"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;使用SI单位制&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT支持SI单位制和US单位制，默认是SI单位制。由于GMT的开发者是美国人，官方的文档使用的是US单位制，因而国内的GMT用户在学习的过程中也就习惯性地使用了US单位制。&lt;/p&gt;
&lt;p&gt;实际上，国内用户对于US单位制没有太多的概念，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-X1i&lt;/span&gt;&lt;/tt&gt;远远没有&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-X2.5c&lt;/span&gt;&lt;/tt&gt;直观。SI单位制是国际标准单位，也是中国人熟悉的单位，使用SI单位制会使得微调更简单。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;不要依赖于GMT的系统设置&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;你所写的每一个脚本，将来都可能传给后来人使用，可能在任一台机器上使用。要保证脚本每次运行的结果完全一致，并不是一个简单的事情。&lt;/p&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;不要修改GMT系统设置&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;有些人喜欢使用特定字体，或者喜欢使用特定尺寸的纸张，这可以通过修改&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;GMTHOME&lt;/span&gt;/share/conf&lt;/tt&gt;下的一堆系统配置文件来实现。但是，不要这样做，这会导致脚本在别人的机器上跑出来完全不一样的结果。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;不要省略单位&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;当使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&lt;span class="caps"&gt;JM10&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;时，GMT会默认使用当前的系统默认单位（一般来说是&lt;tt class="docutils literal"&gt;c&lt;/tt&gt;，也就是厘米），当脚本在另一台系统默认单位为&lt;tt class="docutils literal"&gt;i&lt;/tt&gt;的机器上运行时，绘图的结果会完全不同。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="default"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;default文件的使用&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;不要手动修改default文件！&lt;/p&gt;
&lt;p&gt;GMT中提供了&lt;tt class="docutils literal"&gt;gmtset&lt;/tt&gt;命令可以用于修改缺省参数，比如标题的字体、大小等等。该命令会在当前工作目录下生成一个&lt;tt class="docutils literal"&gt;.gmtdefaults4&lt;/tt&gt;文件，进而影响到接下来绘图命令的执行效果。&lt;/p&gt;
&lt;p&gt;合理的使用方式如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="c"&gt;# 用gmtset修改默认参数&lt;/span&gt;
gmtset BASEMAP_TYPE plain

&lt;span class="c"&gt;# 绘图&lt;/span&gt;
psxy ...
pscoast ...
psxy ...

&lt;span class="c"&gt;# 删除参数文件&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;在脚本的最后&lt;tt class="docutils literal"&gt;rm .gmt*&lt;/tt&gt;至少删除了两个临时文件，一个是&lt;tt class="docutils literal"&gt;.gmtcommands&lt;/tt&gt;，其记录了通用选项的一些信息，另一个是&lt;tt class="docutils literal"&gt;.gmtdefaults4&lt;/tt&gt;，记录了当前的缺省参数。&lt;/p&gt;
&lt;p&gt;删除这些文件的原因在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;临时文件，应该删除。&lt;/li&gt;
&lt;li&gt;脚本已经执行完毕，不应该遗留下无用的文件。&lt;/li&gt;
&lt;li&gt;保留&lt;tt class="docutils literal"&gt;.gmtdefaults4&lt;/tt&gt;文件，可能会导致下次执行脚本时产生不同的效果。例如，脚本中首先使用了默认字体0，然后绘制了一部分图，再使用&lt;tt class="docutils literal"&gt;gmtset&lt;/tt&gt;修改字体为字体1，又绘制了一部分图，若忘记删除&lt;tt class="docutils literal"&gt;.gmtdefaults4&lt;/tt&gt;文件，则该文件会成为下次执行脚本时的默认参数文件，导致默认字体变成1，因而出现不同的绘图效果。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;有这样一种可怕的情况：假如你在&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;HOME&lt;/span&gt;&lt;/tt&gt;下执行了&lt;tt class="docutils literal"&gt;gmtset&lt;/tt&gt;命令，然后画了一个简单的图，但是却忘记删除&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;HOME&lt;/span&gt;&lt;/tt&gt;下生成的&lt;tt class="docutils literal"&gt;.gmtdefaults4&lt;/tt&gt;文件，这会影响到其它目录中几乎所有GMT脚本的执行效果，而且这个问题很难排查。要避免这种情况的发生需要遵循几个原则：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;尽量不要在&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;HOME&lt;/span&gt;&lt;/tt&gt;下执行GMT命令（可能会产生临时文件，难以清理）&lt;/li&gt;
&lt;li&gt;尽量不要使用命令行执行GMT命令（因为你很可能会忘记你刚刚执行过哪些命令）&lt;/li&gt;
&lt;li&gt;使用&lt;tt class="docutils literal"&gt;gmtset&lt;/tt&gt;的脚本，最后一定要记得删除&lt;tt class="docutils literal"&gt;.gmtdefaults4&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="p"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;-P选项的使用&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在《GMT进阶之-P选项》中已经说过，只有第一个绘图命令中的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-P&lt;/span&gt;&lt;/tt&gt;选项是起作用的，所以不需要在每个绘图命令里都使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-P&lt;/span&gt;&lt;/tt&gt;选项，当然若是每个绘图命令都使用了&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-P&lt;/span&gt;&lt;/tt&gt;选项也没有问题，只是不够简洁而已。&lt;/p&gt;
&lt;p&gt;两种推荐的使用方式：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;在开始PS文件时使用该选项：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M20c
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -P &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改&lt;tt class="docutils literal"&gt;PAGE_ORIENTATION&lt;/tt&gt;，不使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-P&lt;/span&gt;&lt;/tt&gt;选项&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M20c
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

gmtset PAGE_ORIENTATION portrait
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="b"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;不要滥用-B选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-B&lt;/span&gt;&lt;/tt&gt;选项用于绘制边框并控制边框的绘制效果。&lt;/p&gt;
&lt;p&gt;即每个使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-B&lt;/span&gt;&lt;/tt&gt;选项的命令都会绘制一次边框，在没有使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-X&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Y&lt;/span&gt;&lt;/tt&gt;的情况下，多个命令重复使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-B&lt;/span&gt;&lt;/tt&gt;选项会绘制多次边框，但由于边框是重合的，所以会看不出来区别。&lt;/p&gt;
&lt;p&gt;对于&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-B&lt;/span&gt;&lt;/tt&gt;选项，合理的用法是仅在第一个命令中使用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="verbose"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;verbose模式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT命令的输出信息常用于在写脚本时判断命令执行是否正确，而在真正执行时过多的输出信息反而会扰乱用户的屏幕输出。合理的使用verbose模式的方式有三种：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;写脚本时每个命令都加上&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-V&lt;/span&gt;&lt;/tt&gt;选项，待确认脚本正确无误之后删除所有&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-V&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;定义Verbose变量&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M20c
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps
&lt;span class="nv"&gt;V&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-V      &lt;span class="c"&gt;# 调试时用这个&lt;/span&gt;
&lt;span class="c"&gt;#V=       # 调试完成用这个&lt;/span&gt;

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -P &lt;span class="nv"&gt;$V&lt;/span&gt; &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K -O &lt;span class="nv"&gt;$V&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &lt;span class="nv"&gt;$V&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改缺省参数&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M20c
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60/30
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

gmtset VERBOSE TRUE
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K &lt;span class="nv"&gt;$V&lt;/span&gt; &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p -A1000 -K -O &lt;span class="nv"&gt;$V&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &lt;span class="nv"&gt;$V&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;从使用上的简洁来看，最简单的是第三种方法。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="x-y"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;慎用-X和-Y&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用这两个选项会导致坐标原点的移动。因而使用的时候需要相当慎重。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;除极个别的情况外，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-X&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Y&lt;/span&gt;&lt;/tt&gt;选项应该仅在绘制组合图（即一张图多个子图）时使用；&lt;/li&gt;
&lt;li&gt;对于非组合图，也可以在第一个绘图命令中使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Xc&lt;/span&gt; &lt;span class="pre"&gt;-Yc&lt;/span&gt;&lt;/tt&gt;使得整个绘图框架位于纸张的中央；&lt;/li&gt;
&lt;li&gt;不要仅仅为了将某个符号或文字移动到某个位置就使用这两个选项，如果真的有这种需求的话，应该使用绝对坐标&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Xa1c&lt;/span&gt; &lt;span class="pre"&gt;-Ya1c&lt;/span&gt;&lt;/tt&gt;，其仅影响当前命令的绘图位置。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id24"&gt;网格文件后缀&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT主要使用netCDF格式作为网格数据的格式，其标准后缀名为&lt;tt class="docutils literal"&gt;.nc&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;需要注意以下两个事实：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;GMT不会对后缀进行检测，所以后缀是什么都不重要&lt;/li&gt;
&lt;li&gt;GMT之前的版本中曾经自定义了一种网格数据格式，并使用后缀&lt;tt class="docutils literal"&gt;.grd&lt;/tt&gt;，因而很多脚本中都使用了&lt;tt class="docutils literal"&gt;.grd&lt;/tt&gt;作为后缀。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id25"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-05-13：初稿；&lt;/li&gt;
&lt;li&gt;2014-05-16：关于“网格文件后缀”的说明；&lt;/li&gt;
&lt;li&gt;2015-03-17：不要跨平台写脚本；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="Guide"></category></entry><entry><title>在Fortran程序中读写SAC文件</title><link href="http://seisman.info/read-and-write-sac-in-fortran-program.html" rel="alternate"></link><updated>2014-05-12T15:55:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-12:read-and-write-sac-in-fortran-program.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;序言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC是进行地震数据预处理的好工具，但是无法实现所有的数据分析功能，这就需要能够在自己的程序中读写SAC文件。这篇博文介绍如何在Fortran程序中读写SAC文件。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;子函数库&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC自带了读写函数库，并且提供了相关的示例程序，这些可以在&lt;a class="reference external" href="http://seisman.info/sac-manual.html"&gt;《SAC参考手册》&lt;/a&gt;中的相关章节中找到。&lt;/p&gt;
&lt;p&gt;SAC自带的读写子函数实际上并不好用，因而就有很多人自己重新实现了SAC读写函数库，其中之一就是Prof. Lupei Zhu所写的&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/home.html"&gt;Prof. Lupei Zhu&lt;/a&gt;的&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;或者 &lt;tt class="docutils literal"&gt;gCAP&lt;/tt&gt;中都包含了SAC读写函数库，&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;sac.h&lt;/tt&gt;。这是一个用C语言实现的SAC读写函数库，同时提供了一些Fortran接口，因而也可以直接在Fortran程序中使用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;子函数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;中定义了如下Fortran接口：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;rdsac0：读取SAC二进制文件&lt;/li&gt;
&lt;li&gt;my_brsac：读取SAC二进制文件的另一个Fortran接口&lt;/li&gt;
&lt;li&gt;wrtsac0：写SAC二进制文件&lt;/li&gt;
&lt;li&gt;wrtsac2：将两个1维数组写成XY形式的SAC数据&lt;/li&gt;
&lt;li&gt;wrtsac3：与wrtsac0类似，但向头段中加入了分量信息&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;读和写一个SAC文件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;最常见的需求是读取一个SAC二进制文件，对数据进行处理，并将处理后的数据写回到原文件中。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;      &lt;span class="k"&gt;program &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;
      &lt;span class="k"&gt;implicit none&lt;/span&gt;
&lt;span class="k"&gt;      &lt;/span&gt;&lt;span class="kt"&gt;integer &lt;/span&gt;&lt;span class="nb"&gt;MAX&lt;/span&gt;
&lt;span class="nb"&gt;      &lt;/span&gt;&lt;span class="k"&gt;parameter&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;MAX&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="kt"&gt;real &lt;/span&gt;&lt;span class="k"&gt;array&lt;/span&gt;
&lt;span class="k"&gt;      dimension array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;MAX&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="kt"&gt;real &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dist&lt;/span&gt;
      &lt;span class="kt"&gt;integer &lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;
      &lt;span class="kt"&gt;character&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;kname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kout&lt;/span&gt;
      &lt;span class="n"&gt;kname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'seis.SAC'&lt;/span&gt;
      &lt;span class="k"&gt;call &lt;/span&gt;&lt;span class="n"&gt;rdsac0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;trim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kname&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c"&gt;!     Process&lt;/span&gt;
      &lt;span class="k"&gt;do &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;
        &lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
      &lt;span class="k"&gt;end do&lt;/span&gt;
&lt;span class="k"&gt;      &lt;/span&gt;&lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;  &lt;span class="c"&gt;! distance&lt;/span&gt;
      &lt;span class="n"&gt;kout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'seis.SAC.out'&lt;/span&gt;
      &lt;span class="k"&gt;call &lt;/span&gt;&lt;span class="n"&gt;wrtsac0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;trim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kout&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dist&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;end program&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;需要注意的几个事项包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;调用子函数前需要使用&lt;tt class="docutils literal"&gt;trim&lt;/tt&gt;将文件名中的多余空白字符去除&lt;/li&gt;
&lt;li&gt;只能返回头段变量delta、npts和b的值，无法获取其它头段变量&lt;/li&gt;
&lt;li&gt;对数据进行处理后，可以直接写回到原文件中，或写入到新文件中&lt;/li&gt;
&lt;li&gt;写数据时，需要提供表示距离的变量&lt;tt class="docutils literal"&gt;dist&lt;/tt&gt;（这完全是个人的需求，所以该子函数并不那么好用）&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;此SAC函数库的Fortran接口，基本是完全根据个人需求而写的，因而没有太高的通用性。且Fortran中不包含结构体，无法一次性获取全部头段变量的信息。有需要在Fortran中读写SAC的可以考虑使用SAC自带的函数库，或者重新定义该函数。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;编译方法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ gfortran prog.c  sacio.c
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-05-11：mars_cfeng原稿；&lt;/li&gt;
&lt;li&gt;2014-05-12：SeisMan修订稿；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Fortran"></category><category term="SAC基础"></category></entry><entry><title>在C程序中读写SAC文件</title><link href="http://seisman.info/read-and-write-sac-in-c-program.html" rel="alternate"></link><updated>2014-05-11T18:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-11:read-and-write-sac-in-c-program.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;序言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC是进行地震数据预处理的好工具，但是无法实现所有的数据分析功能，这就需要能够在自己的程序中读写SAC文件。这篇博文介绍如何在C程序中读写SAC文件。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;子函数库&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC自带了读写函数库，并且提供了相关的示例程序，这些可以在&lt;a class="reference external" href="http://seisman.info/sac-manual.html"&gt;《SAC参考手册》&lt;/a&gt;中的相关章节中找到。&lt;/p&gt;
&lt;p&gt;SAC自带的读写子函数实际上并不好用，因而就有很多人自己重新实现了SAC读写函数库，其中之一就是Prof. Lupei Zhu所写的&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/home.html"&gt;Prof. Lupei Zhu&lt;/a&gt;的&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;或者 &lt;tt class="docutils literal"&gt;gCAP&lt;/tt&gt;中都包含了SAC读写函数库，&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;sac.h&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;子函数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;sac.h&lt;/tt&gt;中定义了名为&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SACHEAD&lt;/span&gt;&lt;/tt&gt;的结构体，其包含了SAC格式的所有头段变量。&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;中定义了如下子函数：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;read_sac：读取SAC二进制数据&lt;/li&gt;
&lt;li&gt;read_sac2：读取含cut选项的二进制数据&lt;/li&gt;
&lt;li&gt;read_sachead：仅读取SAC文件中的头段部分&lt;/li&gt;
&lt;li&gt;write_sac：写SAC二进制数据&lt;/li&gt;
&lt;li&gt;wrtsac2：将两个1维数组写成XY形式的SAC数据&lt;/li&gt;
&lt;li&gt;sachdr：创建一个全新的SAC头段&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;示例&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;读和写一个SAC文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;最常见的需求是读取一个SAC二进制文件，对数据进行处理，并将处理后的数据写回到原文件中。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include "sac.h"        &lt;/span&gt;&lt;span class="c1"&gt;// 包含头文件sac.h&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt;    &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;SACHEAD&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt;     &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;strcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"seis.SAC"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;// 读入数据&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;read_sac&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"npts=%d delta=%f &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;// 其它数据处理&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// 将结果写回到原文件中&lt;/span&gt;
    &lt;span class="n"&gt;write_sac&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;需要注意的几个事项包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;SAC文件的头段区保存到结构体&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SACHEAD&lt;/span&gt; hd&lt;/tt&gt;中。此处必须定义成结构体变量&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SACHEAD&lt;/span&gt; hd&lt;/tt&gt;，若定义成结构体指针&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SACHEAD&lt;/span&gt; *hd&lt;/tt&gt;，必须通过&lt;tt class="docutils literal"&gt;malloc&lt;/tt&gt;为头段区分配空间。&lt;/li&gt;
&lt;li&gt;SAC文件的数据保存到指针&lt;tt class="docutils literal"&gt;float *data&lt;/tt&gt;中，此处不需要对指针分配空间，&lt;tt class="docutils literal"&gt;read_sac&lt;/tt&gt;子函数会首先读取SAC文件的头段区，然后根据头段变量&lt;tt class="docutils literal"&gt;npts&lt;/tt&gt;的值分配合适的内存空间。&lt;/li&gt;
&lt;li&gt;对数据进行处理后，可以直接写回到原文件中，或写入到新文件中。&lt;/li&gt;
&lt;li&gt;指针&lt;tt class="docutils literal"&gt;data&lt;/tt&gt;在该程序中定义，并在子程序&lt;tt class="docutils literal"&gt;read_sac&lt;/tt&gt;中分配内存，最终需要在该程序中&lt;tt class="docutils literal"&gt;free(data)&lt;/tt&gt;将已分配的内存空间释放。在本例中内存是否释放并无太大影响，在有些情况下会出现“内存溢出”的问题。&lt;/li&gt;
&lt;li&gt;本示例中，为了保持代码的简洁性，没有对子函数的返回值进行判断。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;读取一个SAC文件的头段区&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;有些时候只需要SAC文件的头段区的一些信息，此时若读取整个文件就有些浪费了。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include "sac.h"&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt;    &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;SACHEAD&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;strcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"seis.SAC"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;read_sachead&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Too much data points!&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;读取SAC文件中的一段数据&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;有些时候，数据可能有10000s，而我们只需要其中50s的数据。为了获得50s的数据而读取10000s的数据，实在太浪费。因而需要一个有效的手段对数据进行截取，即相当于SAC中的cut命令。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include "sac.h"&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt;    &lt;span class="n"&gt;fin&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt;    &lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;SACHEAD&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt;     &lt;span class="n"&gt;tmark&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt;     &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;strcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"seis.SAC"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;tmark&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;t1&lt;/span&gt;      &lt;span class="o"&gt;=&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;t2&lt;/span&gt;      &lt;span class="o"&gt;=&lt;/span&gt;   &lt;span class="mf"&gt;2.5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;read_sac2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tmark&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"npts=%d delta=%f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;strcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"seis.SAC.cut"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;write_sac&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;tmark、t1和t2确定了要读取的数据的时间窗。其中tmark可以取如下值&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;tmark=-5：以b为时间标记&lt;/li&gt;
&lt;li&gt;tmark=-3：以o为时间标记&lt;/li&gt;
&lt;li&gt;tmark=-2：以a为时间标记&lt;/li&gt;
&lt;li&gt;tmark=0~9：以t0~t9中的某个为时间标记&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此例中，表示仅读取头段变量a前0.5秒到后2.5秒的数据。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;在&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;的源代码中，理解&lt;tt class="docutils literal"&gt;tref = *( (float *) hd + 10 + tmark);&lt;/tt&gt;这一句很重要，在自己的程序中也会经常需要类似的代码。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;虽然只读取了文件中的部分数据，该子程序对于头段区的b、e、npts等做了相应修改，因而最终的头段区是完全正确的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;因为只读取了文件中的部分数据，若将处理之后的数据写入原文件中，会导致原数据丢失，因而一般保持到新的文件中。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;从零开始写一个SAC文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在做合成数据时，经常需要从无到有完全创建一个SAC文件。这相对于一般的“读-&amp;gt;处理-&amp;gt;写”而言要更复杂一些，因为必须首先构建一个基本的头段区。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include "sac.h"&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt;    &lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;SACHEAD&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt;     &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt;     &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;       &lt;span class="c1"&gt;// 采样周期&lt;/span&gt;
    &lt;span class="n"&gt;npts&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;       &lt;span class="c1"&gt;// 数据点数&lt;/span&gt;
    &lt;span class="n"&gt;b&lt;/span&gt;     &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;         &lt;span class="c1"&gt;// 文件开始时间&lt;/span&gt;
    &lt;span class="n"&gt;hd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sachdr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;    &lt;span class="c1"&gt;// 构建基本头段&lt;/span&gt;
    &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dist&lt;/span&gt;     &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;   &lt;span class="c1"&gt;// 给其它头段变量赋值&lt;/span&gt;
    &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cmpaz&lt;/span&gt;    &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cmpinc&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;strcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"seis.syn"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="c1"&gt;// 生成合成数据&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// 写入到文件中&lt;/span&gt;
    &lt;span class="n"&gt;write_sac&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="xysac"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;创建一个XY型SAC文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;XY型数据中包含了两个数据区，分别是自变量和因变量。这种类型的文件其实很少用到。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include "sac.h"&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;char&lt;/span&gt;    &lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xarray&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt;   &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yarray&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kt"&gt;int&lt;/span&gt;     &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt;     &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;strcpy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"seis.syn"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="c1"&gt;// 构建数据&lt;/span&gt;
    &lt;span class="n"&gt;xarray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;yarray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;xarray&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;yarray&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;wrtsac2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xarray&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;yarray&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xarray&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yarray&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;编译方法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ gcc prog.c  sacio.c -lm
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;一些问题&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下面列举中&lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;的一些问题：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;无法正确处理字符型的头段变量。由于C语言中字符串是以&lt;tt class="docutils literal"&gt;\0&lt;/tt&gt;为结束符的，所以长度为8的字符型头段变量实际上需要额外的一个字节保存&lt;tt class="docutils literal"&gt;\0&lt;/tt&gt;，未考虑此问题会导致无法正确使用和修改字符型头段变量，且可能导致字符型头段变量中的信息丢失。&lt;/li&gt;
&lt;li&gt;写文件时未处理中断信号。在写文件的过程中，若出现中断信号，会导致文件损坏，若在写文件过程中遇到中断信号，应保证继续执行写操作或许会更好。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="C"></category><category term="SAC基础"></category></entry><entry><title>辐射花样的计算与震源球的绘制</title><link href="http://seisman.info/radiation-pattern-and-beach-ball.html" rel="alternate"></link><updated>2014-05-01T18:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-05-01:radiation-pattern-and-beach-ball.html</id><summary type="html">
&lt;div class="section" id="p"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;P波辐射花样计算公式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Quantitative Seismology (Aki and Richards,1980) 中式（4.29）给出了零迹地震矩M所产生的n分量位移公式：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="equation for moment tensor source" src="/images/2014050101.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;其中等式右边共计5项，第一项为近场项，第二、三项分别是P、S波的中间场项，第四、五项分别为P、S波的远场项。一般研究辐射花样大多关注于P波远场辐射花样，即第四项。&lt;/p&gt;
&lt;p&gt;式（4.91）中给出了远场P波位移的矢量形式，看上去更加直观一些：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="P-wave far-field term" src="/images/2014050102.jpg" style="width: 250px;"/&gt;
&lt;/div&gt;
&lt;p&gt;其中，除去震源时间函数以及绝对振幅，只留下辐射花样相关的因子：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
Rad = \mathbf{\gamma} \cdot \mathbf{M} \cdot \mathbf{\gamma}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(\mathbf{\gamma}\)&lt;/span&gt;为离源矢量，是离源角和方位角的函数，表征了地震射线从震源的出射方向，&lt;span class="math"&gt;\(\mathbf{M}\)&lt;/span&gt;为矩张量。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;坐标系的选取&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;对于点源而言，上式中的矩张量是一个常量（M(t)与时间相关的部分可以分离成震源时间函数），离源矢量是与方位角和离源角有关的矢量，所以求辐射花样的本质就是矢量和张量的乘法。如何选定坐标系是一个关键问题。&lt;/p&gt;
&lt;p&gt;按照Aki&amp;amp;Richards(1980)中图4.20的方式定义坐标系，如下图，定义X轴为北向，Y轴为东向，Z轴为垂直向下，即NED坐标系。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="NED-coordinate" src="/images/2014050103.jpg" style="width: 450px;"/&gt;
&lt;/div&gt;
&lt;p&gt;可以得到，此坐标下，离源矢量&lt;span class="math"&gt;\(\mathbf{\gamma}\)&lt;/span&gt;的具体形式:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\mathbf{\gamma}=(\sin i_{\xi} \cos\phi, \sin i_{\xi} \sin\phi, \cos i_{\xi})
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;震源机制解&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;震源机制解一般有两种表达方式，一种是矩张量形式，另一种是断层参数形式。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;矩张量形式是震源机制的通用表示方式，需要六个分量。对于地震震源而言，多限制矩张量为零迹张量，即去除爆炸源的成分，只保留double couple和CLVD部分。&lt;/li&gt;
&lt;li&gt;断层参数形式需要三个分量(strike,dip,rake)，只能表示double couple位错源。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Global CMT给出了零迹矩张量解和断层参数解。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;若使用GCMT给出的断层参数(strike,dip,rake)解，则可根据Aki&amp;amp;Richards(1980) P117 Box4.4中式1将其转换成NED坐标系下的矩张量。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="double-couple-to-moment-tensor" src="/images/2014050104.jpg" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;若使用GCMT给出的矩张量解，由于GCMT给出的是(Mrr, Mtt, Mff, Mrt, Mrf, Mtf)解，即USE坐标系下的矩张量，需要转换成NED坐标系的矩张量，方可使用。转换公式如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="from-ned-to-use" src="/images/2014050105.jpg" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;不同的文献给出的坐标系可能不同，比如这里提到的NED坐标系和USE坐标系。即便相同的坐标系所使用的符号也可能不同，比如GCMT的&lt;span class="math"&gt;\((r,t,f)\)&lt;/span&gt;坐标系和Aki&amp;amp;Richards(1980)中给出的&lt;span class="math"&gt;\((r,\Delta,\phi)\)&lt;/span&gt;坐标系其实都是USE坐标系。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;辐射花样计算代码&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;获得矩张量以及离源矢量的表达式之后，即可求出震源球上任一点的辐射振幅。代码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdlib.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;math.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#define PI 3.14159265358979323846&lt;/span&gt;
&lt;span class="cp"&gt;#define DEG2RAD PI/180.0&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"Usage: %s mrr mtt mff mrt mrf mtf&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"   Or: %s strike dip rake&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;    &lt;span class="c1"&gt;// moment tensor&lt;/span&gt;
        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;    &lt;span class="c1"&gt;// mrr -&amp;gt; mzz&lt;/span&gt;
        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;    &lt;span class="c1"&gt;// mtt -&amp;gt; mxx&lt;/span&gt;
        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;    &lt;span class="c1"&gt;// mff -&amp;gt; myy&lt;/span&gt;

        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;    &lt;span class="c1"&gt;// mrt -&amp;gt; mzx&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;    &lt;span class="c1"&gt;// mrf -&amp;gt; -Mzy&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;    &lt;span class="c1"&gt;// mtf -&amp;gt; -Mxy&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// strike, dip, rake&lt;/span&gt;
        &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;   &lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;sscanf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;"%f"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;  &lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;strike&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;DEG2RAD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;rake&lt;/span&gt;   &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;DEG2RAD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;dip&lt;/span&gt;    &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;DEG2RAD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strike&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rake&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"    / %6.3f %6.3f %6.3f &lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"M = | %6.3f %6.3f %6.3f | &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"    &lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s"&gt; %6.3f %6.3f %6.3f / &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

    &lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;fop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"pattern.dat"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"wb"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;az&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;         &lt;span class="c1"&gt;// 离源矢量&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;3600&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="mi"&gt;900&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;az&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;10.0&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DEG2RAD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;     &lt;span class="c1"&gt;// 方位角&lt;/span&gt;
        &lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;double&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;10.0&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DEG2RAD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;    &lt;span class="c1"&gt;// 离源角，仅计算下半球&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;az&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;az&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;amp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
            &lt;span class="n"&gt;amp&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="n"&gt;fwrite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;fclose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;此代码可以正确处理断层参数和矩张量两种形式的震源机制解，二者均可被正确转换为NED坐标系下的矩张量解。对360度的方位角以及90度的离源角进行遍历，计算每一点的振幅值，并保存到&lt;tt class="docutils literal"&gt;pattern.dat&lt;/tt&gt;中待用。&lt;/p&gt;
&lt;p&gt;关于离源角，需要注意两点：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;离源角的取值范围为[0,90]，即只计算震源球的下半球，这是因为多数情况下绘制震源球都使用下半球投影（上半球辐射的能量无法传播到大震中距处）。&lt;/li&gt;
&lt;li&gt;离源角与纬度的对应关系为：纬度=离源角-90。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;震源球的绘制&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;投影方式的选取&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;目前已经拥有了震源球的下半球上任意一点的振幅（未归一化），还需要选择合适的投影方式将数据投影到“赤道”面上。&lt;/p&gt;
&lt;p&gt;绘制震源球有两种投影方式，分别是Schmidt投影和Wulff投影。前者是等面积投影，后者是等角度投影。在GMT中分别对应&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;JA&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;JS&lt;/span&gt;&lt;/tt&gt;。这里以Wulff投影为例，想要使用Schmidt投影只需要把&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;JS&lt;/span&gt;&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;JA&lt;/span&gt;&lt;/tt&gt;即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;绘图脚本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-90/0
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;S0/-90/15c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;a30f10N
&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;pattern
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;meca.ps

gmtset &lt;span class="nv"&gt;BASEMAP_TYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;plain
gmtset &lt;span class="nv"&gt;PLOT_DEGREE_FORMAT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;+
xyz2grd &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.dat -G&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.nc -I6m/6m -R&lt;span class="nv"&gt;$R&lt;/span&gt; -ZLBxf
grd2cpt &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.nc -Cpolar -E100 &amp;gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.cpt
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K -P &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
grdimage &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.nc -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -C&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.cpt -B&lt;span class="nv"&gt;$B&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
grdcontour &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.nc -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -L-0.001/0.001 -C1 -K -O -W2p &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
rm .gmt* &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.cpt &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.nc
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;绘图脚本的一些说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;设置&lt;tt class="docutils literal"&gt;PLOT_DEGREE_FORMAT&lt;/tt&gt;使得方位角范围是0到360，而不是-180到180。其中0度指向正北方向。&lt;/li&gt;
&lt;li&gt;这里R的横向范围是0到360，实际上360度处与0度处是同一个经度，所以网格中没有计算360度处的振幅。同时在-Z选项中使用了x以表明X轴的周期性。&lt;/li&gt;
&lt;li&gt;在振幅为0处绘制了等值线。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;结果展示与比较&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;震源机制解&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;从GCMT中找到一个地震事件，其机制解如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
201304191751A SOUTH OF TIMOR, INDONESI
    Date: 2013/ 4/19 Centroid Time: 17:51:46.9 GMT
    Lat= -12.01 Lon= 121.71
    Depth= 29.5 Half duration= 2.0
    Centroid time minus hypocenter time: 5.5
    Moment Tensor: Expo=24 -1.350 5.410 -4.060 -3.210 -3.580 -0.736
    Mw = 5.8 mb = 6.0 Ms = 5.8 Scalar Moment = 6.88e+24
    Fault plane: strike=315 dip=45 slip=-12
    Fault plane: strike=53  dip=82 slip=-135
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="wulff"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id24"&gt;矩张量+Wulff投影&lt;/a&gt;&lt;/h3&gt;
&lt;div class="figure"&gt;
&lt;img alt="moment-tensor-wulff-projection" src="/images/2014050106.jpg" style="width: 450px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="schmidt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id25"&gt;矩张量+Schmidt投影&lt;/a&gt;&lt;/h3&gt;
&lt;div class="figure"&gt;
&lt;img alt="moment-tensor-Schmidt-projection" src="/images/2014050107.jpg" style="width: 450px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id26"&gt;断层参数+Wulff投影&lt;/a&gt;&lt;/h3&gt;
&lt;div class="figure"&gt;
&lt;img alt="double-coule-wulff-projection" src="/images/2014050108.jpg" style="width: 450px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id27"&gt;断层参数+Schmidt投影&lt;/a&gt;&lt;/h3&gt;
&lt;div class="figure"&gt;
&lt;img alt="double-coule-Schmidt-projection" src="/images/2014050109.jpg" style="width: 450px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt-psmeca"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id28"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; psmeca绘制矩张量解&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;psmeca的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Sm&lt;/span&gt;&lt;/tt&gt;选择可以用于在地图上绘制GCMT矩张量形式的震源球。需要注意的是这个震源球的投影方式与&lt;tt class="docutils literal"&gt;J&lt;/tt&gt;指定的投影无关。这里把边框画出来，以指示出正北方向。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
psmeca -R0/250/-90/90 -JQ22c -Sm7c -W1p -B60/30 &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt; gmt_meca.ps&lt;/span&gt;
&lt;span class="s"&gt;121.71 -12.01 29 -1.35 5.41 -4.06 -3.21 -3.58 -0.74 24 X Y 201304191751A&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="gmt-psmeca-moment-tensor" src="/images/2014050110.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt-psmecadouble-couple"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id29"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; psmeca绘制矩张量的double couple部分&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Sd&lt;/span&gt;&lt;/tt&gt;用于绘制矩张量的double couple部分。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
psmeca -R0/250/-90/90 -JQ22c -Sd7c -W1p -B60/30 &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt; gmt_meca.ps&lt;/span&gt;
&lt;span class="s"&gt;121.71 -12.01 29 -1.35 5.41 -4.06 -3.21 -3.58 -0.74 24 X Y 201304191751A&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="gmt-psmeca-double-couple" src="/images/2014050111.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="mopad"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id30"&gt;Mopad绘制矩张量&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Mopad是一个可以计算与绘制矩张量的Python脚本，其功能强大，可控制的参数更多:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ mopad plot -1.35,5.41,-4.06,-3.21,-3.58,-0.74 -i USE
&lt;/pre&gt;
&lt;p&gt;这里&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-i&lt;/span&gt; &lt;span class="caps"&gt;USE&lt;/span&gt;&lt;/tt&gt;指定了输入的六个矩张量分量是USE坐标下的解。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="plot radiation pattern using mopad" src="/images/2014050112.jpg" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id31"&gt;图像格式转换&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;利用ps2raster命令可以将PS文件转换为其它格式的图像，最好选择透明的PNG格式:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ps2raster -A -TG beachball.ps
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id32"&gt;一些小结&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;绘制震源球时，选择匹配的坐标系很重要；&lt;/li&gt;
&lt;li&gt;可以使用Schmidt投影和Wulff投影绘制震源球，二者大体相同，细节上有差异；&lt;/li&gt;
&lt;li&gt;GMT的psmeca命令使用Schmidt投影绘制震源球，这一点无法修改；&lt;/li&gt;
&lt;li&gt;GCMT给出的震源球精度很低，但可以看出其使用了Schmidt投影&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;JA&lt;/span&gt;&lt;/tt&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id14"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id33"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-04-28：初稿By cxh757；&lt;/li&gt;
&lt;li&gt;2014-05-01：修订与补充By SeisMan；&lt;/li&gt;
&lt;li&gt;2014-05-30：增加了图像格式转换一节；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="辐射花样"></category><category term="震源球"></category><category term="GMT4"></category></entry><entry><title>细数使用Hi-net数据遇到的坑</title><link href="http://seisman.info/traps-using-hinet-data.html" rel="alternate"></link><updated>2014-04-27T13:55:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-04-27:traps-using-hinet-data.html</id><summary type="html">&lt;p&gt;Hi-net是日本的一个高精度密集台网，整个日本境内大概有800个台站，台间距约为20km。Hi-net的数据质量很高，很适合做科学研究。&lt;/p&gt;
&lt;p&gt;用了接近一年的Hi-net数据，遇到了不少坑，这里总（吐）结（槽）一下。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;原网站是日文版，大概于2012年制作了英文测试版，两年多过去了，还是测试版，不知道是在测试服务器，还是英文化没有完成；&lt;/li&gt;
&lt;li&gt;申请数据时遇到的坑&lt;ol class="arabic"&gt;
&lt;li&gt;选择台站时会弹出窗口，需要浏览器支持Java插件方可使用；&lt;/li&gt;
&lt;li&gt;没有批量下载的工具，必须鼠标点击选择机构、台网、数据起始时间（年、月、日、时、分）和数据长度；&lt;/li&gt;
&lt;li&gt;单次申请，一个通道的数据长度不得长于60分钟；（其实这个还好，不算太坑）&lt;/li&gt;
&lt;li&gt;数据文件后缀为cnt，每个文件包含了全部已选通道的一分钟的数据，这意味着如果一次申请所有通道的30分钟的数据，就需要下载30个文件；&lt;/li&gt;
&lt;li&gt;当所有数据的总时间长度小于12000分钟时，Hi-net可以将多个分钟的数据文件打包压缩以方便下载。这大概相当于800个台站（2400个通道）5分钟的数据量。因此一般来说单次申请的数据长度不得超过5分钟。&lt;/li&gt;
&lt;li&gt;一次申请结束之后需等待30秒到1分钟，等到此次申请处理完毕之后才可继续申请，否则会出现错误。&lt;/li&gt;
&lt;li&gt;数据下载需要手动点击&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;数据处理遇到的坑&lt;ol class="arabic"&gt;
&lt;li&gt;数据不是常见格式，而是Hi-net自定义的win32格式，需要使用win32tools将其转换为SAC格式&lt;/li&gt;
&lt;li&gt;win32格式以及相关工具的说明文档是日文，且是euc-jp编码，花了我两个小时才找到方法转换成utf8编码，结果日文还是没看懂。&lt;/li&gt;
&lt;li&gt;将cnt转换为SAC格式时，需要使用其提供的channel table文件。channel table文件包含了台站的通道信息，而channel&amp;nbsp;table内有很多列，没有明确解释每一列的具体含义。&lt;/li&gt;
&lt;li&gt;没有明确的仪器响应信息，似乎是要根据channel&amp;nbsp;table以及其它信息为每个通道单独生成仪器响应文件，才可以去除仪器响应。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="数据"></category><category term="Hinet"></category><category term="台网"></category><category term="申请"></category><category term="仪器响应"></category></entry><entry><title>GMT技巧之地理坐标与笛卡尔坐标混合体</title><link href="http://seisman.info/mix-geographical-coordinate-with-cartesian-coordinate.html" rel="alternate"></link><updated>2014-11-24T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-04-26:mix-geographical-coordinate-with-cartesian-coordinate.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;提出问题&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;要绘制这么一张图，X轴是经度（地理坐标），Y轴是深度（笛卡尔坐标），如下图：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="mix-geographical-coordinate-with-cartesian-coordinate" src="/images/2014042601.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;解决问题&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;因为Y轴是深度，其坐标范围已经超过了正负90的范围，因为只能用&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;JX&lt;/span&gt;&lt;/tt&gt;投影来绘制整张图。最简单的例子如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psbasemap -R40/50/0/600 -JX15c/10c -B2/100 &amp;gt; mix.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="mix-geographical-coordinate-with-cartesian-coordinate" src="/images/2014042602.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;很显然，这样的绘图结果无法满足要求，主要在于X轴坐标的“度”符号以及后缀上。解决办法如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psbasemap -R40/50/0/600 -JX15cd/10c -B2/100 --PLOT_DEGREE_FORMAT=+ddd:mmF &amp;gt; mix.ps
&lt;/pre&gt;
&lt;p&gt;需要注意三点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-JX15cd/10c&lt;/span&gt;&lt;/tt&gt;：X轴多了一个&lt;tt class="docutils literal"&gt;d&lt;/tt&gt;，表示X轴为地理坐标；Y轴没有&lt;tt class="docutils literal"&gt;d&lt;/tt&gt;，为正常的笛卡尔坐标；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--PLOT_DEGREE_FORMAT=+ddd:mmF&lt;/span&gt;&lt;/tt&gt;：已经设定了X轴为地理坐标，通过&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--PLOT_DEGREE_FORMAT=+F&lt;/span&gt;&lt;/tt&gt;进一步修改地理坐标在绘图时的显示方式。&lt;/li&gt;
&lt;li&gt;若要求Y轴向下递增，正确的做法是设置投影方式为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-JX15cd/-10c&lt;/span&gt;&lt;/tt&gt;。由于可能存在的Bug，这样做会导致X轴的Annotation的位置出现问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;其它解决方法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;上面给出的解决方案很简单，完全可以满足需求。&lt;/p&gt;
&lt;p&gt;最开始遇到这个问题的时候没有想到这种方法，所以把问题想复杂了。下面列出最初对于这个问题的分析以及两种稍复杂的解决方案。虽说下面的两种方案更复杂了，但其思路与想法还是很有意思的，或许在其它问题上可以借鉴，因而将其列出。&lt;/p&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;分析问题&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;因为Y轴是线性坐标，所以必然只能选择线性投影，即&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&lt;span class="caps"&gt;JX&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;线性投影的情况下，图的主体很简单，关键在于X轴坐标的“度”符号以及后缀E上&lt;/li&gt;
&lt;li&gt;尝试将X轴和Y轴都当作线性坐标，然后对于X轴设置其&lt;strong&gt;单位&lt;/strong&gt;为特殊的“度”符号。此法看似可行，但实际上GMT内部设置了单位与标注之间的距离，通过单位设置的“度”符号明显离标注的距离较远，不太美观。&lt;/li&gt;
&lt;li&gt;为了使X轴有一个“度”符号，X轴必须当作地理坐标处理；而Y轴的范围已经超过了地理坐标的范围，所以必须当作线性坐标处理；&lt;/li&gt;
&lt;li&gt;综上，必须使用两个命令来绘制边框，分别绘制地理坐标的X轴（-BxxxSN）和线性坐标的Y轴（-BxxxEW）；&lt;/li&gt;
&lt;li&gt;关于如何绘制地理坐标的X轴，有两种解决办法。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;解决问题&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id6"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id15"&gt;法1&lt;/a&gt;&lt;/h4&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;Rx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;40/50    &lt;span class="c"&gt;# X轴范围&lt;/span&gt;
&lt;span class="nv"&gt;Ry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/600    &lt;span class="c"&gt;# Y轴范围&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$Rx&lt;/span&gt;/&lt;span class="nv"&gt;$Ry&lt;/span&gt;
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;2/100     &lt;span class="c"&gt;# 间隔&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X15c/10c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;   &lt;span class="c"&gt;# 写入PS文件头&lt;/span&gt;

psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;SN -K -O --D_FORMAT&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'%g\260E'&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;    &lt;span class="c"&gt;# 绘制X轴&lt;/span&gt;
psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;EW -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;     &lt;span class="c"&gt;# 绘制Y轴&lt;/span&gt;

&lt;span class="c"&gt;# 这里放置其它绘图命令，不再使用B选项&lt;/span&gt;

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;  &lt;span class="c"&gt;# 写入PS文件尾&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这里绘制X轴时直接使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--D_FORMAT=%g\260E&lt;/span&gt;&lt;/tt&gt;，使得在该命令中D_FORMAT的值为&lt;tt class="docutils literal"&gt;%g\260E&lt;/tt&gt;，即设置显示浮点数时在其后加上“度”符号以及后缀“E”。&lt;/p&gt;
&lt;p&gt;此法的优点在于简单，缺点在于后缀“E”是固定值，无法处理东西经同时存在的情况。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id16"&gt;法2&lt;/a&gt;&lt;/h4&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;Rx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;40/50    &lt;span class="c"&gt;# X轴范围&lt;/span&gt;
&lt;span class="nv"&gt;Ry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/600    &lt;span class="c"&gt;# Y轴范围&lt;/span&gt;
&lt;span class="nv"&gt;Rfake&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/1   &lt;span class="c"&gt;# 假轴范围&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$Rx&lt;/span&gt;/&lt;span class="nv"&gt;$Ry&lt;/span&gt;
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;2/100     &lt;span class="c"&gt;# 间隔&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X20c/15c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;map.ps

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;   &lt;span class="c"&gt;# 写入PS文件头&lt;/span&gt;

psbasemap -Rg&lt;span class="nv"&gt;$Rx&lt;/span&gt;/&lt;span class="nv"&gt;$Rfake&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;SN -K -O --BASEMAP_TYPE&lt;span class="o"&gt;=&lt;/span&gt;plain &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;    &lt;span class="c"&gt;# 绘制X轴&lt;/span&gt;
psbasemap -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;EW -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;     &lt;span class="c"&gt;# 绘制Y轴&lt;/span&gt;

&lt;span class="c"&gt;# 这里放置其它绘图命令，不再使用B选项&lt;/span&gt;

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;  &lt;span class="c"&gt;# 写入PS文件尾&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;其它的说明&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;GMT的B选项提供了这样一个功能，可以使用形如&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Bgxmin/xmax/ymin/ymax&lt;/span&gt;&lt;/tt&gt;的语法，其中&lt;tt class="docutils literal"&gt;g&lt;/tt&gt;告诉命令即便使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&lt;span class="caps"&gt;JX&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;投影，也认为其是地理坐标。由于是地理坐标，“度”符号以及后缀“E”就很容易出来了&lt;/li&gt;
&lt;li&gt;使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Bgxmin/xmax/ymin/ymax&lt;/span&gt;&lt;/tt&gt;存在两个问题&lt;ol class="arabic"&gt;
&lt;li&gt;虽然是线性投影，但是由于使用了地理坐标，GMT会默认将底图类型设置为fancy。这一点可以设置&lt;tt class="docutils literal"&gt;BASEMAP_TYPE&lt;/tt&gt;等于&lt;tt class="docutils literal"&gt;plain&lt;/tt&gt;来解决。&lt;/li&gt;
&lt;li&gt;Y轴被当作地理坐标，所以ymin和ymax的范围被限制在[-90,90]之内&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;在此例中在绘制X轴时引入了一个假的Y轴&lt;tt class="docutils literal"&gt;0/1&lt;/tt&gt;，以满足&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Rgxmin/xmax/ymin/ymax&lt;/span&gt;&lt;/tt&gt;形式中对ymin和ymax范围的限制。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这样，X轴和Y轴就都设计好了，接下来要做的就只是保证其它命令都不使用B选项即可。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;2014-04-26：初稿；&lt;/li&gt;
&lt;li&gt;2014-04-26：修改脚本，解决了对Y轴范围的限制；Thanks to Chen Zhaohui；&lt;/li&gt;
&lt;li&gt;2014-06-09：通过修改&lt;tt class="docutils literal"&gt;D_FORMAT&lt;/tt&gt;以解决地理坐标的度符号；该方法由刘珠妹提供；&lt;/li&gt;
&lt;li&gt;2014-07-09：找到了一种非常简单的方法来解决该问题；&lt;/li&gt;
&lt;li&gt;2014-11-24：修正了&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-PLOT_DEGREE_FORMAT&lt;/span&gt;&lt;/tt&gt;中的小问题；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="GMT4"></category></entry><entry><title>SAC发展史及其版权</title><link href="http://seisman.info/history-and-copyright-of-sac.html" rel="alternate"></link><updated>2014-04-01T16:30:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-04-01:history-and-copyright-of-sac.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;发展史&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Lawrence Livermore国家实验室和Los Alamos国家实验室是美国承担核武器设计工作的两个实验室。&lt;span class="caps"&gt;SAC&lt;/span&gt; 于20世纪80年代诞生于实验室的Treaty Verification Program小组里，该组由W. C. Tapley和Joe Tull共同领导。&lt;/p&gt;
&lt;p&gt;起初，SAC是用Fortran语言实现的，并将源代码分发给感兴趣的学者，允许用户进行非商业性的地震数据处理，用户和维护者之间的合作协议要求用户提交bug修正和改进以换取SAC的使用权。到了大概1990年，SAC已经成为全球地震学家的数据处理标准软件。&lt;/p&gt;
&lt;p&gt;从1992年开始，SAC的开发逐渐由Livermore接管，并开始通过分发协议严格限制源代码的分发。与此同时，开发者认为Fortran是一种过于局限的编程语言，其阻碍了SAC特性的进一步开发，因而开发者使用f2c转换工具将SAC的Fortran源码转换成了C源码。&lt;/p&gt;
&lt;p&gt;接下来，Livermore以转换得到的C源码为基础，计划开发一个商业版的地震数据处理产品，命名为SAC2000。这个版本扩展了很多功能，其中一个功能是建立一个日志数据库，记录一个波形从原始数据到最终产品之间的所有处理步骤。这样的设计允许用户暂时保存数据处理步骤，随时将处理的结果提交到内存或回滚到之前的状态。&lt;/p&gt;
&lt;p&gt;约1998年，IRIS意识到，SAC的核心用户群(主要是IRIS的成员)无法确保能够获取SAC的源码。IRIS开始和Livermore协商，希望将SAC的开发分成两条线:一个包含数据库特性，供核监测机构使用;另一个不包含数据库特性，仅供学术机构使用。商业化的努力主要集中在含数据库功能的版本上。&lt;/p&gt;
&lt;p&gt;终于，在2005年，IRIS与Livermore签订了合同，Livermore提供给IRIS一个SAC协议，允许在IRIS社区内部分享SAC/SAC2000的源代码，并提供有限的支持以促进社区的发展。而学术圈对于商业版的SAC没有太大兴趣，因而Livermore逐渐撤出了对于SAC2000的支持。最终IRIS完全接手了SAC的开发和技术支持，并成为了一个新的版本，也就是我们现在正在使用的SAC。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;版权&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;根据IRIS与Livermore的协议，只有IRIS可以分发SAC二进制包以及源码包，任何其它的分发都是不合法的。&lt;/p&gt;
&lt;p&gt;昨日，在SAC邮件组里，有人提了一个问题，附件中附带了SAC的源码包，于是IRIS给出了如下警告。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The distribution of &lt;span class="caps"&gt;SAC&lt;/span&gt; is done by &lt;span class="caps"&gt;IRIS&lt;/span&gt; under an agreement we have with &lt;span class="caps"&gt;LLNL&lt;/span&gt; of the &lt;span class="caps"&gt;US&lt;/span&gt; Department of Energy and the University of California.  The distribution of &lt;span class="caps"&gt;SAC&lt;/span&gt; is limited and  does not allow you to redistribute &lt;span class="caps"&gt;SAC&lt;/span&gt; at all.  In your email to the &lt;span class="caps"&gt;SAC&lt;/span&gt;-&lt;span class="caps"&gt;HELP&lt;/span&gt; list you attached the the distribution of &lt;span class="caps"&gt;SAC&lt;/span&gt; which violates the license agreement that you accepted when you requested &lt;span class="caps"&gt;SAC&lt;/span&gt;,.&lt;/p&gt;
&lt;p&gt;I am copying the &lt;span class="caps"&gt;SAC&lt;/span&gt;-&lt;span class="caps"&gt;HELP&lt;/span&gt; list as well to insure that all subscribers are aware of the limitation of &lt;span class="caps"&gt;SAC&lt;/span&gt; that  is in place. No one other than &lt;span class="caps"&gt;IRIS&lt;/span&gt; should ever redistribute &lt;span class="caps"&gt;SAC&lt;/span&gt; to anyone including a broadcast distribution to a email list server.&lt;/p&gt;
&lt;p&gt;Please take care in following the license conditions that you agreed to or we could lose the ability to distribute &lt;span class="caps"&gt;SAC&lt;/span&gt; to anyone in the future.  I will notify &lt;span class="caps"&gt;LLNL&lt;/span&gt; of this infraction.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;私人分发SAC源码的最严重后果是：用户违背了申请SAC时的agreement，IRIS违反了与LLNL签订的协议，LLNL不再允许IRIS分发SAC源码，SAC软件就此没了。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="SAC"></category></entry><entry><title>SEIZMO：天然地震学Matlab工具箱</title><link href="http://seisman.info/passive-seismology-toolbox-for-matlab-and-gnu-octave.html" rel="alternate"></link><updated>2014-03-30T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-30:passive-seismology-toolbox-for-matlab-and-gnu-octave.html</id><summary type="html">
&lt;div class="section" id="seizmo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;SEIZMO是什么？&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SEIZMO是一个基于Matlab和GNU Octave的地震学数据处理工具箱，其包含了700多个函数，可以用于地震数据的预处理、质量控制以及处理。&lt;/p&gt;
&lt;p&gt;其在某种程度上包含了SAC、TauP、GMT的功能，同时包含多种地球一维、三维模型，GCMT地震目录以及IRIS的仪器响应数据库。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;官方主页：&lt;a class="reference external" href="http://epsc.wustl.edu/~ggeuler/codes/m/seizmo/"&gt;http://epsc.wustl.edu/~ggeuler/codes/m/seizmo/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;项目主页：&lt;a class="reference external" href="https://github.com/g2e/seizmo"&gt;https://github.com/g2e/seizmo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;基本要求&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Matlab7.1+或最新版的GNU Octave&lt;/li&gt;
&lt;li&gt;Signal Processing Toolbox  (for filtering and resampling)&lt;/li&gt;
&lt;li&gt;Statistics Toolbox (for clustering)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;优缺点&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;优点&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;完全基于Matlab的m脚本，无需编译&lt;/li&gt;
&lt;li&gt;与开源的GNU Octave完全兼容&lt;/li&gt;
&lt;li&gt;读写多种地震数据格式（&lt;span class="caps"&gt;SAC&lt;/span&gt;、NDK等）&lt;/li&gt;
&lt;li&gt;help很详细&lt;/li&gt;
&lt;li&gt;可以满足自动分析和交互的需求&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;缺点&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;基于Matlab脚本，相比于Fortran/C来说速度要慢&lt;/li&gt;
&lt;li&gt;仅由一个研究生开发，开发速度缓慢&lt;/li&gt;
&lt;li&gt;没有大量的PDF/HTML文档&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;功能&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;将地震波转换为声音&lt;/li&gt;
&lt;li&gt;震源机制相关转换、计算和绘制&lt;/li&gt;
&lt;li&gt;卷积、反卷积、谱白化和去谱白化&lt;/li&gt;
&lt;li&gt;读取各个机构的震源机制&lt;/li&gt;
&lt;li&gt;滤波&lt;/li&gt;
&lt;li&gt;频率-波数域分析&lt;/li&gt;
&lt;li&gt;绘制GMT风格的地图&lt;/li&gt;
&lt;li&gt;计算走时&lt;/li&gt;
&lt;li&gt;波形叠加&lt;/li&gt;
&lt;li&gt;拾取震相&lt;/li&gt;
&lt;li&gt;重采样&lt;/li&gt;
&lt;li&gt;去仪器响应&lt;/li&gt;
&lt;li&gt;读写数据&lt;/li&gt;
&lt;li&gt;走时校正&lt;/li&gt;
&lt;li&gt;等等&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Matlab"></category></entry><entry><title>走时计算软件包</title><link href="http://seisman.info/travel-time-packages.html" rel="alternate"></link><updated>2014-03-29T15:42:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-29:travel-time-packages.html</id><summary type="html">&lt;p&gt;地震波走时的计算是地震学的一个基本问题。下面列出几个目前已知的几个可以计算地震波走时的包。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;span class="caps"&gt;IASPEI&lt;/span&gt; Travel Time Software - &lt;span class="caps"&gt;AK135&lt;/span&gt;&amp;nbsp;version&lt;/p&gt;
&lt;p&gt;网址：&lt;a class="reference external" href="http://rses.anu.edu.au/seismology/soft/ttsoft.html"&gt;http://rses.anu.edu.au/seismology/soft/ttsoft.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;源码为Fortran版本，这个版本的源码很旧，曾经试图编译，发现很多语法编译器已经不再支持，想要用起来需要一番功夫。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;George&amp;nbsp;Helffrich修改版&lt;/p&gt;
&lt;p&gt;网址：&lt;a class="reference external" href="http://www1.gly.bris.ac.uk/~george/sac-bugs.html#ttimes"&gt;http://www1.gly.bris.ac.uk/~george/sac-bugs.html#ttimes&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Fortran版本，该版本是在前者的基础上修改得到，相比前者，加入了更多的速度模型，可以直接编译使用。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;TauP&amp;nbsp;Toolkit&lt;/p&gt;
&lt;p&gt;网址：&lt;a class="reference external" href="http://www.seis.sc.edu/taup/"&gt;http://www.seis.sc.edu/taup/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Java版，具体良好的跨平台能力。包含图形界面和命令行工具，是目前来说最好用的走时计算工具，但是其还是有一些缺憾，最明显的一点是在命令行的输出对于脚本批量处理不算友好。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;MatTauP&lt;/p&gt;
&lt;p&gt;网址：&lt;a class="reference external" href="https://github.com/g2e/seizmo/tree/master/mattaup"&gt;https://github.com/g2e/seizmo/tree/master/mattaup&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Matlab版，是seiszmo项目的一部分，底层貌似调用了Java版TauP的代码。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这几个软件都是基于同一个原理，参考如下：&lt;/p&gt;
&lt;p&gt;Buland, R. and &lt;span class="caps"&gt;C. H.&lt;/span&gt; Chapman (1983). The Computation of Seismic Travel Times, Bull. Seism. Soc. Am.&amp;nbsp;73(5),1271–1302.&lt;/p&gt;
</summary><category term="走时"></category><category term="TauP"></category></entry><entry><title>GMT在Windows下的中文支持</title><link href="http://seisman.info/gmt-chinese-support-under-windows.html" rel="alternate"></link><updated>2015-01-13T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-27:gmt-chinese-support-under-windows.html</id><summary type="html">
&lt;p&gt;GMT在Windows下如何支持中文的问题在这篇&lt;a class="reference external" href="http://xxqhome.blog.163.com/blog/static/1967330202011112810120598/"&gt;博文&lt;/a&gt;里已经说的差不多了。本文会在该博文的基础上做进一步地整理、归纳和补充。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;准备工作&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;安装Windows版GMT；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装ghostscript；&lt;/p&gt;
&lt;p&gt;需要注意在安装的最后，会有一个生成cidmap的选项，选中该选项则表示会为当前系统自动生成中文所需的cidmap文件。默认该选项是被选中的，一定&lt;strong&gt;不要&lt;/strong&gt;将该选项取消；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;安装gsview；&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="ghostscript"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;ghostscript的中文支持&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;若ghostscript的安装没有问题，则在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;C:\Program&lt;/span&gt; Files\gs\gs9.15\examples\cjk&lt;/tt&gt;目录下可以找到文件&lt;tt class="docutils literal"&gt;gscjk_ag.ps&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;启动cmd，键入如下命令:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cd "C:\Program Files\gs\gs9.16\bin"
gswin64.exe ..\examples\cjk\gscjk_ag.ps
&lt;/pre&gt;
&lt;p&gt;该命令用命令行版本的&lt;tt class="docutils literal"&gt;gswin64c&lt;/tt&gt;打开&lt;tt class="docutils literal"&gt;gscjk_ag.ps&lt;/tt&gt;，若能看到中文，则说明ghostscript是可以正常支持中文的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gsview"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;gsview的中文支持&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;安装好gsview之后，PS格式会自动与gsview关联。一般情况下，直接双击PS文件，就会用gsview打开该PS文件。&lt;/p&gt;
&lt;p&gt;双击打开gscjk_ag.ps，一般情况下不会正确显示汉字。这是因为gsview在打开PS文件时没有找到汉字所对应的字体文件。&lt;/p&gt;
&lt;p&gt;在gsview的“选项”-&amp;gt;“高级配置”中，将Ghostscript Options由&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-dNOPLATFONTS&lt;/span&gt; &lt;span class="pre"&gt;-sFONTPATH="c:\psfonts"&lt;/span&gt;&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-dNOPLATFONTS&lt;/span&gt; &lt;span class="pre"&gt;-sFONTPATH="c:\Windows\Fonts"&lt;/span&gt;&lt;/tt&gt;，此时gsview在调用gswin64打开PS文件时会加入当前系统的字体路径FONTPATH。&lt;/p&gt;
&lt;p&gt;配置完毕后，重新打开gscjk_ag.ps，若中文正常显示，则表示gsview已支持中文。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;GMT的中文支持&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;用&lt;strong&gt;编辑器&lt;/strong&gt;打开gscjk_ag.ps，会看到如下内容:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
/STSong-Light--GB-EUC-H *findfont 20 scalefont setfont
150 400 moveto
(Song Typeface 宋体) show
/STFangsong-Light--GB-EUC-H *findfont 20 scalefont setfont
150 375 moveto
(Fangsong Typeface 仿宋体) show
/STHeiti-Regular--GB-EUC-H *findfont 20 scalefont setfont
150 350 moveto
(Hei Typeface 黑体) show
/STKaiti-Regular--GB-EUC-H *findfont 20 scalefont setfont
150 325 moveto
(Kai Typeface 揩体) show
%
/Times-Roman findfont 13 scalefont setfont
50 200 moveto
(* Chinese translation of "Ghostscript" is merely associative \
characters of these meanings.) show
50 200 13 sub moveto
(In Simplified Chinese articles, customarily we use just "Ghostscript" \
as it is.) show
&lt;/pre&gt;
&lt;p&gt;其中&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;STSong-Light--&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;即为宋体，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;是文字编码方式，H表示水平字体，V表示垂直向字体，这里给出了四种常见字体的名称&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;STSong-Light--&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;STFangsong-Light--&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;STHeiti-Regular--&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;STKaiti-Regular--&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;将这四种中文字体添加到GMT的字体配置文件中，即&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;C:\programs\gmt5\share\pslib\PS_font_info.d&lt;/span&gt;&lt;/tt&gt;。文件修改后，最后几行如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ZapfChancery-MediumItalic   0.610       0
ZapfDingbats            0.700       1
STSong-Light--GB-EUC-H  0.700    1
STFangsong-Light--GB-EUC-H  0.700    1
STHeiti-Regular--GB-EUC-H   0.700   1
STKaiti-Regular--GB-EUC-H   0.700   1
&lt;/pre&gt;
&lt;p&gt;用&lt;tt class="docutils literal"&gt;pstext &lt;span class="pre"&gt;-L&lt;/span&gt;&lt;/tt&gt;查看GMT字体，可以看到，新添加的四种中文字体对应的字体编号为35到38。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;测试脚本&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;本代码为GMT5语法！&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;gmt gmtset FONT_TITLE 40p,35,black

&lt;span class="nb"&gt;echo &lt;/span&gt;3.5 &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; LM 45p,35,red  GMT宋体 &amp;gt; tmp
&lt;span class="nb"&gt;echo &lt;/span&gt;3.5 &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; LM 45p,36,blue GMT仿宋 &amp;gt;&amp;gt; tmp
&lt;span class="nb"&gt;echo &lt;/span&gt;3.5 &lt;span class="m"&gt;3&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; LM 45p,37,yellow GMT黑体 &amp;gt;&amp;gt; tmp
&lt;span class="nb"&gt;echo &lt;/span&gt;3.5 &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; LM 45p,38,green GMT楷体 &amp;gt;&amp;gt; tmp

gmt pstext tmp -R0/7/0/7 -JX6i/6i -Bafg -B+t&lt;span class="s2"&gt;"GMT中文"&lt;/span&gt; -F+a+c+f -P &amp;gt; cn.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;若生成的PS文件正常显示汉字，则表示GMT已经可以支持中文。&lt;/p&gt;
&lt;p&gt;需要注意，若使用记事本编辑bat文件，则保存时应注意编码方式为ANSI、Unicode或Unicode big endian，若使用UTF-8编码则会出现乱码；另外，很多编辑器默认将文本文件以UTF-8编码保存，因而可能需要修改编辑器的默认编码。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;图片格式转换&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用GMT自带的ps2raster命令可以将PS文件转换为其它图片格式。&lt;/p&gt;
&lt;p&gt;在Windows下，对于含中文的PS文件，需要在ps2raster上加上字体路径，如下:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;ps2raster -C-sFONTPATH&lt;span class="o"&gt;=&lt;/span&gt;C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\F&lt;/span&gt;onts test.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;即可正常使用。&lt;/p&gt;
&lt;p&gt;另，&lt;span class="caps"&gt;GMT&lt;/span&gt; 5.1.1存在bug，上面的命令无法与-A选项一起使用，&lt;span class="caps"&gt;GMT&lt;/span&gt; 4可以。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="中文"></category><category term="Windows"></category></entry><entry><title>跟我一起写Makefile (PDF重制版)</title><link href="http://seisman.info/how-to-write-makefile.html" rel="alternate"></link><updated>2014-03-07T14:52:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-07:how-to-write-makefile.html</id><summary type="html">&lt;div class="section" id="id1"&gt;
&lt;h2&gt;简介&lt;/h2&gt;
&lt;p&gt;《跟我一起写Makefile》是&lt;a class="reference external" href="http://coolshell.cn/haoel"&gt;陈皓&lt;/a&gt;发表在其CSDN博客上的系列文章，一直受到读者的推荐，是很多人学习Makefile的首选文档。目前网络上流传的PDF版本多为祝冬华整理的版本。这个版本的排版一般，代码部分没有做任何语法高亮。&lt;/p&gt;
&lt;p&gt;2010年初学Makefile的时候，读了前几章皮毛，一直用到了现在。最近想着重新学习一下Makefile，顺便学习一下Sphinx，重新制作一个更精美的PDF版本。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;相关&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;书的文字部分来自于&lt;a class="reference external" href="http://andriki.com/mediawiki/index.php?title=Linux:%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E5%86%99Makefile"&gt;Andriki&lt;/a&gt;提供的Mediawiki源码；&lt;/li&gt;
&lt;li&gt;使用&lt;a class="reference external" href="http://sphinx-doc.org/"&gt;Sphinx&lt;/a&gt;制作文档&lt;/li&gt;
&lt;li&gt;项目主页：&lt;a class="reference external" href="https://github.com/seisman/how-to-write-makefile"&gt;https://github.com/seisman/how-to-write-makefile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;网页在线版：&lt;a class="reference external" href="http://htwm.readthedocs.org/zh_CN/latest/"&gt;http://htwm.readthedocs.org/zh_CN/latest/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;PDF下载：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/Makefile.pdf"&gt;http://seisman.qiniudn.com/downloads/Makefile.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;epub下载：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/Makefile.epub"&gt;http://seisman.qiniudn.com/downloads/Makefile.epub&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="sphinx"&gt;
&lt;h2&gt;sphinx中文支持&lt;/h2&gt;
&lt;p&gt;sphinx在利用LaTeX生成PDF时，对中文支持不够，因而修改sphinx如下:&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;将&lt;tt class="docutils literal"&gt;sphinx/texinputs/Makefile&lt;/tt&gt;中的&lt;tt class="docutils literal"&gt;pdflatex&lt;/tt&gt;替换成&lt;tt class="docutils literal"&gt;xelatex&lt;/tt&gt;;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改&lt;tt class="docutils literal"&gt;sphinx/writers/latex.py&lt;/tt&gt;，在231行左右对中文做特殊处理；&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;language&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;zh_CN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;babel&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;inputenc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;utf8extra&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改&lt;tt class="docutils literal"&gt;conf.py&lt;/tt&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="make"></category></entry><entry><title>读《编程修养》</title><link href="http://seisman.info/reading-better-programming.html" rel="alternate"></link><updated>2014-03-06T19:55:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-06:reading-better-programming.html</id><summary type="html">&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;版本和版权&lt;/p&gt;
&lt;p&gt;当需要将代码与他人共享时，版本和版权信息很有必要。对于一些私人的代码，文件的版本以及修改历史，可以通过git进行版本控制。文件和函数的描述，函数的输入、输出以及返回值有必要写清楚。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;缩进、空格、换行、空行、对齐&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;对于缩进是使用空格还是tab键纠结了好久。最终决定使用4个空格进行缩进，同时将Tab键的长度设置为4，并且将Tab键自动转换为4个空格。&lt;/p&gt;
&lt;p&gt;对于vim，可以做如下设置:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
set tabstop=4   &amp;quot; Tab键的宽度
set softtabstop=4
set shiftwidth=4    &amp;quot; 自动缩进的宽度
set expandtab
set autoindent
set cindent
set smarttab
set smartindent
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;已经养成了在函数参数间加空格的习惯，但是对于表达式，多余的空格有时反而使得语句难以阅读，且空格过多会使语句变长。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;若函数参数很多，在定义或声明函数时，可以使用每个参数单独一行的方式，以方便做注释，以及理清参数的个数和顺序。调用函数时不必如此。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;用Tab键将数据类型、变量名、注释分别对齐，的确要更好看一些。这种方式适用于每个变量单独定义一行的情况。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;注释&lt;/p&gt;
&lt;p&gt;单行注释用行注释，多行注释时用块注释。对于块注释需要嵌套时，再考虑使用&lt;tt class="docutils literal"&gt;#if 0&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;#endif&lt;/tt&gt;这种方式。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;函数的[in][out]&amp;nbsp;参数&lt;/p&gt;
&lt;p&gt;很少对函数参数是否非法进行判断，assert更是没用过。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;对系统调用的返回进行判断&lt;/p&gt;
&lt;p&gt;已经养成此习惯。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;if&amp;nbsp;语句对出错的处理&lt;/p&gt;
&lt;p&gt;的确，当正常处理代码很长时，很难注意到&lt;tt class="docutils literal"&gt;else&lt;/tt&gt;部分。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;头文件中的#ifndef&lt;/p&gt;
&lt;p&gt;声明冲突的问题遇到过，尤其是当头文件中定义了全局变量并且对该变量进行初始化了。曾经被这个问题坑过。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;在堆上分配内存&lt;/p&gt;
&lt;p&gt;栈区由编译器自动分配释放，存放函数的参数值，局部变量的值等。一般来说栈的内存很小，大约是10 MB的量级。因而定义超大数组时会出现莫名的段错误。堆区的内存由程序员通过&lt;tt class="docutils literal"&gt;malloc&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;free&lt;/tt&gt;进行释放。&lt;/p&gt;
&lt;p&gt;要求malloc和free尽量都在同一层中使用，在很多时候不太现实。&lt;/p&gt;
&lt;p&gt;malloc之后的内存除了要检测内存是否分配成功，还要对已分配内存进行初始化，一般使用memset函数，但是若可以确认内存分配后一定会赋值，则不必初始化。&lt;/p&gt;
&lt;p&gt;free后的指针，其值不为NULL，此时为野指针。应小心使用，设置为NULL更安全。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;变量的初始化&lt;/p&gt;
&lt;p&gt;的确，好的程序员知道哪些变量需要初始化,哪些则不需要。某些系统以及编译器会自动将未初始化的变量初始化为0，但是这个事情及其不靠谱，还是自己初始化比较安全。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;h 和 c&amp;nbsp;文件的使用&lt;/p&gt;
&lt;p&gt;H文件和C文件最大的用处就是声明和实现分开。这一点很像HTML和CSS把结构和表现分离。带初始化的全局变量不要放在 H 文件中! &lt;tt class="docutils literal"&gt;sacio.c&lt;/tt&gt;中的&lt;tt class="docutils literal"&gt;sac_null&lt;/tt&gt;就存在这个问题。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;出错信息的处理&lt;/p&gt;
&lt;p&gt;小程序不适合那种管理错误信息的方式，而且声明一个错误代码全局变量可能有些危险。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;常用函数和循环语句中的被计算量&lt;/p&gt;
&lt;p&gt;学会利用static!&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;函数名和变量名的命名&lt;/p&gt;
&lt;p&gt;试过两种风格，一种是全小写，以下划线对单词进行分割；另一种是单词首字母大小。最终选择了后者。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;函数的传值和传指针&lt;/p&gt;
&lt;p&gt;似懂非懂。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改别人程序的修养&lt;/p&gt;
&lt;p&gt;真心不想用别人写的程序，风格不同看起来真受伤。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;把相同或近乎相同的代码形成函数和宏&lt;/p&gt;
&lt;p&gt;平常注意整理!&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;表达式中的括号&lt;/p&gt;
&lt;p&gt;从来不记优先级，一直靠的就是括号啊。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;函数参数中的&amp;nbsp;const&lt;/p&gt;
&lt;p&gt;不太习惯这种做法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;函数的参数个数&lt;/p&gt;
&lt;p&gt;C语言的返回值只能是一个，在需要多个返回值时就必须使用指针，这很容易导致函数参数过多，这点很麻烦。结构体这东西，不是想定义就可以定义的，如果函数参数之间没有太多的联系，强制定义一个结构体，在函数调用的时候反而不方便。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;函数的返回类型,不要省略&lt;/p&gt;
&lt;p&gt;已经养成了好习惯。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;goto&amp;nbsp;语句的使用&lt;/p&gt;
&lt;p&gt;不知道什么时候开始goto语句就已经被打入冷宫了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;宏的使用&lt;/p&gt;
&lt;p&gt;只使用简单宏；对于复杂宏，只使用min、max这样的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;static&amp;nbsp;的使用&lt;/p&gt;
&lt;p&gt;理解，但是没有用过。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;函数中的代码尺寸&lt;/p&gt;
&lt;p&gt;函数过长导致难以看清代码的结构；函数过多，怎么设计参数传递好纠结。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;typedef&amp;nbsp;的使用&lt;/p&gt;
&lt;p&gt;typedef可以大大缩短类型声明的长度，尤其是在声明结构体时。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;为常量声明宏&lt;/p&gt;
&lt;p&gt;几乎所有的常量都可以声明成宏。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;不要为宏定义加分号&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;|| 和 &amp;amp;&amp;amp;&amp;nbsp;的语句执行顺序&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;尽量用for而不是while做循环&lt;/p&gt;
&lt;p&gt;使用for循环的确会更清晰一些，但是有些while转成for需要好好思考一下。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;请sizeof&amp;nbsp;类型而不是变量&lt;/p&gt;
&lt;p&gt;已经养成习惯。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;不要忽略&amp;nbsp;Warning&lt;/p&gt;
&lt;p&gt;作为一个强迫症患者，一直以来都是不能允许自己的C程序中有Warning存在的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;书写Debug版和Release版的程序&lt;/p&gt;
&lt;p&gt;自从知道了DEBUG宏，就一直在使用。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="读书"></category><category term="C"></category></entry><entry><title>地震数据的命名规则</title><link href="http://seisman.info/seismic-file-name-convetions.html" rel="alternate"></link><updated>2014-03-05T21:48:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-05:seismic-file-name-convetions.html</id><summary type="html">
&lt;p&gt;利用rdseed程序可以很容易地从SEED格式数据中解压得到SAC格式的地震记录，下面就是一个SAC数据的文件名:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2013.166.17.34.00.0195.IU.HRV.10.BHZ.M.SAC
&lt;/pre&gt;
&lt;p&gt;这篇博文说一说文件的命名规则。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;文件名格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;根据rdseed的Manual，SAC数据的文件名形式如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yyyy.ddd.hh.mm.ss.ffff.NN.SSSSS.LL.CCC.Q.SAC
&lt;/pre&gt;
&lt;p&gt;其中&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;yyyy.ddd.hh.mm.ss.ffff是SAC文件中第一个数据点对应的时间&lt;ul&gt;
&lt;li&gt;yyyy为年；&lt;/li&gt;
&lt;li&gt;ddd为一年的第多少天；&lt;/li&gt;
&lt;li&gt;hh.mm.ss为时, 分, 秒；&lt;/li&gt;
&lt;li&gt;ffff为毫秒；需要注意的是1s=1000ms, 这里毫秒却用了4位来表示，这里很容易出错。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;NN为台网名，2字符；&lt;/li&gt;
&lt;li&gt;SSSSS为台站名，一般是3个字符，偶尔见到4字符的；&lt;/li&gt;
&lt;li&gt;LL为location id；为空或两字符；&lt;/li&gt;
&lt;li&gt;CCC为通道名；&lt;/li&gt;
&lt;li&gt;Q为质量控制标识；&lt;/li&gt;
&lt;li&gt;SAC为文件后缀；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="location-id-ll"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Location &lt;span class="caps"&gt;ID&lt;/span&gt;: &lt;span class="caps"&gt;LL&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;什么是Location ID呢？我也没有找到比较权威的解释。&lt;/p&gt;
&lt;p&gt;常见的Location ID为空，偶尔会见到&lt;tt class="docutils literal"&gt;00&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;01&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;10&lt;/tt&gt;这样的，也有遇到&lt;tt class="docutils literal"&gt;60&lt;/tt&gt;这样的。&lt;/p&gt;
&lt;p&gt;Location ID其实是台站下的subcode，即一个台站处，有多套仪器，这些仪器可能是相同的型号，但是位于不同的深度或者指向不同的方位；也有可能是两个仪器是不同的型号。&lt;/p&gt;
&lt;p&gt;经常见到的情况是，同一个台站，不同location ID的两个地震数据具有极为相似但有略有不同的波形，这个就自己慢慢领悟吧。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="q"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;质量控制: Q&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;质量控制标识有四种:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;D: Data of undetermined state&lt;/li&gt;
&lt;li&gt;M: Merged Data&lt;/li&gt;
&lt;li&gt;R: Raw waveform Data&lt;/li&gt;
&lt;li&gt;Q: &lt;span class="caps"&gt;QC&lt;/span&gt;’d data&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一般见到的都是M。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ccc"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;通道名: &lt;span class="caps"&gt;CCC&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;通道名用三个字符来表示，这三个字符分别代表了Band Code、Instrument Code和Orientation Code。&lt;/p&gt;
&lt;div class="section" id="band-code"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;Band Code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Band Code是通道名的第一个字符，表示了仪器的采样率以及响应频带等信息。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="Band Code from SEED Reference Manual" src="/images/2014030501.jpg" style="width: 700px; height: 400px;"/&gt;
&lt;p class="caption"&gt;Band Code&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;常见的仪器一般是宽频带(B)或长周期(L)。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="instrument-code"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;Instrument Code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Instrument Code是通道名的第二个字符，代表了不同的仪器传感器。&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="38%"&gt;&lt;/col&gt;
&lt;col width="63%"&gt;&lt;/col&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head"&gt;Instrument Code&lt;/th&gt;
&lt;th class="head"&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;H&lt;/td&gt;
&lt;td&gt;High Gain Seismometer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;L&lt;/td&gt;
&lt;td&gt;Low Gain Seismometer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;G&lt;/td&gt;
&lt;td&gt;Gravimeter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;M&lt;/td&gt;
&lt;td&gt;Mass position Seismometer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Accelerometer&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;常见的是高增益(H)仪器，记录地面运动速度。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="orientation-code"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;Orientation Code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Orientation Code表示了传感器记录的地面运动的方向。&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="15%"&gt;&lt;/col&gt;
&lt;col width="85%"&gt;&lt;/col&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head"&gt;Code&lt;/th&gt;
&lt;th class="head"&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;N E Z&lt;/td&gt;
&lt;td&gt;南北向、东西向、垂向&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;1 2 3&lt;/td&gt;
&lt;td&gt;3为垂向；1、2为水平方向，
正交但与东西南北向有偏离&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;T R&lt;/td&gt;
&lt;td&gt;切向、径向，主要用于射线束中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;A B C&lt;/td&gt;
&lt;td&gt;三轴向(正交)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;U V W&lt;/td&gt;
&lt;td&gt;可选分量&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;常见的是N、E、Z以及1、2、3。&lt;/p&gt;
&lt;p&gt;需要注意的是：当仪器的方向与东西方向的夹角小于5度时，此Orientation Code 取为E；当与东西方向夹角大于5度时，Orientation Code取为1(或2).对于南北方向同理。&lt;/p&gt;
&lt;p&gt;因而，即便Orientation Code为N，也并不意味着台站是南北方向的，真实的方向还是需要看SAC头段中的&lt;tt class="docutils literal"&gt;cmpaz&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;cpminc&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;rdseed 5.3.1 Manual&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;SEED&lt;/span&gt; Reference Manual v2.4, Appendix A, P136-P140&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary></entry><entry><title>编程修养PDF重制版</title><link href="http://seisman.info/better-programming.html" rel="alternate"></link><updated>2014-03-03T14:18:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-03:better-programming.html</id><summary type="html">&lt;p&gt;《编程修养》是&lt;a class="reference external" href="http://coolshell.cn/haoel"&gt;陈皓&lt;/a&gt;在2003年发布在其CSDN博客上的系列文章，介绍了一个合格的程序员在写C/C++程序时应该注意的一些问题。&lt;/p&gt;
&lt;p&gt;原文没有做排版，网络上流传的PDF版本也多是简单的复制粘贴，这让我不能忍啊。&lt;/p&gt;
&lt;p&gt;利用Pandoc和LaTeX重新制作了PDF版本，加入了语法高亮，并修订了一些笔误。&lt;/p&gt;
&lt;p&gt;制作环境:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;CentOS 6.5&amp;nbsp;x86_64&lt;/li&gt;
&lt;li&gt;Pandoc&amp;nbsp;1.9.4.1&lt;/li&gt;
&lt;li&gt;TeX Live&amp;nbsp;2013&lt;/li&gt;
&lt;li&gt;xeCJK&amp;nbsp;3.2.1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;GitHub主页： &lt;a class="reference external" href="https://github.com/seisman/better-programming"&gt;https://github.com/seisman/better-programming&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;PDF下载： &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/better-programming.pdf"&gt;http://seisman.qiniudn.com/downloads/better-programming.pdf&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-03-03:&amp;nbsp;初稿;&lt;/li&gt;
&lt;li&gt;2014-03-06:&amp;nbsp;原PDF中丢失一代码示例，已修改；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="书籍"></category><category term="C"></category></entry><entry><title>使用EPEL和RPMforge源安装netcdf时的冲突</title><link href="http://seisman.info/conflict-between-epel-and-rpmforge.html" rel="alternate"></link><updated>2014-03-03T00:05:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-03:conflict-between-epel-and-rpmforge.html</id><summary type="html">&lt;p&gt;新版本的GMT的编译与运行要求netCDF的版本大于4，且支持netCDF4/&lt;span class="caps"&gt;HDF5&lt;/span&gt;。即如果想要手动编译netCDF4以上的版本，则同时需要编译hdf5，而hdf5又依赖于zlib和szlib等等包，所以手动编译netcdf相当不合算。&lt;/p&gt;
&lt;p&gt;大多数发行版中应该都有netcdf4，所以不会出现太多的问题。&lt;/p&gt;
&lt;p&gt;CentOS官方源中没有netcdf，因而需要使用第三方源，直接将别人已经编译好的文件拿过来使用。其中最常用的就是EPEL和RPMforge。而恰好二者都包含了netcdf、netcdf-devel、hdf5、hdf5-devel包。由此引发了一些冲突。&lt;/p&gt;
&lt;p&gt;EPEL中的netcdf版本为4.1.1，其编译过程中依赖于hdf5，因而当通过&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install netcdf netcdf-devel
&lt;/pre&gt;
&lt;p&gt;安装netcdf时，hdf5以及hdf5-devel会由于依赖关系而被自动安装。&lt;/p&gt;
&lt;p&gt;而RPMforge中netcdf的版本为4.1.2，其编译过程中没有加入hdf5依赖，所以当&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install netcdf netcdf-devel
&lt;/pre&gt;
&lt;p&gt;时，hdf5由于没有被依赖，所以不会被安装。&lt;/p&gt;
&lt;p&gt;所以通过EPEL安装的netcdf4是可以被GMT使用的，而通过RPMforge安装的netcdf4是不能被使用的。而由于RPMforge的netcdf版本比EPEL的版本高，因而两个源共存时，RPMforge的netcdf会被优先安装。（利用优先级插件设置之后好像没有用）&lt;/p&gt;
&lt;p&gt;因而当遇到如下报错时:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
-- Looking for nc_def_var_deflate
-- Looking for nc_def_var_deflate - not found
CMake Error at cmake/modules/FindNETCDF.cmake:127 (message):
Library found but netCDF-4/HDF5 format unsupported. Do not configure
netCDF-4 with --disable-netcdf-4.
Call Stack (most recent call first):
src/CMakeLists.txt:39 (find_package)
&lt;/pre&gt;
&lt;p&gt;需要确认netcdf究竟来自于EPEL还是RPMforge。&lt;/p&gt;
&lt;p&gt;用来检查的命令如下:&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;查看当前系统中所使用的源&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yum repolist
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;查看优先的netcdf-devel的版本以及来自哪个源&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yum info netcdf-devel
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;查看netcdf-devel包依赖于哪些其他包&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yum deplist netcdf-devel
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;查看当前系统中已安装的相关包&lt;/p&gt;
&lt;pre class="literal-block"&gt;
rpm -qa | grep netcdf
rpm -qa | grep hdf5
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;通过以上四个方法确认netcdf以及hdf5均来自于EPEL，则没问题。&lt;/p&gt;
&lt;p&gt;如果确认无误，依然出现如上报错，一个可能的原因是自己曾经尝试编译过netcdf，并禁用了hdf5相关功能，而删除netcdf时没有删除干净，或者怎样。&lt;/p&gt;
&lt;p&gt;如果真的没招了，可以查看编译GMT时的&lt;tt class="docutils literal"&gt;build/CMakeFiles&lt;/tt&gt;目录下的&lt;tt class="docutils literal"&gt;CMakeError.log&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;CMakeOutput.log&lt;/tt&gt;这两个日志文件，寻找与netcdf相关的部分。&lt;/p&gt;
&lt;p&gt;其实质是找到netcdf的动态链接库，并通过如下C代码&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;netcdf.h&amp;gt;&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="cp"&gt;#ifndef nc_def_var_deflate&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;nc_def_var_deflate&lt;/span&gt;&lt;span class="p"&gt;))[&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="cp"&gt;#else&lt;/span&gt;
        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="cp"&gt;#endif&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;检测动态链接库中是否定义了函数&lt;tt class="docutils literal"&gt;nc_def_var_deflate&lt;/tt&gt;。&lt;/p&gt;
</summary><category term="CentOS"></category><category term="GMT5"></category></entry><entry><title>sphinx生成PDF的中文支持问题</title><link href="http://seisman.info/chinese-support-for-sphinx.html" rel="alternate"></link><updated>2014-03-01T10:50:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-03-01:chinese-support-for-sphinx.html</id><summary type="html">
&lt;p&gt;sphinx可以利用LaTeX将rST源文件转换成PDF文件，官方的模板是无法支持中文的，因而必须要对其进行修改。&lt;/p&gt;
&lt;div class="section" id="makefile"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;修改Makefile&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;当执行&lt;tt class="docutils literal"&gt;make latexpdf&lt;/tt&gt;时，会首先执行&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;sphinx-build&lt;/span&gt;&lt;/tt&gt;生成tex源文件，然后调用&lt;tt class="docutils literal"&gt;_build/latex&lt;/tt&gt;目录下的makefile文件，利用pdflatex引擎将tex文件转换为PDF。&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;build/latex&lt;/tt&gt;下的Makefile文件是&lt;tt class="docutils literal"&gt;sphinx/texinputs/Makefile&lt;/tt&gt;的直接拷贝。因而需要修改&lt;tt class="docutils literal"&gt;sphinx/texinputs/Makefile&lt;/tt&gt;，将其中的pdflatex修改成xelatex。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conf-py"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;修改conf.py&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;修改完Makefile之后，直接make latexpdf之后不会报错，但是中文部分完全没有显示，这是因为缺乏中文所需要的字体设置。&lt;/p&gt;
&lt;p&gt;修改conf.py中的latex_elements参数，如下:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;latex_elements&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="c"&gt;# The paper size ('letterpaper' or 'a4paper').&lt;/span&gt;
&lt;span class="c"&gt;#'papersize': 'letterpaper',&lt;/span&gt;

&lt;span class="c"&gt;# The font size ('10pt', '11pt' or '12pt').&lt;/span&gt;
&lt;span class="c"&gt;#'pointsize': '10pt',&lt;/span&gt;
&lt;span class="c"&gt;# Additional stuff for the LaTeX preamble.&lt;/span&gt;
&lt;span class="s"&gt;'preamble'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;r'''&lt;/span&gt;
&lt;span class="s"&gt;     \usepackage{xeCJK}&lt;/span&gt;
&lt;span class="s"&gt;     \setCJKmainfont{SimSun}&lt;/span&gt;
&lt;span class="s"&gt;     \XeTeXlinebreaklocale "zh"&lt;/span&gt;
&lt;span class="s"&gt;     \XeTeXlinebreakskip = 0pt plus 1pt&lt;/span&gt;
&lt;span class="s"&gt;'''&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="latex-py"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;修改latex.py&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;加入了xeCJK相关设置之后编译还是会出现问题:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
! Undefined control sequence.
\GenericError  ...
            #4  \errhelp \@err@     ...
l.2856   }
&lt;/pre&gt;
&lt;p&gt;这是由于xeCJK包与inputenc包发生冲突导致的，因而也需要修改。&lt;/p&gt;
&lt;p&gt;首先在&lt;tt class="docutils literal"&gt;conf.py&lt;/tt&gt;中设置&lt;tt class="docutils literal"&gt;language=zh_CN&lt;/tt&gt;,然后修改&lt;tt class="docutils literal"&gt;sphinx/writers/latex.py&lt;/tt&gt;，在231行左右加入语句对中文做特殊处理：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;language&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;'zh_CN'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'babel'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;''&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'inputenc'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;''&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'utf8extra'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;''&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;第一个语句禁用了babel包，因而其尚不支持中文；第一个语句禁用了inputenc包，其与xeCJK冲突；第三个语句禁用了一个语句，该语句调用了inputenc包中的命令。&lt;/p&gt;
&lt;p&gt;理论上完全可以通过修改conf.py中的latex_elements来禁用各种宏包的。但是实际上sphinx并没有提供禁用utf8extra的参数，即便禁用了inputenc依然是有问题的。&lt;/p&gt;
&lt;p&gt;修改了这些之后，中文应该就没有问题了。在make latexpdf之前注意先make clean就好。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="sphinx"></category><category term="中文"></category><category term="Python"></category></entry><entry><title>使用xeCJK解决中文问题的最小模板</title><link href="http://seisman.info/mini-template-for-xeCJK.html" rel="alternate"></link><updated>2015-03-23T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-02-28:mini-template-for-xeCJK.html</id><summary type="html">&lt;p&gt;LaTeX的中文支持一直是个问题，11年左右刚开始学习LaTeX的时候，那时的中文解决办法是CJK宏包。到了12年或13年的时候，再接触LaTeX的时候，LaTeX中文支持的最优解决办法变成了&lt;tt class="docutils literal"&gt;xeLaTeX+xeCJK&lt;/tt&gt;，这大概是目前为止最优的中文解决方案。&lt;/p&gt;
&lt;p&gt;后来，CTEX学会将xeCJK的功能进行打包，发布了ctex宏包，进一步简化了用LaTeX写中文文档的问题。&lt;/p&gt;
&lt;p&gt;下面是利用&lt;tt class="docutils literal"&gt;xeLaTeX&lt;/tt&gt;和 &lt;tt class="docutils literal"&gt;xeCJK&lt;/tt&gt;实现中文支持的最小模板:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;\documentclass&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;article&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\usepackage&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;xeCJK&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\begin&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;document&lt;span class="nb"&gt;}&lt;/span&gt;
中文English混合示例。
&lt;span class="k"&gt;\end&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;document&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;相对于英文的最小LaTeX模板来说多了两句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
\usepackage{xeCJK}
&lt;/pre&gt;
&lt;p&gt;xeCJK会自动使用TeXLive自带的Fandole字体。想要该模板能够编译通过，需要将TeXLive自带的中文字体安装到系统中，最简单的办法是在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.fonts&lt;/span&gt;&lt;/tt&gt;目录下建一个软链接:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ln -s /opt/texlive/2014/texmf-dist/fonts/opentype/public/fandol ~/.fonts/
&lt;/pre&gt;
&lt;p&gt;用如下命令编译:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xelatex test.tex
&lt;/pre&gt;
</summary><category term="LaTeX"></category><category term="中文"></category></entry><entry><title>制作Pro Git电子书</title><link href="http://seisman.info/make-progit-ebooks.html" rel="alternate"></link><updated>2014-02-22T10:39:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-02-22:make-progit-ebooks.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Pro Git&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Pro Git是一本关于Git的开源书籍，其源文件为MarkDown格式，目前已被翻译为近20种语言。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;项目主页: &lt;a class="reference external" href="https://github.com/progit/progit"&gt;https://github.com/progit/progit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;中文网页版: &lt;a class="reference external" href="http://git-scm.com/book/zh"&gt;http://git-scm.com/book/zh&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;官方网站仅提供英文版的PDF、EPUB和Mobi格式的电子书，因而想要看中文版的电子书就需要自己编译了。&lt;/p&gt;
&lt;p&gt;根据项目主页README的解释，要编译生成三种格式的电子书，需要先安装Ruby、calibre、pandoc、LaTeX。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ruby"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;安装Ruby&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用RVM来管理Ruby的多版本环境。前面介绍的plenv和pyenv好像都是在模仿Ruby的rvm的功能。因而plenv、pyenv、rvm的用法基本是一致的。&lt;/p&gt;
&lt;p&gt;rvm以及ruby的安装参考了&lt;a class="reference external" href="http://ruby-china.org/wiki/rvm-guide"&gt;RVM实用指南&lt;/a&gt; ，实际安装过程中有修改。&lt;/p&gt;
&lt;p&gt;下载并安装rvm:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
curl -L https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer | bash -s stable
&lt;/pre&gt;
&lt;p&gt;这里不采用原文的&lt;tt class="docutils literal"&gt;curl &lt;span class="pre"&gt;-L&lt;/span&gt; get.rvm.io | bash &lt;span class="pre"&gt;-s&lt;/span&gt; stable&lt;/tt&gt;，是因为该网址一直无法连接。&lt;/p&gt;
&lt;p&gt;rvm安装后会自动在&lt;tt class="docutils literal"&gt;.bashrc&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;.bash_profile&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;.zshrc&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;.zlogin&lt;/tt&gt;等文件中加入环境变量信息，需要手动删除或修改以符合自己的需求。&lt;/p&gt;
&lt;p&gt;列出可安装的ruby版本:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
rvm list known
&lt;/pre&gt;
&lt;p&gt;安装最新版本ruby:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
rvm install 2.1.0
&lt;/pre&gt;
&lt;p&gt;安装的时候下载速度比较慢，查看了一下，发现rvm首先检测出我的系统是CentOS6，然后从&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;https://rvm.io/binaries/centos/6/x86_64/ruby-2.1.0.tar.bz2&lt;/span&gt;&lt;/tt&gt;下载软件包到&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.rvm/archives/bin-ruby-2.1.0.tar.bz2&lt;/span&gt;&lt;/tt&gt;。手动实现这一步骤，重新用rvm安装，rvm检测到安装包的完整性便直接使用，加速不少。&lt;/p&gt;
&lt;p&gt;设置当前版本为默认版本:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
rvm use 2.1.0 --default
&lt;/pre&gt;
&lt;p&gt;由于国内网络原因，ruby的官方源会出现间歇性连接失败，因而需要修改rvm的ruby安装源到国内的&lt;a class="reference external" href="http://ruby.taobao.org/"&gt;淘宝镜像服务器&lt;/a&gt;，以提高安装速度:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ gem sources --remove https://rubygems.org/
$ gem sources -a http://ruby.taobao.org/
$ gem sources -l
*** CURRENT SOURCES ***

http://ruby.taobao.org
# 请确保只有 ruby.taobao.org
$ sed -i 's!cache.ruby-lang.org/pub/ruby!ruby.taobao.org/mirrors/ruby!' $rvm_path/config/db
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;安装ruby相关包&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;gem是ruby的包管理器，类似于perl下的cpan和python下的pip。&lt;/p&gt;
&lt;p&gt;官方使用yum来安装相关包:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yum install ruby rubygems ruby-devel rubygem-ruby-debug rubygem-rdiscount
&lt;/pre&gt;
&lt;p&gt;通过rvm已经安装了&lt;tt class="docutils literal"&gt;ruby rubygems &lt;span class="pre"&gt;ruby-devel&lt;/span&gt; &lt;span class="pre"&gt;rubygem-ruby-debug&lt;/span&gt;&lt;/tt&gt;这四个，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;rubygem-rdiscount&lt;/span&gt;&lt;/tt&gt;需要通过gem来安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gem install rdiscount
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="calibre"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;安装calibre&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://calibre-ebook.com/"&gt;calibre&lt;/a&gt;是一个开源的电子书软件套装，可以用来组织、存放、以及管理电子书，支持大多数的电子书格式。同时也支持与许多流行的电子书阅读器进行同步。&lt;/p&gt;
&lt;p&gt;官方强烈不推荐使用系统自带的软件包管理器来安装calibre，其给出的安装方法如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo python -c "import sys; py3 = sys.version_info[0] &amp;gt; 2; u = __import__('urllib.request' if py3 else 'urllib', fromlist=1); exec(u.urlopen('http://status.calibre-ebook.com/linux_installer').read()); main()"
&lt;/pre&gt;
&lt;p&gt;下载相当慢，所以还是手动下载。从 &lt;a class="reference external" href="http://download.calibre-ebook.com/"&gt;http://download.calibre-ebook.com/&lt;/a&gt; 下载合适的版本，然后将其保持到&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/tmp/calibre-installer-cache&lt;/span&gt;&lt;/tt&gt;，再次执行上面的命令就安装完成啦。&lt;/p&gt;
&lt;p&gt;calibre不仅是一个电子书管理器，也是一个电子书阅读器，更是一个电子书格式转换器。这里仅用到格式转换的功能，其他功能尚待挖掘。其支持的格式可以在&lt;a class="reference external" href="http://manual.calibre-ebook.com/faq.html#what-formats-does-app-support-conversion-to-from"&gt;这里&lt;/a&gt;看到。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pandoc"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;安装Pandoc&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;CentOS 6的官方源中貌似是没有Pandoc的，不过EPEL源中有Pandoc:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yum install pandoc
&lt;/pre&gt;
&lt;p&gt;&lt;a class="reference external" href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt;是一个用于从一种标记格式转换为另一种的Haskell库，号称标记格式界的瑞士军刀。其支持markdown, rST, textile, &lt;span class="caps"&gt;HTML&lt;/span&gt;, DocBook, LaTeX, MediaWiki markup, &lt;span class="caps"&gt;OPML&lt;/span&gt;, Haddock markup之间的互相转换。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="latex"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;安装LaTeX&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;安装过程参考《&lt;a class="reference external" href="http://seisman.info/install-texlive-under-linux.html"&gt;Linux下安装TeXLive 2013&lt;/a&gt;》并配置中文字体。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;获取Pro Git源码&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
git clone git://github.com/progit/progit.git
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;制作电子书&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Pro Git的源码中提供了脚本&lt;tt class="docutils literal"&gt;makeebooks&lt;/tt&gt;以制作电子书，其首先将markdown格式做简单处理生成了html文件，然后利用calibre的ebook-convert命令实现html到指定格式的转换。&lt;/p&gt;
&lt;p&gt;制作mobi格式中文文档:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
FORMAT=mobi ruby makeebooks zh
&lt;/pre&gt;
&lt;p&gt;制作epub格式中文文档:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
FORMAT=epub ruby makeebooks zh
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="pdf"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;制作PDF&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ebook-convert支持输出为PDF格式，但是其生成的PDF效果很差，完全不及mobi和epub格式。&lt;/p&gt;
&lt;p&gt;Pro Git 提供了脚本&lt;tt class="docutils literal"&gt;makepdfs&lt;/tt&gt;，本质上是使用了pandoc的格式转换功能，pandoc提供LaTeX模板，并利用LaTeX来更好地实现markdown到PDF的转换。&lt;/p&gt;
&lt;p&gt;在latex目录下，template.tex提供了生成LaTeX所需要的模板，主要是LaTeX的导言区；config.yml为配置文件，需要修改中文字体。&lt;/p&gt;
&lt;p&gt;查看当前系统下的中文字体:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ fc-list :lang=zh
YouYuan,幼圆:style=Regular
AR PL UMing TW:style=Light
AR PL UMing HK:style=Light
NSimSun,新宋体:style=Regular
FangSong,仿宋:style=Regular,Normal,obyčejné,Standard,Κανονικά,Normaali,Normál,Normale,Standaard,Normalny,Обычный,Normálne,Navadno,Arrunta
AR PL UMing CN:style=Light
KaiTi,楷体:style=Regular,Normal,obyčejné,Standard,Κανονικά,Normaali,Normál,Normale,Standaard,Normalny,Обычный,Normálne,Navadno,Arrunta
Adobe Kaiti Std,Adobe 楷体 Std,Adobe Kaiti Std R,Adobe 楷体 Std R:style=R,Regular
SimSun,宋体:style=Regular
AR PL UKai TW MBE:style=Book
AR PL UKai CN:style=Book
AR PL UKai HK:style=Book
AR PL UKai TW:style=Book
WenQuanYi Zen Hei,文泉驛正黑,文泉驿正黑:style=Regular
SimHei,黑体:style=Regular,Normal,obyčejné,Standard,Κανονικά,Normaali,Normál,Normale,Standaard,Normalny,Обычный,Normálne,Navadno,Arrunta
Adobe Heiti Std,Adobe 黑体 Std,Adobe Heiti Std R,Adobe 黑体 Std R:style=R,Regular
Adobe Song Std,Adobe 宋体 Std,Adobe Song Std L,Adobe 宋体 Std L:style=L,Regular
WenQuanYi Zen Hei Mono,文泉驛等寬正黑,文泉驿等宽正黑:style=Regular
LiSu,隶书:style=Regular
AR PL UMing TW MBE:style=Light
Adobe Fangsong Std,Adobe 仿宋 Std,Adobe Fangsong Std R,Adobe 仿宋 Std R:style=R,Regular
WenQuanYi Zen Hei Sharp,文泉驛點陣正黑,文泉驿点阵正黑:style=Regular
&lt;/pre&gt;
&lt;p&gt;修改如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
font: WenQuanYi Zen Hei
bold: WenQuanYi Zen Hei Mono
mono: WenQuanYi Zen Hei Mono
&lt;/pre&gt;
&lt;p&gt;制作:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./makepdfs zh
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Pro Git &lt;span class="caps"&gt;README&lt;/span&gt;: &lt;a class="reference external" href="https://github.com/progit/progit/blob/master/README.md"&gt;https://github.com/progit/progit/blob/master/&lt;span class="caps"&gt;README&lt;/span&gt;.md&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;RVM实用指南 : &lt;a class="reference external" href="http://ruby-china.org/wiki/rvm-guide"&gt;http://ruby-china.org/wiki/rvm-guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;淘宝镜像服务器: &lt;a class="reference external" href="http://ruby.taobao.org/"&gt;http://ruby.taobao.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Calibre Wiki: &lt;a class="reference external" href="http://zh.wikipedia.org/zh-cn/Calibre"&gt;http://zh.wikipedia.org/zh-cn/Calibre&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Pandoc: &lt;a class="reference external" href="http://johnmacfarlane.net/pandoc/"&gt;http://johnmacfarlane.net/pandoc/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="书籍"></category><category term="Ruby"></category><category term="Pandoc"></category><category term="PDF"></category></entry><entry><title>计算某点离海岸线的距离</title><link href="http://seisman.info/calculate-distance-to-coast.html" rel="alternate"></link><updated>2015-02-27T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-02-21:calculate-distance-to-coast.html</id><summary type="html">
&lt;p&gt;要计算某个点到海岸线的距离，思路很简单，先获取离散的海岸线数据，然后计算该点到所有海岸线数据点的距离，取其中的最小值即可认为是海岸线的距离。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;获取海岸线数据&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;海岸线数据可以从GMT的GSHHG数据中提取，命令如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pscoast -Di -Rd -W -m &amp;gt; coast.txt
&lt;/pre&gt;
&lt;p&gt;简单解释一下:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GSHHG包含了5种不同精度的数据，分别为f, h, i, l, c，过高精度的数据包含了太多的细节、过低精度的数据丢失了太多细节。选择哪一种精度的数据需要仔细权衡。&lt;/li&gt;
&lt;li&gt;-R限定了感兴趣的海岸线数据的范围。&lt;/li&gt;
&lt;li&gt;-W表示提取海岸线数据，还可以使用-I提取河流数据，使用-N提取国界数据；&lt;/li&gt;
&lt;li&gt;-m表示将数据以ASCII格式输出&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;需要注意，该命令提取出的海岸线数据包含了全部4个level的数据，即海岸线数据、湖岸线数据、湖内岛数据以及湖内岛的内湖数据，如只需要Level1即海岸线的数据，则需要使用gmtconvert对数据进行进一步处理:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmtconvert coast.txt -m -S"Level 1" &amp;gt; coast_1.txt
&lt;/pre&gt;
&lt;p&gt;该命令的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-S"Level&lt;/span&gt; 1"&lt;/tt&gt;表示仅提头段记录中包含字符“Level 1”的线段。&lt;/p&gt;
&lt;p&gt;在GMT5中，该命令应该这样写:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt pscoast -Di -Rd -W -M &amp;gt; coast.txt
gmt gmtconvert coast.txt -S"Level 1" &amp;gt; coast_1.txt
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;计算点到海岸线的距离&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;div class="section" id="grdmath"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;grdmath&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT的grdmath命令可以对网格数据进行多种数学操作，其中之一就是计算点到海岸线的距离。&lt;/p&gt;
&lt;p&gt;对于网格的每个点，计算该点到海岸线数据的所有点的距离，找出离海岸线最小距离，将该最小距离作为该网格点的Z值。&lt;/p&gt;
&lt;p&gt;GMT设计了这样一个复杂的命令，却没有“计算点到海岸线的距离”这个更基本的命令。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;grdmath示例&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ grdmath -R240/242/30/32 -I1 coast_1.txt LDIST -fg = dist.grd
$ grd2xyz dist.grd
240 32  143.351409912
241 32  104.02256012
242 32  82.0522842407
240 31  249.291519165
241 31  207.351837158
242 31  138.527618408
240 30  183.434417725
241 30  111.675422668
242 30  92.7098999023
&lt;/pre&gt;
&lt;p&gt;说明:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;这里通过-R和-I选项指定网格的区域以及间隔，也可以直接读取一个网格文件；&lt;/li&gt;
&lt;li&gt;参数格式为&lt;tt class="docutils literal"&gt;操作数 操作符 = 输出网格文件名&lt;/tt&gt;，操作符&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;LDIST&lt;/span&gt;&lt;/tt&gt;需要一个操作数&lt;tt class="docutils literal"&gt;coast_1.txt&lt;/tt&gt;。注意这里&lt;tt class="docutils literal"&gt;coast_1.txt&lt;/tt&gt;的位置必须在&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;LDIST&lt;/span&gt;&lt;/tt&gt;之前。&lt;/li&gt;
&lt;li&gt;默认情况下会计算网格点与线段之间的笛卡尔距离，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-fg&lt;/span&gt;&lt;/tt&gt;选项表明输入数据为地理坐标，此时的输出为千米。&lt;/li&gt;
&lt;li&gt;通过grd2xyz可以看到计算的结果，这里计算出了9个点与海岸线的距离，单位千米。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;计算一点到海岸线的距离&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;上面的例子中，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R240/242/30/32&lt;/span&gt; &lt;span class="pre"&gt;-I1&lt;/span&gt;&lt;/tt&gt;指定的网格中包含了9个点，然后计算出了9个点到海岸线的距离。当只需要计算某个点到海岸线的距离时，理论上只要网格中只包含一个点就可以了。&lt;/p&gt;
&lt;p&gt;想要构建一个只含一个点的网格，网格必须使用像素网格配准方式。&lt;/p&gt;
&lt;p&gt;使用默认的网格线配准方式，网格中至少会有四个网格点:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ grdmath -R240/241/30/31 -I1 coast.txt LDIST -fg = dist.grd
$ grd2xyz dist.grd
240 31  249.291519165
241 31  207.351837158
240 30  183.434417725
241 30  111.675422668
&lt;/pre&gt;
&lt;p&gt;通过&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-F&lt;/span&gt;&lt;/tt&gt;使用像素配准方式，则生成的网格中只有一个点:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ grdmath -R240/241/30/31 -I1 -F -fg coast_1.txt LDIST = dist.grd
$ grd2xyz dist.grd
240.5   30.5    184.780654907
&lt;/pre&gt;
&lt;p&gt;想要计算点(240.111, 30.222)到海岸线的距离:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ grdmath -R240.011/240.211/30.122/30.322 -I0.2 -F -fg coast_1.txt LDIST = dist.grd
$ grd2xyz dist.grd
240.111 30.222  188.54675293
&lt;/pre&gt;
&lt;p&gt;注意理解-R和-I是如何选取的！&lt;/p&gt;
&lt;p&gt;在GMT5下命令如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ gmt grdmath -R240.011/240.211/30.122/30.322 -I0.2 -r -fg coast_1.txt LDIST = dist.grd
$ gmt grd2xyz dist.grd
240.111 30.222  188.537643433
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://oceancolor.gsfc.nasa.gov/DOCS/DistFromCoast/"&gt;http://oceancolor.gsfc.nasa.gov/&lt;span class="caps"&gt;DOCS&lt;/span&gt;/DistFromCoast/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-02-01：初稿；&lt;/li&gt;
&lt;li&gt;2015-02-27：使用gmtconvert提取指定Level的数据；grdmath中应使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-fg&lt;/span&gt;&lt;/tt&gt;选项才会计算得到笛卡尔距离；Thanks to Jiangbo；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="距离"></category><category term="GMT技巧"></category></entry><entry><title>地球物理相关软件</title><link href="http://seisman.info/geo-software.html" rel="alternate"></link><updated>2014-02-20T10:20:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-02-20:geo-software.html</id><summary type="html">
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;通用数据处理&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="seismic-analysis-code"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;Seismic Analysis Code&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;版本: 101.6a&lt;/li&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.iris.edu/ds/nodes/dmc/forms/sac/"&gt;http://www.iris.edu/ds/nodes/dmc/forms/sac/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 地震学数据处理的常用软件。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="computer-programs-in-seismology"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;Computer Programs in Seismology&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Fortran&lt;/li&gt;
&lt;li&gt;版本: 3.3.0&lt;/li&gt;
&lt;li&gt;作者: Saint Louis University Earthquake Center&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqccps.html"&gt;http://www.eas.slu.edu/eqc/eqccps.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/cps330-intro.html"&gt;&lt;span class="caps"&gt;CPS330&lt;/span&gt; : Computer Programs in Seismology&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;数据格式转换&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="rdseed"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;rdseed&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;版本: 5.3.1&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.iris.edu/ds/nodes/dmc/forms/rdseed/"&gt;http://www.iris.edu/ds/nodes/dmc/forms/rdseed/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: SEED格式转换为SAC格式&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/install-rdseed.html"&gt;rdseed的安装&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="win32tools"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;win32tools&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.hinet.bosai.go.jp/REGS/manual/dlDialogue.php?r=win32tools"&gt;http://www.hinet.bosai.go.jp/&lt;span class="caps"&gt;REGS&lt;/span&gt;/manual/dlDialogue.php?r=win32tools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: Hi-net提供的工具，用于将WIN32格式的数据转换为SAC格式&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/hinet-win32tools.html"&gt;Hi-net win32tools&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="mseed2sac"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;mseed2sac&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="https://seiscode.iris.washington.edu/projects/mseed2sac"&gt;https://seiscode.iris.washington.edu/projects/mseed2sac&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 将miniSEED格式转换为SAC格式&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;数据获取工具&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="jweed"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;&lt;span class="caps"&gt;JWEED&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;版本: 4.1.1&lt;/li&gt;
&lt;li&gt;语言: Java&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://ds.iris.edu/ds/nodes/dmc/software/downloads/jweed/"&gt;http://ds.iris.edu/ds/nodes/dmc/software/downloads/jweed/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 用Java实现的IRIS数据申请客户端。功能包括：筛选事件、台站以及下载波形数据和仪器响应文件。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;绘图类&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="generic-mapping-tools"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;Generic Mapping Tools&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;版本: 4.5.13 + 5.1.1&lt;/li&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://gmt.soest.hawaii.edu/"&gt;http://gmt.soest.hawaii.edu/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 地球物理方向绘制地图必备神器。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="pssac"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id24"&gt;pssac&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/home.html"&gt;http://www.eas.slu.edu/People/LZhu/home.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 利用GMT强大的绘图库直接绘制地震图&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="jplotresp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id25"&gt;JPlotResp&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Java&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.isti2.com/JPlotResp/"&gt;http://www.isti2.com/JPlotResp/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 绘制RESP仪器响应文件的振幅相位响应谱。可以直接联网查询某台网某台站某个时间的仪器响应，也可以直接处理本地的RESP文件。&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/jplotresp.html"&gt;JPlotResp：绘制地震仪器响应&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="moment-tensor-plotting-and-decomposition"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id26"&gt;Moment tensor Plotting and Decomposition&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Python&lt;/li&gt;
&lt;li&gt;作者: Lars Krieger and Sebastian Heimann&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.larskrieger.de/mopad/"&gt;http://www.larskrieger.de/mopad/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 地震矩分析和绘图软件，可以做地震矩的各种分解以及分析，绘制各种类型的震源球，可控性非常强，比GMT的psmeca命令要灵活，且可以与GMT联合使用。&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/mopad-moment-tensor-plotting-and-decomposition.html"&gt;MoPaD:地震矩绘制和分析工具&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="gmtpy"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id27"&gt;GmtPy&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Python&lt;/li&gt;
&lt;li&gt;版本: 0.1&lt;/li&gt;
&lt;li&gt;作者: Sebastian Heimann&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://emolch.github.io/gmtpy/"&gt;http://emolch.github.io/gmtpy/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/a-python-interface-to-gmt.html"&gt;GMT的Python接口:GmtPy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 该软件已经很久没有更新了，所以不建议使用。GMT5有计划实现Python接口，值得期待一下。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id28"&gt;通用辅助类&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="distaz"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id29"&gt;distaz&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C、Fortran、Java、Python&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.seis.sc.edu/software/distaz/"&gt;http://www.seis.sc.edu/software/distaz/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 给定震中和台站经纬度，计算震中距、方位角和反方位角的经典代码。&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/calculate-dist-az-baz.html"&gt;震中距、方位角和反方位角的计算&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="taup"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id30"&gt;TauP&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Java&lt;/li&gt;
&lt;li&gt;版本: 2.1.2&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.seis.sc.edu/taup/"&gt;http://www.seis.sc.edu/taup/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 强大的走时计算器，不过其功能可不仅仅只是计算走时这么简单。射线参数、射线路径、反射点、投射点都可以计算，支持自定义速度模型、支持不常见的震相。&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/taup-toolkit.html"&gt;走时计算软件TauP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id31"&gt;理论地震图&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="fk"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id32"&gt;fk&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C、Fortran、Perl&lt;/li&gt;
&lt;li&gt;作者: Lupei Zhu&lt;/li&gt;
&lt;li&gt;版本: 3.2&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/home.html"&gt;http://www.eas.slu.edu/People/LZhu/home.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 计算水平分层各向同性介质下理论地震图位移静态解和动态解的常用代码之一。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="shaxi"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id33"&gt;SHaxi&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Fortran&lt;/li&gt;
&lt;li&gt;作者: Gunnar Jahnke, Mike Thorne, Heiner Ige&lt;/li&gt;
&lt;li&gt;版本: 1.0&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://svn.geophysik.uni-muenchen.de/trac/shaxi"&gt;http://svn.geophysik.uni-muenchen.de/trac/shaxi&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 用有限差分方法计算全球尺度高精度SH波场。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="mineos"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id34"&gt;Mineos&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C + Fortran&lt;/li&gt;
&lt;li&gt;版本: 1.0.1&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="https://github.com/geodynamics/mineos"&gt;https://github.com/geodynamics/mineos&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: Normal modes方法计算球对称非旋转地球模型下的合成地震图&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id35"&gt;特定功能类&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="hk"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id36"&gt;hk&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;版本: 1.3&lt;/li&gt;
&lt;li&gt;作者: Lupei Zhu&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/home.html"&gt;http://www.eas.slu.edu/People/LZhu/home.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 用于接收函数研究的代码。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="interactive-receiver-functions-forward-modeller"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id37"&gt;Interactive Receiver Functions Forward Modeller&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Java + Fortran&lt;/li&gt;
&lt;li&gt;版本: 1.1&lt;/li&gt;
&lt;li&gt;作者: Hrvoje Tkalčić&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://rses.anu.edu.au/~hrvoje/IRFFMv1.1.html"&gt;http://rses.anu.edu.au/~hrvoje/IRFFMv1.1.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 一个有界面的接收函数包。程序包中包含了respknt和iterdecon两个已编译的二进制文件而没有给出源代码，因而程序的通用性成为一个大问题。在帮助文档方面，给出了界面的使用说明，没有给出文件格式的说明，对用户来说不够友好。还有就是看完manual之后发现没有理解这个软件是如何工作的。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="ccp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id38"&gt;&lt;span class="caps"&gt;CCP&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C&lt;/li&gt;
&lt;li&gt;版本: 1.0&lt;/li&gt;
&lt;li&gt;作者: Lupei Zhu&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/home.html"&gt;http://www.eas.slu.edu/People/LZhu/home.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 共转换点地震数据叠加，用于接收函数研究。&lt;/li&gt;
&lt;li&gt;博文: &lt;a class="reference external" href="http://seisman.info/compilation-of-ccp.html"&gt;&lt;span class="caps"&gt;CCP1&lt;/span&gt;.0编译&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="generalized-cut-and-paste"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id39"&gt;Generalized Cut-and-Paste&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: C + Fortran + Perl&lt;/li&gt;
&lt;li&gt;版本: 1.0&lt;/li&gt;
&lt;li&gt;作者: Lupei Zhu&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/home.html"&gt;http://www.eas.slu.edu/People/LZhu/home.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 用于反演震源机制解的CAP方法，虽然是1.0版，实际上N年前国内就已经有很多人在使用这个代码了。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="adaptive-stacking"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id40"&gt;Adaptive Stacking&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;语言: Fortran&lt;/li&gt;
&lt;li&gt;版本: 1.0&lt;/li&gt;
&lt;li&gt;作者: Nick Rawlinson and Brian Kennett&lt;/li&gt;
&lt;li&gt;网址: &lt;a class="reference external" href="http://rses.anu.edu.au/seismology/soft/astack/index.html"&gt;http://rses.anu.edu.au/seismology/soft/astack/index.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;说明: 震相对齐。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="理论地震图"></category><category term="SAC"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>全球水深数据GEBCO</title><link href="http://seisman.info/gebco-global-bathymetry-data.html" rel="alternate"></link><updated>2014-02-05T00:24:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-02-05:gebco-global-bathymetry-data.html</id><summary type="html">&lt;p&gt;GEBCO全称General Bathymetric Chart of the&amp;nbsp;Oceans，给出了全球海水深度数据。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;官方网站： &lt;a class="reference external" href="http://www.gebco.net"&gt;http://www.gebco.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;数据精度：30弧秒和1弧分。&lt;/li&gt;
&lt;li&gt;数据格式：netCDF，可直接用于GMT绘图。&lt;/li&gt;
&lt;li&gt;下载地址：&lt;a class="reference external" href="http://www.bodc.ac.uk/data/online_delivery/gebco/"&gt;http://www.bodc.ac.uk/data/online_delivery/gebco/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;说明&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GEBCO数据中包含了陆地高程和海水深度数据&lt;/li&gt;
&lt;li&gt;陆地高程数据来自于SRTM30和GTOPO30等&lt;/li&gt;
&lt;li&gt;海水深度数据来自于Smith and&amp;nbsp;Sandwell的全球地形数据和290百万个海水深度探测数据&lt;/li&gt;
&lt;li&gt;ETOPO1与之类似，但不确定细节上有何区别。&lt;/li&gt;
&lt;li&gt;GEBCO数据需要注册方可下载&lt;/li&gt;
&lt;li&gt;30弧秒的数据大小为1.1G&lt;/li&gt;
&lt;li&gt;1弧分的数据大小为275M&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="地形"></category><category term="数据"></category><category term="网格"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>CIG软件列表</title><link href="http://seisman.info/cig-software-library.html" rel="alternate"></link><updated>2014-02-02T00:30:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-02-02:cig-software-library.html</id><summary type="html">
&lt;p&gt;&lt;span class="caps"&gt;CIG&lt;/span&gt;，Computational Infrastructure for Geodynamics。&lt;/p&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="http://www.geodynamics.org/"&gt;http://www.geodynamics.org/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;软件下载： &lt;a class="reference external" href="http://www.geodynamics.org/cig/software"&gt;http://www.geodynamics.org/cig/software&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Github项目主页： &lt;a class="reference external" href="https://github.com/geodynamics"&gt;https://github.com/geodynamics&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;网站提供的软件包分类如下：&lt;/p&gt;
&lt;div class="section" id="short-term-crustal-dynamics"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Short-Term Crustal Dynamics&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;PyLith：地壳形变的动态和准静态模拟；1D、2D、3D；有限元；串行、并行；用于研究地震和火山；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;RELAX&lt;/span&gt;：evaluates the displacement and stress in a half space with gravity due to dislocations, Mogi sources, and surface tractions; and the nonlinear time-dependent deformation that follows due to power-law rheology materials in the bulk and/or rate-strengthening friction faults.&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;SELEN&lt;/span&gt;：solves numerically the so-called "Sea Level Equation" (&lt;span class="caps"&gt;SLE&lt;/span&gt;) for a spherical, layered, non-rotating Earth with Maxwell viscoelastic rheology.&lt;/li&gt;
&lt;li&gt;LithoMop：岩石圈形变模拟；粘弹/塑性变形；有限元；PyLith的原始版本；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="long-term-tectonics"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Long-Term Tectonics&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Gale：2D/3D code for the long-term tectonics community. The code solves problems related to orogenesis, rifting, and subduction with coupling to surface erosion models.&lt;/li&gt;
&lt;li&gt;Plasti：2D &lt;span class="caps"&gt;ALE&lt;/span&gt; (Arbitrary Lagrangian Eulerian) code donated to &lt;span class="caps"&gt;CIG&lt;/span&gt; by Sean Willett and Chris Fuller of the University of Washington. The code originated at Dalhousie University in Canada.&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;SNAC&lt;/span&gt;：Updated Lagrangian explicit finite difference code for modeling a finitely deforming elasto-visco-plastic solid in 3D.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="mantle-convection"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Mantle Convection&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Aspect：Finite element parallel code to simulate problems in thermal convection in both 2D and 3D models - currently in alpha testing.&lt;/li&gt;
&lt;li&gt;CitcomCU：Finite element parallel code capable of modeling thermochemical convection in a three dimensional domain appropriate for convection within the Earth’s mantle.&lt;/li&gt;
&lt;li&gt;CitcomS：Finite element code designed to solve compressible thermochemical convection problems relevant to Earth’s mantle.&lt;/li&gt;
&lt;li&gt;ConMan：Finite element program for the solution of the equations of incompressible, infinite-Prandtl number convection in two dimensions, originally written by Scott King, Arthur Raefsky, and Brad Hager.&lt;/li&gt;
&lt;li&gt;Ellipsis3d：Three-dimensional version of the particle-in-cell finite element code Ellipsis, a solid modeling code for visco-elastoplastic materials. The particle-in-cell method combines the strengths of the Lagrangian and Eulerian formulations of mechanics while bypassing their limitations.&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;HC&lt;/span&gt;：Global mantle circulation solver following Hager &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; O’Connell (1981) which can compute velocities, tractions, and geoid for simple density distributions and plate velocities.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="seismology"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Seismology&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Specfem3D：地震波波传播模拟；谱元法；3D沉积盆地；&lt;/li&gt;
&lt;li&gt;Specfem3D Globe：地震波波场模拟；全球或大区域；3D；谱元法；&lt;/li&gt;
&lt;li&gt;Specfem3D Geotech：谱元法；3D slope stability analysis and simulation of 3D multistage excavation；&lt;/li&gt;
&lt;li&gt;Specfem2D：谱元法；2D；波场模拟；acoustic、(an)elastic、poroelastic or coupled acoustic-(an)elastic-poroelastic media.&lt;/li&gt;
&lt;li&gt;Specfem1D：谱元法；波场模拟；1D；演示代码；&lt;/li&gt;
&lt;li&gt;Mineos：合成地震图；1D模型；球对称非旋转地球模型；normal mode summation.&lt;/li&gt;
&lt;li&gt;Flexwin：Automates the time-window selection problem for seismologists. It operates on pairs of observed and synthetic single component seismograms, defining windows that cover as much of a given seismogram as possible, while avoiding portions of the waveform that are dominated by noise.&lt;/li&gt;
&lt;li&gt;Seismic &lt;span class="caps"&gt;CPML&lt;/span&gt;：Eight open-source Fortran90 programs to solve the two-dimensional or three-dimensional isotropic or anisotropic elastic, viscoelastic or poroelastic wave equation using a finite-difference method with Convolutional Perfectly Matched Layer (C-&lt;span class="caps"&gt;PML&lt;/span&gt;) conditions；&lt;/li&gt;
&lt;li&gt;Finite-Frequency Tomography Software：For the programs documented in Nolet, G., A Breviary of Seismic Tomography (&lt;span class="caps"&gt;CUP&lt;/span&gt;, 2008).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="geodynamo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Geodynamo&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Calypso：Set of codes for parallel magnetohydrodynamics dynamo simulation in a rotating spherical shell using spherical harmonics expansion methods.&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;MAG&lt;/span&gt;：Serial version of a rotating spherical convection/magnetoconvection/dynamo code, developed by Gary Glatzmaier and modified by Uli Christensen and Peter Olson.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="computational-science"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Computational Science&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Geodynamics &lt;span class="caps"&gt;AMR&lt;/span&gt; Suite (deal.&lt;span class="caps"&gt;II&lt;/span&gt;)：C++ program library targeted at the computational solution of partial differential equations using adaptive finite elements. Its state-of-the-art programming techniques offer a modern interface to the complex data structures and algorithms required. &lt;span class="caps"&gt;CIG&lt;/span&gt; has sponsored Wolfgang Bangerth (Texas A&amp;amp;M) to produce tutorials that use deal.&lt;span class="caps"&gt;II&lt;/span&gt; in various implementations.&lt;/li&gt;
&lt;li&gt;Cigma：Suite of tools that facilitates the comparison of numerical models, and performs error analysis, benchmarking, and code verification.&lt;/li&gt;
&lt;li&gt;Exchanger：Package containing several C++ base classes. These classes, when customized for a solver, can provide communication channels between solvers. This packaged is used by CitcomS for solver coupling.&lt;/li&gt;
&lt;li&gt;Pythia/Pyre：Pyre framework and a collection of packages that interact with it, such as an interface to the &lt;span class="caps"&gt;ACIS&lt;/span&gt; solid modeling package.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="网站"></category><category term="理论地震图"></category></entry><entry><title>GMT cpt文件库</title><link href="http://seisman.info/gmt-cpt-city.html" rel="alternate"></link><updated>2014-01-30T00:33:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-30:gmt-cpt-city.html</id><summary type="html">&lt;p&gt;GMT4自带了24个cpt文件，GMT5自带了36个cpt文件。如何选择合适的cpt文件是个很头疼的问题，以后再研究。&lt;/p&gt;
&lt;p&gt;cpt-city是一个网站，在很多Linux发行版中也是一个软件包，其包含了众多cpt文件（6000+个）。&lt;/p&gt;
&lt;p&gt;网址： &lt;a class="reference external" href="http://soliton.vm.bytemark.co.uk/pub/cpt-city/"&gt;http://soliton.vm.bytemark.co.uk/pub/cpt-city/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;该网站包含多种格式的cpt文件：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GMT的cpt格式；&lt;/li&gt;
&lt;li&gt;CSS3的c3g格式；&lt;/li&gt;
&lt;li&gt;GIMP的ggr格式；&lt;/li&gt;
&lt;li&gt;Gnuplot的gpf格式；&lt;/li&gt;
&lt;li&gt;Paint Shop&amp;nbsp;Pro或Photoshop支持的grd格式；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;POV&lt;/span&gt;-Ray的inc格式；&lt;/li&gt;
&lt;li&gt;svg格式；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其提供了软件包&lt;a class="reference external" href="http://soliton.vm.bytemark.co.uk/pub/jjg/en/code/cptutils.html"&gt;cptutils&lt;/a&gt;实现了不同cpt格式之间的转换，同时也提供了一个简洁方便的&lt;a class="reference external" href="http://soliton.vm.bytemark.co.uk/pub/cptutils-online/"&gt;在线版本&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;cpt按照用途来分类：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Palettes for &lt;a class="reference external" href="views/bath.html"&gt;bathymetry&lt;/a&gt; and a selection of &lt;a class="reference external" href="views/blues.html"&gt;blues&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Palettes for &lt;a class="reference external" href="views/topo.html"&gt;topography&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Mixed palettes for &lt;a class="reference external" href="views/topobath.html"&gt;topography and&amp;nbsp;bathymetry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Schemes for &lt;a class="reference external" href="views/temp.html"&gt;temperature&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Schemes for &lt;a class="reference external" href="views/rain.html"&gt;precipitation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Various &lt;a class="reference external" href="views/reds.html"&gt;reds&lt;/a&gt;, &lt;a class="reference external" href="views/greys.html"&gt;greys&lt;/a&gt;, &lt;a class="reference external" href="views/greens.html"&gt;greens&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Schemes for &lt;a class="reference external" href="views/div.html"&gt;diverging&lt;/a&gt;&amp;nbsp;data&lt;/li&gt;
&lt;li&gt;Palettes with &lt;a class="reference external" href="views/transparency.html"&gt;transparency&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Gradients of &lt;a class="reference external" href="views/discord.html"&gt;discordance&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不得不说，有些cpt绘制出的图真心好看。&lt;/p&gt;
</summary><category term="CPT"></category><category term="GMT4"></category><category term="GMT5"></category><category term="网站"></category></entry><entry><title>查看IRIS台站分布</title><link href="http://seisman.info/iris-station-distribution.html" rel="alternate"></link><updated>2014-01-28T00:21:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-28:iris-station-distribution.html</id><summary type="html">&lt;p&gt;IRIS利用Google&amp;nbsp;Map服务，提供了直观查看台站分布的方法。&lt;/p&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="http://www.iris.edu/gmap/"&gt;http://www.iris.edu/gmap/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这个服务比较特别，不包含常见的按钮或选项。用户需要根据网站介绍的格式，创建自己需要的URL，直接输入到浏览器中即可查看相关台站分布，并可以查看每个台站的具体信息。&lt;/p&gt;
&lt;p&gt;基本格式为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/[network]/[station]?key1=value1&amp;amp;key2=value2
&lt;/pre&gt;
&lt;p&gt;其中中括号包围的项为可选项，问号后接(key,value)对。具体参见原网站。&lt;/p&gt;
&lt;p&gt;下面是一些例子：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;列出II台网的全部台站:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/?net=II
&lt;/pre&gt;
&lt;p&gt;其等效于:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/II
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;列出IU台网的COLA台站:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/IU/COLA
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;列出虚拟台网_GSN:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/\_GSN
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;列出TA台网2004下半年的所有台站:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/TA?timewindow=2004/6/1-2004/12/31
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;列出_GSN台网1988年工作的所有台站:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/\_GSN?timewindow=1988-1988
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;列出一定范围内的所有台站:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://www.iris.edu/gmap/?minlat=46&amp;amp;maxlat=49&amp;amp;minlon=-125&amp;amp;maxlon=-117
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="IRIS"></category><category term="台站"></category></entry><entry><title>IRIS FTP数据下载脚本</title><link href="http://seisman.info/perl-script-for-downloading-iris-ftp-data.html" rel="alternate"></link><updated>2014-01-25T00:40:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-25:perl-script-for-downloading-iris-ftp-data.html</id><summary type="html">&lt;p&gt;前文说到了IRIS官方给出的几种FTP数据下载方式，除此之外，还有很多方法。比如直接浏览器右键另存为，比如Windows下迅雷的下载链接自动识别，再比如Firefox浏览器+附加组件&amp;quot;DownThemAll!&amp;quot;。这些工具其实和前文说的下载方法类似，都有各种各样的缺点。&lt;/p&gt;
&lt;p&gt;下面的Perl脚本实现了IRIS&amp;nbsp;FTP数据的下载，其思路如下：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;登录IRIS的ftp，获取ftp内的全部文件列表，保存到本地文件ftp.filelist中；&lt;/li&gt;
&lt;li&gt;由于IRIS&amp;nbsp;ftp里的数据默认会保存7天，且用户无删除权限，因而可能有些ftp中的数据已经下载了，所以在本地需要有一个已经下载的数据的列表local.filelist；&lt;/li&gt;
&lt;li&gt;读取ftp.filelist和local.filelist的内容，检查ftp.filelist中的文件是否在local.filelist中，若在则不下载，若不在则下载。&lt;/li&gt;
&lt;li&gt;所有文件下载完成后，则意味着ftp.filelist中的全部文件都已在本地，更新local.filelist。&lt;/li&gt;
&lt;li&gt;重复步骤1,2,3,若ftp.filelist与local.filelist不同则意味着下载过程中有新数据到达，继续下载（这一步其实可以手动重复执行该脚本，而不需要在脚本内部进行循环）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;脚本的一些特性：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;已下载的数据可以移动到其他文件夹，这些数据不会重复下载；（需要重复下载时可手动修改local.filelist）&lt;/li&gt;
&lt;li&gt;FTP中所有不在local.filelist中的文件都会被下载；&lt;/li&gt;
&lt;li&gt;若local.filelist为空，则ftp中所有数据都会被下载；&lt;/li&gt;
&lt;li&gt;若local.filelist包含了7天以前的数据下载信息，这些数据已经在FTP中被删除，这种情况脚本可以处理，不需要删除local.filelist；&lt;/li&gt;
&lt;li&gt;检测本地数据的大小与ftp中数据的大小是否相等，保证了数据的完整性；若不相等，则不将文件名写入local.filelist。&lt;/li&gt;
&lt;li&gt;当脚本或网络由于外部因素出现中断导致数据不完整时，借助于wget断点续传功能，可以直接重新运行该脚本，而不做任何特殊处理。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;cite&gt;irisFetch.pl &amp;lt;https://gist.github.com/seisman/2ccefac15c4cd3239382&amp;gt;&lt;/cite&gt;&lt;/p&gt;
&lt;p&gt;代码预览：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Perl script to fetch seed data form IRIS FTP&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Author:  SeisMan @ seisman.info&lt;/span&gt;
&lt;span class="c1"&gt;#  Date:    05/16/2013&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Modules:&lt;/span&gt;
&lt;span class="c1"&gt;#   1. Net::FTP     #  It is already installed for most Linux OS&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Description:&lt;/span&gt;
&lt;span class="c1"&gt;#   1. $passwd is your email address&lt;/span&gt;
&lt;span class="c1"&gt;#   2. $cmd and $option is tool for downloading&lt;/span&gt;
&lt;span class="c1"&gt;#       $cmd = &amp;quot;wget&amp;quot;;  $option = &amp;quot;-c&amp;quot;;&lt;/span&gt;
&lt;span class="c1"&gt;#   3. ftp.filelist contains all the data in the ftp (less than 7 days).&lt;/span&gt;
&lt;span class="c1"&gt;#   4. local.filelist contains all the file you have already download,&lt;/span&gt;
&lt;span class="c1"&gt;#      file in ftp.filelist but not in local.filelist will be downloaded,&lt;/span&gt;
&lt;span class="c1"&gt;#      so do not delete local.filelist.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Revision History:&lt;/span&gt;
&lt;span class="c1"&gt;#   05/16/2013  SeisMan    Initial Coding&lt;/span&gt;
&lt;span class="c1"&gt;#   01/16/2014  SeisMan    Modify to a serial script&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Net::&lt;/span&gt;&lt;span class="n"&gt;FTP&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;############# Personal Infomation #############&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;XXXXXXXX&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$passwd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;xxxx@xxxxxxxxxx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;#############################################################&lt;/span&gt;
&lt;span class="c1"&gt;## DO NOT MODIFY BELOW UNLESS YOU KNOW WHAT YOU ARE DOING! ##&lt;/span&gt;
&lt;span class="c1"&gt;#############################################################&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;ftp.iris.washington.edu&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$login&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$dir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;pub/userdata&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;# download tools&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$cmd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;wget&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$option&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;# get filelist of ftp&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="bp"&gt;STDERR&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Fetching filelist from $server...\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;ftp_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$server&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$login&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$passwd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$user&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="c1"&gt;# lists&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@ftp_list&lt;/span&gt;    &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;   &lt;span class="c1"&gt;# all the files in ftp&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@local_list&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;   &lt;span class="c1"&gt;# files already downloaded&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@finish_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;   &lt;span class="c1"&gt;# files already downloaded&lt;/span&gt;
　　　　　　　　　　　　　&lt;span class="c1"&gt;#  + files downloaded successfully in this run.&lt;/span&gt;

&lt;span class="c1"&gt;# read ftp filelist&lt;/span&gt;
&lt;span class="nb"&gt;open&lt;/span&gt; &lt;span class="n"&gt;FTP&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;lt; ftp.filelist&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;die&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Can&amp;#39;t open ftp.filelist! \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;@ftp_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sr"&gt;&amp;lt;FTP&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt; &lt;span class="n"&gt;FTP&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;# read local filefilst&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;local.filelist&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="nb"&gt;open&lt;/span&gt; &lt;span class="n"&gt;LOCAL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;lt; local.filelist&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;die&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Can&amp;#39;t open local.filelist\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nv"&gt;@local_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sr"&gt;&amp;lt;LOCAL&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nb"&gt;chomp&lt;/span&gt; &lt;span class="nv"&gt;@local_list&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt; &lt;span class="n"&gt;LOCAL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;############################ start downloading ##############################&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@ftp_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$ftp_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$ftp_size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;split&lt;/span&gt; &lt;span class="sr"&gt;/\s+/&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;# determine $ftp_file downloaded or not&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$in&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@local_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nb"&gt;chomp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_&lt;/span&gt; &lt;span class="o"&gt;=~&lt;/span&gt; &lt;span class="nv"&gt;$ftp_file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nv"&gt;$in&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;last&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nv"&gt;$in&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="c1"&gt;# already downloaded&lt;/span&gt;
        &lt;span class="nb"&gt;push&lt;/span&gt; &lt;span class="nv"&gt;@finish_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$ftp_file&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;# need to be downloaded&lt;/span&gt;
        &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$cmd $option $server/$dir/$user/$ftp_file&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="c1"&gt;# err = 0 means succeed in downloading&lt;/span&gt;
        &lt;span class="c1"&gt;# err = 1 means downloading error&lt;/span&gt;
        &lt;span class="c1"&gt;# err = 2 means interrupt by user&lt;/span&gt;
        &lt;span class="nb"&gt;push&lt;/span&gt; &lt;span class="nv"&gt;@finish_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$ftp_file&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;$err&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="nv"&gt;$ftp_file&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nv"&gt;$ftp_size&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;########################## end downloading ##################################&lt;/span&gt;

&lt;span class="c1"&gt;# update local.filelist&lt;/span&gt;
&lt;span class="nb"&gt;open&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;gt; local.filelist&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;die&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Can&amp;#39;t open local.filelist\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@finish_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$_\n&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="sr"&gt;/seed/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;sub &lt;/span&gt;&lt;span class="nf"&gt;ftp_list&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$server&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$login&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$passwd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;@_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$ftp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nn"&gt;Net::&lt;/span&gt;&lt;span class="n"&gt;FTP&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;Host&lt;/span&gt;    &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="nv"&gt;$server&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Debug&lt;/span&gt;   &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;die&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Can&amp;#39;t connect to $server\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nv"&gt;$ftp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$login&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nv"&gt;$passwd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nv"&gt;$ftp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;cwd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;$dir/$user&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$ftp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="nv"&gt;$ftp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="nb"&gt;open&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;gt; ftp.filelist&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@files&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;/seed$/&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
        &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@line&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;split&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;$line[8] $line[4]\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;一些说明：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;用户只需要修改$user和$passwd即可使用，其中$passwd为邮箱；&lt;/li&gt;
&lt;li&gt;该脚本为串行版本，并行和多线程版本暂不公开；&lt;/li&gt;
&lt;li&gt;该脚本经过测试，但不对其任何特性做任何保证；由于使用该脚本造成的任何损失或损害，由用户自己负责；&lt;/li&gt;
&lt;li&gt;任何疑问、评论、Bug报告，可以在当前页面留言，或邮件联系seisman.info&amp;#64;gmail.com；&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="breq_fast"></category><category term="IRIS"></category><category term="数据"></category><category term="Perl"></category></entry><entry><title>IRIS FTP数据下载的几个方法</title><link href="http://seisman.info/download-data-from-iris-ftp.html" rel="alternate"></link><updated>2014-01-24T00:48:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-24:download-data-from-iris-ftp.html</id><summary type="html">
&lt;p&gt;从IRIS申请地震数据，有些工具会将准备好的数据放在ftp中，供用户下载。&lt;/p&gt;
&lt;p&gt;FTP地址格式如下： &lt;a class="reference external" href="ftp://ftp.iris.washington.edu/pub/userdata/USERNAME"&gt;ftp://ftp.iris.washington.edu/pub/userdata/&lt;span class="caps"&gt;USERNAME&lt;/span&gt;&lt;/a&gt;，其中USERNAME因人而异。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;下载方式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;官方提供了三种数据下载方式：&lt;/p&gt;
&lt;div class="section" id="ftp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;登录FTP下载&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
$ ftp ftp.iris.washington.edu
Name (iris:joe): anonymous # 匿名登录
Password: JoeSeismologist@email.net # 密码随意，建议填写邮件地址
ftp&amp;gt; cd pub/userdata
ftp&amp;gt; ls -f
ftp&amp;gt; cd Joe_Seismologist # 进入自己的目录
ftp&amp;gt; ls -l
ftp&amp;gt; binary # 二进制传输
ftp&amp;gt; mget * # 下载所有文件
ftp&amp;gt; quit
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="wget"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;wget下载全部文件&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
wget -P Directory -m -nd -np -r -c ftp://ftp.iris.washington.edu/pub/userdata/USERNAME/
&lt;/pre&gt;
&lt;p&gt;其中&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Directory为要保存的文件路径，默认为当前目录；&lt;/li&gt;
&lt;li&gt;-m等效于-r -N -l inf —no-remove-listing，其中-r表示对文件夹进行递归，-N表示只下载比本地文件新的文件；-l指定递归深度，inf表示无穷递归；&lt;/li&gt;
&lt;li&gt;-nd表示不在本地重建目录结构，这意味着无论FTP中的目录结构有多复杂，所有文件都保存到本地的一个目录中；&lt;/li&gt;
&lt;li&gt;-np表示不遍历父目录；&lt;/li&gt;
&lt;li&gt;-r表示递归下载；&lt;/li&gt;
&lt;li&gt;-c表示支持断点续传；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;wget下载单个或多个文件&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
wget -P Directory -m -nd -np -r -c -A "FileName" ftp://ftp.iris.washington.edu/pub/userdata/USERNAME/
&lt;/pre&gt;
&lt;p&gt;其中-A表示只下载"FileName"指定的文件。FileName可以表示后缀也可以表示模式，当FileName中只包含英文字母时，则表示后缀，比如FileName为seed，则表示下载所有以seed为后缀的文件。&lt;/p&gt;
&lt;p&gt;当FileName中包含通配符&lt;tt class="docutils literal"&gt;* ? [ ]&lt;/tt&gt;时，FileName表示模式，只下载文件名符合该模式的文件，比如FileName为”2010*.seed“，则表示只下载所有文件名匹配”2010*.seed“的文件。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;缺点&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在大批量数据的情况下，上面三种方法都有一些缺点。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;FTP方法，使用ftp自带的mget命令进行下载，不支持断点续传，难以指定要下载哪些文件。&lt;/li&gt;
&lt;li&gt;wget下载全部数据，若FTP中的数据已存在于当前目录，则不会再次下载。这要求下载好的数据不能从当前目录中移除。一般来说数据下载和数据处理是同步进行的，这样就要求在下载目录中和数据处理目录中存有两份相同的数据。更严重的是，IRIS的FTP数据可以保留7天，今天申请的数据与3天前申请将会下载到同一目录中，不利用用户对SEED文件进行整理。&lt;/li&gt;
&lt;li&gt;wget下载指定数据，如果每次申请的数据是有规律的，比如先申请2004年数据，申请-&amp;gt;等待-&amp;gt;下载，再申请2005年数据，这样可以使用通配符来指定下载数据。若数据申请没有类似规律，则会非常麻烦。理论上，使用BREQ_FAST申请数据时，可以为数据指定LABEL，则SEED文件名为LABEL.xxxx.seed，其中xxxx为"随机数"，因而用户在申请时是无法完全知道seed文件的全名的，又因为wget不支持&lt;tt class="docutils literal"&gt;wget &lt;span class="pre"&gt;http://example.com/20100101.*.seed&lt;/span&gt;&lt;/tt&gt;这样的语法，因而对于数据申请不规律的情况，第三种方法也是很有问题的。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="breq_fast"></category><category term="IRIS"></category><category term="数据"></category></entry><entry><title>IRIS DMC虚拟台网列表</title><link href="http://seisman.info/iris-virtual-network-list.html" rel="alternate"></link><updated>2014-01-19T00:30:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-19:iris-virtual-network-list.html</id><summary type="html">&lt;p&gt;网址： &lt;a class="reference external" href="http://www.iris.edu/vnets"&gt;http://www.iris.edu/vnets&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;列出了IRIS DMC提供的全部53个虚拟台网，常听说的有&lt;tt class="docutils literal"&gt;_GSN&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;_PBO&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;_US-&lt;span class="caps"&gt;TA&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;，所有虚拟台网的台网名以下划线开头。&lt;/p&gt;
&lt;p&gt;对于每个虚拟台网，可以查询到其包含的台站、该台站所属的真实台网，台站的有效工作时间。进一步，可以了解每个台站的具体信息。&lt;/p&gt;
</summary><category term="台网"></category><category term="IRIS"></category></entry><entry><title>计算某日是一年中的第几天</title><link href="http://seisman.info/calculate-jday.html" rel="alternate"></link><updated>2014-08-25T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-18:calculate-jday.html</id><summary type="html">&lt;p&gt;两个子程序，ymd2doy用于从年月日计算该日为当年的第几天，doy2ymd用于根据年份以及该年的第几天来确定月和日。&lt;/p&gt;
&lt;p&gt;ymd2doy的代码很粗暴，直接定义了leap和noleap数组，简单粗暴，忘了该代码片段的来源了。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;noleap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;59&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;120&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;151&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;181&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;212&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;243&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;273&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;304&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;334&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;   &lt;span class="n"&gt;leap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;91&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;152&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;182&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;213&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;244&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;274&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;305&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;335&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="cm"&gt;/* convert month and day to day of year */&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;ymd2doy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;leap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;noleap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="cm"&gt;/* convert day of year to month and day */&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;doy2ymd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;days_since_start&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;days_since_start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;leap&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="n"&gt;days_since_start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;noleap&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;doy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;days_since_start&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;days_since_start&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;days_since_start&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;下面是另一个版本：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;days_in_month&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;ymd2doy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;doy&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;days_in_month&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ISLEAP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;doy&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;doy2ymd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;leap&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;leap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ISLEAP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;doy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;dim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;days_in_month&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leap&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="section" id="id2"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2014-01-18：初稿；&lt;/li&gt;
&lt;li&gt;2014-08-23：将Perl版修改为C版，并加入了doy2ymd；&lt;/li&gt;
&lt;li&gt;2014-08-25：新增了另一个版本的代码；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="时间"></category><category term="C"></category></entry><entry><title>freqlimits的选取</title><link href="http://seisman.info/how-to-choose-freqlimits.html" rel="alternate"></link><updated>2014-01-16T09:33:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-16:how-to-choose-freqlimits.html</id><summary type="html">&lt;p&gt;真实的地面运动，其频谱范围是非常广泛的，从0&amp;nbsp;Hz到几千Hz甚至更高。&lt;/p&gt;
&lt;p&gt;下文全部假定采样间隔为T=0.01s。&lt;/p&gt;
&lt;p&gt;根据奈奎斯特采样定理，采样频率为f=1/T=100 Hz，相应的Nyquist采样频率为f&amp;#8217;=f/2=50 Hz。即当采样间隔为T=0.01 s时，频率低于50 Hz的信号会被正确采样并可以重建原信号，而频率高于50 Hz的信号则会与频率对于50&amp;nbsp;Hz的信号发生混叠。因而，在模拟信号转换为数字信号之前，必须要使用一个低通模拟滤波器或其他数字滤波手段。&lt;/p&gt;
&lt;p&gt;无论怎样，信号在经过采样之后，信号中高于50Hz的部分必须被削弱，因而仪器响应的振幅谱在接近50&amp;nbsp;Hz时迅速下降为0或者非常小的值。&lt;/p&gt;
&lt;p&gt;去除仪器响应，实际上就是频率域的除法，直接做除法会在大于50&amp;nbsp;Hz时出现除以0或小值的情况。因而就需要使用freqlimits。&lt;/p&gt;
&lt;p&gt;freqlimits有四个参数，f1、f2、f3、f4，满足&lt;tt class="docutils literal"&gt;f1&amp;lt;f2&amp;lt;f3&amp;lt;f4&lt;/tt&gt;，其中f4必须小于或等于50Hz，对于其他参数没有过多要求。&lt;/p&gt;
&lt;p&gt;一般而言，f2到f3之间的范围应尽量宽。&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/Questions/qa0001.html"&gt;http://www.eas.slu.edu/eqc/eqc_cps/Questions/qa0001.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/Questions/qa0002.html"&gt;http://www.eas.slu.edu/eqc/eqc_cps/Questions/qa0002.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="仪器响应"></category></entry><entry><title>全球地震目录PDE</title><link href="http://seisman.info/global-earthquake-catalog-pde.html" rel="alternate"></link><updated>2014-01-15T00:38:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-15:global-earthquake-catalog-pde.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;PDE&lt;/span&gt;，是USGS的NEIC组织发布的全球地震目录，全称Preliminary Determination of Epicenters。之所以称为Preliminary，是因为一般认为International Seismological Centre发布的地震目录是终极版。&lt;/p&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="http://earthquake.usgs.gov/research/data/pde.php"&gt;http://earthquake.usgs.gov/research/data/pde.php&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;目录&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;一个完整的PDE目录包含了三个部分：daily &lt;span class="caps"&gt;PDE&lt;/span&gt;、weekly PDE以及monthly &lt;span class="caps"&gt;PDE&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="daily-pde"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Daily &lt;span class="caps"&gt;PDE&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;又称为QED(Quick Epicenters Determinations)或PDE-Q，包含了最近六周的地震事件，每日更新。一段时间以后，Daily PDE中的地震事件会被删除，然后该事件会被添加到Weekly PDE中。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="weekly-pde"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;Weekly &lt;span class="caps"&gt;PDE&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;又称为PDE-W，一般含有6周以前到几个月以前的地震事件，每年52个文件，每个文件包含7天的数据（最后一个文件包含8或9天数据）。Daily PDE中的事件经过修正之后会加入到Weekly PDE中，Weekly PDE中的事件在添加了一些注释信息后会从PDE-W中删除，并添加到Monthly PDE中。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="monthly-pde"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;Monthly &lt;span class="caps"&gt;PDE&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;PDE地震目录的终极版。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;文件格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;三种文件格式：mchedr、ehdf、isf。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;格式说明&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;mchedr： &lt;a class="reference external" href="ftp://hazards.cr.usgs.gov/weekly/mchedr.txt"&gt;ftp://hazards.cr.usgs.gov/weekly/mchedr.txt&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ehdf： &lt;a class="reference external" href="ftp://hazards.cr.usgs.gov/weekly/ehdf.txt"&gt;ftp://hazards.cr.usgs.gov/weekly/ehdf.txt&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;isf: &lt;a class="reference external" href="ftp://colossus.iris.washington.edu/pub/ISF/isf_ext.pdf"&gt;ftp://colossus.iris.washington.edu/pub/&lt;span class="caps"&gt;ISF&lt;/span&gt;/isf_ext.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;简单说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ehdf格式，一个事件一行记录，包含了发震时刻、震源深度、震级以及其他少量信息，一般情况下已经够用。&lt;/p&gt;
&lt;p&gt;mchedr格式，一个事件多行记录，除包含了ehdf格式的信息之外，还包含了地震宏观观测、震相和振幅信息，适合有特殊需求的人使用。&lt;/p&gt;
&lt;p&gt;isf格式主要是用来与其他机构的地震目录进行数据交换用的，一般用不到。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;链接&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Monthly &lt;span class="caps"&gt;PDE&lt;/span&gt;： &lt;a class="reference external" href="ftp://hazards.cr.usgs.gov/pde/"&gt;ftp://hazards.cr.usgs.gov/pde/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Weekly &lt;span class="caps"&gt;PDE&lt;/span&gt;： &lt;a class="reference external" href="ftp://hazards.cr.usgs.gov/weekly/"&gt;ftp://hazards.cr.usgs.gov/weekly/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="USGS"></category><category term="地震目录"></category><category term="震源机制解"></category><category term="震级"></category></entry><entry><title>全球数字高程数据：ASTER GDEM</title><link href="http://seisman.info/aster-gdem.html" rel="alternate"></link><updated>2014-01-12T00:57:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-12:aster-gdem.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;ASTER&lt;/span&gt; &lt;span class="caps"&gt;GDEM&lt;/span&gt;，即先进星载热发射和反射辐射仪全球数字高程模型，与SRTM一样为数字高程DEM，其全球空间分辨率为30米。该数据是根据NASA的新一代对地观测卫星Terra的详尽观测结果制作完成的。其数据覆盖范围为北纬83°到南纬83°之间的所有陆地区域，达到了地球陆地表面的99%。（摘自百度百科）。号称是“迄今最完整的全球地形数据”。&lt;/p&gt;
&lt;p&gt;网站： &lt;a class="reference external" href="http://gdem.ersdac.jspacesystems.or.jp"&gt;http://gdem.ersdac.jspacesystems.or.jp&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;基本信息&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;空间分辨率：1弧度秒 （约30 米）&lt;/p&gt;
&lt;p&gt;精度：垂直精度20米，水平精度30米&lt;/p&gt;
&lt;p&gt;更多信息： &lt;a class="reference external" href="http://www.gscloud.cn/userfiles/file/gdem3.pdf"&gt;http://www.gscloud.cn/userfiles/file/gdem3.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;其他信息&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;网站需要注册，即可免费下载数据；&lt;/li&gt;
&lt;li&gt;点击“Search”即可进入数据选择界面；&lt;/li&gt;
&lt;li&gt;数据被划分为1度*1度的区块，每个区块文件名以区块左下角的经纬度值来命名；&lt;/li&gt;
&lt;li&gt;数据选择界面有四种方式用来选择区块，界面的设计不太习惯，注意看英文；&lt;/li&gt;
&lt;li&gt;数据可以单独下载，也可以批量下载；批量下载貌似需要处理一段时间；&lt;/li&gt;
&lt;li&gt;下载的文件为zip压缩文件，包含了两个文件：dem和num，二者均为GeoTiff格式；&lt;/li&gt;
&lt;li&gt;dem数据即为数字高程数据；&lt;/li&gt;
&lt;li&gt;num数据也称为QA文件，即质量评估文件，其包含了每一点的高程数据的来源等信息，一般用不到；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;格式转换&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用GDAL提供的工具将其转换为GMT可识别的netCDF格式：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gdal_translate -of GMT ASTGTM2_N36E111_dem.tif ASTGTM2_N36E111_dem.grd
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="srtm"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;与SRTM的区别&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;SRTM数据的纬度覆盖范围是[-60,60]，&lt;span class="caps"&gt;ASTER&lt;/span&gt; GDEM数据的纬度覆盖范围为[-83,83]；&lt;/li&gt;
&lt;li&gt;SRTM的空间分辨率一般为90m，只有美国境内存在空间分辨率为30m的数据；&lt;span class="caps"&gt;ASTER&lt;/span&gt; GDEM的空间分辨率为30m；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="地形"></category><category term="数据"></category><category term="格式转换"></category><category term="GMT5"></category><category term="GMT4"></category><category term="高程"></category></entry><entry><title>GeoTiff格式转GMT netCDF格式</title><link href="http://seisman.info/convert-geotiff-to-gmt.html" rel="alternate"></link><updated>2014-01-11T00:41:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-11:convert-geotiff-to-gmt.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://www.gdal.org/"&gt;&lt;span class="caps"&gt;GDAL&lt;/span&gt;&lt;/a&gt;提供了不少小工具，其中，&lt;tt class="docutils literal"&gt;gdal_translate&lt;/tt&gt;可用于网格数据的格式转换。&lt;/p&gt;
&lt;p&gt;下面的命令可以将GeoTiff格式的数据转换为GMT可识别的netCDF格式:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gdal_translate -of GMT srtm_56_05.tif srtm_56_05.nc
&lt;/pre&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;gdal_translate&lt;/tt&gt;的语法如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Usage: gdal_translate [--help-general] [--long-usage]
       [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
             CInt16/CInt32/CFloat32/CFloat64}] [-strict]
       [-of format] [-b band] [-mask band] [-expand {gray|rgb|rgba}]
       [-outsize xsize[%] ysize[%]]
       [-unscale] [-scale[_bn] [src_min src_max [dst_min dst_max]]]* [-exponent[_bn] exp_val]*
       [-srcwin xoff yoff xsize ysize] [-projwin ulx uly lrx lry] [-epo] [-eco]
       [-a_srs srs_def] [-a_ullr ulx uly lrx lry] [-a_nodata value]
       [-gcp pixel line easting northing [elevation]]*
       [-mo &amp;quot;META-TAG=VALUE&amp;quot;]* [-q] [-sds]
       [-co &amp;quot;NAME=VALUE&amp;quot;]* [-stats] [-norat]
       src_dataset dst_dataset
&lt;/pre&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-of&lt;/span&gt;&lt;/tt&gt;后接要转换的数据格式，使用&lt;tt class="docutils literal"&gt;gdal_translate &lt;span class="pre"&gt;--long-usage&lt;/span&gt;&lt;/tt&gt;可以看到，支持的格式如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
VRT: Virtual Raster
GTiff: GeoTIFF
NITF: National Imagery Transmission Format
HFA: Erdas Imagine Images (.img)
ELAS: ELAS
AAIGrid: Arc/Info ASCII Grid
DTED: DTED Elevation Raster
PNG: Portable Network Graphics
JPEG: JPEG JFIF
MEM: In Memory Raster
GIF: Graphics Interchange Format (.gif)
FITS: Flexible Image Transport System
XPM: X11 PixMap Format
BMP: MS Windows Device Independent Bitmap
PCIDSK: PCIDSK Database File
PCRaster: PCRaster Raster File
ILWIS: ILWIS Raster Map
SGI: SGI Image File Format 1.0
SRTMHGT: SRTMHGT File Format
Leveller: Leveller heightfield
Terragen: Terragen heightfield
GMT: GMT NetCDF Grid Format
netCDF: Network Common Data Format
HDF4Image: HDF4 Dataset
ERS: ERMapper .ers Labelled
JPEG2000: JPEG-2000 part 1 (ISO/IEC 15444-1)
FIT: FIT Image
RMF: Raster Matrix Format
RST: Idrisi Raster A.1
INGR: Intergraph Raster
GSAG: Golden Software ASCII Grid (.grd)
GSBG: Golden Software Binary Grid (.grd)
R: R Object Data Store
PNM: Portable Pixmap Format (netpbm)
ENVI: ENVI .hdr Labelled
EHdr: ESRI .hdr Labelled
PAux: PCI .aux Labelled
MFF: Vexcel MFF Raster
MFF2: Vexcel MFF2 (HKV) Raster
BT: VTP .bt (Binary Terrain) 1.3 Format
IDA: Image Data and Analysis
USGSDEM: USGS Optional ASCII DEM (and CDED)
ADRG: ARC Digitized Raster Graphics
BLX: Magellan topo (.blx)
Rasterlite: Rasterlite
SAGA: SAGA GIS Binary Grid (.sdat)
&lt;/pre&gt;
</summary><category term="格式转换"></category><category term="GMT5"></category></entry><entry><title>地震波形数据格式</title><link href="http://seisman.info/iris-data-formats.html" rel="alternate"></link><updated>2014-01-10T00:49:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-10:iris-data-formats.html</id><summary type="html">
&lt;p&gt;地震数据的格式，大概分为两种：一种是以归档和交换为目的的格式，比如SEED，这种格式要求一个文件中包含足够多的数据信息，如果可能的话，进行数据压缩，以减少数据传输量和数据存储空间；另一种是以数据处理为目的的格式，比如SAC，这种格式一般只包含单个台站单个分量或多分量的数据。这里简介一下IRIS提供的以归档和交换为目的的数据格式。&lt;/p&gt;
&lt;div class="section" id="seed"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;&lt;span class="caps"&gt;SEED&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;全称是The Standard for the Exchange of Earthquake Data，其设计的目的是为了数据交换和归档，因而不适宜直接数据处理，一般使用rdseed将seed格式转换为其他数据格式。&lt;/p&gt;
&lt;p&gt;一个完整的SEED数据包含了时间序列以及台站的相关信息。完整的SEED数据又可以分解为两个部分：只包含时间序列的miniSEED格式和只包含台站信息的Dataless SEED格式。完整的SEED格式的说可以参考SEED Reference Manual。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="miniseed"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;miniSEED&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;miniSEED格式是SEED格式的一个子集，其只包含时间序列和极少量的其他信息。&lt;/p&gt;
&lt;p&gt;一个连续的时间序列在SEED格式中被分为若干等长的数据段，这样做的目的还不清楚，也许是出于数据实时传递的考虑。对于实时数据流，段长度为512-byte，对于归档数据段长度为4096-byte。&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://seiscode.iris.washington.edu/projects/libmseed"&gt;libmseed&lt;/a&gt;是一个比较友好的函数库，可以用于读写miniSEED文件。&lt;/p&gt;
&lt;p&gt;miniSEED数据可以通过BREQ_FAST获取，其邮箱地址为：&lt;a class="reference external" href="mailto:miniseed@iris.washington.edu"&gt;miniseed@iris.washington.edu&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="dataless-seed"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Dataless &lt;span class="caps"&gt;SEED&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;dataless SEED中只包含台站的坐标以及仪器响应信息，而不包含任何时间序列。&lt;/p&gt;
&lt;p&gt;为什么要将台站信息保存到单独的文件中？因为台站位置以及仪器响应等信息，在相当长一段时间内（1年的量级）是保持不变的，当大量申请SEED数据时，数据中的台站信息部分大量重复。由于dataless SEED中记录了台站信息的变化历史，因而在大量数据的情况下，将台站信息单独存放更加经济。&lt;/p&gt;
&lt;p&gt;获取dataless SEED数据的几种方法：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;在线申请： &lt;a class="reference external" href="http://www.iris.edu/data/DatalessRequest.htm"&gt;http://www.iris.edu/data/DatalessRequest.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;根据BREQ_FAST格式发送邮件到dataless@iris.washington.edu&lt;/li&gt;
&lt;li&gt;从&lt;a class="reference external" href="http://www.iris.edu/bud_stuff/bud/bud_start.pl?BUDDIR=/budnas/virtualnets/ALL"&gt;&lt;span class="caps"&gt;BUD&lt;/span&gt;&lt;/a&gt;申请&lt;/li&gt;
&lt;li&gt;直接从IRIS的&lt;a class="reference external" href="http://www.iris.edu/pub/RESPONSES/DATALESS_SEEDS/"&gt;&lt;span class="caps"&gt;FTP&lt;/span&gt;&lt;/a&gt;下载&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="stationxml"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;StationXML&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;与dataless SEED类似，保存台站信息。详细信息在&lt;a class="reference external" href="http://www.fdsn.org/xml/station/"&gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="simple-ascii"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Simple &lt;span class="caps"&gt;ASCII&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ASCII格式，占用硬盘空间，不常用。&lt;a class="reference external" href="http://www.iris.edu/dms/nodes/dmc/data/formats/simple-ascii/"&gt;格式说明&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="格式"></category></entry><entry><title>sacdump</title><link href="http://seisman.info/sacdump.html" rel="alternate"></link><updated>2014-01-09T00:36:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-09:sacdump.html</id><summary type="html">
&lt;p&gt;sacdump是一个与SAC相关的小程序。&lt;/p&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="https://seiscode.iris.washington.edu/projects/sacdump"&gt;https://seiscode.iris.washington.edu/projects/sacdump&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ sacdump -h
sacdump version: 1.0

Dump information from SAC formatted files

Usage: sacdump [options] file1 [file2 file3 ...]

## Options ##
-V Report program version
-h Show this usage message
-v Be more verbose, multiple flags can be used
-p header Print specified header field, can be specified multiple times
-a Print a list of all defined header values
-b Print bare output without file name
-d Print first 20 sample values
-D Print all sample values
-tf format Specify time format for data sample output
-s Print basic sample value statistics
-m metafile Write common metadata output to file
-me Write additional fields into the metadata output
-f format Specify input SAC file format (default is autodetect):
0=autodetect, 1=alpha, 2=binary (detect byte order),
3=binary (little-endian), 4=binary (big-endian)

file(s) File(s) of SAC input data
If a file is prefixed with an '@' it is assumed to contain
a list of data files to be read
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;示例&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;获取单个文件的单个头段变量值:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sacdump -p stla TA.ELFS..LHZ.SAC
TA.ELFS..LHZ.SAC:
40.6183
&lt;/pre&gt;
&lt;p&gt;获取单个文件的多个头段变量值:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sacdump -p stla -p stlo TA.ELFS..LHZ.SAC
TA.ELFS..LHZ.SAC:
40.6183 -120.728
&lt;/pre&gt;
&lt;p&gt;加上-b选项，输出对于脚本更友好:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sacdump -p stla -b TA.ELFS..LHZ.SAC
40.6183
&lt;/pre&gt;
&lt;p&gt;输出全部已定义的头段变量:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sacdump -a TA.ELFS..LHZ.SAC
TA.ELFS..LHZ.SAC:
DELTA = 1
SCALE = 6.25202e+08
B = 0.000542
E = 2399
STLA = 40.6183
STLO = -120.728
STEL = 1553
STDP = 0
CMPAZ = 0
CMPINC = 0
KZDATE = MAY 03 (123), 2006
KZTIME = 15:35:00.069
NVHDR = 6
NORID = 0
NEVID = 0
NPTS = 2400
IFTYPE = 1
IDEP = 5
LEVEN = 1
LPSPOL = 0
LCALDA = 1
KSTNM = ELFS
KHOLE =
KCMPNM = LHZ
KNETWK = TA
&lt;/pre&gt;
&lt;p&gt;获取数据的最值、均值等信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sacdump -s TA.ELFS..LHZ.SAC
TA.ELFS..LHZ.SAC:
Min: -231490, Max: 259058, Mean: -9.24625, SD: 33471.8, RMS: 33471.9
&lt;/pre&gt;
&lt;p&gt;输出数据的前20个点:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sacdump -d TA.ELFS..LHZ.SAC
TA.ELFS..LHZ.SAC:
Data samples:
2006,123,15:35:00.069541 85
2006,123,15:35:01.069541 -44
2006,123,15:35:02.069541 -106
2006,123,15:35:03.069541 -172
2006,123,15:35:04.069541 -52
2006,123,15:35:05.069541 -45
2006,123,15:35:06.069541 106
2006,123,15:35:07.069541 245
2006,123,15:35:08.069541 -79
2006,123,15:35:09.069541 -312
2006,123,15:35:10.069541 -96
2006,123,15:35:11.069541 135
2006,123,15:35:12.069541 40
2006,123,15:35:13.069541 -90
2006,123,15:35:14.069541 39
2006,123,15:35:15.069541 84
2006,123,15:35:16.069541 -98
2006,123,15:35:17.069541 -128
2006,123,15:35:18.069541 -24
2006,123,15:35:19.069541 40
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;简评&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;sacdump可以自动检测数据格式（ASCII或二进制，big endian或little endian），这个比较有意思，不知道具体原理是怎样的。源码中涉及到了SAC文件的读取，作者使用了libmseed库，实在有些大才小用了。程序在打印头段方面与saclst功能类似，对于一个文件，其默认输出为两行：一行是文件名，一行是头段变量值；这种设计在处理多个文件时很不友好。使用-b选项输出只有一行，对于脚本来说相对比较友好，但不适合处理多文件。&lt;/p&gt;
&lt;/div&gt;
</summary></entry><entry><title>CPS330 : Computer Programs in Seismology</title><link href="http://seisman.info/cps330-intro.html" rel="alternate"></link><updated>2014-01-01T18:36:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2014-01-01:cps330-intro.html</id><summary type="html">&lt;p&gt;CPS全称Computer Programs in&amp;nbsp;Seismology，是圣路易斯大学地震中心开发并维护的一款地震学软件包，其主要关注地震波在地壳和上地幔介质中的传播和解释。&lt;/p&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqccps.html"&gt;http://www.eas.slu.edu/eqc/eqccps.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;最新版本：3.30&lt;/p&gt;
&lt;p&gt;更新日期：2013-11-08&lt;/p&gt;
&lt;p&gt;软件包中包含了完整的&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/CPS/CPS330.html"&gt;说明文档&lt;/a&gt;，即使不使用该软件，文档中的一些内容还是有参考价值的。&lt;/p&gt;
&lt;p&gt;软件包的源码可以在&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/CPS/cpslisc.html"&gt;这里&lt;/a&gt;申请，第一次下载的时候可以申请一下，以后其实可以从&lt;a class="reference external" href="ftp://ftp.eas.slu.edu/pub/rbh/PROGRAMS.330"&gt;&lt;span class="caps"&gt;FTP&lt;/span&gt;&lt;/a&gt;直接下载。&lt;/p&gt;
&lt;p&gt;软件包还在不断&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/cpsbug.html"&gt;更新&lt;/a&gt;中。官方给了不少&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/TUTORIAL/"&gt;教程&lt;/a&gt;，不仅仅教授如何使用软件，同时也介绍了很多地震学的基础知识，同时还有不少用户的问题以及开发者的&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/Questions/"&gt;回答&lt;/a&gt;。另外官方也会有一些不错的&lt;a class="reference external" href="http://www.eas.slu.edu/eqc/eqc_cps/workshop.html"&gt;Notes&lt;/a&gt;值得一看。&lt;/p&gt;
&lt;p&gt;软件包包含了如下代码：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;合成地震图代码（主要是平层介质）&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;广义射线法；&lt;/li&gt;
&lt;li&gt;波数积分法；&lt;/li&gt;
&lt;li&gt;模态叠加法；&lt;/li&gt;
&lt;li&gt;渐进射线理论；&lt;/li&gt;
&lt;/ul&gt;
&lt;ol class="arabic simple" start="2"&gt;
&lt;li&gt;地壳结构研究&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;面波频散；&lt;/li&gt;
&lt;li&gt;远震P波接收函数；&lt;/li&gt;
&lt;li&gt;面波频散和接收函数联合反演；&lt;/li&gt;
&lt;/ul&gt;
&lt;ol class="arabic simple" start="3"&gt;
&lt;li&gt;区域地震及远震震源反演&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;震源深度；&lt;/li&gt;
&lt;li&gt;震源机制解；&lt;/li&gt;
&lt;li&gt;地震矩；&lt;/li&gt;
&lt;/ul&gt;
&lt;ol class="arabic simple" start="4"&gt;
&lt;li&gt;&lt;span class="caps"&gt;GSAC&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;GSAC可以认为是SAC的重新实现，作者给了一些需要重写SAC的理由。&lt;/p&gt;
&lt;ol class="arabic simple" start="5"&gt;
&lt;li&gt;&lt;span class="caps"&gt;CALPLOT&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;为了实现代码的易移植性，CPS自带了CALPLOT绘图包。&lt;/p&gt;
</summary><category term="理论地震图"></category><category term="参考模型"></category><category term="接收函数"></category><category term="震源机制解"></category></entry><entry><title>全球地形起伏数据：SRTM30_PLUS</title><link href="http://seisman.info/srtm30-plus.html" rel="alternate"></link><updated>2013-12-31T19:10:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-12-31:srtm30-plus.html</id><summary type="html">&lt;ul class="simple"&gt;
&lt;li&gt;主页：&lt;a class="reference external" href="http://topex.ucsd.edu/WWW_html/srtm30_plus.html"&gt;http://topex.ucsd.edu/WWW_html/srtm30_plus.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;精度：30弧秒（约1km）&lt;/li&gt;
&lt;li&gt;版本：V11（20141129）&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;数据说明&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;整个数据被分为33个文件，与GTOPO30相同；&lt;/li&gt;
&lt;li&gt;同时也提供了单个包含全部地形数据的二进制文件；&lt;/li&gt;
&lt;li&gt;提供了1分和2分精度的netCDF格式网格文件；&lt;/li&gt;
&lt;li&gt;大部分陆地区域使用SRTM30中的陆地高程数据；&lt;/li&gt;
&lt;li&gt;SRTM在高纬度陆地区域无数据，则使用GTOPO30数据；&lt;/li&gt;
&lt;li&gt;纬度[-81,81]范围内的海底地形数据来自于Smith和Sandwell的全球1分数据；&lt;/li&gt;
&lt;li&gt;更高精度的数据来自于&lt;a class="reference external" href="http://ocean-ridge.ldeo.columbia.edu/general/html/home.html"&gt;&lt;span class="caps"&gt;LDEO&lt;/span&gt; Ridge Multibeam Synthesis Project&lt;/a&gt;、&lt;a class="reference external" href="http://www.jamstec.go.jp/cruisedata/e/"&gt;&lt;span class="caps"&gt;JAMSTEC&lt;/span&gt; Data Site for Research Cruises&lt;/a&gt;和&lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/coastal/coastal.html"&gt;&lt;span class="caps"&gt;NGDC&lt;/span&gt; Coastal Relief Model&lt;/a&gt;。&lt;/li&gt;
&lt;li&gt;两极地区的数据来自于&lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/bathymetry/arctic/arctic.html"&gt;International Bathymetric Chart of the Oceans&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其他信息：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/README.V11.txt"&gt;说明文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/SRTM30_PLUS.kmz"&gt;Google&amp;nbsp;KMZ文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/srtm30/"&gt;srtm30格式&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;数据的使用&lt;/h2&gt;
&lt;div class="section" id="xyz"&gt;
&lt;h3&gt;XYZ格式&lt;/h3&gt;
&lt;p&gt;下载： &lt;a class="reference external" href="http://topex.ucsd.edu/cgi-bin/get_srtm30.cgi"&gt;&lt;span class="caps"&gt;ASCII&lt;/span&gt;&amp;nbsp;XYZ格式&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;比如下载的经度[5,7]，纬度[5,7]范围内的数据，可使用如下GMT5命令转换:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt xyz2grd data.xyz -Gdata.nc -R5/7/5/7 -I30s/30s -r -V
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="topo30"&gt;
&lt;h3&gt;topo30格式&lt;/h3&gt;
&lt;p&gt;二进制格式: &lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/topo30/topo30"&gt;ftp://topex.ucsd.edu/pub/srtm30_plus/topo30/topo30&lt;/a&gt;
netCDF格式: &lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/topo30/topo30.grd"&gt;ftp://topex.ucsd.edu/pub/srtm30_plus/topo30/topo30.grd&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;数据有1.&lt;span class="caps"&gt;7GB&lt;/span&gt;，直接下载netCDF即可使用。&lt;/p&gt;
&lt;p&gt;若是下载了二进制格式的，可以向&lt;tt class="docutils literal"&gt;grdraser&lt;/tt&gt;中添加如下语句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
44 &amp;quot;SRTM30_PLUS&amp;quot;                &amp;quot;m&amp;quot;     -R0/360/-90/90          -I0.5m          PG i 1           0    -9999      srtm30_plus B
&lt;/pre&gt;
&lt;p&gt;未测试，同时不建议这样使用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;srtm30格式&lt;/h3&gt;
&lt;p&gt;SRTM30_PLUS遵循了&lt;a class="reference external" href="2013-08-11_global-digital-elevation-model-gtopo30.rst"&gt;&lt;span class="caps"&gt;GTOPO30&lt;/span&gt;&lt;/a&gt;的数据处理方法，其将全球分为33个区块。GTOPO30仅包含了陆地的地形数据，而SRTM30_PLUS则包含了陆地地形和海洋深度数据，因而SRTM30_PLUS完全可以替代GTOPO30数据。&lt;/p&gt;
&lt;p&gt;二进制格式: &lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/srtm30/data/"&gt;ftp://topex.ucsd.edu/pub/srtm30_plus/srtm30/data/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;SRTM30_PLUS的二进制格式的使用方法与GTOPO30相同，不再多说。&lt;/p&gt;
&lt;p&gt;netCDF格式: &lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/srtm30/grd/"&gt;ftp://topex.ucsd.edu/pub/srtm30_plus/srtm30/grd/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;SRTM30_PLUS同时提供了33个区块的netCDF格式的网格文件，可以直接用于GMT绘图。&lt;/p&gt;
&lt;p&gt;从二进制到netCDF格式的转换，使用了&lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/srtm30/grd/bin2grd"&gt;bin2grd脚本&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="topo1topo2"&gt;
&lt;h3&gt;topo1和topo2&lt;/h3&gt;
&lt;p&gt;SRTM30_PLUS同时提供了1分和2分精度的数据，这个数据应该与ETOPO1和ETOPO2类似。直接用ETOPO就好。&lt;/p&gt;
&lt;p&gt;topo1: &lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/topo1_topo2/topo1.grd"&gt;ftp://topex.ucsd.edu/pub/srtm30_plus/topo1_topo2/topo1.grd&lt;/a&gt;
topo2: &lt;a class="reference external" href="ftp://topex.ucsd.edu/pub/srtm30_plus/topo1_topo2/topo2.grd"&gt;ftp://topex.ucsd.edu/pub/srtm30_plus/topo1_topo2/topo2.grd&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-12-31：初稿；&lt;/li&gt;
&lt;li&gt;2015-04-07：更新版本，增加了对不同格式的说明；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="地形"></category><category term="网格"></category><category term="高程"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>绘制中国边界需要注意的问题汇总</title><link href="http://seisman.info/gmt-china-boundary-problems.html" rel="alternate"></link><updated>2013-12-30T22:17:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-12-30:gmt-china-boundary-problems.html</id><summary type="html">
&lt;p&gt;在中国，发表论文若地图中涉及到中国边界时，图件需要上报进行审核。具体审核哪些内容，我没有细致地找过相关文件和制图要求。&lt;/p&gt;
&lt;p&gt;一直听说GMT绘制的中国边界有问题，无法直接发表，需要做额外的处理。这篇文章总结一下GMT在绘制中国边界时需要注意的一些问题。&lt;/p&gt;
&lt;p&gt;我没有绘制中国边界的需求，所以没有认真研究过究竟需要注意哪些问题，下面的问题列表还需要更多的补充和修订。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;九段线数据&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT自带的数据中没有九段线数据，因而在绘制中国边界时需要额外提供九段线数据。目前没有找到比较官方的九段线数据。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;边界问题&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;前面的系列博文&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/introduction-to-dcw-gmt5.html"&gt;GMT5的DCW数据简介&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="filename}/GMT/2013-11-21_usage-of-dcw-data.rst"&gt;GMT5的DCW数据的使用&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/gmt-map-coloring.html"&gt;GMT技巧之利用DCW数据进行区域涂色&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/china-administrative-areas-data.html"&gt;中国行政区划数据下载&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;中介绍了如何利用DCW数据和公开的行政区划数据绘制省界和国界等，这两种方法绘制的边界都存在问题，无法直接用于发表。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;麦克马洪线&lt;/li&gt;
&lt;li&gt;新疆地区中印边界&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如何绘制中国边界，这个问题很重要，不过目前对这个问题没太大的兴趣。&lt;/p&gt;
&lt;p&gt;关于边界差异的细节可以参考&lt;a class="reference external" href="http://hi.baidu.com/yangleir"&gt;Altimetry 技术空间&lt;/a&gt;博客里的&lt;a class="reference external" href="http://hi.baidu.com/yangleir/item/09dc00074c9b6d35a3332a33"&gt;这篇博文&lt;/a&gt;中的第一张图。&lt;/p&gt;
&lt;p&gt;未完待续。。&lt;/p&gt;
&lt;p&gt;欢迎补充。。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>脚本中调用SAC时不显示版本信息</title><link href="http://seisman.info/sac-display-copyright.html" rel="alternate"></link><updated>2013-12-26T20:52:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-12-26:sac-display-copyright.html</id><summary type="html">&lt;p&gt;在终端使用SAC时默认会出现版本信息，如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sac
SEISMIC ANALYSIS CODE [11/11/2013 (Version 101.6a)]
Copyright 1995 Regents of the University of California

SAC&amp;gt;
&lt;/pre&gt;
&lt;p&gt;若在SAC宏文件或者bash、perl脚本中多次调用SAC命令的话，则会重复出现版本信息，严重干扰了宏文件或脚本的输出，对于用户来说是很糟糕的体验。&lt;/p&gt;
&lt;p&gt;版本信息的显示由环境变量SAC_DISPLAY_COPYRIGHT来控制，其可以取值为0或1，其中1代表显示版本信息（默认值），0代表不显示版本信息。&lt;/p&gt;
&lt;p&gt;在Bash脚本中，可以这样写:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC_DISPLAY_COPYRIGHT=0
&lt;/pre&gt;
&lt;p&gt;在Perl脚本中，可以这样写:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ENV{SAC_DISPLAY_COPYRIGHT} = 0 ;
&lt;/pre&gt;
</summary><category term="SAC技巧"></category><category term="版本"></category></entry><entry><title>CCP1.0编译</title><link href="http://seisman.info/compilation-of-ccp.html" rel="alternate"></link><updated>2013-11-29T16:37:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-29:compilation-of-ccp.html</id><summary type="html">
&lt;p&gt;Prof. Lupei Zhu最近又在网上公开了两个程序包，CCP和CAP。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;CCP&lt;/span&gt;，即Common-Conversion-Point，用于共转换点地震数据的叠加，这个程序主要与&lt;a class="reference external" href="http://seisman.info/compilation-of-hk.html"&gt;hk1.3&lt;/a&gt;一起使用，用于接收函数的研究。&lt;/p&gt;
&lt;p&gt;安装方法以及一些修改与hk1.3类似：&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;下载与解压&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;wget http://www.eas.slu.edu/People/LZhu/downloads/ccp1.0.tar
&lt;span class="nv"&gt;$ &lt;/span&gt;tar -xvf ccp1.0.tar
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;ccp
&lt;span class="nv"&gt;$ &lt;/span&gt;make clean
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="makefile"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;修改Makefile&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在Makefile中加入如下两行，定义变量&lt;tt class="docutils literal"&gt;GMT_INC&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;GMT_LIB&lt;/tt&gt;：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;GMT_INC&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; -I/opt/GMT/include
&lt;span class="nv"&gt;GMT_LIBS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; -L/opt/GMT/lib -lgmt -lpsl -lnetcdf -lm -s
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;编译&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ make
&lt;/pre&gt;
&lt;/div&gt;
</summary><category term="接收函数"></category><category term="编译"></category></entry><entry><title>中国行政区划数据下载</title><link href="http://seisman.info/china-administrative-areas-data.html" rel="alternate"></link><updated>2013-11-23T00:35:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-23:china-administrative-areas-data.html</id><summary type="html">
&lt;div class="section" id="gadm"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;GADM数据库&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;GADM&lt;/span&gt;，是一个全球行政区划数据库。包括了几乎全部国家和地区的国界、省界以及更小的行政区划。&lt;/p&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="http://www.gadm.org/"&gt;http://www.gadm.org/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下载： &lt;a class="reference external" href="http://www.gadm.org/country"&gt;http://www.gadm.org/country&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;数据格式包括：shapefile、&lt;span class="caps"&gt;ESRI&lt;/span&gt; geodatabase、RData、Google Earth kmz format。&lt;/p&gt;
&lt;p&gt;在GADM中，country的定义为“any entity with an &lt;span class="caps"&gt;ISO&lt;/span&gt; country code”。关于ISO country code，可以参考维基百科相关&lt;a class="reference external" href="http://zh.wikipedia.org/wiki/ISO_3166-1"&gt;词条&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;因而想要下载完整的中国数据，实际上需要下载四个文件：China、Hong Kong、Macao、Taiwan。&lt;/p&gt;
&lt;p&gt;数据格式选择shapefile。&lt;/p&gt;
&lt;p&gt;可以在 &lt;a class="reference external" href="http://www.gadm.org/version2"&gt;http://www.gadm.org/version2&lt;/a&gt; 下载全球的行政区划数据，但非常不推荐。一方面是数据量偏大，另一方面是全球区划数据保存到一个文件中，难以整理。不如麻烦一点，需要哪个国家下哪个国家。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ogr2ogr"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;ogr2ogr&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT目前还不能识别shapefile格式的数据，因而就需要将shapefile格式转换为GMT可识别的格式。转换工具为ogr2ogr，这是GDAL自带的一个命令，因而如果正确安装了GMT5的话应该是很容易找到这个命令。&lt;/p&gt;
&lt;p&gt;以中国数据为例：&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;解压数据&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
unzip CHN_adm.zip -d CHN_adm
&lt;/pre&gt;
&lt;p&gt;解压后得到一堆文件，其中CHN_adm0.shp、CHN_adm1.shp、CHN_adm2.shp、CHN_adm3.shp为实际需要的shapefile数据，0、1、2、3为第零、一、二、三级行政区划，基本相当于国界、省界、市界、区界。（是这么个说法吧。。）&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;格式转换&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;命令从网上找到的，CHN_adm0为要生成的数据的文件名前缀，但是为什么要出现两次，表示很不解。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ogr2ogr -f GMT -nln CHN_adm0 CHN_adm0 CHN_adm0.shp
$ ogr2ogr -f GMT -nln CHN_adm1 CHN_adm1 CHN_adm1.shp
$ ogr2ogr -f GMT -nln CHN_adm2 CHN_adm2 CHN_adm2.shp
$ ogr2ogr -f GMT -nln CHN_adm3 CHN_adm3 CHN_adm3.shp
&lt;/pre&gt;
&lt;p&gt;对于Hong Kong、Macao、Taiwan的数据做类似操作，最终生成了一堆以gmt结尾的文件。共计10个，如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
CHN_adm0.gmt  CHN_adm2.gmt  HKG_adm0.gmt  MAC_adm0.gmt  TWN_adm1.gmt
CHN_adm1.gmt  CHN_adm3.gmt  HKG_adm1.gmt  TWN_adm0.gmt  TWN_adm2.gmt
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;绘图测试&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;国界&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;绘制国界需要全部0级数据。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS1&lt;/span&gt;：数据为多段数据，在GMT4中需要使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-m&lt;/span&gt;&lt;/tt&gt;选项，而GMT5已经可以自动处理多段数据，所以不需要使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-m&lt;/span&gt;&lt;/tt&gt;选项。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS2&lt;/span&gt;：中国的国界在有些地方是有争议的，因而使用该国界数据绘制的地图是不能在正规期刊上发表的。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;gmt psxy -J$J -R$R -T -K -U &amp;gt; $PS
gmt psxy -R$R -J$J CHN_adm0.gmt -K -O &amp;gt;&amp;gt; $PS
gmt psxy -R$R -J$J HKG_adm0.gmt -K -O &amp;gt;&amp;gt; $PS
gmt psxy -R$R -J$J MAC_adm0.gmt -K -O &amp;gt;&amp;gt; $PS
gmt psxy -R$R -J$J TWN_adm0.gmt -K -O &amp;gt;&amp;gt; $PS
gmt psxy -R$R -J$J -T -O &amp;gt;&amp;gt; $PS
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;代码运行过程中GMT会出现如下的警告(或错误？)&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psxy: Bad OGR/GMT: @D record has more items than declared by @N
&lt;/pre&gt;
&lt;p&gt;猜测是ogr2ogr转换的问题。在我的系统环境该警告不影响绘图效果，但评论中@vv指出在他的系统环境下会导致图形无法绘制。&lt;/p&gt;
&lt;p&gt;效果图（缺了南海的九段线数据）：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013112301.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;省级行政区划&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;与上面的代码几乎一样，1级数据中0级数据，所以直接绘制1级数据即可，Macao没有1级数据，直接用0级数据。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;72/136/15/54
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M15c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;china.ps

gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -U &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; CHN_adm1.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; HKG_adm1.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; MAC_adm0.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; TWN_adm1.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果图：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013112302.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;在上一篇博文《&lt;a class="reference external" href="http://seisman.info/usage-of-dcw-data.html"&gt;GMT5进阶之DCW数据的使用&lt;/a&gt;》中利用GMT自带的DCW数据也生成了类似的图，如下图。查看全图，对比一下会发现，两张图的细节方面还是有些区别的，本文的数据绘制的似乎包含了更多的细节（主要是小的岛屿）。这个就得根据需求去选择了，当然也有可能两个都是有问题的。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013112303.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;市级行政区划&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;转换出来的2级数据中包含了全国所有的市级边界，用编辑器打开查看内容就会发现，每条线段都有完整的注释，很容易从众多线段中提取出自己想要的部分。以安徽省为例，将与安徽有关的线段数据保存到文件Anhui_adm2.gmt中：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;114/120/29/35
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M10c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;anhui.ps

gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -U &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; Anhui_adm2.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;上面的脚本有一个很不方便的地方：想要画一个省的2级数据，每次都要从CHN_adm2.gmt中手动提取该省的数据信息。下面的例子可以避免这种手动提取的过程，主要通过DCW数据和psclip命令，使用全国2级数据（CHN_adm2.gmt），但是只绘制安徽省的2级数据。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;114/120/29/35
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M10c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;anhui.ps

gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -U &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt pscoast -FCN.34 -M &amp;gt; Anhui_bnd.gmt
gmt psclip -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; Anhui_bnd.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; CHN_adm2.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psclip -C -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;脚本利用pscoast命令，将安徽省（代码为34）的省界数据导出到文件Anhui_bnd.gmt中，然后利用该文件进行clip，psxy绘图时虽然使用的是全国的2级数据CHN_adm2.gmt，但是只有安徽省内的部分会被绘制出来，最后还需要再次调用psclip以结束clip。&lt;/p&gt;
&lt;p&gt;上面的这个脚本生成了一个中间文件Anhui_bnd.gmt，有强迫症的人是无法忍受这个的，因而上面的代码利用管道可以进一步简化为：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;114/120/29/35
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M10c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;anhui.ps

gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -U &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt pscoast -FCN.34 -M &lt;span class="p"&gt;|&lt;/span&gt; gmt psclip -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; CHN_adm2.gmt -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psclip -C -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;上面三个脚本的最终结果基本是一致的，效果图如下：&lt;/p&gt;
&lt;p&gt;注：三个脚本的成图效果是有差的，但是目前没有体现出来，在下一段“区级行政区划”中，可以更明显地看出区别。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013112304.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;区级行政区划&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这里还是以安徽省为例，实际上只用3级数据即可，这里同时用了2级数据和3级数据，并且用不同的粗细和颜色来区分。需要注意，由于3级数据中包含了2级数据，所以下面的例子先画了3级数据，再用2级数据覆盖。如果画的顺序反了，效果就会差很多。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;114.8/120/29.3/36
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M14c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;anhui.ps

gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -U &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; CHN_adm3.gmt -W0.5p,gray -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; CHN_adm2.gmt -W1p -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果图如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013112305.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;下面的脚本利用了前面提到的psclip的方法：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;114.8/120/29.3/36
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M14c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;anhui.ps

gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -U &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt pscoast -FCN.34 -M &lt;span class="p"&gt;|&lt;/span&gt; gmt psclip -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; CHN_adm3.gmt -W0.5p,gray -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; CHN_adm2.gmt -W1p -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psclip -C -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果图如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013112306.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;将这两张图对比一下，容易发现，省界的部分线段明显变细了，这算是clip的一个缺点，使用省界数据进行clip，同时又要绘制省界数据，如何判断省界数据点是否在clip区域内部是个问题。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-11-23：初稿；&lt;/li&gt;
&lt;li&gt;2013-11-28：绘制2级和3级边界时，利用clip的方法以减少人工操作。Thanks to @yangtze。&lt;/li&gt;
&lt;li&gt;2013-12-05：删除了数据包中的冗余隐藏文件，重新打包，提供多种格式下载。&lt;/li&gt;
&lt;li&gt;2014-01-19：不推荐下载全球行政区划数据；&lt;/li&gt;
&lt;li&gt;2015-04-11：存在个别IP恶意下载数据，导致我流量异常高，因而删除其他格式的数据压缩包，仅留下7z格式的，若仍出现流量异常，则删除该数据；&lt;/li&gt;
&lt;li&gt;2015-05-01：流量依然异常，猜测是搜索引擎会对齐定时抓取导致的；虽然已经在七牛限制了文件的非本站访问，但似乎对压缩文件无效。故删除该数据，有需要的可以自己去转换格式；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="格式转换"></category><category term="网站"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>GMT技巧之利用DCW数据进行区域涂色</title><link href="http://seisman.info/gmt-map-coloring.html" rel="alternate"></link><updated>2013-11-22T00:58:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-22:gmt-map-coloring.html</id><summary type="html">&lt;p&gt;关于DCW数据，前面两篇博文已经介绍了很多，这个是一个更具体的实例&amp;#8212;&amp;#8212;-区域涂色。&lt;/p&gt;
&lt;p&gt;问题描述：绘制中国地图，包括国界和省界，并对每个省份填充不同的颜色。&lt;/p&gt;
&lt;p&gt;根据著名的&lt;a class="reference external" href="http://zh.wikipedia.org/wiki/%E5%9B%9B%E8%89%B2%E5%AE%9A%E7%90%86"&gt;四色定理&lt;/a&gt;：任意一个无飞地的地图都可以用四种颜色染色，使得没有两个相邻国家染的颜色相同。&lt;/p&gt;
&lt;p&gt;如果真的要求最多只用四色填图，这个问题还真麻烦，这里不强求，只要求相邻省份的颜色不同即可。&lt;/p&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;70/150/10/60
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M25c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;10
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;china.ps

&lt;span class="c"&gt;# 打开GMT&lt;/span&gt;
gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 对每个省份进行循环&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; code in &lt;span class="m"&gt;11&lt;/span&gt; &lt;span class="m"&gt;12&lt;/span&gt; &lt;span class="m"&gt;13&lt;/span&gt; &lt;span class="m"&gt;14&lt;/span&gt; &lt;span class="m"&gt;15&lt;/span&gt; &lt;span class="m"&gt;21&lt;/span&gt; &lt;span class="m"&gt;22&lt;/span&gt; &lt;span class="m"&gt;23&lt;/span&gt; &lt;span class="m"&gt;31&lt;/span&gt; &lt;span class="m"&gt;32&lt;/span&gt; &lt;span class="m"&gt;33&lt;/span&gt; &lt;span class="m"&gt;34&lt;/span&gt; &lt;span class="m"&gt;35&lt;/span&gt; &lt;span class="m"&gt;36&lt;/span&gt; &lt;span class="m"&gt;37&lt;/span&gt; &lt;span class="m"&gt;41&lt;/span&gt; &lt;span class="m"&gt;42&lt;/span&gt; &lt;span class="m"&gt;43&lt;/span&gt; &lt;span class="m"&gt;44&lt;/span&gt; &lt;span class="m"&gt;45&lt;/span&gt; &lt;span class="m"&gt;46&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt; &lt;span class="m"&gt;51&lt;/span&gt; &lt;span class="m"&gt;52&lt;/span&gt; &lt;span class="m"&gt;53&lt;/span&gt; &lt;span class="m"&gt;54&lt;/span&gt; &lt;span class="m"&gt;61&lt;/span&gt; &lt;span class="m"&gt;62&lt;/span&gt; &lt;span class="m"&gt;63&lt;/span&gt; &lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="m"&gt;65&lt;/span&gt; &lt;span class="m"&gt;71&lt;/span&gt; &lt;span class="m"&gt;91&lt;/span&gt; 92&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
   &lt;span class="c"&gt;# 随机生成RGB颜色&lt;/span&gt;
   &lt;span class="nb"&gt;declare&lt;/span&gt; -i &lt;span class="nv"&gt;red&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$RANDOM&lt;/span&gt;&lt;span class="se"&gt;\*&lt;/span&gt;256/32768
   &lt;span class="nb"&gt;declare&lt;/span&gt; -i &lt;span class="nv"&gt;green&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$RANDOM&lt;/span&gt;&lt;span class="se"&gt;\*&lt;/span&gt;256/32768
   &lt;span class="nb"&gt;declare&lt;/span&gt; -i &lt;span class="nv"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$RANDOM&lt;/span&gt;&lt;span class="se"&gt;\*&lt;/span&gt;256/32768
   &lt;span class="c"&gt;# 绘图并涂色&lt;/span&gt;
   gmt pscoast -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -FCN.&lt;span class="nv"&gt;$code&lt;/span&gt;+p1p+g&lt;span class="nv"&gt;$red&lt;/span&gt;/&lt;span class="nv"&gt;$green&lt;/span&gt;/&lt;span class="nv"&gt;$blue&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="c"&gt;# 关闭GMT&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;分析一下代码：&lt;/p&gt;
&lt;p&gt;由于一个pscoast命令中最多只能用一次-F选项，因而需要对不同省份进行循环，即11-19行。14-16行是生成随机RGB颜色，$RANDOM是Bash的一个内置变量，每次调用随机生成0-32767之间的任意整数，这里做了简单的映射，使得结果为0-255。&lt;tt class="docutils literal"&gt;declare &lt;span class="pre"&gt;-i&lt;/span&gt;&lt;/tt&gt;声明变量为整型，使得映射正确。&lt;/p&gt;
&lt;p&gt;由于是随机生成颜色，所以每次运行结果都不一样，这样也不错哈。&lt;/p&gt;
&lt;p&gt;结果如下图（好像有些省份的颜色比较接近）：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013112201.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;顺便改一下代码，生成一下动画，下面的代码有意思的点有几个：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;采用增量绘图，每次绘制一个省份之后将未关闭的$PS复制一份，命名为$code.ps，然后将$code.ps文件正常关闭；即L15-L16；&lt;/li&gt;
&lt;li&gt;展示了如何利用convert命令将多个jpg文件转换为一个gif文件；这里使用了通配符*.jpg，所以正确的给动画的每一帧取名很重要，这决定了每一张jpg在gif中的顺序；delay设置了每帧之间的时间延迟，loop设置了gif循环播放；&lt;/li&gt;
&lt;li&gt;ps2raster在转换时将DPI设置为100，以减少最终生成的gif的尺寸，也有人喜欢压缩成avi视频格式；&lt;/li&gt;
&lt;/ul&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;70/150/10/60
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M25c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;10
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;china.ps

gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -Xc -Yc &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; code in &lt;span class="m"&gt;11&lt;/span&gt; &lt;span class="m"&gt;12&lt;/span&gt; &lt;span class="m"&gt;13&lt;/span&gt; &lt;span class="m"&gt;14&lt;/span&gt; &lt;span class="m"&gt;15&lt;/span&gt; &lt;span class="m"&gt;21&lt;/span&gt; &lt;span class="m"&gt;22&lt;/span&gt; &lt;span class="m"&gt;23&lt;/span&gt; &lt;span class="m"&gt;31&lt;/span&gt; &lt;span class="m"&gt;32&lt;/span&gt; &lt;span class="m"&gt;33&lt;/span&gt; &lt;span class="m"&gt;34&lt;/span&gt; &lt;span class="m"&gt;35&lt;/span&gt; &lt;span class="m"&gt;36&lt;/span&gt; &lt;span class="m"&gt;37&lt;/span&gt; &lt;span class="m"&gt;41&lt;/span&gt; &lt;span class="m"&gt;42&lt;/span&gt; &lt;span class="m"&gt;43&lt;/span&gt; &lt;span class="m"&gt;44&lt;/span&gt; &lt;span class="m"&gt;45&lt;/span&gt; &lt;span class="m"&gt;46&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt; &lt;span class="m"&gt;51&lt;/span&gt; &lt;span class="m"&gt;52&lt;/span&gt; &lt;span class="m"&gt;53&lt;/span&gt; &lt;span class="m"&gt;54&lt;/span&gt; &lt;span class="m"&gt;61&lt;/span&gt; &lt;span class="m"&gt;62&lt;/span&gt; &lt;span class="m"&gt;63&lt;/span&gt; &lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="m"&gt;65&lt;/span&gt; &lt;span class="m"&gt;71&lt;/span&gt; &lt;span class="m"&gt;91&lt;/span&gt; 92&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
   &lt;span class="nb"&gt;declare&lt;/span&gt; -i &lt;span class="nv"&gt;red&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$RANDOM&lt;/span&gt;*256/32768
   &lt;span class="nb"&gt;declare&lt;/span&gt; -i &lt;span class="nv"&gt;green&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$RANDOM&lt;/span&gt;*256/32768
   &lt;span class="nb"&gt;declare&lt;/span&gt; -i &lt;span class="nv"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$RANDOM&lt;/span&gt;*256/32768
   gmt pscoast -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -FCN.&lt;span class="nv"&gt;$code&lt;/span&gt;+p1p+g&lt;span class="nv"&gt;$red&lt;/span&gt;/&lt;span class="nv"&gt;$green&lt;/span&gt;/&lt;span class="nv"&gt;$blue&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
   cp &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="nv"&gt;$code&lt;/span&gt;.ps
   gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$code&lt;/span&gt;.ps
&lt;span class="k"&gt;done&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

ps2raster -P -E100 *.ps
convert -delay &lt;span class="m"&gt;30&lt;/span&gt; -loop &lt;span class="m"&gt;0&lt;/span&gt; *.jpg china.gif
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;由于生成PDF时，不支持导入GIF文件，故而就不再给出动态效果图了。&lt;/p&gt;
</summary><category term="GMT技巧"></category><category term="GMT脚本"></category><category term="动画"></category><category term="图像"></category></entry><entry><title>GMT5进阶之DCW数据的使用</title><link href="http://seisman.info/usage-of-dcw-data.html" rel="alternate"></link><updated>2013-11-21T00:17:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-21:usage-of-dcw-data.html</id><summary type="html">
&lt;p&gt;问题描述：想要绘制一个中国地图，区域范围为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R70/140/15/55&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;代码1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT4中可以使用pscoast命令的-N选项绘制国界，代码如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pscoast -R70/140/15/55 -JM15c -B10 -N1/0.25p,blue -U &amp;gt; china.ps
&lt;/pre&gt;
&lt;p&gt;效果图如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013112101.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;这里的国界其实指的是陆地部分国家与国家之间的界限。显然这样的图不能用。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;代码2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;还是用GMT4，加上海岸线，代码如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pscoast -R70/140/15/55 -JM15c -B10 -N1/0.25p,blue -W1/0.3p,black -U &amp;gt; china.ps
&lt;/pre&gt;
&lt;p&gt;效果如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013112102.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;为了凸显海岸线与国界的区别，这里分别用了两种颜色。如果把二者调成一种颜色，粗细也相同，这样看上去也比较符合要求了，但是显得有点不伦不类了，当然有时候就是要这个效果。&lt;/p&gt;
&lt;p&gt;下面用GMT5的DCW数据来画图。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pscoast"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;pscoast&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;关于pscoast在GMT4中的用法，可以参考《&lt;a class="reference external" href="http://seisman.info/gmt-pscoast.html"&gt;GMT命令之用pscoast绘图海岸线&lt;/a&gt;》。&lt;/p&gt;
&lt;p&gt;GMT5的语法相对于GMT4有了不少变化，这里只说与DCW有关的-F选项，有关DCW数据的信息看上一篇博文。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
-Fcode1,code2,...[+l|L][+gfill][+ppen][+r|R[incs]]
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;想要绘制某个或某些国家的边界，可以使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;code1,code2,...&lt;/span&gt;&lt;/tt&gt;来选定，其中每个code代表不同的国家2位代码，用逗号分隔。&lt;/li&gt;
&lt;li&gt;如果想要选择某个国家的某个省的边界，则code应该为&lt;tt class="docutils literal"&gt;country.state&lt;/tt&gt;的格式，比如&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;US&lt;/span&gt;.&lt;span class="caps"&gt;TX&lt;/span&gt;&lt;/tt&gt;代表美国的Texas州。&lt;/li&gt;
&lt;li&gt;如果想要选定整个大洲，则需要在洲代码&lt;strong&gt;前&lt;/strong&gt;加上等于号，比如code为"=&lt;span class="caps"&gt;AF&lt;/span&gt;"则表示选择整个非洲的数据；&lt;/li&gt;
&lt;li&gt;追加&lt;strong&gt;+l&lt;/strong&gt;会列出国家名以及国家代码，不提取数据或绘图。（没试出效果）&lt;/li&gt;
&lt;li&gt;追加&lt;strong&gt;+L&lt;/strong&gt;会列出州/省名，以及代码；&lt;/li&gt;
&lt;li&gt;追加&lt;strong&gt;+r&lt;/strong&gt;会计算当前选择的边界数据的范围，并返回该范围；还可以加入xinc/yinc或者winc/einc/sinc/ninc来指定-B选项；（没理解）&lt;/li&gt;
&lt;li&gt;追加&lt;strong&gt;+R&lt;/strong&gt;会计算当前选择的边界数据的范围，并向外扩展incs的范围；（没理解）&lt;/li&gt;
&lt;li&gt;追加&lt;strong&gt;+p&lt;/strong&gt;&lt;em&gt;pen&lt;/em&gt;指定边界的线条属性；&lt;/li&gt;
&lt;li&gt;追加&lt;strong&gt;+g&lt;/strong&gt;&lt;em&gt;fill&lt;/em&gt;指定填充属性；&lt;/li&gt;
&lt;li&gt;一条命令中只能出现一次-F选项，如有特殊需求，需多次调用pscoast；&lt;/li&gt;
&lt;li&gt;还有一些更复杂的规则，有些乱。。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;例1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;绘制-R70/150/10/60范围内的全部亚洲国家的边界:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt pscoast -R70/150/10/60 -JM20c -B10 -F=AS -U &amp;gt; asia.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013112103.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;例2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;绘制中国边界（不含台湾、香港、澳门）:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt pscoast -B10 -R70/150/10/60 -JM20c -FCN -U &amp;gt; china.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013112104.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;例3&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;绘制内蒙古，并修改边界和填充颜色:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt pscoast -B10 -R70/150/10/60 -JM20c -FCN.15+p1p,blue+gred -U &amp;gt; state.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013112105.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;例4&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;导出中国内蒙古的边界数据:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt pscoast -FCN.15 -M -V &amp;gt; neimenggu.dat
&lt;/pre&gt;
&lt;p&gt;这里只需要使用-M选项即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;例5&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个例子算是一个相对比较完整的中国地图，包含了必要的省界信息。距离出版可能还需要九段线数据，具体不讨论。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;70/150/15/55
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M20c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;10
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;china.ps
gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K -U &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; code in &lt;span class="m"&gt;11&lt;/span&gt; &lt;span class="m"&gt;12&lt;/span&gt; &lt;span class="m"&gt;13&lt;/span&gt; &lt;span class="m"&gt;14&lt;/span&gt; &lt;span class="m"&gt;15&lt;/span&gt; &lt;span class="m"&gt;21&lt;/span&gt; &lt;span class="m"&gt;22&lt;/span&gt; &lt;span class="m"&gt;23&lt;/span&gt; &lt;span class="m"&gt;31&lt;/span&gt; &lt;span class="m"&gt;32&lt;/span&gt; &lt;span class="m"&gt;33&lt;/span&gt; &lt;span class="m"&gt;34&lt;/span&gt; &lt;span class="m"&gt;35&lt;/span&gt; &lt;span class="m"&gt;36&lt;/span&gt; &lt;span class="m"&gt;37&lt;/span&gt; &lt;span class="m"&gt;41&lt;/span&gt; &lt;span class="m"&gt;42&lt;/span&gt; &lt;span class="m"&gt;43&lt;/span&gt; &lt;span class="m"&gt;44&lt;/span&gt; &lt;span class="m"&gt;45&lt;/span&gt; &lt;span class="m"&gt;46&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt; &lt;span class="m"&gt;51&lt;/span&gt; &lt;span class="m"&gt;52&lt;/span&gt; &lt;span class="m"&gt;53&lt;/span&gt; &lt;span class="m"&gt;54&lt;/span&gt; &lt;span class="m"&gt;61&lt;/span&gt; &lt;span class="m"&gt;62&lt;/span&gt; &lt;span class="m"&gt;63&lt;/span&gt; &lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="m"&gt;65&lt;/span&gt; &lt;span class="m"&gt;71&lt;/span&gt; &lt;span class="m"&gt;91&lt;/span&gt; 92&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
    gmt pscoast -B10 -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -FCN.&lt;span class="nv"&gt;$code&lt;/span&gt; -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013112106.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="GMT脚本"></category><category term="数据"></category><category term="GMT5"></category></entry><entry><title>GMT5的DCW数据简介</title><link href="http://seisman.info/introduction-to-dcw-gmt5.html" rel="alternate"></link><updated>2013-11-20T00:05:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-20:introduction-to-dcw-gmt5.html</id><summary type="html">
&lt;div class="section" id="dcw"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;&lt;span class="caps"&gt;DCW&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;DCW&lt;/span&gt;，全称Digital Chart of the World，是一个内容广泛的数字地图，2006年免费公开，但是其数据实际上从1992年起就没有再更新过。&lt;/p&gt;
&lt;p&gt;DCW数据被分为2094个区块，基本上一个区块代表5度×5度的区域。DCW数据中包含了国界、公路、铁路等等。&lt;/p&gt;
&lt;p&gt;详细信息参考维基百科词条：&lt;a class="reference external" href="http://en.wikipedia.org/wiki/Digital_Chart_of_the_World"&gt;Digital Chart of the World&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="dcw-gmt"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;&lt;span class="caps"&gt;DCW&lt;/span&gt;-&lt;span class="caps"&gt;GMT&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;DCW&lt;/span&gt;-GMT算是DCW的升级版，其特点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;包含全球各国国界；&lt;/li&gt;
&lt;li&gt;包含部分国家的省界（目前只有8个比较大的国家，包括中国）；&lt;/li&gt;
&lt;li&gt;数据格式为netCDF-4，可以直接在GMT中使用，也容易从中提取所需的边界数据；&lt;/li&gt;
&lt;li&gt;数据应该是比较新的，且有人维护，因而发现问题可以报告Bug；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;主页： &lt;a class="reference external" href="http://www.soest.hawaii.edu/wessel/dcw/"&gt;http://www.soest.hawaii.edu/wessel/dcw/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;为什么又是国界？&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在GMT4中，可以用&lt;tt class="docutils literal"&gt;pscoast&lt;/tt&gt;的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-N1&lt;/span&gt;&lt;/tt&gt;选项来绘制国界，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-N2&lt;/span&gt;&lt;/tt&gt;选项来绘制省界（仅美国、加拿大等国）。&lt;/p&gt;
&lt;p&gt;这样绘制的国界有什么问题呢？比如，设定绘图区域为中国，然后使用&lt;tt class="docutils literal"&gt;pscoast &lt;span class="pre"&gt;-N1&lt;/span&gt;&lt;/tt&gt;加入国界，得到的结果里将不仅仅是中国的国界，还有俄罗斯、日本、印度等的国界。即GSHHG的国界数据是完全的，但是并不能区分每段数据属于哪个国家。所以网上有一堆文章在研究GMT中怎么只绘制中国的边界。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;DCW&lt;/span&gt;-GMT是为了解决这个问题而存在的，当你想绘制中国国界时，得到的就是干干净净的中国国界，而没有其他国家的国界的干扰。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;&lt;span class="caps"&gt;DCW&lt;/span&gt;-GMT详情&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下载安装什么的在博文《&lt;a class="reference external" href="http://seisman.info/install-gmt5-under-linux.html"&gt;&lt;span class="caps"&gt;GMT5&lt;/span&gt;.1.0在Linux下的安装&lt;/a&gt;》中已经说过了，不再多说。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;DCW&lt;/span&gt;-GMT包含了如下文件：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
.
├── COPYING.LESSERv3
├── COPYINGv3
├── dcw-countries.txt
├── dcw-gmt.nc
├── dcw-states.txt
├── LICENSE.TXT
└── README.TXT
&lt;/pre&gt;
&lt;p&gt;真正有用的文件包括dcw-countries.txt、dcw-gmt.nc、dcw-states.txt。其中dcw-gmt.nc是netCDF格式的数据，其他两个txt文件为辅助文档。&lt;/p&gt;
&lt;div class="section" id="dcw-contries"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;dcw-contries&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;文件格式为&lt;tt class="docutils literal"&gt;大洲代码 国家代码 国家名&lt;/tt&gt;，代码均为两位字符。&lt;/p&gt;
&lt;p&gt;大洲代码包括AF(非洲)、&lt;span class="caps"&gt;AN&lt;/span&gt;(南极洲)、&lt;span class="caps"&gt;AS&lt;/span&gt;(亚洲)、&lt;span class="caps"&gt;EU&lt;/span&gt;(欧洲)、&lt;span class="caps"&gt;OC&lt;/span&gt;(大洋洲)、&lt;span class="caps"&gt;NA&lt;/span&gt;(北美洲)和SA(南美洲)。&lt;/p&gt;
&lt;p&gt;国家代码就更多了，比如中国是CN。准确来说，不是国家代码，而是国家和/或地区代码，比如China、Hong Kong、Macao和Taiwan分别有不同的国家代码。&lt;/p&gt;
&lt;p&gt;这个文件是GMT绘制国界时需要查找的文件，同时也是用户绘图边界时需要参考的文件。该文件共计250个国家或地区。文件内容大致如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
AS BH Bahrain
AS BN Brunei
AS BT Bhutan
AS CN China
AS CX Christmas Island
AS GE Georgia
AS HK Hong Kong
AS HM Heard Island and McDonald Islands
AS ID Indonesia
AS IL Israel
AS IN India
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="dcw-states"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;dcw-states&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;文件格式为&lt;tt class="docutils literal"&gt;国家代码 省代码 省名&lt;/tt&gt;。国家代码为两位，与dcw-contries.txt中对应，省代码则比较乱了，用的时候再查。中国的省代码居然是数字，不知道为什么这么安排。&lt;/p&gt;
&lt;p&gt;目前有AR(阿根廷)、&lt;span class="caps"&gt;AU&lt;/span&gt;(澳大利亚)、&lt;span class="caps"&gt;BR&lt;/span&gt;(巴西)、&lt;span class="caps"&gt;CA&lt;/span&gt;(加拿大)、&lt;span class="caps"&gt;US&lt;/span&gt;(美国)、&lt;span class="caps"&gt;CN&lt;/span&gt;(中国)、&lt;span class="caps"&gt;IN&lt;/span&gt;(印度)、&lt;span class="caps"&gt;RU&lt;/span&gt;(俄罗斯)共计八个国家的省/州界数据。&lt;/p&gt;
&lt;p&gt;只关心中国的数据，包括全部34个省级行政区域，包括23个省，5个自治区，4个直辖市，以及香港，澳门2个特别行政区。（台湾在里面，不然又该引起争端了）。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
CN 11 Beijing
CN 50 Chongqing
CN 31 Shanghai
CN 12 Tianjin
CN 34 Anhui
CN 35 Fujian
CN 62 Gansu
CN 44 Guangdong
CN 52 Guizhou
CN 46 Hainan
CN 13 Hebei
CN 23 Heilongjiang
CN 41 Henan
CN 42 Hubei
CN 43 Hunan
CN 32 Jiangsu
CN 36 Jiangxi
CN 22 Jilin
CN 21 Liaoning
CN 63 Qinghai
CN 61 Shaanxi
CN 37 Shandong
CN 14 Shanxi
CN 51 Sichuan
CN 71 Taiwan
CN 53 Yunnan
CN 33 Zhejiang
CN 45 Guangxi
CN 15 Nei Mongol
CN 64 Ningxia
CN 65 Xinjiang
CN 54 Xizang
CN 91 Xianggang (Hong Kong)
CN 92 Aomen (Macao)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;如何使用DCW数据？&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT5中，可以通过pscoast命令的-F选项调用DCW数据来绘制国界和省界，具体的下一篇再说。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="GMT5"></category></entry><entry><title>GMT进阶之自定义GMT的Logo</title><link href="http://seisman.info/customized-gmt-logo.html" rel="alternate"></link><updated>2013-11-19T00:20:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-19:customized-gmt-logo.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;这篇博文想干什么？&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;如下图，这篇博文的目的就是把左边的时间戳变成右边的时间戳。黑底白字的部分，我称之为Logo。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="gmt logo" src="/images/2013111901.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="logo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;为什么要自定义Logo？&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;生命在于折腾；&lt;/li&gt;
&lt;li&gt;体现个性；&lt;/li&gt;
&lt;li&gt;类似于微博配图加水印，算是图片版权说明；&lt;/li&gt;
&lt;li&gt;给自己打广告；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;理解原理&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="gmt-timestamp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;gmt_timestamp&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="id3"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id13"&gt;函数定义&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;以下代码来自于GMT-5.1.0/src/gmt_plot.c：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;gmt_timestamp&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;GMT_CTRL&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;PSL_CTRL&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;justify&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;U_label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="cm"&gt;/* x, y = location of the time stamp box&lt;/span&gt;
&lt;span class="cm"&gt;* justify indicates the corner of the box that (x,y) refers to, see below&lt;/span&gt;
&lt;span class="cm"&gt;* U_label = label to be plotted to the right of the box&lt;/span&gt;
&lt;span class="cm"&gt;*&lt;/span&gt;
&lt;span class="cm"&gt;*   9        10       11&lt;/span&gt;
&lt;span class="cm"&gt;*   |------------------|&lt;/span&gt;
&lt;span class="cm"&gt;*   5         6        7&lt;/span&gt;
&lt;span class="cm"&gt;*   |------------------|&lt;/span&gt;
&lt;span class="cm"&gt;*   1         2        3&lt;/span&gt;
&lt;span class="cm"&gt;*/&lt;/span&gt;

&lt;span class="kt"&gt;time_t&lt;/span&gt; &lt;span class="n"&gt;right_now&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;GMT_LEN256&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;GMT_LEN256&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mf"&gt;0.365&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.032&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;   &lt;span class="cm"&gt;/* Predefined dimensions in inches */&lt;/span&gt;
&lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;unset_rgb&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="cm"&gt;/* Plot time string in format defined by format_time_stamp */&lt;/span&gt;

&lt;span class="n"&gt;right_now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;time_t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;strftime&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setting&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format_time_stamp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;localtime&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;right_now&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="n"&gt;sprintf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"  %s  "&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="n"&gt;PSL_command&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"%% Begin GMT time-stamp&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;V&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_setorigin&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PSL_FWD&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_setlinewidth&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.25&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_setfont&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setting&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;font_logo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_defunits&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"PSL_g_w"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;  &lt;span class="cm"&gt;/* Size of the black [GMT] box */&lt;/span&gt;
&lt;span class="n"&gt;PSL_defunits&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"PSL_g_h"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="n"&gt;PSL_deftextdim&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"PSL_b"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;8.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;  &lt;span class="cm"&gt;/* Size of the white [timestamp] box (use only length) */&lt;/span&gt;

&lt;span class="cm"&gt;/* When justification is not BL (justify == 1), add some PostScript code to move to the&lt;/span&gt;
&lt;span class="cm"&gt;location where the lower left corner of the time stamp box is to be drawn */&lt;/span&gt;

&lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;justify&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="cm"&gt;/* Center */&lt;/span&gt;
        &lt;span class="n"&gt;PSL_command&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"PSL_g_w PSL_b_w add 2 div neg 0 T&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="cm"&gt;/* Right justify */&lt;/span&gt;
        &lt;span class="n"&gt;PSL_command&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"PSL_g_w PSL_b_w add neg 0 T&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;justify&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="cm"&gt;/* Middle */&lt;/span&gt;
        &lt;span class="n"&gt;PSL_command&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"0 PSL_g_h 2 div neg T&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="cm"&gt;/* Top justify */&lt;/span&gt;
        &lt;span class="n"&gt;PSL_command&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"0 PSL_g_h neg T&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="cm"&gt;/* Now draw black box with GMT logo, and white box with time stamp */&lt;/span&gt;

&lt;span class="n"&gt;PSL_setfill&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setting&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map_default_pen&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rgb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_plotsymbol&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PSL_RECT&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_plotcolorimage&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;PSL_BL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GMT_glyph&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;220&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_setfill&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;page_rgb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_command&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"PSL_g_h PSL_b_w PSL_g_w 0 Sb&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL_plottext&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;8.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="cm"&gt;/* Optionally, add additional label to the right of the box */&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;U_label&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;U_label&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;sprintf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"   %s"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;U_label&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;PSL_plottext&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;PSL_command&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"U&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;%% End GMT time-stamp&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="cm"&gt;/* Reset fill style to empty and no outline and reset linewidth */&lt;/span&gt;
&lt;span class="n"&gt;PSL_setfill&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unset_rgb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;false&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linewidth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id14"&gt;源码说明&lt;/a&gt;&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;L16：定义数组dim，其中dim[0]代表时间戳黑色部分的宽度，dim[1]代表黑色部分的高度，dim[2]没有用；其单位为英寸；&lt;/li&gt;
&lt;li&gt;L25：开始向PS文件中写入代码；&lt;/li&gt;
&lt;li&gt;L26-L31：一些设置；&lt;/li&gt;
&lt;li&gt;L51：设置填充色为黑色；&lt;/li&gt;
&lt;li&gt;L52：绘制矩形；&lt;/li&gt;
&lt;li&gt;L53：将GMT_glyph写入矩形中；这个是重点！&lt;/li&gt;
&lt;li&gt;L54-L56：写入时间；&lt;/li&gt;
&lt;li&gt;L60-L63：写入command或者label；&lt;/li&gt;
&lt;li&gt;L65：结束；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt-glyph"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;GMT_glyph&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT_glyph的定义位于gmt_plot.c中：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/* Get bitmapped 600 dpi GMT glyph for timestamp.  The glyph is a 90 x 220 pixel 1-bit image&lt;/span&gt;
&lt;span class="cm"&gt;   and it is here represented as ceil (220 / 8) * 90 = 2520 bytes */&lt;/span&gt;
&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;GMT_glyph&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2520&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="err"&gt;……&lt;/span&gt;
&lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x0f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;其解释表明，GMT的logo是个dpi=600的位图，位图像素为220×90，即dim[0]=220/600=0.366 =&amp;gt; 0.365 inch，dim[1]=90/600=0.15 inch。&lt;/p&gt;
&lt;p&gt;位图为1-bit图，即黑白图，0表示白色，1表示黑色。由于GMT的一些内部设置，实际上这里0表示黑色，1表示白色。每个char型为8bit，即一个char可以用于存储8个像素的信息，比如0x0f的二进制表示为00001111，即表示这8个点中，前四个为黑色，后四个为白色。&lt;/p&gt;
&lt;p&gt;因而想要修改GMT位图的核心是创建一个GMT_glyph数组！&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="psl-plotcolorimage"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;PSL_plotcolorimage&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;PSL_plotcolorimage的函数声明如下，取自GMT5.1.0/src/pslib.c：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;PSL_plotcolorimage&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="n"&gt;PSL_CTRL&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;PSL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;xsize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;double&lt;/span&gt; &lt;span class="n"&gt;ysize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;justify&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nbits&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="cm"&gt;/* Plots a 24-bit color image in Grayscale, RGB or CMYK mode.&lt;/span&gt;
&lt;span class="cm"&gt; * When the number of unique colors does not exceed PSL_MAX_COLORS, the routine will index&lt;/span&gt;
&lt;span class="cm"&gt; * 24-bit RGB images and then attempt to reduce the depth of the indexed image to 1, 2 or 4 bits.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * x, y     : lower left position of image in plot units&lt;/span&gt;
&lt;span class="cm"&gt; * xsize, ysize : image size in units (if 0, adjust to keep the original aspect ratio)&lt;/span&gt;
&lt;span class="cm"&gt; * justify  : indicates what corner x,y refers to (see graphic below)&lt;/span&gt;
&lt;span class="cm"&gt; * buffer   : contains the bytes for the image&lt;/span&gt;
&lt;span class="cm"&gt; * nx, ny   : pixel dimension&lt;/span&gt;
&lt;span class="cm"&gt; * nbits    : number of bits per pixel (1, 2, 4, 8, 24)&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * Special cases:&lt;/span&gt;
&lt;span class="cm"&gt; * nx &amp;lt; 0   : 8- or 24-bit image contains a color mask (first 1 or 3 bytes)&lt;/span&gt;
&lt;span class="cm"&gt; * nbits &amp;lt; 0    : "Hardware" interpolation requested&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; *   9       10      11&lt;/span&gt;
&lt;span class="cm"&gt; *   |----------------|&lt;/span&gt;
&lt;span class="cm"&gt; *   5    &amp;lt;image&amp;gt;     7&lt;/span&gt;
&lt;span class="cm"&gt; *   |----------------|&lt;/span&gt;
&lt;span class="cm"&gt; *   1       2        3&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;从函数参数的解释中可以看出，nbits代表了一个像素所需要的位数，nbits可以取1、2、4、8、24；buffer即数组GMT_glyph；&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;具体步骤&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;建立位图文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;直接利用GIMP创建位图文件。&lt;/p&gt;
&lt;p&gt;打开GIMP，"文件-&amp;gt;新建"，设置宽度"520"，高度"90"，分辨率"600"，色彩空间为灰色，填充前景色。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013111902.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;输入文件，字体"STIXGeneral Bold Italic"，大小为"95"，居中，上下留白2像素，左右留白12像素；&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013111903.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;保存为Sun Raster格式，文件名为raster.im8，提示需要导出，数据格式选择"&lt;strong&gt;标准&lt;/strong&gt;"。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sun-rasterxbm"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;将Sun Raster文件转换为xbm格式&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;xbm格式类似于C语言的格式，也就是GMT_glyph数组所需要的。&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;执行&lt;tt class="docutils literal"&gt;raster2xbm&lt;/tt&gt;，(代码在这里&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/raster2xbm.tar.gz"&gt;下载&lt;/a&gt;)，将输出保存到gmt_plot.c中的char数组GMT_glyph中。&lt;/li&gt;
&lt;li&gt;将&lt;tt class="docutils literal"&gt;unsigned char GMT_glyph[2520]&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;unsigned char GMT_glyph[46800]&lt;/tt&gt;，其中46800=520*90；&lt;/li&gt;
&lt;li&gt;gmt_timestamp中&lt;tt class="docutils literal"&gt;double dim[3] = {0.365, 0.15, 0.032};&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;double dim[3] = {0.867, 0.15, 0.032};&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;gmt_timestamp中&lt;tt class="docutils literal"&gt;PSL_plotcolorimage (&lt;span class="caps"&gt;PSL&lt;/span&gt;, 0.0, 0.0, dim[0], dim[1], PSL_BL, GMT_glyph, 220, 90, 1);&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;PSL_plotcolorimage (&lt;span class="caps"&gt;PSL&lt;/span&gt;, 0.0, 0.0, dim[0], dim[1], PSL_BL, GMT_glyph, 520, 90, 8);&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;重新编译GMT&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;一些说明&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;这里改变的Logo的宽度而没有改变Logo的高度，主要是因为Logo与后面的时间戳共用一个高度，修改高度之后可能很多东西都要改，这样比较麻烦；&lt;/li&gt;
&lt;li&gt;GMT原始的Logo为黑白1-bit图，精度稍显不够，因而这里使用8-bit灰度图；当然也可以使用彩色图；&lt;/li&gt;
&lt;li&gt;GIMP可以直接保存为xbm格式的1-bit图，之所以不使用，一方面是因为1-bit精度不够，另一方面是GIMP保存的xbm格式的数据的字节序与本机的字节序不同，导致Logo相邻两列或四列的数据相互交换位置。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="图像"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>Perl如何找出两个数组的交集、并集</title><link href="http://seisman.info/find-intersection-and-difference-of-two-arrays.html" rel="alternate"></link><updated>2013-11-18T09:08:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-18:find-intersection-and-difference-of-two-arrays.html</id><summary type="html">&lt;p&gt;本文整理自&lt;a class="reference external" href="http://perldoc.perl.org/perlfaq4.html#How-do-I-compute-the-difference-of-two-arrays%3f-How-do-I-compute-the-intersection-of-two-arrays%3f"&gt;perlfaq4&lt;/a&gt;：&lt;/p&gt;
&lt;p&gt;Q：如何计算两个数组的差异、交集以及并集？&lt;/p&gt;
&lt;p&gt;A：使用Hash。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@union&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;@intersection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;@difference&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;%count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$element&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@array1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;@array2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nv"&gt;$count&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;$element&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$element&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;keys&lt;/span&gt; &lt;span class="nv"&gt;%count&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nb"&gt;push&lt;/span&gt; &lt;span class="nv"&gt;@union&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$element&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nb"&gt;push&lt;/span&gt; &lt;span class="nv"&gt;@&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nv"&gt;$count&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;$element&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;?&lt;/span&gt; &lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="nv"&gt;@intersection&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="nv"&gt;@difference&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nv"&gt;$element&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;最终得到&lt;tt class="docutils literal"&gt;&amp;#64;union&lt;/tt&gt;为两个数组的并集，&lt;tt class="docutils literal"&gt;&amp;#64;intersection&lt;/tt&gt;为两个数组的交集，&lt;tt class="docutils literal"&gt;&amp;#64;difference&lt;/tt&gt;为所有只在一个数组中出现的元素。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：这个方法要求每个数组内部元素不相同！&lt;/p&gt;
</summary><category term="Perl"></category></entry><entry><title>SAC容易忽略的一个陷阱</title><link href="http://seisman.info/traps-of-sac.html" rel="alternate"></link><updated>2014-04-18T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-17:traps-of-sac.html</id><summary type="html">&lt;p&gt;事情大概是这样的：当前文件夹下有很多个SAC文件（约700个，没有超过SAC一次只能处理1000个数据的限制），需要对SAC文件进行简单的滤波处理，然后保存。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：SAC版本为101.5c。&lt;/p&gt;
&lt;p&gt;在Perl脚本中调用SAC，一开始是这样写的：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@sacfiles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;glob&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;N.*.U&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;| sac&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r @sacfiles \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;rmean; rtr; taper \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;bp c 1 3 n 2 p 1 \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;w over \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;quit \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;第5行通过glob通配当前目录下的所有文件名符合&amp;quot;N.*.U&amp;quot;的文件。第7-13行，打开SAC进行数据处理，然后关闭SAC。&lt;/p&gt;
&lt;p&gt;这个脚本看似没有问题，但是经过比对就会发现，只有部分数据被正确地滤波了，所以&lt;strong&gt;这个脚本是错误的！&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;为了验证究竟是哪里的问题，将上面的脚本修改一下，如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@sacfiles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;glob&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;N.*.U&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;| sac&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;echo on errors warnings output commands macros processed \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r @sacfiles \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;read @sacfiles \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;rmean; rtr; taper \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;bp c 1 3 n 2 p 1 \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;w over \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;quit \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;脚本的第8行&lt;tt class="docutils literal"&gt;echo&lt;/tt&gt;是SAC的一个命令，这个命令将显示全部“错误、警告、输出、命令、宏、处理后的命令”，因而可以用来监视SAC究竟做了什么。第10行&lt;tt class="docutils literal"&gt;print &amp;quot;read &amp;#64;sacfiles \n&amp;quot;;&lt;/tt&gt;用于验证Perl传递给SAC的究竟是什么，这里使用&lt;tt class="docutils literal"&gt;read&lt;/tt&gt;而不是&lt;tt class="docutils literal"&gt;r&lt;/tt&gt;是为了区分Perl的输出和SAC的输出。&lt;/p&gt;
&lt;p&gt;终端显示结果如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
read N.AGMH.U N.AGWH.U N.AHIH.U N.AIOH.U N.AIRH.U N.AJSH.U N.AKIH.U
N.AKNH.U N.AKSH.U N.AMAH.U N.AMNH.U N.AMZH.U N.ANIH.U N.ANJH.U N.ANNH.U
N.ANSH.U N.AOMH.U N.ARIH.U N.ARKH.U N.ASAH.U N.ASBH.U N.ASHH.U N.ASKH.U
N.ASNH.U N.ASRH.U N.ASSH.U N.ASUH.U N.ASVH.U N.ATDH.U N.ATGH.U N.ATKH.U
N.ATMH.U N.AWNH.U N.AYEH.U N.AYKH.U N.AYWH.U N.BEEH.U N.BEWH.U N.BFEH.U
N.BFNH.U N.BFWH.U N.BHRH.U N.BKEH.U N.BKWH.U N.BREH.U N.BRWH.U N.BSEH.U
N.BTOH.U N.BZNH.U N.CBAH.U N.CCNH.U N.CH2H.U N.CHKH.U N.CHNH.U N.CHZH.U
N.CKRH.U N.CRNH.U N.CTSH.U N.CZEH.U N.DGOH.U N.DMOH.U N.DWAH.U N.EBTH.U
N.EDSH.U N.EIHH.U N.FBRH.U N.FCHH.U N.FGNH.U N.FGSH.U N.FGTH.U N.FJEH.U
N.FJIH.U N.FJOH.U N.FKCH.U N.FKRH.U N.FKSH.U N.FKUH.U N.FMIH.U N.FRKH.U
N.FRNH.U N.FSTH.U N.FSWH.U N.FUTH.U N.GEIH.U N.GENH.U N.GHKH.U N.GJOH.U
N.GKSH.U N.GNOH.U N.GOTH.U N.GR2H.U N.GSIH.U N.GZNH.U N.HAGH.U N.HASH.U
N.HAZH.U N.HBAH.U N.HBTH.U N.HDKH.U N.HGAH.U N.HGIH.U N.HH2H.U N.HHEH.U
N.HHIH.U N.HHNH.U N.HHRH.U N.HIKH.U N.HIMH.U N.HINH.U N.HIRH.U N.HISH.U
N.HIYH.U N.HKBH.U N.HKSH.U N.HKTH.U N.HMAH.U N.HMMH.U N.HMNH.U N.HMSH.U
N.HMTH.U N.HNBH.U N.HNKH.U N.HNOH.U N.HNRH.U N.HNSH.U N.HNZH.U N.HOBH.U
N.HOCH.U N.HOFH.U N.HOJH.U N.HONH.U N.HOSH.U N.HOTH.U N.HOUH.U N.HRDH.U
N.HRKH.U N.HRMH.U N.HRNH.U N.HRSH.U N.HRYH.U N.HSEH.U N.HSFH.U N.HSKH.U
N.HSMH.U N.HTAH.U N.HTBH.U N.HTKH.U N.HWSH.U N.HYGH.U N.HYKH.U N.HYNH.U
N.HYOH.U N.HYSH.U N.IAMH.U N.ICEH.U N.ICHH.U N.ICWH.U N.IGWH.U N.IHEH.U
N.IICH.U N.IKIH.U N.IKKH.U N.IKNH.U N.IKSH.U N.IKTH.U N.IKWH.U N.IMIH.U
N.IMRH.U N.INAH.U N.INEH.U N.INHH.U N.INMH.U N.INOH.U N.INSH.U N.INWH.U
N.ISGH.U N.ISSH.U N.ITDH.U N.ITHH.U N.IWAH.U N.IWEH.U N.IWNH.U N.IWSH.U
N.IWTH.U N.IWWH.U N.IWZH.U N.IZMH.U N.IZSH.U N.IZUH.U N.JHKH.U N.JNSH.U
N.JUOH.U N.KACH.U N.KADH.U N.KAHH.U N.KAIH.U N.KAKH.U N.KAMH.U N.KANH.U
N.KASH.U N.KAWH.U N.KAYH.U N.KDIH.U N.KGIH.U N.KGNH.U N.KGRH.U N.KGSH.U
N.KHEH.U N.KHKH.U N.KHOH.U N.KHUH.U N.KHYH.U N.KIBH.U N.KIDH.U N.KIGH.U
N.KIKH.U N.KIWH.U N.KIYH.U N.KIZH.U N.KJNH.U N.KJSH.U N.KKAH.U N.KKCH.U
N.KKEH.U N.KKGH.U N.KKIH.U N.KKWH.U N.KKYH.U N.KMAH.U N.KMBH.U N.KMDH.U
N.KMEH.U N.KMGH.U N.KMHH.U N.KMIH.U N.KMKH.U N.KMMH.U N.KMNH.U N.KMOH.U
N.KMWH.U N.KMYH.U N.KNBH.U N.KNEH.U N.KNGH.U N.KNHH.U N.KNIH.U N.KNNH.U
N.KNSH.U N.KNZH.U N.KOKH.U N.KORH.U N.KOSH.U N.KOTH.U N.KRHH.U N.KRIH.U
N.KRMH.U N.KRTH.U N.KRYH.U N.KSAH.U N.KSBH.U N.KSGH.U N.KSIH.U N.KSMH.U
N.KSOH.U N.KT2H.U N.KTDH.U N.KTGH.U N.KTMH.U N.KTNH.U N.KTRH.U N.KTWH.U
N.KUCH.U N.KUMH.U N.KURH.U N.KWAH.U N.KWBH.U N.KWHH.U N.KWKH.U N.KWMH.U
N.KWNH.U N.KWSH.U N.KWTH.U N.KWZH.U N.KYAH.U N.KYDH.U N.KYEH.U N.KYMH.U
N.KYOH.U N.KYSH.U N.KYWH.U N.KZMH.U N.KZNH.U N.MABH.U N.MAKH.U N.MASH.U
N.MBEH.U N.MBUH.U N.MBWH.U N.MCTH.U N.MGMH.U N.MGWH.U N.MHRH.U N.MHSH.U
N.MICH.U N.MIEH.U N.MIGH.U N.MIHH.U N.MIKH.U N.MINH.U N.MISH.U N.MITH.U
N.MIZH.U N.MJNH.U N.MJSH.U N.MKGH.U N.MKIH.U N.MKJH.U N.MKMH.U N.MKOH.U
N.MKRH.U N.MKWH.U N.MMBH.U N.MMKH.U N.MMOH.U N.MMRH.U N.MMTH.U N.MNAH.U
N.MNEH.U N.MNKH.U N.MNMH.U N.MNOH.U N.MOKH.U N.MORH.U N.MOTH.U N.MRMH.U
N.MROH.U N.MRRH.U N.MRUH.U N.MS2H.U N.MSAH.U N.MSFH.U N.MSIH.U N.MSNH.U
N.MSTH.U N.MTDH.U N.MTKH.U N.MTMH.U N.MTOH.U N.MTYH.U N.MUIH.U N.MURH.U
N.MYJH.U N.MYKH.U N.MYMH.U N.MZEH.U N.MZKH.U N.NAGH.U N.NANH.U N.NAWH.U
N.NAZH.U N.NCNH.U N.NCPH.U N.NDGH.U N.NEOH.U N.NFRH.U N.NGIH.U N.NGKH.U
N.NGOH.U N.NGRH.U N.NGSH.U N.NGTH.U N.NGUH.U N.NGWH.U N.NHEH.U N.NHJH.U
N.NHWH.U N.NITH.U N.NJMH.U N.NKEH.U N.NKMH.U N.NKNH.U N.NKOH.U N.NKTH.U
N.NKWH.U N.NMEH.U N.NMKH.U N.NMNH.U N.NMTH.U N.NNMH.U N.NOBH.U N.NRAH.U
N.NRKH.U N.NRTH.U N.NS2H.U N.NSBH.U N.NSEH.U N.NSHH.U N.NSMH.U N.NSNH.U
N.NSSH.U N.NSTH.U N.NTBH.U N.NTGH.U N.NTHH.U N.NUKH.U N.NUMH.U N.NWAH.U
N.NYAH.U N.NYOH.U N.NYRH.U N.NZWH.U N.OBMH.U N.ODTH.U N.ODWH.U N.OGCH.U
N.OGNH.U N.OGOH.U N.OHAH.U N.OHCH.U N.OHRH.U N.OHTH.U N.OIWH.U N.OKCH.U
N.OKEH.U N.OKMH.U N.OKYH.U N.OKZH.U N.OM2H.U N.OMMH.U N.OMRH.U N.ONDH.U
N.ONIH.U N.ONPH.U N.OOCH.U N.OOKH.U N.OOMH.U N.OOTH.U N.OOZH.U N.OPEH.U
N.OPWH.U N.OREH.U N.ORWH.U N.OSUH.U N.OTAH.U N.OTOH.U N.OTUH.U N.OTWH.U
N.OUMH.U N.OWNH.U N.OWSH.U N.OYMH.U N.RBSH.U N.RKBH.U N.RKSH.U N.RNKH.U
N.RZTH.U N.SADH.U N.SAIH.U N.SAKH.U N.SAMH.U N.SATH.U N.SBAH.U N.SBKH.U
N.SBNH.U N.SBSH.U N.SCNH.U N.SCSH.U N.SDAH.U N.SDMH.U N.SDWH.U N.SENH.U
N.SETH.U N.SFNH.U N.SFSH.U N.SGOH.U N.SGRH.U N.SGUH.U N.SGWH.U N.SHGH.U
N.SHJH.U N.SHKH.U N.SHMH.U N.SHZH.U N.SIKH.U N.SINH.U N.SISH.U N.SJOH.U
N.SKGH.U N.SKIH.U N.SKNH.U N.SKSH.U N.SKUH.U N.SKWH.U N.SMAH.U N.SMGH.U
N.SMMH.U N.SMNH.U N.SMPH.U N.SMSH.U N.SMTH.U N.SNDH.U N.SNIH.U N.SNNH.U
N.SNSH.U N.SNTH.U N.SNWH.U N.SOIH.U N.SOJH.U N.SONH.U N.SOSH.U N.SRIH.U
N.SRMH.U N.SROH.U N.SRUH.U N.SRWH.U N.SSKH.U N.SSMH.U N.SSRH.U N.SSSH.U
N.SSTH.U N.SSWH.U N.SSYH.U N.ST1H.U N.ST2H.U N.ST3H.U N.ST4H.U N.ST5H.U
N.ST6H.U N.STDH.U N.STKH.U N.STNH.U N.STRH.U N.STSH.U N.SUGH.U N.SUKH.U
N.SUZH.U N.SWEH.U N.SWWH.U N.SYKH.U N.SYNH.U N.SYOH.U N.SYSH.U N.SYTH.U
N.SZGH.U N.SZJH.U N.SZKH.U N.SZNH.U N.SZUH.U N.SZWH.U N.TAGH.U N.TAJH.U
N.TAKH.U N.TAMH.U N.TARH.U N.TAYH.U N.TBEH.U N.TBRH.U N.TBTH.U N.TBYH.U
N.TCKH.U N.TDEH.U N.TDMH.U N.TDOH.U N.TGIH.U N.TGKH.U N.TGOH.U N.TGUH.U
N.THGH.U N.THNH.U N.THTH.U N.TISH.U N.TJOH.U N.TJRH.U N.TKBH.U N.TKEH.U
N.TKGH.U N.TKHH.U N.TKIH.U N.TKJH.U N.TKKH.U N.TKNH.U N.TKRH.U N.TKSH.U
N.TKTH.U N.TKUH.U N.TKWH.U N.TMAH.U N.TMGH.U N.TMNH.U N.TMOH.U N.TMYH.U
N.TNEH.U N.TNMH.U N.TOBH.U N.TOGH.U N.TOHH.U N.TOIH.U N.TOKH.U N.TOMH.U
N.TOUH.U N.TOWH.U N.TOYH.U N.TREH.U N.TRGH.U N.TRIH.U N.TROH.U N.TRSH.U
N.TRUH.U N.TRWH.U N.TSKH.U N.TSMH.U N.TSOH.U N.TSRH.U N.TSSH.U N.TSTH.U
N.TSUH.U N.TSYH.U N.TT2H.U N.TTAH.U N.TTKH.U N.TTNH.U N.TU2H.U N.TUMH.U
N.TUNH.U N.TUSH.U N.TWAH.U N.TWEH.U N.TWWH.U N.TY2H.U N.TYEH.U N.TYHH.U
N.TYMH.U N.TYOH.U N.TYRH.U N.TYTH.U N.TYUH.U N.TZWH.U N.UBEH.U N.UCNH.U
N.UCUH.U N.UJEH.U N.UKHH.U N.UMEH.U N.UMIH.U N.UMWH.U N.UMYH.U N.UNNH.U
N.UNSH.U N.UOZH.U N.URSH.U N.USDH.U N.UUMH.U N.UWAH.U N.UWEH.U N.WATH.U
N.WKMH.U N.WKYH.U N.WNEH.U N.WNNH.U N.WNWH.U N.WSMH.U N.YABH.U N.YBKH.U
N.YBNH.U N.YBRH.U N.YFTH.U N.YGDH.U N.YGNH.U N.YGTH.U N.YHBH.U N.YITH.U
N.YJMH.U N.YKHH.U N.YKIH.U N.YKWH.U N.YM2H.U N.YMAH.U N.YMDH.U N.YMGH.U
N.YMIH.U N.YMMH.U N.YMSH.U N.YMTH.U N.YNDH.U N.YNTH.U N.YNZH.U N.YOKH.U
N.YOTH.U N.YROH.U N.YSDH.U N.YSHH.U N.YSKH.U N.YTOH.U N.YUBH.U N.YUZH.U
N.YWTH.U N.YZEH.U N.YZWH.U

r N.AGMH.U N.AGWH.U N.AHIH.U N.AIOH.U N.AIRH.U N.AJSH.U N.AKIH.U
N.AKNH.U N.AKSH.U N.AMAH.U N.AMNH.U N.AMZH.U N.ANIH.U N.ANJH.U N.ANNH.U
N.ANSH.U N.AOMH.U N.ARIH.U N.ARKH.U N.ASAH.U N.ASBH.U N.ASHH.U N.ASKH.U
N.ASNH.U N.ASRH.U N.ASSH.U N.ASUH.U N.ASVH.U N.ATDH.U N.ATGH.U N.ATKH.U
N.ATMH.U N.AWNH.U N.AYEH.U N.AYKH.U N.AYWH.U N.BEEH.U N.BEWH.U N.BFEH.U
N.BFNH.U N.BFWH.U N.BHRH.U N.BKEH.U N.BKWH.U N.BREH.U N.BRWH.U N.BSEH.U
N.BTOH.U N.BZNH.U N.CBAH.U N.CCNH.U N.CH2H.U N.CHKH.U N.CHNH.U N.CHZH.U
N.CKRH.U N.CRNH.U N.CTSH.U N.CZEH.U N.DGOH.U N.DMOH.U N.DWAH.U N.EBTH.U
N.EDSH.U N.EIHH.U N.FBRH.U N.FCHH.U N.FGNH.U N.FGSH.U N.FGTH.U N.FJEH.U
N.FJIH.U N.FJOH.U N.FKCH.U N.FKRH.U N.FKSH.U N.FKUH.U N.FMIH.U N.FRKH.U
N.FRNH.U N.FSTH.U N.FSWH.U N.FUTH.U N.GEIH.U N.GENH.U N.GHKH.U N.GJOH.U
N.GKSH.U N.GNOH.U N.GOTH.U N.GR2H.U N.GSIH.U N.GZNH.U N.HAGH.U N.HASH.U
N.HAZH.U N.HBAH.U N.HBTH.U N.HDKH.U N.HGAH.U N.HGIH.U N.HH2H.U N.HHEH.U
N.HHIH.U N.HHNH.U N.HHRH.U N.HIKH.U N.HIMH.U N.HINH.U N.HIRH.U N.HISH.U
rmean; rtr; taper
bp c 1 3 n 2 p 1
w over
quit
&lt;/pre&gt;
&lt;p&gt;可以看到：第1行是Perl的输出，也就是Perl的print语句传递给SAC句柄的内容，其正确的传递了700多个文件的文件名。第3行之后为SAC的输出，可以看到第3行的内容与第1行内容类似，但是明显短了非常多。这意味着&lt;strong&gt;部分内容在由Perl传递给SAC之后丢失了&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;可以比较容易地发现，SAC显示的read语句长度为1002字符，大概就是1000字符，所以猜测是SAC在读取命令行的内容时，其字符串数组的长度限制在1000字符，进而导致Perl传递进来700多个文件名，实际上SAC只处理了120个（120个文件名基本是1000字符）。&lt;/p&gt;
&lt;p&gt;查看SAC源码可以发现，SAC中用字符数组&lt;tt class="docutils literal"&gt;kline[&lt;span class="caps"&gt;MCMSG&lt;/span&gt;+1]&lt;/tt&gt;来处理命令行输入，其中MCMSG的值为1001，即&lt;tt class="docutils literal"&gt;kline&lt;/tt&gt;的有效长度仅仅是1001，加上的1是为了处理C语言的&lt;tt class="docutils literal"&gt;'\0'&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;由于SAC的确处理了前1000个字符，即前120个文件，所以整个过程都不会报错！所以这个Bug很难察觉！&lt;/p&gt;
&lt;p&gt;几个可以避免该问题的Perl脚本：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;| sac&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r N.*.U \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;rmean; rtr; taper \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;bp c 1 3 n 2 p 1 \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;w over \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;quit \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个脚本没有问题，因为这里的通配符“N.*.U”是由SAC去解释而不是由Bash去解释，所以SAC接收到的命令行长度只有不到10个字符。但是这个脚本不够通用，因为有些时候需要处理的文件无法用通配符表示，比如要处理所有震中距在10到30度以内的文件。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@sacfiles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;glob&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;N.*.U&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;| sac&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@sacfiles&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
   &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r $_ \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;rmean; rtr; taper \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;bp c 1 3 n 2 p 1 \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;w over \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;quit \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个脚本还是继续使用Perl的glob，然后使用foreach循环，每次只处理一个文件，也不会出现问题，速度相对上一个版本可能会慢一些，不过有时候可能就需要这样做。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@sacfiles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;glob&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;N.*.U&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;| sac&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@sacfiles&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
   &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;r more $_ \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;rmean; rtr; taper \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;bp c 1 3 n 2 p 1 \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;w over \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;SAC&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;quit \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SAC&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;该脚本使用foreach循环，不断读入更多的文件，然后一次性进行数据处理，相对于上一个脚本而言，速度要快很多。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-11-17：初稿；&lt;/li&gt;
&lt;li&gt;2014-04-18：根据SAC源码确认了SAC能处理的命令行长度为1000字符；&lt;/li&gt;
&lt;li&gt;2014-05-19：增加了第三个可以避免该问题的脚本；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Bug"></category></entry><entry><title>GMT的Python接口：GmtPy</title><link href="http://seisman.info/a-python-interface-to-gmt.html" rel="alternate"></link><updated>2013-11-16T01:23:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-16:a-python-interface-to-gmt.html</id><summary type="html">&lt;p&gt;GmtPy是GitHub上的一个开源项目，其将GMT绘图功能无缝集成到Python语言中。除了GMT的功能之外，其还支持自动缩放、自动决定tick增量、整体布局管理等。&lt;/p&gt;
&lt;p&gt;项目主页： &lt;a class="reference external" href="http://emolch.github.io/gmtpy/"&gt;http://emolch.github.io/gmtpy/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;版本：V0.1&lt;/p&gt;
&lt;p&gt;依赖：Python（猜测是2）、&lt;span class="caps"&gt;GMT&lt;/span&gt;（4.5以上？）、NumPy、pycdf&lt;/p&gt;
&lt;p&gt;Manual: &lt;a class="reference external" href="http://emolch.github.io/gmtpy/documentation.html#module-gmtpy"&gt;http://emolch.github.io/gmtpy/documentation.html#module-gmtpy&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;一些例子&lt;/h2&gt;
&lt;p&gt;看看下面一些例子，看看GmtPy的优点在哪里。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;基本用法&lt;/h3&gt;
&lt;p&gt;Bash：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
gmtset &lt;span class="nv"&gt;BASEMAP_TYPE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; fancy &lt;span class="se"&gt;\&lt;/span&gt;
       &lt;span class="nv"&gt;PAPER_MEDIA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; a4+ &lt;span class="se"&gt;\&lt;/span&gt;
       &lt;span class="nv"&gt;PAGE_ORIENTATION&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; portrait

pscoast -R5/15/52/58 &lt;span class="se"&gt;\&lt;/span&gt;
        -JB10/55/55/60/10c &lt;span class="se"&gt;\&lt;/span&gt;
        -B4g4 &lt;span class="se"&gt;\&lt;/span&gt;
        -Df &lt;span class="se"&gt;\&lt;/span&gt;
        -S114/159/207 &lt;span class="se"&gt;\&lt;/span&gt;
        -G233/185/110 &lt;span class="se"&gt;\&lt;/span&gt;
        -Wthinnest &amp;gt; example1.eps

epstopdf --outfile&lt;span class="o"&gt;=&lt;/span&gt;example1.pdf example1.eps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;GmtPy:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;gmtpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;BASEMAP_TYPE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;fancy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pscoast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;5/15/52/58&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;B10/55/55/60/10c&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;4g4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;f&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;114&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;159&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;207&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
             &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;233&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;185&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
             &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;thinnest&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;example1.pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;example1.eps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;img alt="image0" src="http://emolch.github.io/gmtpy/_images/example1.png" /&gt;&lt;/p&gt;
&lt;p&gt;最大的特色在于不用像GMT那样每个绘图命令里都要将输出重定向到PS文件中。GmtPy直接使用save控制输出的文件类型，不知道是否支持其他图片格式。&lt;/p&gt;
&lt;p&gt;GmtPy的可能机制的猜测：&lt;/p&gt;
&lt;p&gt;GmtPy中没有-K、-O，完全无法预测哪一个命令是最后一个绘图命令，因而只能创建临时文件夹，将所有的输出重定向到临时PS文件。上面的脚本中使用GMT()创建了一个名为gmt的对象，每个对象对应一个临时文件，当遇到gmt.save命令时，即认为绘图结束，save命令向临时PS文件中加入Trailer信息，并重命名。save也许会进行格式转换工作。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pythongmt"&gt;
&lt;h3&gt;从Python向GMT传递数据&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;gmtpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;PAGE_COLOR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;247/247/240&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psbasemap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
               &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;X&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;i/&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;i&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
               &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;:Time:/&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;:Amplitude:SWne&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="c"&gt;# Make four different datasets&lt;/span&gt;

&lt;span class="c"&gt;# (1) a nested list, with the first dim corresponding to columns&lt;/span&gt;
&lt;span class="n"&gt;data_as_columns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c"&gt;# (2) a nested list, with the first dim corresponding to rows&lt;/span&gt;
&lt;span class="n"&gt;data_as_rows&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c"&gt;# (3) a string containing an ascii table&lt;/span&gt;
&lt;span class="n"&gt;data_as_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&amp;#39;0 5&lt;/span&gt;
&lt;span class="s"&gt;1 4&lt;/span&gt;
&lt;span class="s"&gt;2 3.5&lt;/span&gt;
&lt;span class="s"&gt;3 4&lt;/span&gt;
&lt;span class="s"&gt;4 4.5&lt;/span&gt;
&lt;span class="s"&gt;5 5&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;


&lt;span class="c"&gt;# (4) write ascii table in a temporary file...&lt;/span&gt;

&lt;span class="c"&gt;# Get a filename in the private tempdir of the GMT instance.&lt;/span&gt;
&lt;span class="c"&gt;# Files in that directory get deleted automatically.&lt;/span&gt;
&lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tempfilename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;table.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;0 3&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;1 3&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;5 1.2&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="c"&gt;# Plot the four datasets&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# The kind of input is selected with the keyword arguments beginning&lt;/span&gt;
&lt;span class="c"&gt;# with &amp;#39;in_&amp;#39;.&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# Specifying R=True and J=True results &amp;#39;-R&amp;#39; and &amp;#39;-J&amp;#39; being passed&lt;/span&gt;
&lt;span class="c"&gt;# to the GMT program without any arguments. (Doing so causes GMT to&lt;/span&gt;
&lt;span class="c"&gt;# repeat the previous values.)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;1p,black&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;in_columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data_as_columns&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;1p,red&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="n"&gt;in_rows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data_as_rows&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;1p,blue&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;in_string&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data_as_string&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;1p,purple,a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;in_filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;example2.pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;img alt="image1" src="http://emolch.github.io/gmtpy/_images/example2.png" /&gt;&lt;/p&gt;
&lt;p&gt;这个例子展示了Python向GMT传递数据的四种方式：in_columns、in_rows、in_string、in_filename。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;默认布局&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;gmtpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cm&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;PAGE_COLOR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;247/247/240&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;default_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plot_widget&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_widget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plot_widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_horizontal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_widget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;top&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_vertical&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psbasemap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
               &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;:Time [ s ]:/&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;:Amplitude [ m ]:SWne&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
               &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;plot_widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;XYJ&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;2p,blue,o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="n"&gt;in_columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;plot_widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;XYJ&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;example3.pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bbox&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;img alt="image2" src="http://emolch.github.io/gmtpy/_images/example3.png" /&gt;&lt;/p&gt;
&lt;p&gt;自动计算图相对纸张的位置。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;自定义布局&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;gmtpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GridLayout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FrameLayout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;golden_ratio&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="c"&gt;# some data to plot...&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ys&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;PAGE_COLOR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;247/247/240&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GridLayout&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;widgets&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;iwidget&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;inner_layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FrameLayout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_widget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iwidget&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;inner_layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;widget&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;inner_layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_widget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_horizontal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_vertical&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;golden_ratio&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;widgets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;widget&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;# gmt.draw_layout( layout )&lt;/span&gt;
&lt;span class="c"&gt;# print layout&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;widgets&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ys&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psbasemap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;:Time [ s ]:/&lt;/span&gt;&lt;span class="si"&gt;%g&lt;/span&gt;&lt;span class="s"&gt;:Amplitude [ m ]:SWne&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;XYJ&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

    &lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;psxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;2p,blue,o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="n"&gt;in_columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;XYJ&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;gmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;example4.pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bbox&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;img alt="image3" src="http://emolch.github.io/gmtpy/_images/example4.png" /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="模块"></category><category term="Python"></category></entry><entry><title>man转pdf的命令行法</title><link href="http://seisman.info/man2pdf.html" rel="alternate"></link><updated>2013-11-15T00:03:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-15:man2pdf.html</id><summary type="html">&lt;p&gt;Linux下的man是个好东西，下面的命令实现了从man到pdf的转换:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
man -t tmux | ps2pdf - &amp;gt; tmux.pdf
&lt;/pre&gt;
&lt;p&gt;其中&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-t&lt;/span&gt;&lt;/tt&gt;选项本质上调用了&lt;tt class="docutils literal"&gt;/usr/bin/groff &lt;span class="pre"&gt;-Tps&lt;/span&gt; &lt;span class="pre"&gt;-mandoc&lt;/span&gt;&lt;/tt&gt;，即生成了PS代码，然后利用ps2pdf将其转换为PDF格式。&lt;/p&gt;
</summary><category term="命令"></category><category term="格式转换"></category><category term="PDF"></category></entry><entry><title>判断字节序的多种方法</title><link href="http://seisman.info/linux-endian.html" rel="alternate"></link><updated>2013-11-13T00:33:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-13:linux-endian.html</id><summary type="html">&lt;p&gt;本文整理自： &lt;a class="reference external" href="http://serverfault.com/questions/163487/linux-how-to-tell-if-system-is-big-endian-or-little-endian"&gt;http://serverfault.com/questions/163487/linux-how-to-tell-if-system-is-big-endian-or-little-endian&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;直接查看系统文件:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
lscpu | grep -i byte
&lt;/pre&gt;
&lt;p&gt;Bash版:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
echo -n I | od -to2 | head -n1 | cut -f2 -d&amp;quot; &amp;quot; | cut -c6
&lt;/pre&gt;
&lt;p&gt;若输出为1则为Little Endian，若输出为0则为Big&amp;nbsp;Endian。&lt;/p&gt;
&lt;p&gt;为了适应不同操作系统的需求，还有其他各种变种&lt;/p&gt;
&lt;pre class="literal-block"&gt;
echo I | tr -d [:space:] | od -to2 | head -n1 | awk '{print $2}' | cut -c6
&lt;/pre&gt;
&lt;pre class="literal-block"&gt;
echo -n I | od -to2 | awk '{ print substr($2,6,1); exit}'
&lt;/pre&gt;
&lt;pre class="literal-block"&gt;
echo -n I | hexdump -o | awk '{ print substr($2,6,1); exit}'
&lt;/pre&gt;
&lt;p&gt;Python一行命令版&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;import sys;print(0 if sys.byteorder==&amp;#39;big&amp;#39; else 1)&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Python脚本版&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;struct&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pack&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pack&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;@h&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;pack&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;lt;h&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Little Endian&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Big Endian&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Jython脚本版&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;java&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lang&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;System&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;property&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt; &lt;span class="nf"&gt;dict&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getProperties&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="na"&gt;items&lt;/span&gt;&lt;span class="o"&gt;():&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;property&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;endswith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;cpu&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;endian&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="endian"></category><category term="Bash"></category><category term="Python"></category></entry><entry><title>GMT选项之时间戳-U</title><link href="http://seisman.info/gmt-option-u.html" rel="alternate"></link><updated>2013-11-12T00:11:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-12:gmt-option-u.html</id><summary type="html">
&lt;p&gt;本文适用于GMT4和GMT5。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;-U选项会在绘图上加上GMT的小logo以及时间戳。&lt;/p&gt;
&lt;p&gt;几种常见用法：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-U&lt;/span&gt;&lt;/tt&gt;：采用默认参数，时间戳位于绘图的左下角；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Ujust/dx/dy&lt;/span&gt;&lt;/tt&gt;：just指定时间戳的对齐方式，dx和dy指定时间戳与绘图原点的偏移量；缺省情况下-U等效于-&lt;span class="caps"&gt;UBL&lt;/span&gt;/-2c/-2c；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Uc&lt;/span&gt;&lt;/tt&gt;：&lt;strong&gt;c&lt;/strong&gt;代表command，这种方式会将当前命令打印在时间戳之后；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Ulabel&lt;/span&gt;&lt;/tt&gt;：label可以是任意的字符串；常用来做一些小注释；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Ujust/dx/dy/c|label&lt;/span&gt;&lt;/tt&gt;：最完整的用法；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;默认参数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该选项的默认参数为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&lt;span class="caps"&gt;UBL&lt;/span&gt;/0/0&lt;/span&gt;&lt;/tt&gt;，即时间戳的左下角与绘图原点对齐。&lt;/p&gt;
&lt;p&gt;GMT提供了一些参数可以修改这些默认行为：&lt;/p&gt;
&lt;div class="section" id="gmt4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;&lt;span class="caps"&gt;GMT4&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;UNIX_TIME：控制默认情况下是否要绘制时间戳；缺省值为FALSE，即不绘制；&lt;/li&gt;
&lt;li&gt;UNIX_TIME_POS：默认情况下时间戳的位置：&lt;span class="caps"&gt;BL&lt;/span&gt;/-2c/-2c；&lt;/li&gt;
&lt;li&gt;UNIX_TIME_FORMAT：时间格式，默认值为&lt;tt class="docutils literal"&gt;%Y %b %d &lt;span class="pre"&gt;%H:%M:%S&lt;/span&gt;&lt;/tt&gt;，具体格式可以参考C语言strftime函数；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;&lt;span class="caps"&gt;GMT5&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;MAP_LOGO：即GMT4中的UNIX_TIME；&lt;/li&gt;
&lt;li&gt;MAP_LOGO_POS：即GMT4中的UNIX_TIME_POS，默认值为BL/-54p/-54p；&lt;/li&gt;
&lt;li&gt;FORMAT_TIME_STAMP：即GMT4中的UNIX_TIME_FORMAT；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="logo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;自定义Logo&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;其实这篇博文的目的是为了引入下一篇博文—-自定义GMT的Logo。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT选项"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>GMT进阶之修改箭头形状</title><link href="http://seisman.info/gmt-vector-shape.html" rel="alternate"></link><updated>2013-11-11T00:04:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-11:gmt-vector-shape.html</id><summary type="html">&lt;p&gt;感觉GMT默认的箭头很丑，一直以为GMT没法修改箭头的形状，细细看了gmtdefaults才发现，箭头其实也是可以自定义的。&lt;/p&gt;
&lt;p&gt;在GMT4中，可以通过修改默认参数VECTOR_SHAPE来自定义箭头形状。其取值范围为[-2,2]，默认值为0。&lt;/p&gt;
&lt;p&gt;在GMT5中，这个参数改名为MAP_VECTOR_SHAPE。&lt;/p&gt;
&lt;p&gt;如下图所示：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013111101.jpg" style="width: 400px;" /&gt;
&lt;/div&gt;
&lt;p&gt;坐标的坐标对应了不同的VECTOR_SHAPE的取值，默认值为0，此时的箭头是个等腰三角形。个人感觉VECTOR_SHAPE取[0.5,1]的值看上去比较美观。&lt;/p&gt;
&lt;p&gt;下面为绘图所用脚本&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c"&gt;# GMT 4&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0.8/3/-2.5/2.5
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6c/8c
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0.5/0.5W
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;vector.ps

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; i in -2 -1.5 -1 -0.5 &lt;span class="m"&gt;0&lt;/span&gt; 0.5 &lt;span class="m"&gt;1&lt;/span&gt; 1.5 2&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
   gmtset VECTOR_SHAPE &lt;span class="nv"&gt;$i&lt;/span&gt;
psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -Sv -Gblack -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;span class="s"&gt;1 $i 0 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="GMT技巧"></category><category term="GMT脚本"></category><category term="GMT4"></category></entry><entry><title>GMT5进阶之图层透明效果</title><link href="http://seisman.info/gmt5-transparency.html" rel="alternate"></link><updated>2013-11-10T00:14:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-10:gmt5-transparency.html</id><summary type="html">
&lt;p&gt;设置图层的透明度，大概是GMT5新增的绘图功能中最大的一个亮点。&lt;/p&gt;
&lt;div class="section" id="t"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;-t选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;-t是一个GMT5通用选项，用于设置图层透明度，其用法很简单。&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-ttrans&lt;/span&gt;&lt;/tt&gt;，其中&lt;tt class="docutils literal"&gt;trans&lt;/tt&gt;可以取0-100的值，0代表完全不透明，100代表完全透明。需要注意的是PS是不支持透明特性的，透明的效果只能在PDF中看到。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;一个例子&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个脚本严格遵循GMT5的语法。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;g
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;H20c
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;trans.ps

&lt;span class="c"&gt;# 打开GMT5&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -K -UBL/0/0 &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制海岸线&lt;/span&gt;
gmt pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Bpx60 -W1/0.2p -N1 -K -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 绘制第一个不透明矩形框&lt;/span&gt;
gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -W1p -L -Gred -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;span class="s"&gt;100 -20&lt;/span&gt;
&lt;span class="s"&gt;100 20&lt;/span&gt;
&lt;span class="s"&gt;140 20&lt;/span&gt;
&lt;span class="s"&gt;140 -20&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="c"&gt;# 绘制第二个透明矩形框&lt;/span&gt;
gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -W1p -L -Gred -t60 -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;span class="s"&gt;280 -20&lt;/span&gt;
&lt;span class="s"&gt;280 20&lt;/span&gt;
&lt;span class="s"&gt;320 20&lt;/span&gt;
&lt;span class="s"&gt;320 -20&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

&lt;span class="c"&gt;# 关闭GMT&lt;/span&gt;
gmt psxy -R&lt;span class="nv"&gt;$R&lt;/span&gt; -J&lt;span class="nv"&gt;$J&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;转换为其他格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;PS格式不支持透明，所以在PS文件中看不到任何透明效果。&lt;/p&gt;
&lt;p&gt;ps2raster可以将PS文件转换为bmp、eps、pdf、png、jpeg、ppm、tif格式，但是只有PDF格式中可以看到透明效果。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt ps2raster -A -P -Tf trans.ps
&lt;/pre&gt;
&lt;p&gt;如果想要其他格式怎么办？再用convert将PDF转换为其他格式即可:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
convert -density 300 trans.pdf trans.jpg
&lt;/pre&gt;
&lt;p&gt;注意：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;是两步走，先用ps2raster将PS转换为PDF，再用convert将PDF转换为其他格式。&lt;/li&gt;
&lt;li&gt;直接用convert将PS转换为其他任何格式（包括PDF），都没有透明效果。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;效果图&lt;/a&gt;&lt;/h2&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013111001.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="GMT脚本"></category><category term="GMT选项"></category><category term="GMT5"></category></entry><entry><title>GMT 5与4:如何兼得？</title><link href="http://seisman.info/multiple-versions-of-gmt.html" rel="alternate"></link><updated>2013-11-09T00:13:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-09:multiple-versions-of-gmt.html</id><summary type="html">
&lt;p&gt;想要看具体的解决办法，可以直接跳转至&lt;a class="reference external" href="http://seisman.info/multiple-versions-of-gmt.html#i"&gt;第4部分&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;2013年11月05日，&lt;span class="caps"&gt;GMT&lt;/span&gt; 4以及GMT 5同时发布了最新版本。&lt;span class="caps"&gt;GMT&lt;/span&gt; 4.5.11在经历了4系列的不断升级后，其稳定性值得信任。而5系列相对于4系列的变化非常之大，几乎重写或重整了全部代码，功能更丰富，bug“可能”会多一些。&lt;/p&gt;
&lt;p&gt;一个是已经用习惯的老版本，一个是必须去适应的新版本，该怎么选择是个问题。官方声称GMT 4系列会继续维护更新直到GMT6出来，按照现在的速度，GMT4应该还会维护至少4-5年，即便4-5年之后GMT4不再更新，使用GMT4语法也不是问题。&lt;/p&gt;
&lt;p&gt;对于新手来说，使用GMT5是必然的趋势也是最好的选择；对于老手来说，是该固守GMT4还是该学习GMT5呢？&lt;/p&gt;
&lt;p&gt;下面分几个情况讨论，GMT4和GMT5的选择问题：&lt;/p&gt;
&lt;div class="section" id="gmt4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;只安装GMT4&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这一类是保守派。毕竟GMT4用习惯了，以前的所有脚本都是用GMT4的语法写的，重新学习GMT5的成本太大。对于这一类，老老实实用GMT4就好，不必理会GMT5。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;只安装GMT5&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这一类是改革派。又分为两种情况：&lt;/p&gt;
&lt;div class="section" id="gmt5gmt4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;GMT5兼容GMT4语法&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT5完全可以“兼容”GMT4的用法。兼容的好处在于可以帮助用户实现GMT4到GMT5的无痛过渡；不好的地方在于为了实现兼容，需要写更多的代码，或使用不合适的特性。&lt;/p&gt;
&lt;p&gt;维基百科在&lt;a class="reference external" href="http://zh.wikipedia.org/wiki/%E5%90%91%E4%B8%8B%E5%85%BC%E5%AE%B9"&gt;向下兼容&lt;/a&gt;词条中举例：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;通常更新一个软件时，应该为向下兼容性做出一定的考虑，这往往能给用户带来方便并更好地留住用户。Microsoft
特别强调维持软件的向下兼容性。为了实现此一目标，有时微软甚至不惜支持使用了非官方乃至误用的
&lt;span class="caps"&gt;API&lt;/span&gt; 的软件。&lt;/p&gt;
&lt;p&gt;但情况并不总是这样，有时为了考虑向下兼容会带来一些累赘，尤其是进行过较多升级后。Python
3.0 便是放弃向下兼容的一个例子。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;前面说过，GMT5与GMT4的一个最大区别是，GMT5中只有一个唯一的可执行文件：&lt;tt class="docutils literal"&gt;gmt&lt;/tt&gt;。GMT4中的所有命令在GMT5中都作为命令&lt;tt class="docutils literal"&gt;gmt&lt;/tt&gt;的一个模块来调用。比如GMT4的&lt;tt class="docutils literal"&gt;pscoast&lt;/tt&gt;命令在GMT5中应该使用&lt;tt class="docutils literal"&gt;gmt pscoast&lt;/tt&gt;来调用。&lt;/p&gt;
&lt;p&gt;为了兼容GMT4，GMT5除了在代码上下了很多功夫外，还有两个事情是一般用户值得注意的：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GMT5的默认参数文件位于GMT/share/conf/gmt.conf，其中GMT_COMPATIBILITY=4代表当前的GMT5在源代码级别上兼容GMT4；&lt;/li&gt;
&lt;li&gt;GMT5的bin目录下，提供了众多指向二进制文件gmt的符号链接。因而当用户输入命令&lt;tt class="docutils literal"&gt;pscoast&lt;/tt&gt;，实际上是在执行&lt;tt class="docutils literal"&gt;gmt pscoast&lt;/tt&gt;；这保证了在兼容模式下用GMT4语法写的脚本不必修改也可直接使用；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;GMT5不兼容GMT4语法&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;对于新手来说，学习GMT4过时的语法反而是个累赘。这个时候最好不要让GMT5兼容GMT4语法。&lt;/p&gt;
&lt;p&gt;将GMT/share/conf/gmt.conf中的&lt;/p&gt;
&lt;pre class="literal-block"&gt;
GMT_COMPATIBILITY = 4
&lt;/pre&gt;
&lt;p&gt;改成&lt;/p&gt;
&lt;pre class="literal-block"&gt;
GMT_COMPATIBILITY = 5
&lt;/pre&gt;
&lt;p&gt;即可。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt4gmt5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;同时安装GMT4和GMT5&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个算是什么派呢？安装GMT5是为了顺应潮流，安装GMT4是为了其他程序的兼容性问题，比如地震学常用的pssac目前只支持GMT4，Prof. Zhu不知道有没有心思让pssac支持GMT5。两个版本同时存在，具体怎么搞？&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; manual的第5章给出了两种解决办法，下面简要介绍，并重点给出我的第三种办法。&lt;/p&gt;
&lt;div class="section" id="gmtswitchgmt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;用gmtswitch切换GMT版本&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在安装完全部需要的GMT版本之后，运行&lt;tt class="docutils literal"&gt;gmtswitch&lt;/tt&gt;，该命令会搜索当前系统中所有可用GMT版本，并将搜索结果保存在文件=/.gmtversions中，该文件每行给定一个GMT版本的绝对路径（如/usr/local/&lt;span class="caps"&gt;GMT&lt;/span&gt;-4.5.9），如果搜索结果有误（搜索结果错误的概率好像很大），自己可以手动修改该文件。然后用户需要在.bashrc中修改环境变量:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
export $PATH=${PATH}:$HOME/this_gmt/bin
&lt;/pre&gt;
&lt;p&gt;注意，最好把原来GMT安装时加入的GMT路径删除。&lt;/p&gt;
&lt;p&gt;下次运行gmtswitch时，如果没有提供参数，gmtswitch会列出所有可能的GMT版本，供用户选择:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ gmtswitch
1. Version GMT-4.5.9
2. Version GMT-4.5.11
3. Version GMT-5.1.0

Please choose a GMT version (1-3) [1]: 1
&lt;/pre&gt;
&lt;p&gt;选择之后，该命令会在HOME下创建一个指向对应GMT版本根目录的符号链接this_gmt。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ll this_gmt
lrwxrwxrwx. 1 seisman seisman 14 11月 6 18:58 this_gmt -&amp;gt; /opt/GMT-4.5.9
&lt;/pre&gt;
&lt;p&gt;当然，也可以使用下面的方式来切换版本:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ gmtswitch 4.5.11
$ gmtswitch GMT-5.1.0
&lt;/pre&gt;
&lt;p&gt;这个方法实际上是在模拟当前十分流行的多版本切换方法，比如plenv、pyenv、perlbrew都是用类似的方法切换不同版本。这样做的缺点在于需要明确知道自己要使用哪个版本，需要不断地进行切换。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bash"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;Bash脚本切换版本&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;脚本如下:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nv"&gt;$1&lt;/span&gt; in
    4&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;function&lt;/span&gt; gmt&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="nv"&gt;module&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; /path/to/gmt4/bin/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;module&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; &lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;
    5&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;function&lt;/span&gt; gmt&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        /path/to/gmt5/bin/gmt &lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;
    *&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;
    &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;span class="k"&gt;esac&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; -f gmt
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;将该脚本命名为gmtfun，通过如下命令进行版本切换:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ . gmtfun 4 #切换到GMT4
$ . gmtfun 5 #切换到GMT5
&lt;/pre&gt;
&lt;p&gt;已经无力吐嘲这个版本切换的方法了。。。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;个人比较推荐的版本共存方法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;先说怎么做，再解释原因。&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;修改环境变量&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这里，同时添加两个GMT版本的路径，理论上这样做命令会出现多个版本的冲突。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# GMT 4&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;GMT4_HOME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/opt/GMT-4.5.11
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GMT4_HOME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;/bin:&lt;span class="nv"&gt;$PATH&lt;/span&gt;

&lt;span class="c"&gt;# GMT 5&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;GMT5_HOME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/opt/GMT-5.1.0
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GMT5_HOME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;/bin:&lt;span class="nv"&gt;$PATH&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="gmt5bin"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;删除GMT5的bin目录下的所有符号链接&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;删除GMT5的符号链接以解决这些冲突:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ cd /opt/GMT-5.1.0/bin/
# 建立临时目录，需要Root权限
$ sudo mkdir temp
#
&lt;/pre&gt;
&lt;p&gt;GMT5的bin目录，gmt为可执行文件，gmt-config、gmtlogo、gmt_shell_functions.sh、 gmtswitch、isogmt为Bash脚本，其余都是指向可执行文件gmt的符号链接:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sudo mv gmt gmt-config gmtlogo gmt_shell_functions.sh gmtswitch isogmt temp/
$ sudo rm * # 删除除temp目录之外的全部符号链接
rm: 无法删除"temp": 是一个目录
# 将temp目录下的文件复制回bin下
$ sudo mv temp/* .
# 删除temp目录
$ sudo rmdir temp/
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;修改GMT5为不兼容模式&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;修改GMT5的文件share/gmt.conf，将其中的&lt;/p&gt;
&lt;pre class="literal-block"&gt;
GMT_COMPATIBILITY = 4
&lt;/pre&gt;
&lt;p&gt;改成&lt;/p&gt;
&lt;pre class="literal-block"&gt;
GMT_COMPATIBILITY = 5
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;测试一下&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
$ psxy -
psxy 4.5.11 [64-bit] - Plot lines, polygons, and symbols on maps

usage: psxy &amp;lt;infiles&amp;gt; -J&amp;lt;params&amp;gt; -R&amp;lt;west&amp;gt;/&amp;lt;east&amp;gt;/&amp;lt;south&amp;gt;/&amp;lt;north&amp;gt;[r] [-A[m|p]] [-B&amp;lt;params&amp;gt;] [-C&amp;lt;cpt&amp;gt;] [-D&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;]
    [-E[x|y|X|Y][n][cap][/[+|-]&amp;lt;pen&amp;gt;]] [-G&amp;lt;fill&amp;gt;] [-H[i][&amp;lt;nrec&amp;gt;]] [-I&amp;lt;intens&amp;gt;] [-K] [-L] [-N] [-O] [-P]
    [-S[&amp;lt;symbol&amp;gt;][&amp;lt;size&amp;gt;]] [-T] [-U[&amp;lt;just&amp;gt;/&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;/]1] [-V] [-W[+|-][&amp;lt;pen&amp;gt;]] [-X[a|c|r]&amp;lt;x_shift&amp;gt;[u]] [-Y[a|c|r]&amp;lt;x_shift&amp;gt;[u]]
    [-c&amp;lt;ncopies&amp;gt;] [-:[i|o]] [-bi[s|S|d|D[&amp;lt;ncol&amp;gt;]|c[&amp;lt;var1&amp;gt;/...]]] [-f[i|o]&amp;lt;colinfo&amp;gt;] [-g[a]x|y|d|X|Y|D|[&amp;lt;col&amp;gt;]z[-|+]&amp;lt;gap&amp;gt;[unit]] [-m[&amp;lt;flag&amp;gt;]]

$ gmt psxy -
psxy(core) 5.1.0 (r12452) [64-bit] - Plot lines, polygons, and symbols on maps

usage: psxy [&amp;lt;table&amp;gt;] -J&amp;lt;args&amp;gt; -R&amp;lt;west&amp;gt;/&amp;lt;east&amp;gt;/&amp;lt;south&amp;gt;/&amp;lt;north&amp;gt;[/&amp;lt;zmin&amp;gt;/&amp;lt;zmax&amp;gt;][r] [-A[m|p]]
    [-B&amp;lt;args&amp;gt;] [-C&amp;lt;cpt&amp;gt;] [-D&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;] [-E[x|y|X|Y][n][cap][/[+|-]&amp;lt;pen&amp;gt;]] [-G&amp;lt;fill&amp;gt;]
    [-Jz|Z&amp;lt;args&amp;gt;] [-I&amp;lt;intens&amp;gt;] [-K] [-L] [-N] [-O] [-P] [-S[&amp;lt;symbol&amp;gt;][&amp;lt;size&amp;gt;|+s&amp;lt;scale&amp;gt;[unit][/&amp;lt;origin&amp;gt;][l]]]
    [-T] [-U[&amp;lt;just&amp;gt;/&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;/]1] [-V[&amp;lt;level&amp;gt;]] [-W[+|-][&amp;lt;pen&amp;gt;]]
    [-X[a|c|r]&amp;lt;xshift&amp;gt;[&amp;lt;unit&amp;gt;]] [-Y[a|c|r]&amp;lt;yshift&amp;gt;[&amp;lt;unit&amp;gt;]] [-a&amp;lt;col&amp;gt;=&amp;lt;name&amp;gt;[,...]]
    [-bi[&amp;lt;ncol&amp;gt;][t][w][+L|B]] [-c&amp;lt;ncopies&amp;gt;] [-f[i|o]&amp;lt;info&amp;gt;]
    [-g[a]x|y|d|X|Y|D|[&amp;lt;col&amp;gt;]z[-|+]&amp;lt;gap&amp;gt;[&amp;lt;unit&amp;gt;]]
    [-h[i|o][&amp;lt;nrecs&amp;gt;][+c][+d][+r&amp;lt;remark&amp;gt;][+t&amp;lt;title&amp;gt;]] [-i&amp;lt;cols&amp;gt;[l][s&amp;lt;scale&amp;gt;][o&amp;lt;offset&amp;gt;][,...]]
    [-p[x|y|z]&amp;lt;azim&amp;gt;/&amp;lt;elev&amp;gt;[/&amp;lt;zlevel&amp;gt;][+w&amp;lt;lon0&amp;gt;/&amp;lt;lat0&amp;gt;[/&amp;lt;z0&amp;gt;][+v&amp;lt;x0&amp;gt;/&amp;lt;y0&amp;gt;]] [-s[&amp;lt;cols&amp;gt;][a|r]]
    [-t&amp;lt;transp&amp;gt;] [-:[i|o]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id22"&gt;补充说明&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;删除符号链接的步骤比较麻烦，其实有更简单的办法，在编译GMT5之前，修改cmake/ConfigUser.cmake时，其中有一行:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
#set (GMT_INSTALL_MODULE_LINKS FALSE)
&lt;/pre&gt;
&lt;p&gt;将该行前的“#”去掉，即设置GMT_INSTALL_MODULE_LINKS=&lt;span class="caps"&gt;FALSE&lt;/span&gt;，则在安装过程中就不会创建符号链接了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;原理解释&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;主要利用的一点是“GMT5中只有gmt这一个可执行文件”。删除了GMT5下的所有符号链接并设置GMT5为不兼容模式后，所有类似&lt;tt class="docutils literal"&gt;psxy&lt;/tt&gt;的命令都会被认为是GMT4的语法，这样以前的GMT4脚本都不需要做任何修改。所有类似&lt;tt class="docutils literal"&gt;gmt psxy&lt;/tt&gt;的命令都会被认为是GMT5的语法，并严格要求必须是GMT5语法，这样有利用用户实现过渡。总之，这样做的好处就是，以前的GMT4脚本不用改，新写的脚本严格遵循GMT5语法。互不干涉，挺好的。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="GMT4"></category><category term="GMT5"></category><category term="版本"></category></entry><entry><title>GMT5相对GMT4的一些变化</title><link href="http://seisman.info/difference-between-gmt-5-and-4.html" rel="alternate"></link><updated>2013-11-08T00:17:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-08:difference-between-gmt-5-and-4.html</id><summary type="html">
&lt;p&gt;期待了很久的GMT5终于出来了，先总结一下GMT5相对于GMT4的变化。内容主要来自于GMT manual。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;一些基本的变化&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GMT5文档本身变丑了，没有设计封面，完全没有美感可言，内部的排版也没有GMT4的文档美观；&lt;/li&gt;
&lt;li&gt;增加了200+新特性；&lt;/li&gt;
&lt;li&gt;重写了PSL绘图函数库，生成的PS代码更短更兼容；&lt;/li&gt;
&lt;li&gt;开放了API，可以供C/C++直接调用，部分可以支持F77。目前正在开发Matlab接口，并计划开发Python接口；&lt;/li&gt;
&lt;li&gt;GMT5的部分命令以及几乎全部默认参数名都发生了变化，但是GMT5提供了兼容模式，可以良好执行GMT4语法；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;命令的变化&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;对于GMT4而言，&lt;span class="caps"&gt;GMT&lt;/span&gt;/bin目录下有143个可执行文件，而对于GMT5来说，只有一个命令&lt;tt class="docutils literal"&gt;gmt&lt;/tt&gt;和几个辅助型bash脚本，其他命令如&lt;tt class="docutils literal"&gt;psxy&lt;/tt&gt;都是指向gmt的符号链接。GMT5采用"gmt module"的方式执行单个命令，比如&lt;tt class="docutils literal"&gt;gmt pscoast&lt;/tt&gt;与GMT4中的&lt;tt class="docutils literal"&gt;pscoast&lt;/tt&gt;相同。这样做的好处在于，避免了GMT的psxy命令与其他软件的psxy命令相互冲突。&lt;/p&gt;
&lt;p&gt;之所以建立指向gmt的众多符号链接，是为了满足GMT4兼容性的需求。其实，或许有个更好的办法，下一篇博文再说。&lt;/p&gt;
&lt;p&gt;有部分命令修改了名字，有部分命令从原来的补充包中提升到标准包中，具体的不说。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;常用选项的变化&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT5新增了一些常用选项，同时也删除了部分GMT4中不用的常用选项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-a选项：用于处理GDAL数据；&lt;/li&gt;
&lt;li&gt;-b选项的功能被加强，可以自定义二进制文件的格式；&lt;/li&gt;
&lt;li&gt;-i和-o选项可以控制读取和写入table数据时读取哪些列，以及按照何种顺序读取/写入，更灵活了；&lt;/li&gt;
&lt;li&gt;-n选项：可以控制网格读取时的插值和边界条件；&lt;/li&gt;
&lt;li&gt;-p选项：perspective view，应该翻译成立体图或者视角图，以前只有特定的命令才可使用，（如pscoast加上-E选项），现在所有绘图命令都可以使用该视图了；&lt;/li&gt;
&lt;li&gt;-s选项：控制读入数据时的NaN；&lt;/li&gt;
&lt;li&gt;-t选项：支持图层的透明化。该特性对PS文件无效，需要将ps转换为pdf才能看到透明效果；&lt;/li&gt;
&lt;li&gt;-B选项：功能增强了，可以自定义更灵活的坐标轴了；同时其也可以自动计算最优的间隔；&lt;/li&gt;
&lt;li&gt;-R选项：有一点变化，具体没看懂；&lt;/li&gt;
&lt;li&gt;-fp：允许输入的数据是已经经过投影之后的坐标；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;一些默认参数的变化&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;几乎所有的默认参数名字都变了，其目的是为了更好的根据名字来分组，看上去有些不习惯了。同时多了一些新的默认参数，下面列举几个比较有意思的：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;DIR_DCW：GMT现在支持了DCW数据；&lt;/li&gt;
&lt;li&gt;DIR_GSHHG：GMT的GSHHG的目录；&lt;/li&gt;
&lt;li&gt;GMT_COMPATIBILITY：若为4则表示兼容GMT4；若为5则表示严格按照GMT5的语法；&lt;/li&gt;
&lt;li&gt;PS_TRANSPARENCY：当PS转换为PDF文件时，透明图层要如何处理；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;其他的一些改变&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;对于绘图尺寸单位以及距离单位进行了重新定义；&lt;/li&gt;
&lt;li&gt;程序可以自动识别多段数据了，这意味着再也不需要-m选项了；&lt;/li&gt;
&lt;li&gt;对于网格文件，支持更多的操作；&lt;/li&gt;
&lt;li&gt;cpt文件可以对应不同的单位；&lt;/li&gt;
&lt;li&gt;支持直接读取Arc/Info 浮点型二进制网格文件以及ESRI的.hdr格式；&lt;/li&gt;
&lt;li&gt;所有的文本都支持描边了；&lt;/li&gt;
&lt;li&gt;所有颜色均可定义透明度；&lt;/li&gt;
&lt;li&gt;新增到36个标准CPT文件；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;结束&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;总的来说，GMT5相对于GMT4来说的变化还是很大的。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT5"></category><category term="GMT4"></category></entry><entry><title>GMT 4.5.13在Linux下的安装</title><link href="http://seisman.info/install-gmt4-under-linux.html" rel="alternate"></link><updated>2015-01-01T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-07:install-gmt4-under-linux.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;本文介绍如何在Linux下编译GMT4的最新版本：&lt;span class="caps"&gt;GMT&lt;/span&gt; 4.5.13。&lt;/p&gt;
&lt;p&gt;很多Linux发行版的源中带有GMT软件包，但是版本一般较老，因而这里假定想要自己编译GMT4的读者，下载和编译的都是GMT4的最新版本，因而本文会随着GMT4新版本的发行而不断作出修改。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;官方ftp：&lt;a class="reference external" href="ftp://ftp.soest.hawaii.edu/gmt"&gt;ftp://ftp.soest.hawaii.edu/gmt&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;需要下载的包包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://ftp.soest.hawaii.edu/gmt/gmt-4.5.13-src.tar.bz2"&gt;gmt-4.5.13-src.tar.bz2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://ftp.soest.hawaii.edu/gmt/gshhg-gmt-2.3.4.tar.gz"&gt;gshhg-gmt-2.3.4.tar.gz&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注：GMT中的&lt;tt class="docutils literal"&gt;triangulate&lt;/tt&gt;命令有两个不同的源码，其中一个遵循GPL协议，另一个不遵循GPL协议。GMT的src包中包含了前者。若有特殊需求，需要使用后者源码的功能，可以下载&lt;a class="reference external" href="ftp://ftp.soest.hawaii.edu/gmt/gmt-4.5.13-non-gpl-src.tar.bz2"&gt;gmt-4.5.13-non-gpl-src.tar.bz2&lt;/a&gt;，并将解压后的triangulate源码覆盖&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;gmt-4.5.13-src.tar.bz2&lt;/span&gt;&lt;/tt&gt;中的相应源码。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;依赖关系&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;基础依赖包&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT编译过程需要C编译器，以及一些底层的库文件。&lt;/p&gt;
&lt;p&gt;对于Ubuntu/Debian:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo apt-get install g++ libxt-dev libxaw7-dev libxmu-dev libSM-dev
&lt;/pre&gt;
&lt;p&gt;对于CentOS/&lt;span class="caps"&gt;RHEL&lt;/span&gt;/Fedora:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install gcc-c++ libXt-devel libXaw-devel libXmu-devel libSM-devel
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;软件依赖包&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT4主要依赖于netCDF，可以直接使用Linux发行版官方源中提供的netCDF包&lt;a class="footnote-reference" href="#id8" id="id6"&gt;[*]&lt;/a&gt;。除了netcdf之外，建议还安装gdal包。虽然GMT不依赖于gdal，但gdal可以轻松地将其他数据格式转换为GMT可识别的格式。&lt;/p&gt;
&lt;p&gt;对于Ubuntu/Debian:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo apt-get install libnetcdf-dev libgdal1-dev
&lt;/pre&gt;
&lt;p&gt;对于RHEL/CentOS/Fedora&lt;a class="footnote-reference" href="#id9" id="id7"&gt;[†]&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install netcdf netcdf-devel gdal gdal-devel
&lt;/pre&gt;
&lt;table class="docutils footnote" frame="void" id="id8" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label"&gt;&lt;/col&gt;&lt;col&gt;&lt;/col&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id6"&gt;[*]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;GMT4可以使用netCDF3或netCDF4，但新版本的GMT正在逐渐放弃对netCDF3的支持，因而建议&lt;strong&gt;使用netCDF4&lt;/strong&gt;，且建议&lt;strong&gt;不要自行编译netCDF4&lt;/strong&gt;。&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="id9" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label"&gt;&lt;/col&gt;&lt;col&gt;&lt;/col&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id7"&gt;[†]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;CentOS和RHEL的官方源中没有netCDF，需要首先添加EPEL源再安装netCDF。&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;安装GMT&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;编译GMT源码&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;tar -jxvf gmt-4.5.13-src.tar.bz2
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;gmt-4.5.13
&lt;span class="nv"&gt;$ &lt;/span&gt;./configure --prefix&lt;span class="o"&gt;=&lt;/span&gt;/opt/GMT-4.5.13
&lt;span class="nv"&gt;$ &lt;/span&gt;make
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo make install-all
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;安装海岸线数据&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;tar -zxvf gshhg-gmt-2.3.4.tar.gz
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo mkdir /opt/GMT-4.5.13/share/coast
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo cp -r gshhg-gmt-2.3.4/* /opt/GMT-4.5.13/share/coast/
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id22"&gt;修改环境变量&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;向&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;中加入GMT4的环境变量，并使环境变量生效：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export GMT4HOME=/opt/GMT-4.5.13'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export PATH=${GMT4HOME}/bin:$PATH'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${GMT4HOME}/lib64'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;exec&lt;/span&gt; &lt;span class="nv"&gt;$SHELL&lt;/span&gt; -l
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;第一个命令向&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;中添加环境变量&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT4HOME&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;第二个命令修改&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;，将GMT4的bin目录加入到&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PATH&lt;/span&gt;&lt;/tt&gt;中；&lt;/li&gt;
&lt;li&gt;第三个命令将GMT4的lib目录加入到动态链接库路径中，若为32位系统，则为&lt;tt class="docutils literal"&gt;lib&lt;/tt&gt;；64位系统则为&lt;tt class="docutils literal"&gt;lib64&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;第四个命令是重新载入bash，相当于&lt;tt class="docutils literal"&gt;source &lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-11-07：针对GMT 4.5.11发布初稿；&lt;/li&gt;
&lt;li&gt;2014-03-02：针对GMT 4.5.12进行更新；&lt;/li&gt;
&lt;li&gt;2014-03-08：&lt;tt class="docutils literal"&gt;make install&lt;/tt&gt;-&amp;gt;“make install-all“；&lt;/li&gt;
&lt;li&gt;2014-07-10：更新gshhg为2.3.1版；GMT4不依赖&lt;tt class="docutils literal"&gt;gdal&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;2014-09-14：更新gshhg为2.3.2版；&lt;/li&gt;
&lt;li&gt;2014-09-26：Ubuntu下&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;libxaw-dev&lt;/span&gt;&lt;/tt&gt;应为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;libxaw7-dev&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;2014-10-14：修正了若干细节；&lt;/li&gt;
&lt;li&gt;2014-11-04：修改环境变量&lt;tt class="docutils literal"&gt;LD_LIBRARY_PATH&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;2015-01-01：更新至GMT4.5.13；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="安装"></category><category term="GMT4"></category><category term="编译"></category></entry><entry><title>GMT 5.1.2在Linux下的安装</title><link href="http://seisman.info/install-gmt5-under-linux.html" rel="alternate"></link><updated>2015-05-05T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-06:install-gmt5-under-linux.html</id><summary type="html">
&lt;p&gt;本文介绍如何在Linux下编译安装GMT5。对于想要自己编译安装GMT5的读者而言，我默认读者下载并想要安装的是最新的GMT5版本，因而本文会随着GMT5新版本的发布而不断更新。&lt;/p&gt;
&lt;p&gt;若新版本的安装方式与旧版本的安装方式有区别，则本文只介绍新版本的安装方式（也许会提几句与旧版本的区别）。执意要安装旧版本GMT5的读者，需要自己解决所遇到的问题。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 5.1.2 需要下载三个文件：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;GMT源码： &lt;a class="reference external" href="http://gmt.soest.hawaii.edu/files/download?name=gmt-5.1.2-src.tar.gz"&gt;http://gmt.soest.hawaii.edu/files/download?name=gmt-5.1.2-src.tar.gz&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;全球海岸线数据GSHHG： &lt;a class="reference external" href="http://gmt.soest.hawaii.edu/files/download?name=gshhg-gmt-2.3.4.tar.gz"&gt;http://gmt.soest.hawaii.edu/files/download?name=gshhg-gmt-2.3.4.tar.gz&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;全球数字图表DCW： &lt;a class="reference external" href="http://gmt.soest.hawaii.edu/files/download?name=dcw-gmt-1.1.1.tar.gz"&gt;http://gmt.soest.hawaii.edu/files/download?name=dcw-gmt-1.1.1.tar.gz&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;解决依赖关系&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;基础依赖包&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT编译过程需要C编译器，以及一些系统级别的库文件。&lt;/p&gt;
&lt;p&gt;对于Ubuntu/Debian:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo apt-get install g++ libxt-dev libxaw7-dev libxmu-dev libSM-dev
&lt;/pre&gt;
&lt;p&gt;对于CentOS/&lt;span class="caps"&gt;RHEL&lt;/span&gt;/Fedora:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install gcc-c++ libXt-devel libXaw-devel libXmu-devel libSM-devel
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;软件依赖包&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT5的依赖包，相对来说要复杂很多。&lt;/p&gt;
&lt;p&gt;必须的包包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;看ps文件需要&lt;tt class="docutils literal"&gt;ghostscript&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;编译需要&lt;tt class="docutils literal"&gt;cmake&lt;/tt&gt;（&amp;gt;=2.8.5）；&lt;/li&gt;
&lt;li&gt;网格文件需要&lt;tt class="docutils literal"&gt;netCDF&lt;/tt&gt;（&amp;gt;=4.0,且需要支持netCDF-4/&lt;span class="caps"&gt;HDF5&lt;/span&gt;）。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其他可有可无的依赖包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Perl兼容正则表达式库&lt;a class="reference external" href="http://www.pcre.org/"&gt;&lt;span class="caps"&gt;PCRE&lt;/span&gt;&lt;/a&gt;；&lt;/li&gt;
&lt;li&gt;地理空间数据抽象库&lt;a class="reference external" href="http://www.gdal.org/"&gt;&lt;span class="caps"&gt;GDAL&lt;/span&gt;&lt;/a&gt;；&lt;/li&gt;
&lt;li&gt;Fourier变换库&lt;a class="reference external" href="http://www.fftw.org/"&gt;&lt;span class="caps"&gt;FFTW&lt;/span&gt;&lt;/a&gt; ；&lt;/li&gt;
&lt;li&gt;如果想要自行编译文档的话还需要&lt;a class="reference external" href="http://sphinx-doc.org/"&gt;Sphinx&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于Ubuntu/Debian:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo apt-get install ghostscript build-essential cmake libnetcdf-dev libgdal1-dev
&lt;/pre&gt;
&lt;p&gt;对于RHEL/CentOS/Fedora:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
# 安装必须依赖包
sudo yum install ghostscript cmake netcdf netcdf-devel gdal gdal-devel
# 安装非必须依赖包
sudo yum install pcre-devel fftw-devel sphinx
&lt;/pre&gt;
&lt;p&gt;一些需要注意的地方:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;CentOS &lt;strong&gt;6.5&lt;/strong&gt;官方源中cmake的版本为2.6.4，版本过低，无法满足要求；&lt;/li&gt;
&lt;li&gt;CentOS &lt;strong&gt;6.6&lt;/strong&gt;的官方源中cmake的版本升级至2.8.12，可以满足要求；&lt;/li&gt;
&lt;li&gt;若已安装cmake，可以通过&lt;tt class="docutils literal"&gt;cmake &lt;span class="pre"&gt;--version&lt;/span&gt;&lt;/tt&gt;检查cmake版本；&lt;/li&gt;
&lt;li&gt;使用CentOS 6.5的用户可以&lt;tt class="docutils literal"&gt;yum update&lt;/tt&gt;升级至6.6，即可使用较高版本的cmake；&lt;/li&gt;
&lt;li&gt;若不愿意升级整个系统，则需要先安装EPEL源，再安装EPEL源中的&lt;tt class="docutils literal"&gt;cmake28&lt;/tt&gt;，并且在接下来的编译过程中要将&lt;tt class="docutils literal"&gt;cmake&lt;/tt&gt;命令改成&lt;tt class="docutils literal"&gt;cmake28&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;CentOS 7官方源中cmake版本为2.8.11，可以直接安装使用；&lt;/li&gt;
&lt;li&gt;CentOS官方源中不带有netCDF，需要先安装EPEL源。需要安装的包包括&lt;tt class="docutils literal"&gt;netcdf&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;netcdf-devel&lt;/span&gt;&lt;/tt&gt;，其他包（尤其是hdf5包）会根据依赖关系自动安装。&lt;/li&gt;
&lt;li&gt;GDAL包是非必须的，但是在数据格式转换时非常有用，建议安装。同样，CentOS需要先安装EPEL源；&lt;/li&gt;
&lt;li&gt;PCRE以及FFTW等其他非必须包，如有需要，可以自行搜索安装；&lt;/li&gt;
&lt;li&gt;其他发行版很久不用了，不清楚细节，读者可以在使用过程中补充。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;安装GMT&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;解决了依赖关系之后，就可以安装了。这里假定刚才下载的三个压缩文件都位于目录&lt;tt class="docutils literal"&gt;/home/seisman/Desktop/gmt&lt;/tt&gt;中：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;pwd&lt;/span&gt;
/home/seisman/Desktop/gmt
&lt;span class="nv"&gt;$ &lt;/span&gt;ls
dcw-gmt-1.1.1.tar.gz gmt-5.1.2-src.tar.gz gshhg-gmt-2.3.4.tar.gz
&lt;span class="nv"&gt;$ &lt;/span&gt;tar -zxvf gmt-5.1.2-src.tar.gz
&lt;span class="nv"&gt;$ &lt;/span&gt;tar -zxvf dcw-gmt-1.1.1.tar.gz
&lt;span class="nv"&gt;$ &lt;/span&gt;tar -zxvf gshhg-gmt-2.3.4.tar.gz
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;gmt-5.1.2
&lt;span class="nv"&gt;$ &lt;/span&gt;cp cmake/ConfigUserTemplate.cmake cmake/ConfigUser.cmake
&lt;span class="nv"&gt;$ &lt;/span&gt;vi cmake/ConfigUser.cmake &lt;span class="c"&gt;# 修改Config文件&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;修改&lt;tt class="docutils literal"&gt;ConfigUser.cmake&lt;/tt&gt;以对安装的细节进行自定义。一个基本的示例如下，找到相关行，并去掉该行最前面的“#”，再根据自身情况修改:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
set (CMAKE_INSTALL_PREFIX "/opt/GMT-5.1.2")
set (GMT_INSTALL_MODULE_LINKS FALSE)
set (GSHHG_ROOT "/home/seisman/Desktop/gmt/gshhg-gmt-2.3.4")
set (COPY_GSHHG TRUE)
set (DCW_ROOT "/home/seisman/Desktop/gmt/dcw-gmt-1.1.1")
set (COPY_DCW TRUE)
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;CMAKE_INSTALL_PREFIX&lt;/tt&gt;设置GMT的安装路径；&lt;/li&gt;
&lt;li&gt;设置&lt;tt class="docutils literal"&gt;GMT_INSTALL_MODULE_LINKS&lt;/tt&gt;为FALSE，这样调用GMT模块时必须使用&lt;tt class="docutils literal"&gt;gmt modulename options&lt;/tt&gt;的形式，也是GMT5推荐的使用方法；若该值为TRUE，则会在GMT的bin目录下建立多个指向&lt;tt class="docutils literal"&gt;gmt&lt;/tt&gt;的形如&lt;tt class="docutils literal"&gt;pscoast&lt;/tt&gt;的软链接；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;GSHHG_ROOT&lt;/tt&gt;为GSHHG数据的位置，需要对下载下来的压缩文件进行解压，并给出文件夹的&lt;strong&gt;绝对路径&lt;/strong&gt;；&lt;tt class="docutils literal"&gt;COPY_GSHHG&lt;/tt&gt;为TRUE会将GSHHG数据复制到&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt;/share/coast&lt;/tt&gt;下；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;DCW_ROOT&lt;/tt&gt;设置DCW数据的位置，需给出DCW数据所在文件夹的绝对路径，&lt;tt class="docutils literal"&gt;COPY_DCW&lt;/tt&gt;将数据复制到&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt;/share/dcw&lt;/tt&gt;下；&lt;/li&gt;
&lt;li&gt;cmake似乎不能识别&lt;tt class="docutils literal"&gt;~&lt;/tt&gt;，因而上面提到的所有路径中都不能用&lt;tt class="docutils literal"&gt;~&lt;/tt&gt;代替&lt;tt class="docutils literal"&gt;/home/xxx&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;: 若系统中存在多个GMT的版本，按照上面的做法会存在多个GSHHG和DCW数据的副本。可以将这些数据放置在系统中固定的位置（比如我把这些数据都放在&lt;tt class="docutils literal"&gt;/home/seisman/Datas&lt;/tt&gt;目录下），然后有两种处理方式：其一，设置COPY_GSHHG为FALSE，则安装时不会将GSHHG数据复制到GMT目录下，而GMT命令运行时会到GSHHG_ROOT指定的目录中寻找数据；其二，使用默认的GSHHG_ROOT以及COPY_GSHHG，在安装完成之后，到GMT/share目录下设置一个target为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/home/seisman/Datas/gshhg-gmt-2.3.4&lt;/span&gt;&lt;/tt&gt;，link name为coast的软链接即可。对于DCW数据，同理。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS2&lt;/span&gt;：上面的PS要是没看懂的话就直接忽略吧。&lt;/p&gt;
&lt;p&gt;修改完毕后，进行编译:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ mkdir build
$ cd build/
$ cmake ..
&lt;/pre&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;cmake ..&lt;/tt&gt;会检查GMT对软件的依赖关系，我的检查结果如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
*  Options:
*  Found GSHHG database       : /home/seisman/Desktop/gmt/gshhg-gmt-2.3.4 (2.3.4)
*  Found DCW-GMT database     : /home/seisman/Desktop/gmt/dcw-gmt-1.1.1
*  NetCDF library             : /usr/lib64/libnetcdf.so
*  NetCDF include dir         : /usr/include
*  GDAL library               : /usr/lib64/libgdal.so
*  GDAL include dir           : /usr/include/gdal
*  FFTW library               : /usr/lib64/libfftw3f.so
*  FFTW include dir           : /usr/include
*  Accelerate Framework       :
*  Regex support              : PCRE (/usr/lib64/libpcre.so)
*  ZLIB library               : /usr/lib64/libz.so
*  ZLIB include dir           : /usr/include
*  License restriction        : no
*  Triangulation method       : Shewchuk
*  Build mode                 : shared
*  Build GMT core             : always [libgmt.so]
*  Build PSL library          : always [libpsl.so]
*  Build GMT supplements      : yes [supplements.so]
*  Build proto supplements    : none
*
*  Locations:
*  Installing GMT in          : /opt/GMT-5.1.2
*  GMT_DATADIR                : /opt/GMT-5.1.2/share
*  GMT_DOCDIR                 : /opt/GMT-5.1.2/share/doc
*  GMT_MANDIR                 : /opt/GMT-5.1.2/share/man
-- Configuring done
-- Generating done
&lt;/pre&gt;
&lt;p&gt;检查完毕，开始编译和安装:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ make
$ sudo make install
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;自行编译文档&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;如果系统中安装了sphinx和LaTeX，则可以自行编译文档。一般情况下，不建议自行编译文档，官方提供的文档已经足够:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ make docs_man
$ make docs_html
$ make docs_pdf
$ sudo make install
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;修改环境变量&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;修改环境变量并使其生效&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export GMT5HOME=/opt/GMT-5.1.2'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export PATH=${GMT5HOME}/bin:$PATH'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${GMT5HOME}/lib64'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;exec&lt;/span&gt; &lt;span class="nv"&gt;$SHELL&lt;/span&gt; -l
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;说明&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;第一个命令向&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;中添加环境变量&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT5HOME&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;第二个命令修改&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;，将GMT5的bin目录加入到&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PATH&lt;/span&gt;&lt;/tt&gt;中；&lt;/li&gt;
&lt;li&gt;第三个命令将GMT5的lib目录加入到动态链接库路径中，若为32位系统，则为&lt;tt class="docutils literal"&gt;lib&lt;/tt&gt;；64位系统则为&lt;tt class="docutils literal"&gt;lib64&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;第四个命令是重新载入bash，相当于&lt;tt class="docutils literal"&gt;source &lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;安装测试&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在终端键入&lt;tt class="docutils literal"&gt;gmt&lt;/tt&gt;，若出现如下输出，则安装成功:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ gmt

GMT - The Generic Mapping Tools, Version 5.1.2 (r14256) [64-bit]
(c) 1991-2015 Paul Wessel, Walter H. F. Smith, R. Scharroo, J. Luis, and F. Wobbe

Supported in part by the US National Science Foundation (http://www.nsf.gov/)
and volunteers from around the world (see http://gmt.soest.hawaii.edu/).

This program comes with NO WARRANTY, to the extent permitted by law.
You may redistribute copies of this program under the terms of the
GNU Lesser General Public License (http://www.gnu.org/licenses/lgpl.html).
For more information about these matters, see the file named LICENSE.TXT.

usage: gmt [options]
       gmt &amp;lt;module name&amp;gt; [&amp;lt;module options&amp;gt;]

options:
  --help            List and description of GMT modules.
  --version         Print version and exit.
  --show-datadir    Show data directory and exit.
  --show-bindir     Show directory of executables and exit.

if &amp;lt;module options&amp;gt; is '=' we call exit (0) if module exist and non-zero otherwise.
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;参考来源&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://gmtrac.soest.hawaii.edu/projects/gmt/wiki/BuildingGMT"&gt;http://gmtrac.soest.hawaii.edu/projects/gmt/wiki/BuildingGMT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/install-gmt4-under-linux.html"&gt;&lt;span class="caps"&gt;GMT4&lt;/span&gt;.5.13在Linux下的安装&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-11-06：初稿；&lt;/li&gt;
&lt;li&gt;2014-02-22：cmake版本需要2.8以上；&lt;/li&gt;
&lt;li&gt;2014-03-02：更新至GMT 5.1.1；&lt;/li&gt;
&lt;li&gt;2014-09-14：更新GSHHG至2.3.2；&lt;/li&gt;
&lt;li&gt;2014-09-26：Ubuntu下&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;libxaw-dev&lt;/span&gt;&lt;/tt&gt;应为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;libxaw7-dev&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;2014-11-04：修改环境变量&lt;tt class="docutils literal"&gt;LD_LIBRARY_PATH&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;2014-11-29：CentOS 6.6中的cmake版本为2.8.12；&lt;/li&gt;
&lt;li&gt;2015-02-01：更新GSHHG至2.3.4；&lt;/li&gt;
&lt;li&gt;2015-03-14：路径中不能用波浪号代替家目录；&lt;/li&gt;
&lt;li&gt;2015-05-05：更新至GMT 5.1.2；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="编译"></category><category term="GMT5"></category><category term="安装"></category></entry><entry><title>EasyBMP：BMP图像处理函数库</title><link href="http://seisman.info/introduction-to-easybmp.html" rel="alternate"></link><updated>2013-11-04T00:45:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-04:introduction-to-easybmp.html</id><summary type="html">&lt;p&gt;EasyBMP是一个用于处理BMP（Windows&amp;nbsp;Bitmap）格式图像的C++库。&lt;/p&gt;
&lt;p&gt;主页：&lt;a class="reference external" href="http://easybmp.sourceforge.net/"&gt;http://easybmp.sourceforge.net/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;语言：C++&lt;/p&gt;
&lt;p&gt;开源协议：Revised/Modified &lt;span class="caps"&gt;BSD&lt;/span&gt;&amp;nbsp;License.&lt;/p&gt;
&lt;p&gt;相关项目：EasyBMPtoAVI&amp;#8212;将BMP转换成AVI动画的工具。&lt;/p&gt;
&lt;p&gt;特点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;简单，易于使用；就算是不懂C++，用起来也基本没问题；&lt;/li&gt;
&lt;li&gt;仅支持1、4、8、16、24、32位BMP图像格式；&lt;/li&gt;
&lt;li&gt;跨平台，支持各平台主流编译器；&lt;/li&gt;
&lt;li&gt;不依赖于其他库，完全自给自足；&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="C"></category><category term="图像"></category></entry><entry><title>Perl多版本共存之plenv</title><link href="http://seisman.info/perl-plenv.html" rel="alternate"></link><updated>2013-11-03T01:24:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-03:perl-plenv.html</id><summary type="html">
&lt;p&gt;前面写了两篇相关的文章。&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://seisman.info/perlbrew-for-multiple-versions-of-perl.html"&gt;《Perl多版本共存之Perlbrew》&lt;/a&gt;中介绍了如何用Perlbrew实现多个Perl版本的共存。&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://seisman.info/python-pyenv.html"&gt;《Python多版本共存之pyenv》&lt;/a&gt;中介绍了如何使用pyenv实现多个Python版本的共存。&lt;/p&gt;
&lt;p&gt;plenv和PerlBrew是相同功能的工具，不过，感觉plenv比perlbrew要更方便好用。&lt;/p&gt;
&lt;p&gt;官方网站：&lt;a class="reference external" href="https://github.com/tokuhirom/plenv"&gt;https://github.com/tokuhirom/plenv&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="plenv"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;安装plenv&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;git clone git://github.com/tokuhirom/plenv.git ~/.plenv
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export PATH="$HOME/.plenv/bin:$PATH"'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'eval "$(plenv init -)"'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;exec&lt;/span&gt; &lt;span class="nv"&gt;$SHELL&lt;/span&gt; -l
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="plenvbuild"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;安装plenv的build插件&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;git clone git://github.com/tokuhirom/Perl-Build.git ~/.plenv/plugins/perl-build/
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;查看所有可以安装的版本&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;plenv install --list
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Perl的版本格式为&lt;tt class="docutils literal"&gt;5.xx.x&lt;/tt&gt;，其中&lt;tt class="docutils literal"&gt;xx&lt;/tt&gt;为偶数的版本为稳定版。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;安装指定版本&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;plenv install 5.18.1
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;更新数据库&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;plenv rehash
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="perl"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;修改全局Perl版本&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;plenv versions
&lt;span class="nv"&gt;$ &lt;/span&gt;plenv global 5.18.1
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="cpanm"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;安装cpanm&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Perl的cpan工具可以方便的安装和管理众多模块。cpanm与cpan类似，其功能更强大，其可以根据当前的Perl版本，将模块安装到对应的路径中，而不会对系统自带的Perl模块以及其他Perl版本的模块进行任何修改。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;plenv install-cpanm
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
</summary><category term="安装"></category><category term="版本"></category><category term="Perl"></category></entry><entry><title>PKP射线路径</title><link href="http://seisman.info/pkp-ray-path.html" rel="alternate"></link><updated>2013-11-02T00:09:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-02:pkp-ray-path.html</id><summary type="html">&lt;div class="figure align-center"&gt;
&lt;img alt="pkp" src="/images/2013110201.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;利用TauP直接生成GMT脚本:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_path -ph PKP,PKIKP -mod prem -h 100 -deg 150 --gmt --mapwidth 6
&lt;/pre&gt;
&lt;p&gt;修改GMT脚本&lt;/p&gt;
&lt;p&gt;注：脚本太长，故删除部分数据贴在这里：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/sh&lt;/span&gt;
gmtset HEADER_FONT_SIZE 30p

&lt;span class="c"&gt;# draw surface and label distances.&lt;/span&gt;
psbasemap -K -P -R0/360/0/6371.0 -JP6.0i -B:.&lt;span class="s2"&gt;&amp;quot;Ray Path of PKP&amp;quot;&lt;/span&gt;: &amp;gt; taup_path.ps
&lt;span class="c"&gt;# draw circles for branches, note these are scaled for a&lt;/span&gt;
&lt;span class="c"&gt;# map using -JP6.0i&lt;/span&gt;
psxy -K -O -P -R -JP -Sc -A &amp;gt;&amp;gt; taup_path.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;ENDLAYERS&lt;/span&gt;
&lt;span class="s"&gt;0.0 0.0 6.0i&lt;/span&gt;
&lt;span class="s"&gt;0.0 0.0 6.0i&lt;/span&gt;
&lt;span class="s"&gt;0.0 0.0 3.2773504i&lt;/span&gt;
&lt;span class="s"&gt;0.0 0.0 1.1503688i&lt;/span&gt;
&lt;span class="s"&gt;ENDLAYERS&lt;/span&gt;

pstext -K -O -R -JP &amp;gt;&amp;gt; taup_path.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; END&lt;/span&gt;
&lt;span class="s"&gt;0.0 0.0 12 0 0 CM Inner Core&lt;/span&gt;
&lt;span class="s"&gt;180.0 1500.0 12 0 0 RM Outer Core&lt;/span&gt;
&lt;span class="s"&gt;180.0 5000.0 12 0 0 CM Mantle&lt;/span&gt;
&lt;span class="s"&gt;70.0 2500.0 12 -15 0 CM PKPab&lt;/span&gt;
&lt;span class="s"&gt;70.0 1600.0 12 -15 0 CM PKPbc&lt;/span&gt;
&lt;span class="s"&gt;70.0 800.0 12 -15 0 CM PKPdf&lt;/span&gt;
&lt;span class="s"&gt;END&lt;/span&gt;

&lt;span class="c"&gt;# draw paths&lt;/span&gt;
psxy -P -R -K -O -JP -m -A &amp;gt;&amp;gt; taup_path.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;END&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt; PKP at 1177.26 seconds at 150.00 degrees for a 100.0 km deep source in the prem model with rayParam 2.359 s/deg.&lt;/span&gt;
&lt;span class="s"&gt;0.00 6271.0&lt;/span&gt;
&lt;span class="s"&gt;0.01 6264.0&lt;/span&gt;
&lt;span class="s"&gt;*****************省略了一堆数据******************&lt;/span&gt;
&lt;span class="s"&gt;150.04 6370.1&lt;/span&gt;
&lt;span class="s"&gt;150.04 6371.0&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt; PKP at 1183.17 seconds at 150.00 degrees for a 100.0 km deep source in the prem model with rayParam 4.083 s/deg.&lt;/span&gt;
&lt;span class="s"&gt;0.00 6271.0&lt;/span&gt;
&lt;span class="s"&gt;0.02 6264.0&lt;/span&gt;
&lt;span class="s"&gt;******************省略一堆数据****************&lt;/span&gt;
&lt;span class="s"&gt;150.00 6370.1&lt;/span&gt;
&lt;span class="s"&gt;150.00 6371.0&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt; PKIKP at 1172.10 seconds at 150.00 degrees for a 100.0 km deep source in the prem model with rayParam 1.577 s/deg.&lt;/span&gt;
&lt;span class="s"&gt;0.00 6271.0&lt;/span&gt;
&lt;span class="s"&gt;0.01 6264.0&lt;/span&gt;
&lt;span class="s"&gt;**************省略一堆数据*************&lt;/span&gt;
&lt;span class="s"&gt;150.00 6370.1&lt;/span&gt;
&lt;span class="s"&gt;150.00 6371.0&lt;/span&gt;
&lt;span class="s"&gt;END&lt;/span&gt;
psxy -P -R -O -JP -m -A &amp;gt;&amp;gt; taup_path.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;END&lt;/span&gt;
&lt;span class="s"&gt;END&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="GMT脚本"></category><category term="TauP"></category><category term="射线"></category><category term="震相"></category></entry><entry><title>PKP震相走时曲线</title><link href="http://seisman.info/pkp-travel-time-curve.html" rel="alternate"></link><updated>2013-11-01T00:37:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-11-01:pkp-travel-time-curve.html</id><summary type="html">&lt;div class="figure align-center"&gt;
&lt;img alt="pkp" src="/images/2013110101.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;PKP是内核研究中常用的震相。PKP震相一般分为三个，PKPab、PKPbc和PKPdf。其中PKPab为穿过外核中上部的射线，PKPbc为穿过外核底部的射线，PKPdf为穿过内核的射线（即PKIKP）。（一个疑问：为什么没有E呢？）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;成图过程：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;首先利用taup_curve直接生成GMT脚本:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
taup_curve -ph PKP,PKIKP -mod prem -h 100 -gmt
&lt;/pre&gt;
&lt;p&gt;在生成的GMT脚本上做稍许修改，结果如下&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
gmtset CHAR_ENCODING ISOLatin1+
gmtset HEADER_FONT_SIZE 30p

pstext -JX6.0i -P -R110/180/1050.0/1350.0 -B10:&lt;span class="s2"&gt;&amp;quot;Distance(\232)&amp;quot;&lt;/span&gt;:/50:&lt;span class="s2"&gt;&amp;quot;Time(s)&amp;quot;&lt;/span&gt;:WSen:.&lt;span class="s1"&gt;&amp;#39;Travel time curve of PKP&amp;#39;&lt;/span&gt;: -K -Xc &amp;gt; taup_curve.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;END&lt;/span&gt;
&lt;span class="s"&gt;177.69 1303.39 15 0 0 LM A&lt;/span&gt;
&lt;span class="s"&gt;144.83 1163.03 15 0 0 RB B&lt;/span&gt;
&lt;span class="s"&gt;152.58 1182.97 15 0 0 LB C&lt;/span&gt;
&lt;span class="s"&gt;116.02 1109.21 15 0 0 RB D&lt;/span&gt;
&lt;span class="s"&gt;179.00 1195.17 15 0 0 RT F&lt;/span&gt;
&lt;span class="s"&gt;END&lt;/span&gt;

psxy -JX -R -m -O &amp;gt;&amp;gt; taup_curve.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;END&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt; PKP for a source depth of 100.0 kilometers in the prem model&lt;/span&gt;
&lt;span class="s"&gt;177.69 1303.39&lt;/span&gt;
&lt;span class="s"&gt;173.96 1286.87&lt;/span&gt;
&lt;span class="s"&gt;172.49 1280.37&lt;/span&gt;
&lt;span class="s"&gt;170.49 1271.52&lt;/span&gt;
&lt;span class="s"&gt;168.78 1263.98&lt;/span&gt;
&lt;span class="s"&gt;167.41 1257.94&lt;/span&gt;
&lt;span class="s"&gt;165.25 1248.42&lt;/span&gt;
&lt;span class="s"&gt;163.86 1242.35&lt;/span&gt;
&lt;span class="s"&gt;162.67 1237.13&lt;/span&gt;
&lt;span class="s"&gt;160.67 1228.44&lt;/span&gt;
&lt;span class="s"&gt;159.04 1221.35&lt;/span&gt;
&lt;span class="s"&gt;157.65 1215.35&lt;/span&gt;
&lt;span class="s"&gt;156.17 1209.01&lt;/span&gt;
&lt;span class="s"&gt;154.89 1203.59&lt;/span&gt;
&lt;span class="s"&gt;152.79 1194.73&lt;/span&gt;
&lt;span class="s"&gt;151.27 1188.38&lt;/span&gt;
&lt;span class="s"&gt;150.59 1185.57&lt;/span&gt;
&lt;span class="s"&gt;149.96 1183.01&lt;/span&gt;
&lt;span class="s"&gt;148.86 1178.56&lt;/span&gt;
&lt;span class="s"&gt;147.94 1174.87&lt;/span&gt;
&lt;span class="s"&gt;146.89 1170.75&lt;/span&gt;
&lt;span class="s"&gt;146.70 1170.00&lt;/span&gt;
&lt;span class="s"&gt;145.77 1166.45&lt;/span&gt;
&lt;span class="s"&gt;145.28 1164.66&lt;/span&gt;
&lt;span class="s"&gt;144.90 1163.30&lt;/span&gt;
&lt;span class="s"&gt;144.85 1163.10&lt;/span&gt;
&lt;span class="s"&gt;144.83 1163.03&lt;/span&gt;
&lt;span class="s"&gt;144.83 1163.06&lt;/span&gt;
&lt;span class="s"&gt;145.04 1163.75&lt;/span&gt;
&lt;span class="s"&gt;145.25 1164.43&lt;/span&gt;
&lt;span class="s"&gt;145.66 1165.68&lt;/span&gt;
&lt;span class="s"&gt;146.05 1166.85&lt;/span&gt;
&lt;span class="s"&gt;146.26 1167.48&lt;/span&gt;
&lt;span class="s"&gt;146.43 1167.98&lt;/span&gt;
&lt;span class="s"&gt;146.77 1168.93&lt;/span&gt;
&lt;span class="s"&gt;147.11 1169.89&lt;/span&gt;
&lt;span class="s"&gt;147.75 1171.62&lt;/span&gt;
&lt;span class="s"&gt;148.36 1173.23&lt;/span&gt;
&lt;span class="s"&gt;149.04 1174.93&lt;/span&gt;
&lt;span class="s"&gt;149.68 1176.51&lt;/span&gt;
&lt;span class="s"&gt;149.79 1176.76&lt;/span&gt;
&lt;span class="s"&gt;150.56 1178.56&lt;/span&gt;
&lt;span class="s"&gt;151.31 1180.27&lt;/span&gt;
&lt;span class="s"&gt;152.58 1182.97&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt; PKIKP for a source depth of 100.0 kilometers in the prem model&lt;/span&gt;
&lt;span class="s"&gt;116.02 1109.21&lt;/span&gt;
&lt;span class="s"&gt;121.32 1119.47&lt;/span&gt;
&lt;span class="s"&gt;123.31 1123.31&lt;/span&gt;
&lt;span class="s"&gt;124.76 1126.09&lt;/span&gt;
&lt;span class="s"&gt;125.93 1128.34&lt;/span&gt;
&lt;span class="s"&gt;127.78 1131.90&lt;/span&gt;
&lt;span class="s"&gt;129.25 1134.71&lt;/span&gt;
&lt;span class="s"&gt;130.96 1137.97&lt;/span&gt;
&lt;span class="s"&gt;132.35 1140.63&lt;/span&gt;
&lt;span class="s"&gt;134.67 1145.00&lt;/span&gt;
&lt;span class="s"&gt;136.46 1148.36&lt;/span&gt;
&lt;span class="s"&gt;138.04 1151.31&lt;/span&gt;
&lt;span class="s"&gt;139.38 1153.76&lt;/span&gt;
&lt;span class="s"&gt;140.53 1155.87&lt;/span&gt;
&lt;span class="s"&gt;141.55 1157.72&lt;/span&gt;
&lt;span class="s"&gt;143.30 1160.83&lt;/span&gt;
&lt;span class="s"&gt;144.77 1163.41&lt;/span&gt;
&lt;span class="s"&gt;145.97 1165.47&lt;/span&gt;
&lt;span class="s"&gt;147.02 1167.25&lt;/span&gt;
&lt;span class="s"&gt;147.88 1168.68&lt;/span&gt;
&lt;span class="s"&gt;148.68 1169.98&lt;/span&gt;
&lt;span class="s"&gt;149.43 1171.20&lt;/span&gt;
&lt;span class="s"&gt;150.14 1172.32&lt;/span&gt;
&lt;span class="s"&gt;151.34 1174.19&lt;/span&gt;
&lt;span class="s"&gt;152.43 1175.83&lt;/span&gt;
&lt;span class="s"&gt;153.64 1177.59&lt;/span&gt;
&lt;span class="s"&gt;154.10 1178.24&lt;/span&gt;
&lt;span class="s"&gt;155.44 1180.09&lt;/span&gt;
&lt;span class="s"&gt;156.67 1181.72&lt;/span&gt;
&lt;span class="s"&gt;157.49 1182.77&lt;/span&gt;
&lt;span class="s"&gt;159.02 1184.62&lt;/span&gt;
&lt;span class="s"&gt;160.44 1186.24&lt;/span&gt;
&lt;span class="s"&gt;160.60 1186.41&lt;/span&gt;
&lt;span class="s"&gt;161.94 1187.83&lt;/span&gt;
&lt;span class="s"&gt;163.21 1189.09&lt;/span&gt;
&lt;span class="s"&gt;163.54 1189.40&lt;/span&gt;
&lt;span class="s"&gt;164.04 1189.86&lt;/span&gt;
&lt;span class="s"&gt;165.22 1190.90&lt;/span&gt;
&lt;span class="s"&gt;166.38 1191.83&lt;/span&gt;
&lt;span class="s"&gt;166.95 1192.27&lt;/span&gt;
&lt;span class="s"&gt;167.49 1192.67&lt;/span&gt;
&lt;span class="s"&gt;168.33 1193.25&lt;/span&gt;
&lt;span class="s"&gt;169.16 1193.78&lt;/span&gt;
&lt;span class="s"&gt;170.86 1194.76&lt;/span&gt;
&lt;span class="s"&gt;171.72 1195.19&lt;/span&gt;
&lt;span class="s"&gt;171.90 1195.28&lt;/span&gt;
&lt;span class="s"&gt;173.07 1195.78&lt;/span&gt;
&lt;span class="s"&gt;174.20 1196.20&lt;/span&gt;
&lt;span class="s"&gt;174.61 1196.33&lt;/span&gt;
&lt;span class="s"&gt;175.97 1196.70&lt;/span&gt;
&lt;span class="s"&gt;177.30 1196.96&lt;/span&gt;
&lt;span class="s"&gt;177.54 1196.99&lt;/span&gt;
&lt;span class="s"&gt;178.77 1197.12&lt;/span&gt;
&lt;span class="s"&gt;180.00 1197.17&lt;/span&gt;
&lt;span class="s"&gt;END&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="TauP"></category><category term="走时"></category><category term="震相"></category></entry><entry><title>PDF合并和分割工具—PDFtk</title><link href="http://seisman.info/introduction-to-pdftk.html" rel="alternate"></link><updated>2013-10-31T00:24:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-31:introduction-to-pdftk.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;PDFtk是什么？我觉得官网的一句话解释得很好。&lt;/p&gt;
&lt;blockquote&gt;
If &lt;span class="caps"&gt;PDF&lt;/span&gt; is electronic paper, then PDFtk is an electronic
staple-remover, hole-punch, binder, secret-decoder-ring, and
X-Ray-glasses. PDFtk is a simple tool for doing everyday things with
&lt;span class="caps"&gt;PDF&lt;/span&gt; documents.&lt;/blockquote&gt;
&lt;p&gt;其官方网站为： &lt;a class="reference external" href="http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit"&gt;http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;PDFtk目前分为三个版本：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;PDFtk Server：命令行工具。支持windows、Linux、Mac。&lt;/li&gt;
&lt;li&gt;PDFtk Free：图形界面基础免费版；仅限windows用户；功能仅限于PDF合并和分割；&lt;/li&gt;
&lt;li&gt;PDFtk Pro：图形界面专业收费版；仅限windows用户，可以对PDF文档进行合并、分割、旋转、加水印、加邮戳、加密。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于Linux用户，唯一的选择是免费的PDFtk Server，其功能与收费PDFtk Pro完全相同，只是没有GUI而已。作者还是很厚道的。&lt;/p&gt;
&lt;p&gt;Linux的各个发行版的官方源中基本都有该软件，直接apt-get或者yum安装即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;功能&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;合并PDF；&lt;/li&gt;
&lt;li&gt;分割PDF页面；&lt;/li&gt;
&lt;li&gt;旋转PDF文档或页面；&lt;/li&gt;
&lt;li&gt;PDF解密；（不是破解）&lt;/li&gt;
&lt;li&gt;PDF加密；&lt;/li&gt;
&lt;li&gt;用X/FDF填写PDF表格；&lt;/li&gt;
&lt;li&gt;从PDF表格中生成PDF Data Stencils；&lt;/li&gt;
&lt;li&gt;加背景水印或前景印章；&lt;/li&gt;
&lt;li&gt;报告PDF Metrics，书签和元数据；&lt;/li&gt;
&lt;li&gt;增加/更新PDF书签或元数据；&lt;/li&gt;
&lt;li&gt;给PDF页面或文档加附件；&lt;/li&gt;
&lt;li&gt;解压PDF附件；&lt;/li&gt;
&lt;li&gt;分解PDF文档为多个单页；&lt;/li&gt;
&lt;li&gt;解压缩和重压缩页面流；&lt;/li&gt;
&lt;li&gt;修复受损的PDF文档；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这功能完全可以与Adobe Acrobat相媲美了，更重要的是PDFtk支持Linux且完全免费。（个人用户免费，若用于商业用途需付费）。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;用法示例&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;具体选项看这里： &lt;a class="reference external" href="http://www.pdflabs.com/docs/pdftk-man-page/"&gt;http://www.pdflabs.com/docs/pdftk-man-page/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下面给出一些常见的例子。例子原文在： &lt;a class="reference external" href="http://www.pdflabs.com/docs/pdftk-cli-examples/"&gt;http://www.pdflabs.com/docs/pdftk-cli-examples/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;扫描一本书，odd.pdf为书的全部奇数页，even.pdf为书的全部偶数页，下面的命令可以将两个pdf合并成页码正常的书:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk A=odd.pdf B=even.pdf shuffle A B output collated.pdf
&lt;/pre&gt;
&lt;p&gt;如果odd.pdf是逆序的:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk A=odd.pdf B=even.pdf shuffle Aend-1 B output collated.pdf
&lt;/pre&gt;
&lt;p&gt;加密PDF:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk secured.pdf input_pw foopass output unsecured.pdf
&lt;/pre&gt;
&lt;p&gt;&lt;span class="caps"&gt;PDF&lt;/span&gt; 128位加密，保留全部权限:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk 1.pdf output 1.128.pdf owner_pw foopass
&lt;/pre&gt;
&lt;p&gt;&lt;span class="caps"&gt;PDF&lt;/span&gt; 128位加密，保留全部权限，打开文档需输入密码"baz":&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk 1.pdf output 1.128.pdf owner_pw foo user_pw baz
&lt;/pre&gt;
&lt;p&gt;&lt;span class="caps"&gt;PDF&lt;/span&gt; 128位加密，打开文档需输入密码"baz"，保留打印之外的其他权限:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk 1.pdf output 1.128.pdf owner_pw foo user_pw baz allow printing
&lt;/pre&gt;
&lt;p&gt;合并in1.pdf和in2.pdf到新PDF中:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk in1.pdf in2.pdf cat output out1.pdf
&lt;/pre&gt;
&lt;p&gt;或（使用句柄）:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk A=in1.pdf B=in2.pdf cat A B output out1.pdf
&lt;/pre&gt;
&lt;p&gt;或（使用通配符）:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk *.pdf cat output combined.pdf
&lt;/pre&gt;
&lt;p&gt;去除in1.pdf中的第13页，并创建out1.pdf:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk in.pdf cat 1-12 14-end output out1.pdf
&lt;/pre&gt;
&lt;p&gt;或&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk A=in1.pdf cat A1-12 A14-end output out1.pdf
&lt;/pre&gt;
&lt;p&gt;对输出进行40位加密，撤销所有权限，设置owner密码为foopass:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk 1.pdf 2.pdf cat output 3.pdf encrypt_40bit owner_pw foopass
&lt;/pre&gt;
&lt;p&gt;合并两个文件，其中一个需要被加密。对输出不加密:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk A=secured.pdf 2.pdf input\_pw A=foopass cat output 3.pdf
&lt;/pre&gt;
&lt;p&gt;解压PDF页面流，然后就可以在文本编辑器中编辑PDF文件:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk doc.pdf output doc.unc.pdf uncompress
&lt;/pre&gt;
&lt;p&gt;压缩PDF:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk mydoc.pdf output mydoc.clear.pdf compress
&lt;/pre&gt;
&lt;p&gt;修复破损的PDF:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk broken.pdf output fixed.pdf
&lt;/pre&gt;
&lt;p&gt;将一个PDF文档分割成一页一个文档:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk in.pdf burst
&lt;/pre&gt;
&lt;p&gt;将一个PDF文档分割成一页一个文档，并加密，允许低质量的打印:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk in.pdf burst owner_pw foopass allow DegradedPrinting
&lt;/pre&gt;
&lt;p&gt;获取PDF问的元数据和书签信息:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk in.pdf dump_data output report.txt
&lt;/pre&gt;
&lt;p&gt;将PDF第一页顺时针旋转90度:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk in.pdf cat 1east 2-end output out.pdf
&lt;/pre&gt;
&lt;p&gt;将整个PDF文档旋转180度:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pdftk in.pdf cat 1-endsouth output out.pdf
&lt;/pre&gt;
&lt;/div&gt;
</summary><category term="用法"></category><category term="PDF"></category></entry><entry><title>GMT进阶之pscoast的clip功能的例子</title><link href="http://seisman.info/gmt-pscoast-clip-example.html" rel="alternate"></link><updated>2013-10-30T00:15:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-30:gmt-pscoast-clip-example.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;问题描述&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;已有etopo数据，其包含了全球地形以及海水深度数据，现绘制全球地图，要求有全球海岸线和地形数据。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;代码1&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M24c

grdraster &lt;span class="m"&gt;8&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -I2m -Gout.grd
makecpt -Cglobe -T-11500/8500/2000 -Z &amp;gt; colors.cpt
grdimage out.grd -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Ccolors.cpt -K &amp;gt; a.ps
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B60/30 -W1/0.5p -N1 -O &amp;gt;&amp;gt; a.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013103001.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;这里可以很明显地看出，海岸线与地形是不重合的。一开始以为是脚本的问题，想想才明白，地形与海岸线不匹配是正常的，其差异是由于大陆架造成的。理论上可以通过修改cpt文件，使得大于0和小于0的地形的颜色对比更强烈一些。不过这不是这篇博文所关注的东西。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;代码2&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M24c

grdraster &lt;span class="m"&gt;1&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -I5m -Gout.grd
makecpt -Cglobe -T-11500/8500/2000 -Z &amp;gt; colors.cpt

pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Gc -K -V &amp;gt; a.ps
grdimage out.grd -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Ccolors.cpt -K -O -V &amp;gt;&amp;gt; a.ps
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Q -K -O -V &amp;gt;&amp;gt; a.ps
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B60/30 -W1/0.5p -N1 -O -V &amp;gt;&amp;gt; a.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013103002.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;这里使用了三个pscoast命令，第一个pscoast将陆地区域clip出来，第二个pscoast关闭clip，第三个pscoast绘制海岸线。效果还不错。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;代码3&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/360/-60/60
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;M24c

grdraster &lt;span class="m"&gt;1&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -I5m -Gout.grd
makecpt -Cglobe -T-11500/8500/2000 -Z &amp;gt; colors.cpt

pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Sc -K -V &amp;gt; a.ps
grdimage out.grd -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Ccolors.cpt -K -O -V &amp;gt;&amp;gt; a.ps
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Q -K -O -V &amp;gt;&amp;gt; a.ps
pscoast -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B60/30 -W1/0.5p -N1 -O -V &amp;gt;&amp;gt; a.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013103003.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;与代码2类似，这里只绘制出了海洋部分的地形。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT脚本"></category><category term="GMT4"></category></entry><entry><title>GMT命令之用pscoast绘图海岸线</title><link href="http://seisman.info/gmt-pscoast.html" rel="alternate"></link><updated>2013-10-28T00:48:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-28:gmt-pscoast.html</id><summary type="html">
&lt;p&gt;pscoast是GMT最常用也是最核心的命令。这篇博文将一步步地指引着用户写出需要的命令。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;确定地图基本信息&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;地图的基本信息包括三个，投影方式（-J）、区域范围（-R）以及地图边框的注释（-B）。&lt;/p&gt;
&lt;p&gt;这三个都是GMT的标准选项，不多说。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;数据选择&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
-Dresolution[+]
&lt;/pre&gt;
&lt;p&gt;pscoast可以绘制海岸线、国界以及河流。既然要画，就一定需要数据。&lt;/p&gt;
&lt;p&gt;默认情况下，这些数据位于&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;${&lt;span class="caps"&gt;GMTHOME&lt;/span&gt;}/share/coast&lt;/span&gt;&lt;/tt&gt;下，包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;binned_border_x.nc：国界、省界数据；&lt;/li&gt;
&lt;li&gt;binned_GSHHS_x.nc：海岸线数据；&lt;/li&gt;
&lt;li&gt;binned_river_x.nc：河流、湖泊；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;每个数据都有5个版本，代表不同的精度，从高到低依次为&lt;strong&gt;f&lt;/strong&gt;ull、&lt;strong&gt;h&lt;/strong&gt;igh、&lt;strong&gt;i&lt;/strong&gt;ntermediate、&lt;strong&gt;l&lt;/strong&gt;ow、&lt;strong&gt;c&lt;/strong&gt;rude。&lt;/p&gt;
&lt;p&gt;resolution可以取为f、h、i、l、c。在不使用-D选项的情况下，GMT默认的数据精度为低精度（l）。在精度后加上一个“+”使得命令在找不到当前指定的精度数据时，自动寻找更低精度的数据。&lt;/p&gt;
&lt;p&gt;以当前计算机的性能来说，即便是全球区域使用full精度的数据画图也基本不会消耗几秒钟。因而推荐使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Df&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;究竟要画什么？&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;数据包含了海岸线、国界以及河流湖泊的信息。选好数据精度之后，还有告诉GMT究竟要画哪些部分？下面的六个选项，分别根据数据绘制不同的部分，6个选项至少要选择一个，该命令才会执行。&lt;/p&gt;
&lt;p&gt;所有的海岸线数据以及其他，从本质上来说就是多边形。对于一个多边形来说，可以只绘制其所有的边，也可以只给多边形涂色，当然也可以既画边也涂色。&lt;/p&gt;
&lt;p&gt;先说说画边的3个选项：&lt;/p&gt;
&lt;div class="section" id="shorelines-w"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;绘制shorelines -W&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
-W[level/]pen
&lt;/pre&gt;
&lt;p&gt;先说说shore这个单词吧。shore指水与陆地交界的“岸”(如：海岸、湖岸、河岸等)，是一个较为笼统的说法。&lt;/p&gt;
&lt;p&gt;GMT将shoreline分成四个等级（level取1-4）：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;coastline：真正意义上的海岸线；&lt;/li&gt;
&lt;li&gt;lakeshore：湖泊与陆地的岸线；&lt;/li&gt;
&lt;li&gt;island-in-lake shore：首先要有陆地，陆地中有个湖，湖里有个岛。即岛的岸线；&lt;/li&gt;
&lt;li&gt;lake-in-island-in-lake shore：首先有陆地，陆地中有个湖，湖中有个岛，岛里又有个湖。这里指的是湖的岸线；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;不使用-W选项，则不绘制任何shore。如果使用-W，给定画笔属性pen，但是不给出level，则绘制四个level的shore。可以用-Wlevel/pen的方式指定要绘制哪一类shore，并指定pen，且在同一个命令中可以多次使用-W，以指定不同level的shore的画笔属性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;-W选项中level是可选的，而pen是必须的！因而若使用“-W2“，2将被解释为所有level的pen属性，而不是level 2。&lt;/p&gt;
&lt;div class="section" id="lakeshore-a"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id18"&gt;lakeshore的一些细节 -A&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="literal-block"&gt;
-Amin_area[/min_level/max_level][+r|l][ppercent]
&lt;/pre&gt;
&lt;p&gt;面积小于min_area或者level不在[min_level,max_level]的shore不会不绘制。min_level和max_level限制哪些level的shore会被绘制，与-W的功能有部分重复。min_area限制了要绘制的多边形的最小面积，这样做使得小面积的湖泊不会干扰整个地图的美观。&lt;/p&gt;
&lt;p&gt;对于level 2，即湖岸线，这里的湖包括了常规的湖以及很宽的河流。加上“+r”则只绘制河流湖，加上“+l”则只绘制常规湖。（试验没成功，出现段错误。。。）&lt;/p&gt;
&lt;p&gt;一个多边形，降低精度后，边数减少，面积变化，当面积变化过大时再绘制这个多边形就不合适了，可以加上&lt;strong&gt;p&lt;/strong&gt;percent以去除那些面积与全精度面积之比小于percent的多边形。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="n"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;绘制政治边界 -N&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
-Nborder[/pen]
&lt;/pre&gt;
&lt;p&gt;注意这里border是必须值，pen是可选值。pen的默认值为width = 0.25p, color = black, texture = solid。&lt;/p&gt;
&lt;p&gt;border指定不同的边界类型，可以取值如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;1：国界；&lt;/li&gt;
&lt;li&gt;2：州界；（目前只有美国、加拿大、澳大利亚以及南美各国的数据）&lt;/li&gt;
&lt;li&gt;3：Marine boundaries（没看懂到底是什么边界）&lt;/li&gt;
&lt;li&gt;a：1-3的全部边界；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;可以多次使用-N选项，以绘制多种政治边界。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="i"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;绘制河流 -I&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
-Iriver[/pen]
&lt;/pre&gt;
&lt;p&gt;pen的默认值为width = 0.25p, color = black, texture = solid。&lt;/p&gt;
&lt;p&gt;river可以分为如下几类：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;1 = Permanent major rivers&lt;/li&gt;
&lt;li&gt;2 = Additional major rivers&lt;/li&gt;
&lt;li&gt;3 = Additional rivers&lt;/li&gt;
&lt;li&gt;4 = Minor rivers&lt;/li&gt;
&lt;li&gt;5 = Intermittent rivers - major&lt;/li&gt;
&lt;li&gt;6 = Intermittent rivers - additional&lt;/li&gt;
&lt;li&gt;7 = Intermittent rivers - minor&lt;/li&gt;
&lt;li&gt;8 = Major canals&lt;/li&gt;
&lt;li&gt;9 = Minor canals&lt;/li&gt;
&lt;li&gt;10 = Irrigation canals&lt;/li&gt;
&lt;li&gt;a = All rivers and canals (1-10)&lt;/li&gt;
&lt;li&gt;r = All permanent rivers (1-4)&lt;/li&gt;
&lt;li&gt;i = All intermittent rivers (5-7)&lt;/li&gt;
&lt;li&gt;c = All canals (8-10)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不清楚这些英语单词的具体区别。一般-Ia或者-Ir就好。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="g"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;给陆地涂色 -G&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;指定所有的dry区域的涂色。可以使用灰度、彩色或者图案。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="s"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id22"&gt;给海洋涂色 -S&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;指定所有的wet区域的涂色。可以使用灰度、彩色或者图案。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="c"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;给湖泊涂色 -C&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
-C[l|r/]fill
&lt;/pre&gt;
&lt;p&gt;默认情况下，湖泊被当成wet区域，其直接使用-S指定的颜色。这里可以单独指定湖泊的颜色。如果想要对常规湖泊和河流湖分别涂色，则需指定l或r。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id24"&gt;小结&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;六个选项，至少需要指定其中一个，也可以指定多个或全部选项。当指定-G而不指定-S时，海洋区域为透明色，即不会覆盖原先已绘的图案；同理，当指定-S而不指定-G时，陆地区域为透明色。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id25"&gt;还可以画什么？&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="l"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id26"&gt;绘制比例尺 -L&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
-L[f][x]lon0/lat0[/slon]/slat/length[m|n|k][+llabel][+jjust][+ppen][+ffill][+u] ]
&lt;/pre&gt;
&lt;p&gt;可以使用psscale命令绘制比例尺，但是对于这种简单的比例尺，pscoast自己就可以搞定。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;lon0/lat0指定了比例尺中心的经纬度位置。如果使用-Lx，则lon0/lat0被解释为相对原点的x、y距离。&lt;/li&gt;
&lt;li&gt;不同的经纬度，其比例尺不同，因而需要指定是要哪个地方的比例尺，slat指定纬度，对于倾斜投影也可以指定slon。&lt;/li&gt;
&lt;li&gt;length为比例尺的长度，单位为km，也可以使用英里（m）或海里（n）。默认比例尺为plain样式，可以使用-Lf得到fancy样式的比例尺。&lt;/li&gt;
&lt;li&gt;对于fancy样式的比例尺，加上“+l”将在比例尺上方加上当前比例尺的单位（km），也可以加上“+llabel”自定义label，该label的具体属性由&lt;tt class="docutils literal"&gt;LABEL_FONT&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;LABEL_FONT_SIZE&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;LABEL_OFFSET&lt;/tt&gt;控制。label的位置可以使用“+jjust”进行调节，其中just可以取b（bottom）、t（top）、l（left）和r（right）。&lt;/li&gt;
&lt;li&gt;对于fancy样式的比例尺，加上“+u”可以在比例尺上所有注释处加上单位。&lt;/li&gt;
&lt;li&gt;+p和+f可以给比例尺的背景处加上边框并涂色。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="t"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id27"&gt;绘制指向标 -T&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
-T[f|m][x]lon0/lat0/size[/info][:w,e,s,n:][+gint[/mint]]
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;lon0/lat0指定了比例尺中心的经纬度位置。如果使用-Tx，则lon0/lat0被解释为相对原点的x、y距离。&lt;/li&gt;
&lt;li&gt;size为指向标的直径；&lt;/li&gt;
&lt;li&gt;可以使用-Tf指定为fancy样式；对于fancy样式，info可以取1、2、3，具体效果看图。&lt;/li&gt;
&lt;li&gt;也可以使用-Tm指定为罗盘样式，此时info的格式dec/dlabel，dec为磁偏角，dlabel为罗盘指针的label（可以使用“-”使用默认label）。&lt;/li&gt;
&lt;li&gt;:w,e,s,n:指定了各个方向的名字，可以用任意字符串指定方向名，若n=*，则在北方向标签处绘制一个星。&lt;/li&gt;
&lt;li&gt;gints/mints设置了地理方向和地磁方向的注释以及两个tick间隔，默认值为10/5/1和30/5/1。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id28"&gt;其他一些选项&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="e"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id29"&gt;-E&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;设置视角的方位和高度。得到伪3D的效果。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="jz-z"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id30"&gt;-Jz和-Z&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;仅对3D绘图有效，没试出来具体的效果。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id31"&gt;再其他一些选项&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;还有一些GMT常见的选项，比如-K、-O、-P、-U、-V、-X、-Y、-c，不多说。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id32"&gt;特殊用法&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id33"&gt;数据提取&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;如果使用了-m选项，pscoast则不绘图，而将数据写入到标准输出中，因而可以很容易地从GMT中提取出我们需要的海岸线、边界等数据。使用该选项必须指定-J和-R，对于-W、-I和-N，可以需指定其中的至少一个。输出的文本文件为GMT多段数据，但是具体每段数据对应哪一个边界，还得再细细分析。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="clip"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id34"&gt;Clip模式&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT有个命令叫做psclip，其读取一个xy文件，得到一个闭合的多边形，然后clip该区域。接下来所有的绘图命令（无论是线段还是颜色或者文字），只有在该区域才会被绘制，不再该区域则不会被绘制。&lt;/p&gt;
&lt;p&gt;pscoast可是使用-Gc剪切出陆地区域，接下来的绘图命令中只有位于陆地区域的部分才会被绘制。&lt;/p&gt;
&lt;p&gt;也可以使用-Sc剪切出海洋区域，接下来的绘图命令中只有位于海洋区域的部分才会被绘制。（一个可能的例子：已有etopo数据，包含了全球地形和海水深度数据，若研究区域在海洋，只想绘制海水深度，而不想将陆地的地形也绘制出来，则可以使用-Sc将海洋区域clip出来，然后再使用grdimage绘图）。&lt;/p&gt;
&lt;p&gt;在clip结束之后，都需要再次调用pscoast，并加上-Q选项。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id35"&gt;例子&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id36"&gt;全球图&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
pscoast -JM25c -R0/360/-65/65 -B60/30 -W1/1p -N1/red -N2 -A500 -Gyellow -Slightblue -Cblue &amp;gt; map.ps
&lt;/pre&gt;
&lt;p&gt;该图绘制了：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;海岸线，笔宽1p；&lt;/li&gt;
&lt;li&gt;国界线，笔宽默认0.25p，颜色红色；&lt;/li&gt;
&lt;li&gt;州界线，默认画笔属性；&lt;/li&gt;
&lt;li&gt;陆地填充黄色；&lt;/li&gt;
&lt;li&gt;海洋浅蓝色；&lt;/li&gt;
&lt;li&gt;内陆湖泊蓝色；&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013102801.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id37"&gt;小区域图&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
pscoast -JM12c -R250/300/30/60 -B5/5 -W1/1p -I1 -A0 -Gyellow -Slightblue -Cblue -Lf-70/33/33/1000+u &amp;gt; a.ps
&lt;/pre&gt;
&lt;p&gt;左右两图分别的位于区别是-A0和-A1000，右图显得更干净一些。图中顺便展示了比例尺的写法。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013102802.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id38"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-10-28：初稿；&lt;/li&gt;
&lt;li&gt;2014-12-25：图例中label由LABEL_*控制；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="GMT4"></category></entry><entry><title>GMT命令之用pslegend绘制图例</title><link href="http://seisman.info/gmt-pslegend.html" rel="alternate"></link><updated>2013-10-27T00:24:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-27:gmt-pslegend.html</id><summary type="html">
&lt;p&gt;GMT的psxy命令是很强大的，可以绘制各种颜色、各种类型的线段以及各种不同的符号。对于稍稍复杂的图来说，图例是必不可少的。图例的作用在于指明某种样式的线段代表什么样的数据，或者符号的大小如何与数据的具体数值相联系。&lt;/p&gt;
&lt;p&gt;理论上来说，用psxy以及pstext就可以做出一个完整的图例了，只是这样的方法稍稍有些复杂。每个元素如何定位？每个元素之间间隔如何协调？这些都是个问题。pslegend算是解决了这个问题，从本质上来说，pslegend命令只是调用了psxy和pstext的相关功能。因而想要理解pslegend的用法，就得首先对psxy和&lt;a class="reference external" href="http://seisman.info/gmt-pstext.html"&gt;pstext&lt;/a&gt;的用法有足够的了解。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
usage: pslegend [&amp;lt;infofile&amp;gt;] -D[x]&amp;lt;x0&amp;gt;/&amp;lt;y0&amp;gt;/w/h/just -J&amp;lt;params&amp;gt;
    -R&amp;lt;west&amp;gt;/&amp;lt;east&amp;gt;/&amp;lt;south&amp;gt;/&amp;lt;north&amp;gt;[r] [-B&amp;lt;params&amp;gt;] [-C&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;] [-F] [-G&amp;lt;fill&amp;gt;]
    [-K] [-L&amp;lt;spacing&amp;gt;] [-O] [-P] [-S[&amp;lt;script&amp;gt;]] [-U[&amp;lt;just&amp;gt;/&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;/][c language="|&amp;lt;label&amp;gt;"][/c]]
    [-V] [-X[a|c|r]&amp;lt;x_shift&amp;gt;[u]] [-Y[a|c|r]&amp;lt;x_shift&amp;gt;[u]] [-c&amp;lt;ncopies&amp;gt;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;标准选项有-J、-R、-B、-K、-O、-P、-U、-V、-X、-Y、-c，不再说。&lt;/p&gt;
&lt;div class="section" id="d"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;图例的位置-D&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
-D[x]lon/lat/width/height/just
&lt;/pre&gt;
&lt;p&gt;首先可以指定整个图例的大小，也就是width和height，注意这里的width和height都用长度。&lt;/p&gt;
&lt;p&gt;lon和lat则给定了图例的位置，just为两个字符，代表整个图例的对齐方式（这个可以参考pstext）。注意这里的lon和lat不是长度单位，而是对应地图上的某个坐标点。&lt;/p&gt;
&lt;p&gt;如果想要指定图例离原点的距离，可以加个x，这样lon和lat代表的是长度而不是一个坐标点了。&lt;/p&gt;
&lt;p&gt;两种指定位置的方式各有利弊，得按照实际需求选择。如果能够很好地与对齐方式just配合，则会更加方便。&lt;/p&gt;
&lt;p&gt;下面的例子展示了常见的四种情形：&lt;/p&gt;
&lt;p&gt;我个人更喜欢-Dx这种用法，只要知道了-JX的值8c，就可以很容易的得出图例的合适位置（0.2,0.2）,（7.8,0.2）,（0.2,7.8）,（7.8,7.8）；&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X8c
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/5/0/5
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1g1/1g1WS
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;just.ps

gmtset HEADER_FONT_SIZE 20
gmtset HEADER_OFFSET 0.2c
gmtset PAGE_ORIENTATION portrait

psbasemap -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt;:.&lt;span class="s2"&gt;"Bottom Left"&lt;/span&gt;: -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pslegend -Dx0.2/0.2/2.5c/0.8c/BL -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -F -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt;$PS&lt;/span&gt;
&lt;span class="s"&gt;S 0.4c c 0.5 - 1p/black 0.8c Circle&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psbasemap -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt;:.&lt;span class="s2"&gt;"Bottom Right"&lt;/span&gt;: -K -O -X10c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pslegend -Dx7.8/0.2/2.5c/0.8c/BR -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -F -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt;$PS&lt;/span&gt;
&lt;span class="s"&gt;S 0.4c c 0.5 - 1p/black 0.8c Circle&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psbasemap -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt;:.&lt;span class="s2"&gt;"Top Left"&lt;/span&gt;: -K -O -X-10c -Y11c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pslegend -Dx0.2/7.8/2.5c/0.8c/TL -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -F -K -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt;$PS&lt;/span&gt;
&lt;span class="s"&gt;S 0.4c c 0.5 - 1p/black 0.8c Circle&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psbasemap -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt;:.&lt;span class="s2"&gt;"Top Right"&lt;/span&gt;: -K -O -X10c &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pslegend -Dx7.8/7.8/2.5c/0.8c/TR -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -F -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt;$PS&lt;/span&gt;
&lt;span class="s"&gt;S 0.4c c 0.5 - 1p/black 0.8c Circle&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;结果图：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="legend" src="/images/2013102701.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;给图例加个框&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-F选项可以给图例加个框，框的线条由参数FRAME_PEN来控制。不管最终成图的时候，图例是否需要个框，在调试的时候有个框还是很有必要的，可以对整个图例的布局有更好的把握。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;给图例区填色&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-G选项。默认是无填充的，加个背景色使得图例与地图本身有所区分也不错。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="c"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;选项-C&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-C选项可以控制图例框与内部图例之间的距离。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="l"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;选项-L&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;设置图例里的行距比例。默认值为1.1，即行距为1.1倍的注释字体大小。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="s"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;选项-S&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;前面已经说到pslegend本质上是调用了psxy和pstext。默认pslegend命令会生成相应的PS代码，可以用-K、-O加到PS绘图文件中。-S选项使得该命令不产生PS代码，而是产生由psxy和pstext构成的bash脚本。这样的话更加方便用户手动调节图例。毕竟pslegend没法完全发挥psxy和pstext的全部功能。但是需要注意的是改bash脚本本身是很危险的，牵一发而动全身。还是不太建议这样做。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;输入文件格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;由于pslegend本质上是调用psxy和pstext，所以其输入文件的格式在很大程序上与psxy和pstext的文件格式有相似之处。&lt;/p&gt;
&lt;p&gt;这个文件指定了图例中每个元素的细节，以及各个元素之间的相对顺序。输入文件中每一行称为一个记录，每个记录的首字符定义了该记录的具体含义，就像psxy中-Sc的c代表了circle一样。&lt;/p&gt;
&lt;p&gt;根据首字符的不同，将所有的记录分为如下几类：&lt;/p&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id22"&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;以“#”开头的记录代表注释行，后面可以加任意注释。该记录以及空白行都会被跳过。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="b"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;B&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;以“B”开头的记录绘制一个水平color bar。其格式如下&lt;/p&gt;
&lt;pre class="literal-block"&gt;
B cptname offset height [ optional arguments ]
&lt;/pre&gt;
&lt;p&gt;cptname为color bar对应的cpt文件，offset定义了color bar与图例左边界的距离。该水平color bar的高度为height。另外可以直接将psscale的选项-A、-B、-E、-I、-L、-M、-N、-S、-Z加在记录的最后。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id24"&gt;C&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;以“C”开头的记录定义了接下来所有文字的颜色。可以在不同的记录处使用C选项来不断改变文本颜色。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
C textcolor
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id25"&gt;D&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;格式如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
D offset pen
&lt;/pre&gt;
&lt;p&gt;以“D”开头的记录会在图例中绘制一条水平线，其中pen定义了水平线的属性。除了画一条线之外，还会在线的上下各留出1/4行间距的空白。同时该水平线的离图例框左右各留出offset单位的距离。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="g"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id26"&gt;G&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
G gap
&lt;/pre&gt;
&lt;p&gt;以“G”开头的记录会在垂直方向上产生一个gap，实际就是一个长度为gap的空白区。gap除了可以用i、c、p做单位外，还可以使用l（代表行）。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="h"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id27"&gt;H&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
H fontsize font header
&lt;/pre&gt;
&lt;p&gt;以“H”开头的记录代表一个居中对齐的文本，fontsize和font指定了具体字体参数，若fontsize或font为“-”，则使用HEADER_FONT_SIZE和HEADER_FONT的值。header为要写的文本。这个主要用来写图例的标题。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="i"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id28"&gt;I&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
I imagefile width justification
&lt;/pre&gt;
&lt;p&gt;将EPS文件或Sun光栅文件放在图例中的“当前位置”，有点psimage的意思。width为图像尺寸，justification为对齐方式。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id29"&gt;L&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
L fontsize font justification label
&lt;/pre&gt;
&lt;p&gt;与“H”类似，这里的justification可以选择L、R、C，即左对齐、右对齐、居中对齐。label为具体文本。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="m"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id30"&gt;M&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
M slon slat length f|p [ −Rw/e/s/n −Jparam ]
&lt;/pre&gt;
&lt;p&gt;该选项可以在图例中绘制比例尺（psscale）。地图在进行投影之后，不同的位置其比例尺不同，slon、slat指定了要绘制哪一点的比例尺（不是比例尺绘制在哪一点！）。slon仅对特定的倾斜投影有效，对于其他投影，可以设置slon为“-”。&lt;/p&gt;
&lt;p&gt;lenth指定了比例尺的长度，默认单位为km（后加m代表英里，加n代表海里。），也可以加f或者p以使用fancy或者plain的比例尺。如果pslegend的-J和-R选项与绘制比例尺所需的-J、-R不同，则可以在记录中加入-J和-R参数。还有一堆看不懂的说明，等以后看了psscale再理解吧。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="n"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id31"&gt;N&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
N ncolumns
&lt;/pre&gt;
&lt;p&gt;以“N”开头的记录，将图例等分为ncolumns列，该记录仅对图例中的符号（S）和标签（L）有影响。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id32"&gt;S&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
S dx1 symbol size fill pen [ dx2 text ]
&lt;/pre&gt;
&lt;p&gt;最常用的记录类型，symbol指定了要绘制的符号的类型，具体参见psxy的-S选项，dx1为符号距图例当前列左边界的距离，如果只有一列，dx1就是距图例左边界的距离。size为符号尺寸，fill为符号填充，pen为符号轮廓。&lt;/p&gt;
&lt;p&gt;可以给符号加上文本说明text，dx2指定了text距离左边界的距离。&lt;/p&gt;
&lt;p&gt;对于两个特殊的符号front（f）和vector（v），在symbole后应加入该符号所需要的其他信息，具体参见示例。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="t"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id33"&gt;T&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
T paragraph-text
&lt;/pre&gt;
&lt;p&gt;该记录会输入成段的文本，其字体由ANNOT_FONT_SIZE_PRIMARY和ANNOT_FONT_PRIMARY控制。如果想要控制更多特性，可以使用下面的“&amp;gt;”记录。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="v"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id34"&gt;V&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
V offset pen
&lt;/pre&gt;
&lt;p&gt;与“D”记录类似，该记录在每两列之间绘制垂直线段（前提是图例被分为多列），offset是垂直线段离上下边界的空白距离。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id35"&gt;&amp;gt;&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
&amp;gt; paragraph-mode-header-for-pstext
&lt;/pre&gt;
&lt;p&gt;这个记录调用pstext的段落模式，具体参见《&lt;a class="reference external" href="http://seisman.info/gmt-pstext.html"&gt;GMT命令之用pstext在图上写入文本&lt;/a&gt;》&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id36"&gt;例子&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个例子来自于GMT pslegend的官方例子，略有修改。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;pslegend -R-10/10/-10/10 -JM6i -Gazure1 -Dx0.5i/0.5i/5i/3.3i/BL -C0.1i/0.1i -L1.2 -F -B5f1 -P &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt; map.ps&lt;/span&gt;
&lt;span class="s"&gt;G -0.1i&lt;/span&gt;
&lt;span class="s"&gt;# 设置标题&lt;/span&gt;
&lt;span class="s"&gt;H 24 Times-Roman My Map Legend&lt;/span&gt;
&lt;span class="s"&gt;# 水平线&lt;/span&gt;
&lt;span class="s"&gt;D 0.2i 1p&lt;/span&gt;
&lt;span class="s"&gt;# 分栏&lt;/span&gt;
&lt;span class="s"&gt;N 2&lt;/span&gt;
&lt;span class="s"&gt;# 垂直线起点&lt;/span&gt;
&lt;span class="s"&gt;V 0 1p&lt;/span&gt;
&lt;span class="s"&gt;# 7种符号&lt;/span&gt;
&lt;span class="s"&gt;S 0.1i c 0.15i p300/12 0.25p 0.3i This circle is hachured&lt;/span&gt;
&lt;span class="s"&gt;S 0.1i e 0.15i 255/255/0 0.25p 0.3i This ellipse is yellow&lt;/span&gt;
&lt;span class="s"&gt;S 0.1i w 0.15i 0/255/0 0.25p 0.3i This wedge is green&lt;/span&gt;
&lt;span class="s"&gt;S 0.1i f 0.25i/-1/0.075ilb 0/0/255 0.25p 0.3i This is a fault&lt;/span&gt;
&lt;span class="s"&gt;S 0.1i - 0.15i - 0.25tap 0.3i A contour&lt;/span&gt;
&lt;span class="s"&gt;S 0.1i v 0.25i/0.02i/0.06i/0.05i 255/0/255 0.25p 0.3i This is a vector&lt;/span&gt;
&lt;span class="s"&gt;S 0.1i i 0.15i 0/255/255 0.25p 0.3i This triangle is boring&lt;/span&gt;
&lt;span class="s"&gt;# 垂直线终点&lt;/span&gt;
&lt;span class="s"&gt;V 0 1p&lt;/span&gt;
&lt;span class="s"&gt;# 水平线&lt;/span&gt;
&lt;span class="s"&gt;D 0.2i 1p&lt;/span&gt;
&lt;span class="s"&gt;# 回到单栏模式&lt;/span&gt;
&lt;span class="s"&gt;N 1&lt;/span&gt;
&lt;span class="s"&gt;M 5 5 600+u f&lt;/span&gt;
&lt;span class="s"&gt;G 0.05i&lt;/span&gt;
&lt;span class="s"&gt;# I GMT_coverlogo.eps 3i CT&lt;/span&gt;
&lt;span class="s"&gt;G 0.05i&lt;/span&gt;
&lt;span class="s"&gt;# B colors.cpt 0.2i 0.2i&lt;/span&gt;
&lt;span class="s"&gt;G 0.05i&lt;/span&gt;
&lt;span class="s"&gt;L 9 4 R Smith et al., @%5%J. Geophys. Res., 99@%%, 2000&lt;/span&gt;
&lt;span class="s"&gt;G 0.1i&lt;/span&gt;
&lt;span class="s"&gt;T Let us just try some simple text that can go on a few lines.&lt;/span&gt;
&lt;span class="s"&gt;T There is no easy way to predetermine how many lines will be required,&lt;/span&gt;
&lt;span class="s"&gt;T so we may have to adjust the box height to get the right size box.&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013102702.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;对于这个例子，如果在pslegend命令里加上-S选项，将会得到一个脚本，其内容为&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;psbasemap -R0/5/0/3.3 -JX5i/-3.3i -Xr1.48425i -Yr1.48425i -K  -P -B0 -Gazure1
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'2.5 0.312167 24 0 Times-Roman BC My Map Legend '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo &lt;/span&gt;0.2 0.458333 &amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo &lt;/span&gt;4.8 0.458333 &amp;gt;&amp;gt; pslegend_26300.txt
psxy -R -JX -O -K  -W1p pslegend_26300.txt
rm -f pslegend_26300.txt
&lt;span class="nb"&gt;echo &lt;/span&gt;0.2 0.633333 &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -JX -O -K  -Sc0.15i -Gp300/12 -W0.25p
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'0.4 0.701389 14 0 0 BL This circle is hachured '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo &lt;/span&gt;2.7 0.633333 &lt;span class="m"&gt;0&lt;/span&gt; 0.381 0.24765 &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -JX -O -K  -Se0.15i -G255/255/0 -W0.25p
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'2.9 0.701389 14 0 0 BL This ellipse is yellow '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo &lt;/span&gt;0.125 0.904167 &lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="m"&gt;60&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -JX -O -K  -Sw0.15i -G0/255/0 -W0.25p
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'0.4 0.934722 14 0 0 BL This wedge is green '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo &lt;/span&gt;2.575 0.866667 &amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo &lt;/span&gt;2.825 0.866667 &amp;gt;&amp;gt; pslegend_26300.txt
psxy -R -JX -O -K  -Sf-1/0.075ilb pslegend_26300.txt -G0/0/255 -W0.25p
rm -f pslegend_26300.txt
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'2.9 0.934722 14 0 0 BL This is a fault '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo &lt;/span&gt;0.2 1.1 &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -JX -O -K  -S-0.15i -W0.25tap
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'0.4 1.16806 14 0 0 BL A contour '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo &lt;/span&gt;2.7 1.1 &lt;span class="m"&gt;0&lt;/span&gt; 0.635 &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -JX -O -K  -Svb0.02i/0.06i/0.05i -G255/0/255 -W0.25p
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'2.9 1.16806 14 0 0 BL This is a vector '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo &lt;/span&gt;0.2 1.33333 &lt;span class="p"&gt;|&lt;/span&gt; psxy -R -JX -O -K  -Si0.15i -G0/255/255 -W0.25p
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'0.4 1.40139 14 0 0 BL This triangle is boring '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="c"&gt;# vertical lines &amp;gt; pslegend_26300.txt&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="se"&gt;\&amp;gt;&lt;/span&gt; bar &lt;span class="m"&gt;1&lt;/span&gt; &amp;gt;&amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo &lt;/span&gt;2.5 0.458333 &amp;gt;&amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo &lt;/span&gt;2.5 1.50833 &amp;gt;&amp;gt; pslegend_26300.txt
psxy -R -JX -O -K  -W1p -H -m pslegend_26300.txt
rm -f pslegend_26300.txt
&lt;span class="nb"&gt;echo &lt;/span&gt;0.2 1.50833 &amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo &lt;/span&gt;4.8 1.50833 &amp;gt;&amp;gt; pslegend_26300.txt
psxy -R -JX -O -K  -W1p pslegend_26300.txt
rm -f pslegend_26300.txt
psbasemap -R-10/10/-10/10 -JM6i -O -K -Lfx2.5i/1.73333i/5/5/600+u
psxy -R0/5/0/3.3 -JX5i/-3.3i -O -K -T
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'4.9 2.12732 9 0 4 BR Smith et al., @%5%J. Geophys. Res., 99@%%, 2000 '&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; pstext -R -JX -O -K
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="se"&gt;\&amp;gt;&lt;/span&gt; 0.1 2.30887 &lt;span class="m"&gt;14&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; TL 0.233333i 4.8i j &amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'Let us just try some simple text that can go on a few lines. '&lt;/span&gt; &amp;gt;&amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'There is no easy way to predetermine how many lines will be required, '&lt;/span&gt; &amp;gt;&amp;gt; pslegend_26300.txt
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'so we may have to adjust the box height to get the right size box. '&lt;/span&gt; &amp;gt;&amp;gt; pslegend_26300.txt
pstext -R -JX -O -K  -m pslegend_26300.txt
rm -f pslegend_26300.txt
psxy -R-10/10/-10/10 -JM6i -T -Xr-0.5i -Yr-0.5i -O  -B5f1
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="GMT脚本"></category><category term="GMT4"></category></entry><entry><title>GMT技巧之GMT与LaTeX的合作</title><link href="http://seisman.info/use-latex-in-gmt.html" rel="alternate"></link><updated>2013-10-24T00:16:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-24:use-latex-in-gmt.html</id><summary type="html">
&lt;p&gt;GMT的pstext命令支持一些简单的文本特效以及特殊字符，但是如果想在GMT中显示一些更复杂的公式或者其他，GMT则无能为力了。&lt;/p&gt;
&lt;p&gt;这个时候自然而然就会想到功能强大的LaTeX了，写公式、画图都算是强项。显然GMT自身是无法直接支持LaTeX的语法的（若要支持LaTeX的语法，在绘图时必须调用LaTeX引擎，这样GMT对其他软件的依赖性过大，而且从技术上来说对于GMT的开发者来说也有些难度）。&lt;/p&gt;
&lt;p&gt;虽然说用GMT绘图时在图上显示公式算是一个很小众的需求，从折腾的角度来看，还是很值得的。&lt;/p&gt;
&lt;div class="section" id="latex"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;用LaTeX写公式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下面的LaTeX代码包含了地震学里最基础的波动方程：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;\documentclass&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;book&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\begin&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;document&lt;span class="nb"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;\thispagestyle&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;empty&lt;span class="nb"&gt;}&lt;/span&gt;

&lt;span class="c"&gt;% 波动方程&lt;/span&gt;
&lt;span class="k"&gt;\begin&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;displaymath&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\rho&lt;/span&gt; &lt;span class="k"&gt;\frac&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;&lt;span class="k"&gt;\partial&lt;/span&gt;&lt;span class="nb"&gt;^&lt;/span&gt;2 u&lt;span class="nb"&gt;_&lt;/span&gt;i&lt;span class="nb"&gt;}{&lt;/span&gt;&lt;span class="k"&gt;\partial&lt;/span&gt; t&lt;span class="nb"&gt;^&lt;/span&gt;2&lt;span class="nb"&gt;}&lt;/span&gt; = f&lt;span class="nb"&gt;_&lt;/span&gt;i +&lt;span class="k"&gt;\tau&lt;/span&gt;&lt;span class="nb"&gt;_{&lt;/span&gt;ij,j&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\end&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;displaymath&lt;span class="nb"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;\end&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;document&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;需要说明的两点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;默认生成的结果中是有页码的，页码的存在会影响PS文件的Bounding Box，thispagestyle{empty}设置当前页面不显示页码。&lt;/li&gt;
&lt;li&gt;displaymath环境得到的是无编号的公式。而equation环境得到的是有编号的公式，也会影响PS文件的Bounding Box，所以不要使用。&lt;/li&gt;
&lt;li&gt;公式环境还有其他表示方法，具体参见LaTeX语法；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;编译LaTeX源码，并处理输出文件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;上面的LaTeX代码保存在文件equation.tex中。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;latex equation.tex
&lt;span class="nv"&gt;$ &lt;/span&gt;dvips equation.dvi
&lt;span class="nv"&gt;$ &lt;/span&gt;ps2eps equation.ps -f -l
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;简单解释一下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;latex将tex文件编译成dvi文件；&lt;/li&gt;
&lt;li&gt;dvips将dvi文件转换为ps文件；&lt;/li&gt;
&lt;li&gt;ps2eps将ps文件转换为eps文件；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;关于ps2eps的一些介绍：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-f表示若已存在同名eps文件，则强制覆盖；&lt;/li&gt;
&lt;li&gt;在将ps文件转换为eps文件时，会根据ps文件中的Bounding Box信息对PS文件进行切边，但是默认的切边方式切得有点过了，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-l&lt;/span&gt;&lt;/tt&gt;会在四个方向上各扩展1个点的距离，切边效果更好。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--resolution=dpi&lt;/span&gt;&lt;/tt&gt;可以设置PS文件的精度；默认效果应该足够了；&lt;/li&gt;
&lt;li&gt;如果有其他需求，可以参考ps2eps的官方说明： &lt;a class="reference external" href="http://www.tm.uka.de/~bless/ps2eps"&gt;http://www.tm.uka.de/~bless/ps2eps&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;也可以不使用ps2eps，而直接使用convert命令，convert默认的切边效果非常好，但是默认精度比较低，需要自己调高。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gmtlatex"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;GMT与LaTeX的合并&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
pstext -JX15c -R0/10/0/10 -B2/2:.&lt;span class="s2"&gt;"Equation of motion"&lt;/span&gt;: -K &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;5 6 15 0 0 CM Equation Start.&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psimage equation.eps -W5c -C8/7/CM -K -O &amp;gt;&amp;gt; a.ps
psimage equation.eps -W8c -C8/5/CM -K -O &amp;gt;&amp;gt; a.ps

pstext -J -R -O &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;5 2 15 0 0 CM Equation End&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;其实本质上就是利用psimage命令将EPS文件嵌入到当前PS文件中。这里写了两个psimage命令，以展示psimage对图形的自由伸缩。需要注意的是-C后面给定的是长度单位，与pstext中的坐标点的意义是不同的。&lt;/p&gt;
&lt;p&gt;GMT和LaTeX虽然都使用PS代码（EPS算是特殊的PS），但是二者的一些结构和定义不同（最明显的区别是一个是PS-Adobe-2.0，一个是PS-Adobe-3.0），因而上面生成的ps文件不能用ps2raster来转换（撒了个小谎，实际上可以转换为eps文件，其他格式都会报错）。&lt;/p&gt;
&lt;p&gt;这是个小问题，毕竟还有万能的convert命令（点&lt;a class="reference external" href="http://seisman.info/convert-and-ps2raster.html"&gt;这里&lt;/a&gt;），转换命令如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ convert -trim -density 300 -rotate 90 a.ps a.jpg
&lt;/pre&gt;
&lt;p&gt;效果如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="latex-in-gmt" src="/images/2013102401.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;其他一些需要说明的地方&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;从本质上来说，这个技巧利用了psimage命令，直接将EPS文件的代码嵌入到新的PS文件中，因而基本上只要是EPS文件都可以这么做。利用这一点可以做很多事情，比如GMT的箭头比较难看，可以用LaTeX的TikZ包来生成好看的箭头，然后再导入进去。&lt;/li&gt;
&lt;li&gt;用latex将tex编译成dvi，再转换为ps文件是一种比较老的latex编译方式；也是这里推荐的编译方式。&lt;/li&gt;
&lt;li&gt;现在更流行的是编译方式是直接用pdflatex或者xelatex生成pdf文件。但是这里需要eps文件，所以需要调用pdf2ps转换为ps再转换为eps，pdflatex生成的pdf效果很好，但是再生成ps文件清晰度会降低很多。因而最好还是用比较古老的编译方式吧。&lt;/li&gt;
&lt;li&gt;这个方法或许也可以用来在GMT上写中文。目前对中文支持最好的应该是xelatex了，其好像只能生成pdf，转换为ps后精度必然不够。一个解决办法是写足够大的字，转换之后用psimage缩小到需要的尺寸，这样或许精度上看上去效果更好。另一个办法是查一查pdf到ps转换有没有高精度的实现方法。不过GMT的中文问题还是用&lt;a class="reference external" href="http://seisman.info/gmt-chinese-under-linux.html"&gt;Linux下的GMT中文显示&lt;/a&gt;的方法更好。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="图像"></category><category term="格式转换"></category><category term="LaTeX"></category></entry><entry><title>GMT技巧之图像合并2</title><link href="http://seisman.info/gmt-merge-images-again.html" rel="alternate"></link><updated>2013-10-23T09:12:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-23:gmt-merge-images-again.html</id><summary type="html">&lt;p&gt;在之前的博文《&lt;a class="reference external" href="http://seisman.info/gmt-merge-images.html"&gt;GMT技巧之图像合并&lt;/a&gt;》中说到了为什么需要图像合并以及图像合并的几种实现方法。&lt;/p&gt;
&lt;p&gt;先说说前面的两个半方法的缺点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;解决办法1：为了将每个子图缩小到合适的尺寸，需要调节-J的尺寸以及其他很多细节参数（比如字体大小以及一些位置）。&lt;/li&gt;
&lt;li&gt;解决办法2：通过修改纸张大小，然后将每个子图放在纸张合适的位置。这个方法的前提是每个子图的相对尺寸是合适的。&lt;/li&gt;
&lt;li&gt;解决办法2升级版：同解决方法2，要求子图的相对大小合适。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;先看看脚本fig1.sh：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;psxy -JX10c -R0/10/0/10 -B2/2 -Sc -K &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -J -R -O &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 2 20 0 0 CM Outside&lt;/span&gt;
&lt;span class="s"&gt;5 3 20 0 0 CM Inside&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;再看看脚本fig2.sh&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;psxy -JX5c -R0/10/0/10 -B2/2 -St -K &amp;gt; b.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -J -R -O &amp;gt;&amp;gt; b.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 2 20 0 0 CM Outside&lt;/span&gt;
&lt;span class="s"&gt;5 3 20 0 0 CM Inside&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;两个代码都很简单，一个画圆一个画三角形，然后写了&amp;quot;Outside&amp;quot;和&amp;quot;Inside&amp;quot;两个字符串。注意两张图的尺寸是不同的（-JX10c和-JX5c）。&lt;/p&gt;
&lt;p&gt;现在要求把两张图合并到一张图中。&lt;/p&gt;
&lt;p&gt;根据原来博文的思想，先将上面两个脚本fig1.sh和fig2.sh合并成一个脚本fig3.sh，合并过程中需要注意修改PS文件名，注意-K、-O，注意&amp;gt;和&amp;gt;&amp;gt;的区别，内容如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;psxy -JX10c -R0/10/0/10 -B2/2 -Sc -K &amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -J -R -K -O &amp;gt;&amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 2 20 0 0 CM Outside&lt;/span&gt;
&lt;span class="s"&gt;5 3 20 0 0 CM Inside&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psxy -JX5c -R0/10/0/10 -B2/2 -St -K -O -X12c &amp;gt;&amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -J -R -O &amp;gt;&amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 2 20 0 0 CM Outside&lt;/span&gt;
&lt;span class="s"&gt;5 3 20 0 0 CM Inside&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;绘图结果如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="fig" src="/images/2013102301.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;左图和右图大小不一样，这图交给老板，肯定要被老板训一顿了。&lt;/p&gt;
&lt;p&gt;试着将左边的图修改小一点，修改之后fig4.sh，内容如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;psxy -JX5c -R0/10/0/10 -B2/2 -Sc -K &amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -J -R -K -O &amp;gt;&amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 2 20 0 0 CM Outside&lt;/span&gt;
&lt;span class="s"&gt;5 3 20 0 0 CM Inside&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

psxy -JX5c -R0/10/0/10 -B2/2 -St -K -O -X12c &amp;gt;&amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5 5&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
pstext -J -R -O &amp;gt;&amp;gt; c.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;5 2 20 0 0 CM Outside&lt;/span&gt;
&lt;span class="s"&gt;5 3 20 0 0 CM Inside&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;绘图如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="fig" src="/images/2013102302.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这下左图和右图大小一致了，但是左图已经完全变形了，又是被老板训的节奏。&lt;/p&gt;
&lt;p&gt;根据解法1的思路，下面就是要重新调节左图的一些细节，这与重新画图基本没啥区别了。&lt;/p&gt;
&lt;p&gt;这个时候就想，GMT要是能够实现图形的整体缩放就好了。恰好psimage可以实现这个功能。&lt;/p&gt;
&lt;p&gt;这里直接利用最初的两个代码fig1.sh和fig2.sh:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# 执行前两个脚本&lt;/span&gt;
sh fig1.sh
sh fig2.sh

&lt;span class="c"&gt;# 将生成的a.ps和b.ps转换成EPS文件&lt;/span&gt;
ps2raster -A -P -Te a.ps
ps2raster -A -P -Te b.ps

&lt;span class="c"&gt;# 利用psimage进行缩放&lt;/span&gt;
psimage a.eps -W5c -K &amp;gt; fig.ps
psimage b.eps -W5.3c -C6/0/BL -O &amp;gt;&amp;gt; fig.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果图：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="fig" src="/images/2013102303.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这个脚本在没有对原脚本进行修改的前提下，实现了图形的缩放，虽然最终效果上还是有些不足，主要表现在注释等字体的大小上。因而还需要进行一些微调。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;备注&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;前段时间了解了一下TikZ的绘图功能，其自由的可缩放性让我觉得得心应手，当时就想，GMT为什么不支持缩放呢？&lt;/p&gt;
&lt;p&gt;其实是支持的，只是一直被我忽略了。GMT的.gmtdefaults4文件中有两个参数，GLOBAL_X_SCALE和GLOBAL_Y_SCALE，可以用来控制图形的缩放。但是这两个参数与-P选项类似，在执行第一个绘图命令时就将PS代码写入了PS文件中了。之后无论怎样修改这两个参数都是没有用的。即GLOBAL_X_SCALE和GLOBAL_Y_SCALE只能修改整个图形相对纸张的比例，而不能修改图形的某个部分相对于整个图形的比例。这应该算是GMT将不同功能分布在多个命令中的弊端之一吧。&lt;/p&gt;
</summary><category term="GMT技巧"></category><category term="图像"></category></entry><entry><title>GMT命令之很有用但是却不常用的psimage</title><link href="http://seisman.info/gmt-psimage.html" rel="alternate"></link><updated>2013-10-22T00:31:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-22:gmt-psimage.html</id><summary type="html">
&lt;p&gt;psimage是个不太常用的命令，其主要功能是将一个图像文件直接绘制到当前地图中去。本文介绍一下psimage的基本语法，接下来的两篇博文介绍一下该命令的一些特殊用途（只是一些想法，具体能否实现还得再测试）。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
usage: psimage &amp;lt;imagefile&amp;gt; [-E&amp;lt;dpi&amp;gt; or -W[-]&amp;lt;width&amp;gt;[/&amp;lt;height&amp;gt;]]
    [-C&amp;lt;xpos&amp;gt;/&amp;lt;ypos&amp;gt;[/&amp;lt;justify&amp;gt;]] [-F&amp;lt;pen&amp;gt;] [-G[b|f|t]&amp;lt;color&amp;gt;] [-I] [-K] [-M]
    [-N&amp;lt;nx&amp;gt;[/&amp;lt;ny&amp;gt;]] [-O] [-P] [-U[&amp;lt;just&amp;gt;/&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;/][c language="|&amp;lt;label&amp;gt;"][/c]]
    [-V] [-X[a|c|r]&amp;lt;x_shift&amp;gt;[u]] [-Y[a|c|r]&amp;lt;x_shift&amp;gt;[u]] [-c&amp;lt;ncopies&amp;gt;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;输入文件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;psimage可以处理的图像文件包括EPS文件和1、8、24或32位Sun光栅文件。光栅文件平常不太用；需要注意的是，这里使用的是EPS文件而不是PS文件！（当然二者可以通过ps2raster命令很方便的进行转换）。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;标准选项有-K、-O、-P、-U、-V、-X、-Y、-c，不多说。&lt;/p&gt;
&lt;div class="section" id="e-w"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;控制图像尺寸-E和-W&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-E和-W选项可以用于控制待插入图像的尺寸，可以任意缩放。-E和-W任选其一即可。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-E：设置图像的dpi；由于EPS文件的点数已经固定，因而这里dpi越大，图看上去越小；&lt;/li&gt;
&lt;li&gt;-W：设置图像在当前绘图坐标系中的宽度（和高度）；若未指定高度，则保持原横纵比；若宽度为负值，则取其绝对值，然后。。。（没看懂，也没看出区别）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;觉得-W选项更加简单明了，更好用。需要注意的是，一般绘图-JX10c中的10cm指的是绘图框架的宽度，不包括周围的注释以及标题，而这里的-W包含了注释和标题所占的宽度，实际上-W是读取了文件中的BoundingBox的范围来进行缩放的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="c"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;位置控制-C&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;设置图像在当前绘图中相对于当前原点的位置。默认值为0/0/&lt;span class="caps"&gt;BL&lt;/span&gt;，即图像的左下角位于当前绘图的原点处。-X和-Y选项也可以控制图像位置，但是我觉得-C选项更好用，有两个理由：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;-C提供了对齐方式选项，更加灵活，一般的BL对齐方式是常用选择；&lt;/li&gt;
&lt;li&gt;使用-C选项不会对当前绘图的原点位置进行修改，而使用-X、-Y选项原点位置会被修改。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;其他选项&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-F：该选项可以给图像加入一个边框，还可以设置边框的画笔属性；&lt;/li&gt;
&lt;li&gt;-M：将彩图转换为黑白灰度图；&lt;/li&gt;
&lt;li&gt;-N：将图像在x和y方向重复nx和ny次，常用于用小图构建pattern。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于1位Sun光栅文件（即黑白图），有如下选项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-Gb：设置背景色（即原图中的白色像素点），若颜色为“-”，则背景色为透明；&lt;/li&gt;
&lt;li&gt;-Gf：设置前景色（即原图中的黑色像素点），若颜色为“-”，则前景色为透明；&lt;/li&gt;
&lt;li&gt;-I：黑变白，白变黑；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于8、24、32位光栅文件，有如下选项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-Gt：设置光栅文件中的某种颜色为透明色。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;备注和说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Q1：如何获取EPS文件？&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A1：&lt;/strong&gt;对于GMT生成的PS文件，可以直接使用ps2raster命令转换成EPS文件，命令如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ps2raster -A -P -Te image.ps
&lt;/pre&gt;
&lt;p&gt;其中-A对图像做切边，这个很重要！-P选项是对图像进行旋转，这个看具体需求；-Te选项指定输入格式为EPS；&lt;/p&gt;
&lt;p&gt;对于其他软件产生的ps文件，由于不符合GMT的标准，所以很大程序上ps2raster无法进行转换，可以考虑使用ps2eps或者convert命令。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Q2：EPS文件与PS文件有什么区别？&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A2：&lt;/strong&gt;印象中有看到过，EPS文件不包含PS文件中的部分危险指令，因而更安全。对于GMT来说，ps2raster转换生成的EPS文件和原PS文件几乎没有区别（EPS文件中缺少了几行）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Q3：psimage生成的图是矢量图还是位图？&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A3：&lt;/strong&gt;psimage生成了PS代码，所以最终成图是矢量图。从PS代码中可以看到，psimage大概只是把EPS的代码做了简单修改就直接放入了新生成的PS文件中，所以EPS文件里的图像在新生成的PS文件中依然是矢量的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Q4：psimage命令在什么情况下会用到？&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A4：&lt;/strong&gt;目前想到两个可能的用途，一个是以前博文曾经试图解决的图像合并问题，另一个是制作复杂公式的问题。这两个问题会在接下来的两篇博文中试着解决。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="图像"></category><category term="GMT4"></category></entry><entry><title>GMT进阶之文本特效</title><link href="http://seisman.info/gmt-text-effect.html" rel="alternate"></link><updated>2013-10-21T10:55:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-21:gmt-text-effect.html</id><summary type="html">
&lt;p&gt;下面用pstext来展示一下GMT支持的所有文本特效（我能想到的部分）。当然，只要是GMT中的文本，不管是-B选项中的坐标轴名、标题名还是psxy里放在某个坐标上的文本，都可以用同样的方法实现文本特效。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;文本特效图&lt;/a&gt;&lt;/h2&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="text-effect" src="/images/2013102101.jpg" style="width: 450px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;脚本&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;text.ps
psbasemap -JX4c/-20c -B1/1W -R-1/5/0/20 -K -P &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pstext -J -B -R -N -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt; &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;0 1 15 0 0 ML abcdefghijklmnopqrstuvwxyz&lt;/span&gt;
&lt;span class="s"&gt;0 2 15 0 0 ML 1234567890&lt;/span&gt;
&lt;span class="s"&gt;0 3 15 0 0 ML ~!#$%^&amp;amp;*()_-=+[]{}\|;:'",.&amp;lt;&amp;gt;/?&lt;/span&gt;
&lt;span class="s"&gt;0 4 15 0 0 ML @@ \100&lt;/span&gt;
&lt;span class="s"&gt;0 5 15 0 0 ML \221 \251 \200 \101&lt;/span&gt;
&lt;span class="s"&gt;0 6 15 0 12 ML abcdefghijklmnopqrstuvwxyz&lt;/span&gt;
&lt;span class="s"&gt;0 7 15 0 12 ML \141\142\143\144\145\147\150\151&lt;/span&gt;
&lt;span class="s"&gt;0 8 15 0 34 ML abcdefghijklmnopqrstuvwxyz&lt;/span&gt;
&lt;span class="s"&gt;0 9 15 0 34 ML \141\142\143\144\145\147\150\151&lt;/span&gt;
&lt;span class="s"&gt;0 10 15 0 0 ML abc@~def@~ghi&lt;/span&gt;
&lt;span class="s"&gt;0 11 15 0 0 ML 4@+2@+=16  x@+2@-1&lt;/span&gt;
&lt;span class="s"&gt;0 12 15 0 0 ML (x@-1@-,x@-2@-,x@-3@-)&lt;/span&gt;
&lt;span class="s"&gt;0 13 15 0 0 ML T@#his@# is a word.&lt;/span&gt;
&lt;span class="s"&gt;0 14 15 0 0 ML This is @_important@_.&lt;/span&gt;
&lt;span class="s"&gt;0 15 15 0 0 ML abc@%1%def@%2%ghi@%12%jkl@%34%mno@%%pqr&lt;/span&gt;
&lt;span class="s"&gt;0 16 15 0 0 ML normal @:5:tiny @:10:small @:20:large @:25:larger @::What size?&lt;/span&gt;
&lt;span class="s"&gt;0 17 15 0 0 ML BLACK @;red;RED @;blue;BLUE @;green;GREEN @;;What color?&lt;/span&gt;
&lt;span class="s"&gt;0 18 15 0 0 ML ab @!ofxyz @!\161\155&lt;/span&gt;
&lt;span class="s"&gt;0 19 15 0 0 ML @E @O @A @C @N @U @s @e @o @a @c @n @u&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;第1行：26个英文字母；大小写都可以；&lt;/p&gt;
&lt;p&gt;第2行：10个阿拉伯数字；&lt;/p&gt;
&lt;p&gt;第3行：键盘上可见的所有符号；（@和`除外）&lt;/p&gt;
&lt;p&gt;第4行：@是GMT中的转义字符，因而可以用@@来输入一个at符号，当然直接使用at符号的八进制码100；&lt;/p&gt;
&lt;p&gt;第5行：倒引号“`”在bash下具有特殊含义，因而必须使用221来表示该字符。这里还展示了其他几个用八进制码表示的字符；&lt;/p&gt;
&lt;p&gt;第6行：注意，这里选择的是12号字体，此时abcd会被自动转换为相应的希腊字母；&lt;/p&gt;
&lt;p&gt;第7行：这里选择的是12号字体，通过使用八进制码的方式生成希腊字母；猜测第六行的原理是先将英文字母转换为八进制，然后根据字体号输入相应的希腊字母；&lt;/p&gt;
&lt;p&gt;第8行：选择34号字体，生成各种符号；用字母表示；&lt;/p&gt;
&lt;p&gt;第9行：选择34号字体，生成各种符号；用八进制表示；&lt;/p&gt;
&lt;p&gt;第10行：@~可以临时将字体转换成symbol字体（即12号），因而可以很容易地在一个字符串中同时存在英语字母和希腊字母；&lt;/p&gt;
&lt;p&gt;第11行：@+可以打开或关闭上标；不支持上标的上标；上标和下标同时存在的支持不够；&lt;/p&gt;
&lt;p&gt;第12行：@-可以打开或关闭下标；不支持下标的下标；&lt;/p&gt;
&lt;p&gt;第13行：@#可以打开小型大小字母，THIS中HIS的高度比T高度稍小；&lt;/p&gt;
&lt;p&gt;第14行：@_产生下划线；&lt;/p&gt;
&lt;p&gt;第15行：@%fontno%可以修改接下来字符的字体，@%%使用前一个字体；@%12%与@=功能相同；&lt;/p&gt;
&lt;p&gt;第16行：@:size:修改文本大小，这里展示了各种不同的大小，@::的说明中给出的是“上一个字体大小”，但是实际的效果好像是默认字体大小；&lt;/p&gt;
&lt;p&gt;第17行：@;color;修改字体颜色，@;;回到默认颜色；&lt;/p&gt;
&lt;p&gt;第18行：@!会将接下来的两个字符重叠在一起，比如例子中的o和f就叠在一起了；&lt;/p&gt;
&lt;p&gt;第19行：其他一些可以使用@转义的特殊字符；&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;在不同的脚本语言中，某些符号可能具有特别的意义，因而无法直接生成，这个时候采用八进制码应该都可以解决问题；&lt;/li&gt;
&lt;li&gt;不支持上标和下标同时存在；&lt;/li&gt;
&lt;li&gt;在使用转义字符@之后，pstext命令无法准确计算文本的高度和宽度，导致pstext命令不能给文本加边框；&lt;/li&gt;
&lt;li&gt;很多用法不支持嵌套；&lt;/li&gt;
&lt;li&gt;无法稍复杂的公式，比如分数，比如二阶偏导，比如矢量箭头；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="GMT4"></category></entry><entry><title>GMT命令之用pstext在图上写入文本</title><link href="http://seisman.info/gmt-pstext.html" rel="alternate"></link><updated>2013-10-20T09:42:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-20:gmt-pstext.html</id><summary type="html">
&lt;p&gt;一张好图不仅仅是花花绿绿的颜色和各种样式的线条，还需要有必要的文字。GMT的-B选项可以设置坐标轴名、标签名、标题等，当需要在任意地方写任意字符串的时候则需要使用pstext命令。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
usage: pstext &amp;lt;txtfile&amp;gt; -J&amp;lt;params&amp;gt; -R&amp;lt;west&amp;gt;/&amp;lt;east&amp;gt;/&amp;lt;south&amp;gt;/&amp;lt;north&amp;gt;[/&amp;lt;zmin/zmax&amp;gt;][r]
    [-A] [-B&amp;lt;params&amp;gt;] [-C&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;] [-D[j]&amp;lt;dx&amp;gt;[/&amp;lt;dy&amp;gt;][v[&amp;lt;pen&amp;gt;]]
    [-E&amp;lt;azim&amp;gt;/&amp;lt;elev&amp;gt;[+w&amp;lt;lon&amp;gt;/&amp;lt;lat&amp;gt;[&amp;lt;z&amp;gt;][+v&amp;lt;x0&amp;gt;/&amp;lt;y0&amp;gt;]] [-G&amp;lt;color&amp;gt;]
    [-H[&amp;lt;nrec&amp;gt;]] [-K] [-L] [-N] [-O] [-P] [-S&amp;lt;pen&amp;gt;] [-U[&amp;lt;just&amp;gt;/&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;/][c language="|&amp;lt;label&amp;gt;"][/c]]
    [-V] [-W[&amp;lt;fill&amp;gt;,][o|O|c|C[&amp;lt;pen&amp;gt;]]] [-X[a|c|r]&amp;lt;x_shift&amp;gt;[u]]
    [-Y[a|c|r]&amp;lt;x_shift&amp;gt;[u]] [-Z[&amp;lt;zlevel&amp;gt;|+]] [-:[i|o]] [-c&amp;lt;ncopies&amp;gt;]
    [-f[i|o]&amp;lt;colinfo&amp;gt;] [-m[&amp;lt;flag&amp;gt;]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;文件格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;输入文件包含一个或多个记录，每个记录的格式如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
x y size angle fontno justify text
&lt;/pre&gt;
&lt;p&gt;其中&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;x、y：字符串在地图上的坐标位置；&lt;/li&gt;
&lt;li&gt;size：文本字体大小，单位为points；&lt;/li&gt;
&lt;li&gt;angle：文本相对于水平方向逆时针旋转的角度；&lt;/li&gt;
&lt;li&gt;fontno：字体号，系统默认字体号为0-34，可以通过&lt;tt class="docutils literal"&gt;pstext &lt;span class="pre"&gt;-L&lt;/span&gt;&lt;/tt&gt;命令获取GMT可用的所有字体；也可以直接用字体名来指定字体；&lt;/li&gt;
&lt;li&gt;justify：文本对齐方式，即确定文本的哪个点对应（x，y）坐标；对齐方式由两个字符构成，第一个字符是L、C、R中的一个，分别代表左、中、右；第二个字符为T、M、B中的一个，分别代表上、中、下；比如BL代表文本的左下角位于(x,y)处；&lt;/li&gt;
&lt;li&gt;text：要显示在地图上的字符串；除了最基本的英语字母、阿拉伯数字一些键盘上可见的符号之外，GMT还支持一些特殊字符及特殊效果，后面再说。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;基本选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;pstext的必须选项有-J和-R，对于三维图来还需要-Jz；&lt;/p&gt;
&lt;p&gt;其他一些标准选项包括：-B、-H、-K、-O、-P、-U、-V、-X、-Y、-：、-c、-f，不再多说。&lt;/p&gt;
&lt;p&gt;-Z是三维绘图中常用的一个选项，不说。&lt;/p&gt;
&lt;p&gt;最简单的例子如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
pstext -R0/10/0/10 -JX5i -B1g1f1/1f1g1 &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;5 5 25 45 0 CM TEST&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果图：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="fig 1" src="/images/2013102001.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;p&gt;由于justify选择了CM，所以字符串“&lt;span class="caps"&gt;TEST&lt;/span&gt;”的中心位于(5,5)处，然后整个字符串逆时针旋转了45度。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;专有选项&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="a"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;选项-A&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;输入文件中angle指定了“文本方向与水平方向逆时针旋转的角度”，加上-A选项后，angle的定义变成了“方位角”，也就是相对于北向顺时针旋转的角度。&lt;/p&gt;
&lt;!-- code-block::bash

#!/bin/bash
pstext -R0/360/-80/80 -JM5i -B30/30 -A &gt; a.ps &lt;&lt;EOF
180 30 25 0 0 CM TEXT1
180 -30 25 90 0 CM TEXT2
EOF
rm .gmt* --&gt;
&lt;div class="figure"&gt;
&lt;img alt="fig 1" src="/images/2013102002.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;p&gt;从图中可以看到，加上-A选项之后，angle=0时，文本为垂直向的，angle=90时，文本为水平向的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="w-c"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;选项-W和-C&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-W可以在文本的周围加上一个矩形框，并可以设置矩形的填充色，使用o、O、c、C设置矩形轮廓细节，并可以设置矩形边框的画笔属性。-C选项设置了边框与文本之间的距离，默认为当前字体大小的15%，也可以使用具体的长度比如1c作为间距。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
pstext -R0/2/0/2 -JX2i -B1f1g1/1f1g1 -P -W -K &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;1 1 25 0 0 CM TEXT1&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

pstext -R0/2/0/2 -JX2i -B1f1g1/1f1g1 -P -Wyellow,o3p,black,solid -K -O -X3i &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;1 1 25 0 0 CM TEXT2&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

pstext -R0/2/0/2 -JX2i -B1f1g1/1f1g1 -P -WO2p,blue -K -O -X-3i -Y3i &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;1 1 25 0 0 CM TEXT2&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

pstext -R0/2/0/2 -JX2i -B1f1g1/1f1g1 -P -W0/255/0,O2p,blue -C1c -K -O -X3i &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;1 1 25 0 0 CM TEXT3&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="fig 1" src="/images/2013102003.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;左下角的图是没有使用-W和-C的参考图；&lt;/li&gt;
&lt;li&gt;右下角的图设置填充颜色为yellow，o代表标准矩形轮廓，然后设置画笔属性为3p,black,solid；&lt;/li&gt;
&lt;li&gt;左上角的图没有设置填充颜色，此时矩形框内无填充颜色，O表示圆角矩形轮廓，画笔属性为2p,blue；&lt;/li&gt;
&lt;li&gt;右上角的图设置填充颜色为0/255/0；&lt;/li&gt;
&lt;li&gt;矩形轮廓还可以用c和C，其仅可以在段落模式中使用，后面再说；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="d"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;选项-D&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-D选项可以使得文本的实际位置相对(x,y)有一定的偏移，格式为-Ddx/dy，其中dx和dy分别为相对与(x,y)点的偏移量，在最后追加v可以在(x,y)和文本真实位置之间加上一条直线。还有一种使用方式是-Djdx/dy，没看懂其原理。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
pstext -R0/4/0/4 -JX8c -B1f1g1/1f1g1 -D1c/1cv &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;2 2 25 0 0 BL TEXT1&lt;/span&gt;
&lt;span class="s"&gt;1 1 25 0 0 CM TEXT2&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="fig 1" src="/images/2013102004.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="e"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;选项-E&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;设置视角，可以指定Azimuth和Elevation。该选项不仅仅对文本有效果，对整个绘图都会产生影响。从不同的方向看一张图，看到的图像是不同的。默认azimuth=180,elevation=90，即视线与纸张垂直。elevation=0即视线与纸张完全平行，此时什么也看不到，所以elevation=0是被禁止的。azimuth=180为正常的看图方式，azimuth=0相当于将图倒过来看。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="g"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;选项-G&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;设置文本颜色。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="l"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;选项-L&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;该选项会列出GMT支持的字体名及对应的字体号。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="n"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;选项-N&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-R设定了地图的区域，当文本位置(x,y)或者偏移之后的文本位置(x+dx,y+dy)超过了-R的范围，默认文本不会被显示。-N选项使得超过-R范围的文本依然显示。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
pstext -R0/4/0/4 -JX4c -B1f1g1/1f1g1 -Gred -K &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;3 0 25 0 0 CM TEXT&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

pstext -R0/4/0/4 -JX4c -B1f1g1/1f1g1 -Gred -N -O -X6c &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;3 0 25 0 0 CM TEXT&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="fig 1" src="/images/2013102005.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="s"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;选项-S&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;绘制文本的轮廓，注意这里是文本的轮廓，而不是矩形框的轮廓。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
pstext -R0/4/0/4 -JX4c -B1f1g1/1f1g1 -S3p,red &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;2 2 0 25 0 0 CM TEXT&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="fig 1" src="/images/2013102006.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="m"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;段落模式-m&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在其他命令中，-m一般表示输入文件是多段数据。在pstext命令中，其表示文本为段落模式。此时输入文件必须是多段文件，每段之间用特定记录隔开。该特定记录的格式如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
&amp;gt; x y size angle fontno justify linespace parwidth parjust
&lt;/pre&gt;
&lt;p&gt;首字符为"&amp;gt;"，第二个字符为空格，x、y、size、angle、fontno、justify与前面所说的相同。linespace为行间距，parwidth为段落的宽度，parjust为段落对齐方式，可以是l（左对齐）、c（居中对齐）、r（右对齐）、j（分散对齐）。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
pstext -R0/3/0/5 -JX3i -B1f1g1/1f1g1 -H -m -N -Y3i &amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;# x y size angle fontno justify linespace parwidth parjust&lt;/span&gt;
&lt;span class="s"&gt;&amp;gt; 0 -0.5 12 0 4 LT 13p 3i j&lt;/span&gt;
&lt;span class="s"&gt;@%5%Figure 1.@%% This illustration shows nothing useful, but it still needs&lt;/span&gt;
&lt;span class="s"&gt;a figure caption. Highlighted in @;255/0/0;red@;; you can see the locations&lt;/span&gt;
&lt;span class="s"&gt;of cities where it is @_impossible@_ to get any good Thai food; these are to be avoided.&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="fig 1" src="/images/2013102007.jpg" style="width: 300px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="GMT4"></category></entry><entry><title>打印维基百科页面</title><link href="http://seisman.info/wikipedia-print.html" rel="alternate"></link><updated>2013-10-17T08:17:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-17:wikipedia-print.html</id><summary type="html">&lt;p&gt;在看wikipedia的时候，经常遇到一些很好的页面，想要打印下来。原来都是利用浏览器自身的打印功能生成pdf，但是效果比较差，生成的文件布局和原网页布局不一致，公式以图片的形式给出，在A4纸上打印明显有模糊感。&lt;/p&gt;
&lt;p&gt;搜了一下，发现wikipedia的左边栏处提供了如下高质量打印页面的方法：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Create a&amp;nbsp;book&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;添加该页面作为书的一部分，然后wikipedia会帮忙生成高质量的pdf文件。这样就可以先搜集一下自己感兴趣的页面，然后一次性打印&lt;/p&gt;
&lt;ol class="arabic simple" start="2"&gt;
&lt;li&gt;Download as&amp;nbsp;pdf&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;直接将该页面渲染为pdf文件，此种方法基本保留了原有的一切布局，文字部分应该是矢量的，字体看上去也很漂亮，比直接浏览器打印效果要好，公式方面依然是图片格式，但只要放大倍率在300%以内，公式效果还是非常好的。&lt;/p&gt;
&lt;p&gt;注：貌似目前只有wikipedia提供打印，维基百科不提供。&lt;/p&gt;
</summary></entry><entry><title>Perl中的时间加法</title><link href="http://seisman.info/timespan-in-perl.html" rel="alternate"></link><updated>2013-10-16T09:02:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-16:timespan-in-perl.html</id><summary type="html">
&lt;p&gt;数据申请的过程中，经常需要处理的一个问题是：已知某时刻，在该时刻的基础上加上一段时间之后对应的时刻是多少？&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;基本解法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;最朴素的思想是自己写一个程序：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;把该时刻的年月日时分秒分别加上一个时间间隔；&lt;/li&gt;
&lt;li&gt;检查秒数，若秒数大于60，则秒数减60同时分钟数加1；&lt;/li&gt;
&lt;li&gt;检查分钟，若分钟数大于60，则分钟数减60同时小时数加1；&lt;/li&gt;
&lt;li&gt;检查小时，若小时大于24，则小时数减24同时天数加1；&lt;/li&gt;
&lt;li&gt;根据当前月份确定当前月有多少天，如果超过该天数，则减去天数值，月份进1；这里大概要做12次判断，同时还要考虑闰年的问题；&lt;/li&gt;
&lt;li&gt;然后就发现这样的办法太麻烦了。。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;高级解法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;更高端一些的解法是，计算当前时刻与某个特定时刻的秒数差，然后再加上时间间隔，再将新的秒数差转换为时刻。&lt;/p&gt;
&lt;p&gt;其实程序写起来依然很麻烦。在Perl中，已经有相当多的模块可以用于解决这个问题，直接调用即可。Perl模块的强大之处即在此，这也是我不再使用Bash的一个原因。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="timegm"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;timegm&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Perl的模块Time::Local下有个函数，叫做timegm。其用法如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$time = timegm( $sec, $min, $hour, $mday, $mon, $year );
&lt;/pre&gt;
&lt;p&gt;输入参数有6个（默认情况下，该函数会进行输入检查，以确保这六个元素给定的时间的存在性。）：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;$sec：秒（0-59）；&lt;/li&gt;
&lt;li&gt;$min：分（0-59）；&lt;/li&gt;
&lt;li&gt;$hour：时（0-23）&lt;/li&gt;
&lt;li&gt;$mday：每月的第几天（1-31）；&lt;/li&gt;
&lt;li&gt;$mon：月份&lt;strong&gt;（0-11）&lt;/strong&gt;；&lt;/li&gt;
&lt;li&gt;$year：年份；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;关于年份，其范围要复杂一些：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;如果$year&amp;gt;999，则将其解释为真实的年份；&lt;/li&gt;
&lt;li&gt;如果$year在100到999之间，则将其解释为与1900年的年份差；&lt;/li&gt;
&lt;li&gt;如果$year在0到99之间，规则已经复杂的没有必要了。。。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于实际应用来说，前两条规则就够用了。&lt;/p&gt;
&lt;p&gt;该函数的输出是当前时刻&lt;strong&gt;相对于1970年1月1日午夜的秒数&lt;/strong&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gmtime"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;gmtime&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Perl内置一个函数gmtime，Time::Local模块里的timegm实际上是该函数的逆函数。&lt;/p&gt;
&lt;p&gt;其用法如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
($sec ,$min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = gmtime($time);
&lt;/pre&gt;
&lt;p&gt;其输入是相对于1970年1月1日午夜的秒数。&lt;/p&gt;
&lt;p&gt;其输出有9个元素：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;$sec：秒（0-59）；&lt;/li&gt;
&lt;li&gt;$min：分（0-59）；&lt;/li&gt;
&lt;li&gt;$hour：时（0-23）&lt;/li&gt;
&lt;li&gt;$mday：每月的第几天（1-31）；&lt;/li&gt;
&lt;li&gt;$mon：月份&lt;strong&gt;（0-11）&lt;/strong&gt;；&lt;/li&gt;
&lt;li&gt;$year：年份-1900；&lt;/li&gt;
&lt;li&gt;$wday：周的第几天（0-6）；0代表周日，1代表周一；&lt;/li&gt;
&lt;li&gt;$yday：一年的第几天（0-364或者0-365）；&lt;/li&gt;
&lt;li&gt;$isdst：是否是夏令时（0-1）&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;脚本实现&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="c1"&gt;# Example to show the use of time_add&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Time::&lt;/span&gt;&lt;span class="n"&gt;Local&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;# 当前时刻为2013年10月12日04时5分0秒&lt;/span&gt;
&lt;span class="c1"&gt;#   - 04时或者4时都可以&lt;/span&gt;
&lt;span class="c1"&gt;#   - 10月是真正的10月&lt;/span&gt;
&lt;span class="c1"&gt;#   - 子函数中的变量与主函数中变量相互独立&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$year&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2013&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$mon&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mo"&gt;04&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$sec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;# 时间差，5分15秒&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$span&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;"BEFORE $year/$mon/$day $hour:$min:$sec\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;time_add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$span&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;"AFTER  $year/$mon/$day $hour:$min:$sec\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;


&lt;span class="c1"&gt;# 子程序&lt;/span&gt;
&lt;span class="k"&gt;sub &lt;/span&gt;&lt;span class="nf"&gt;time_add&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
    &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$timespan&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;@_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$wday&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$yday&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$isdast&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;# 函数的月份范围为0-11&lt;/span&gt;
    &lt;span class="nv"&gt;$mon&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# 计算该时刻与1970年1月1日午夜的秒数差&lt;/span&gt;
    &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;timegm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;# 将该秒数加上一个时间差&lt;/span&gt;
    &lt;span class="nv"&gt;$time&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nv"&gt;$timespan&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# 将时间差转换为具体的时刻&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$wday&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$yday&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$isdast&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;gmtime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$time&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;# 对年份和月份特殊处理&lt;/span&gt;
    &lt;span class="nv"&gt;$year&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1900&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nv"&gt;$mon&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# 返回&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;参考来源&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Perl 中的时间： &lt;a class="reference external" href="http://cn.perlmaven.com/the-year-19100"&gt;http://cn.perlmaven.com/the-year-19100&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Perl内置文档： &lt;a class="reference external" href="http://perldoc.perl.org/functions/localtime.html"&gt;http://perldoc.perl.org/functions/localtime.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Time::Local模块： &lt;a class="reference external" href="http://perldoc.perl.org/Time/Local.html"&gt;http://perldoc.perl.org/Time/Local.html&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="Perl"></category><category term="时间"></category><category term="模块"></category></entry><entry><title>用Matlab处理SAC数据的一些脚本</title><link href="http://seisman.info/matlab-scripts-for-sac.html" rel="alternate"></link><updated>2013-10-14T06:19:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-14:matlab-scripts-for-sac.html</id><summary type="html">
&lt;p&gt;我是那种乖乖用SAC处理sac数据的人。身边有些老师及其学生比较喜欢用matlab处理sac数据，故而这里还是收集一下相关脚本，以造福部分人。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;来源1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;其实SAC包中自带了一些matlab脚本。&lt;/p&gt;
&lt;p&gt;在sac/utils目录下有四个matlab脚本，作者Xiaoning Yang，具体功能看文件名，具体用法看脚本：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
getsacdata.m  padcat.m  readsac.m  writesac.m
&lt;/pre&gt;
&lt;p&gt;在sac/aux/mat目录有62个脚本文件，看上去功能很齐全，可能是SAC调用matlab引擎后可以执行的一些命令，不确定是否可以直接调用：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
arrow3d.m              GetFiles2.m          mat.m           SaveResults.m
BAZauto.m              GetFiles.m           mkAxisSymb.m    ScrollHelp.m
BAZ.m                  getMisFit.m          mkcircle.m      setAZIM.m
ButtonRelease.m        getReferenceTime.m   MLest.m         setDomain.m
CalcMLM.m              getWinPolariz.m      MLMcallback.m   setELEV.m
closePPM.m             hclose.m             mlm.m           SetFilter.m
crosshair.m            inspCallbacks.m      NextGroup.m     SetHighCorner.m
deleteDuplicatePick.m  inspector.m          plotmain.m      SetLowCorner.m
DeletePick.m           inspFigure.m         ppm3.m          SetOrder.m
DispatchButtonPress.m  inspRealPlot.m       PrevGroup.m     SetPickType.m
DispatchKeys.m         inspToolbar.m        printfig.m      SetUpSlider.m
DispatchMouseMove.m    magnifyTrces.m       quitP.m         SetWaveType.m
dispHelp.m             MainButtonPress.m    RedrawSeis.m    UpdatePPMplot.m
DoRotations.m          MainButtonRelease.m  RotateToBAZ.m   Winpolariz.m
drawRect.m             MainMouseMove.m      SacCheck.m
filterTraces.m         makeFigure.m         SaveResults2.m
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;来源2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Prof. Zhigang Peng或收集、或编写、或改写了部分matlab脚本，如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
fget_sac.m newSacHeader.m  rdSacHead.m  rdSac.m  sacfft.m  sachdr.m  sac.m wtSac.m
&lt;/pre&gt;
&lt;p&gt;其下载地址位于： &lt;a class="reference external" href="http://geophysics.eas.gatech.edu/people/zpeng/Teaching/MatSAC.tar.gz"&gt;http://geophysics.eas.gatech.edu/people/zpeng/Teaching/MatSAC.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;具体用法可以看脚本或者点击&lt;a class="reference external" href="http://geophysics.eas.gatech.edu/classes/SAC/"&gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;来源3&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Prof. Michael Thorne写了几个matlab脚本：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
rsac.m - Read SAC binary
wsac.m - Write SAC binary
bsac.m - Be SAC - convert Matlab array to saclab format
lh.m - List header
ch.m - Change header
p1.m - Plot traces (one plot per subplot) - Example screenshot
p2.m - Plot traces (overlay traces) - Example screenshot
marktimes.m - Calculate travel times and put in SAC header (by Sean Ford)
&lt;/pre&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://web.utah.edu/thorne/software.html"&gt;http://web.utah.edu/thorne/software.html&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</summary><category term="SAC技巧"></category><category term="Matlab"></category></entry><entry><title>实现进度条的模块</title><link href="http://seisman.info/perl-progressbar.html" rel="alternate"></link><updated>2013-10-13T09:08:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-13:perl-progressbar.html</id><summary type="html">&lt;p&gt;Term::ProgressBar模块是一个可以用于生成进度条的Perl模块。&lt;/p&gt;
&lt;p&gt;最小脚本，展示如何最快学会使用该模块：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Term::&lt;/span&gt;&lt;span class="n"&gt;ProgressBar&lt;/span&gt; &lt;span class="mf"&gt;2.00&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$max&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;50000000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$progress&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nn"&gt;Term::&lt;/span&gt;&lt;span class="n"&gt;ProgressBar&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$max&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$next_update&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="nv"&gt;$max&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nv"&gt;$next_update&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="nv"&gt;$progress&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="c1"&gt;# 更新进度条&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="nv"&gt;$next_update&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nv"&gt;$progress&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$max&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;          &lt;span class="c1"&gt;# 保证进度条为100%&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;$max&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="nv"&gt;$next_update&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;最全脚本，包含了所有功能和设置：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Term::&lt;/span&gt;&lt;span class="n"&gt;ProgressBar&lt;/span&gt; &lt;span class="mf"&gt;2.00&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$max&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;50000000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$progress&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nn"&gt;Term::&lt;/span&gt;&lt;span class="n"&gt;ProgressBar&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt;    &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="s"&gt;&amp;#39;Counts&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="c1"&gt;# 进度条名&lt;/span&gt;
    &lt;span class="n"&gt;count&lt;/span&gt;   &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="nv"&gt;$max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;       &lt;span class="c1"&gt;# 总数&lt;/span&gt;
    &lt;span class="n"&gt;remove&lt;/span&gt;  &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;          &lt;span class="c1"&gt;# 结束后进度条是否消失&lt;/span&gt;
    &lt;span class="n"&gt;ETA&lt;/span&gt;     &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="s"&gt;&amp;#39;linear&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="c1"&gt;# 估计剩余时间,undef || linear&lt;/span&gt;
&lt;span class="c1"&gt;#   major_char =&amp;gt; &amp;#39;=&amp;#39;,       # major 进度条字符&lt;/span&gt;
&lt;span class="c1"&gt;#   minor_char =&amp;gt; &amp;#39;*&amp;#39;,       # minor 进度条字符&lt;/span&gt;
&lt;span class="c1"&gt;#   fh      =&amp;gt;   \*STDERR,   # 输出的文件句柄，\*STDERR || \*STDOUT&lt;/span&gt;
&lt;span class="c1"&gt;#   term_width =&amp;gt; 50,        # 终端宽度&lt;/span&gt;
&lt;span class="c1"&gt;#   silent  =&amp;gt;   0,          # 若为1，则该模块不进行任何操作&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;

&lt;span class="c1"&gt;# $progress-&amp;gt;target($max*2); # 重定义count值&lt;/span&gt;
&lt;span class="c1"&gt;# $progress-&amp;gt;minor(0);       # 关闭minor进度条&lt;/span&gt;
&lt;span class="c1"&gt;# $progress-&amp;gt;max_update_rate(0.5);   # 两次更新的最小时间间隔(s)&lt;/span&gt;
&lt;span class="c1"&gt;# $progress-&amp;gt;lbrack(&amp;#39;[&amp;#39;);    # 进度条左符号&lt;/span&gt;
&lt;span class="c1"&gt;# $progress-&amp;gt;rbrack(&amp;#39;]&amp;#39;);    # 进度条右符号&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$next_update&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="nv"&gt;$max&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt; &lt;span class="nv"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;1000000&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nv"&gt;$progress&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;          &lt;span class="c1"&gt;# 输出信息，但保证进度条在输出信息的下方&lt;/span&gt;
            &lt;span class="nb"&gt;sprintf&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Found %d\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt;
        &lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="nv"&gt;$next_update&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="nv"&gt;$progress&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="c1"&gt;# 更新进度条&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="nv"&gt;$next_update&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nv"&gt;$progress&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$max&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;          &lt;span class="c1"&gt;# 保证进度条为100%&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;$max&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="nv"&gt;$next_update&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;参考来源：&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;CPAN&lt;/span&gt;：&lt;a class="reference external" href="http://search.cpan.org/~szabgab/Term-ProgressBar-2.14/lib/Term/ProgressBar.pm"&gt;http://search.cpan.org/~szabgab/Term-ProgressBar-2.14/lib/Term/ProgressBar.pm&lt;/a&gt;&lt;/p&gt;
</summary><category term="Perl"></category><category term="模块"></category><category term="用法"></category></entry><entry><title>GMT进阶之-B选项中的冒号</title><link href="http://seisman.info/gmt-option-b-colon.html" rel="alternate"></link><updated>2013-10-12T09:15:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-12:gmt-option-b-colon.html</id><summary type="html">
&lt;p&gt;-B选项是GMT的常用选项之一，其除了可以设置刻度之外，还可以设置标题、坐标轴名、注释前缀以及单位。在绘图的过程中遇到一个非常有趣的问题，总结如下。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;问题描述&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;如下图，想要用-B选项给图加上标题，标题的格式为&lt;tt class="docutils literal"&gt;Title : eltiT&lt;/tt&gt;，即想要在标题中加个冒号，为了增加问题的复杂度，标题中还有空格。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013101201.png" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="bash"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;Bash实现&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;无冒号的写法&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
psbasemap -R0/5/0/5 -JX5i -B1/1:.&lt;span class="s2"&gt;"Title eltiT"&lt;/span&gt;: &amp;gt; a.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;:."string":&lt;/span&gt;&lt;/tt&gt;这样的方式可以很容易的加上标题，由于字符串中有空格，所以需要用双引号（或单引号）将标题字符串括起来。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;经典错误写法&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;根据无冒号时候的写法，很容易想当然地直接在标题字符串中加上冒号，如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
psbasemap -R0/5/0/5 -JX5i -B1/1:.&lt;span class="s2"&gt;"Title : eltiT"&lt;/span&gt;: &amp;gt; a.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;直接运行报错如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psbasemap: ERROR: Missing terminating colon in -B string 1ltiT:\
&lt;/pre&gt;
&lt;p&gt;这样的写法为什么错呢？在-B选项中，冒号被用作为分界符，一对冒号包围了一个标题或一个坐标轴名或单位。上面的例子中，直接加上一个冒号之后形成了三个冒号的尴尬局面，GMT默认将离得最近的两个冒号当成一对分界符，然后最后的一个冒号就悲剧了，然后报错。上面给出的错误信息只是常见的错误信息之一。另外，上面的写法用单引号也是错误的。理由相同。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;正确写法&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;既然-B选项把冒号当作分界符，那么字符串中就不能再出现&lt;tt class="docutils literal"&gt;:&lt;/tt&gt;了，考虑用冒号的八进制编码来表示冒号。查查GMT官方文档的附录F可以知道冒号对应的八进制编码为&lt;tt class="docutils literal"&gt;\072&lt;/tt&gt;。脚本如下所示：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
psbasemap -R0/5/0/5 -JX5i -B1/1:.&lt;span class="s2"&gt;"Title \072 eltiT"&lt;/span&gt;: &amp;gt; a.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;为什么用八进制表示冒号就可以呢？GMT对-B选项进行解释时，遇到了":."，代表着接下来的字符串是标题，然后往后寻找找到下一个冒号":"，并将":."和":"之间的字符串作为标题。那么对于这种情况来说这个字符串就是"Title 072 eltiT"（引号不是字符串的一部分）。由于GMT是用C语言写的，当把字符串"Title 072 eltiT"用类似printf("Title 072 eltiT")的语法写到PS文件中时，就变成了"Title : eltiT"。即字符串以"Title 072 eltiT"的形式被GMT解释，然后以"Title : eltiT"的形式被C打印出来。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="perl"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;Perl实现&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;对于习惯使用Perl的人来说，不要以为仅仅知道上面一点就结束了，Perl实现起来比Bash要更复杂一些。&lt;/p&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;无冒号写法&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在Perl中通过system函数来调用系统命令来运行GMT。当然也可以使用倒引号调用系统命令，倒引号敲起来更简单，但是其运行效率相对system更低，不可滥用。&lt;/p&gt;
&lt;p&gt;对于system函数来说，参数需要放在引号中，引号中的内容是要调用的系统命令及系统命令的参数。这里存在至少两对引号，system参数所需要的引号以及带空格的字符串所需要的引号。&lt;/p&gt;
&lt;p&gt;下面两种写法使用了两种引号，因而是对的：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;"psbasemap -R0/10/0/10 -JX6i -B1/1:.'Title eltiT': &amp;gt; a.ps"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;'psbasemap -R0/10/0/10 -JX6i -B1/1:."Title eltiT": &amp;gt; a.ps'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;下面两种写法只用了一种引号，因而会出现无法正确分界的问题：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;"psbasemap -R0/10/0/10 -JX6i -B1/1:."&lt;/span&gt;&lt;span class="n"&gt;Title&lt;/span&gt; &lt;span class="n"&gt;eltiT&lt;/span&gt;&lt;span class="s"&gt;": &amp;gt; a.ps"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;'psbasemap -R0/10/0/10 -JX6i -B1/1:.'&lt;/span&gt;&lt;span class="n"&gt;Title&lt;/span&gt; &lt;span class="n"&gt;eltiT&lt;/span&gt;&lt;span class="s"&gt;': &amp;gt; a.ps'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;经典错误写法&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在吸取了bash的经验教训之后，知道可以用"072"来表示冒号，脚本如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;"psbasemap -R0/10/0/10 -JX6i -B1/1:.'Title \072 eltiT': &amp;gt; a.ps"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这种写法为什么是错的？因为perl首先会对system的参数（即双引号内的值）进行解释，双引号内的单引号被当作普通字符来解释（而不是任何分界符），而在双引号内反斜杠是可以转义的，因而072被转义为":"，然后再调用psbasemap命令，即真正传给psbasemap并运行的命令其实是&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psbasemap -R0/10/0/10 -JX6i -B1/1:.'Title : eltiT': &amp;gt; a.ps
&lt;/pre&gt;
&lt;p&gt;这相当于Bash的经典错误写法。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;一种正确的写法&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;'psbasemap -R0/10/0/10 -JX6i -B1/1:."Title \072 eltiT": &amp;gt; a.ps'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这种写法为什么是正确的呢？因为Perl首先要对参数进行内插，由于参数是由单引号括起来的，此时双引号被当作普通字符而不是分界符，而单引号内反斜杠可以转义的字符只有单引号以及反斜杠，因而在单引号内072不会被解释。那么传送给psbasemap的命令实际上就是&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psbasemap -R0/10/0/10 -JX6i -B1/1:."Title \072 eltiT": &amp;gt; a.ps
&lt;/pre&gt;
&lt;p&gt;这相当于Bash中的正确写法。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;正确写法在变量内插时遇到的问题&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;使用Perl而不是Bash的一个重要理由在于，Perl在字符串处理以及数值计算方面相对Bash来说要有很大的优势。因而用Perl写脚本的时候，如果仅仅只是像上面那个例子那样单引号内只有一堆字符就没有意义了。更常见的情况是system的参数中含有一些变量，如下所示：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nv"&gt;$R&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"0/10/0/10"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;$J&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"X6i"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;'psbasemap -R$R -J$J -B1/1:."Title \072 eltiT": &amp;gt; a.ps'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这样写是错误的，因为单引号内变量$R和$J都不会被内插，所以传送给psbasemap的是无意义的参数。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id22"&gt;错误写法修正版&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;单引号内的变量不会被内插是肯定的了，但是变量不可能不用，那就只能把错误写法修改一下啦：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class="nv"&gt;$R&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"0/10/0/10"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;$J&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"X6i"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;system&lt;/span&gt; &lt;span class="s"&gt;"psbasemap -R$R -J$J -B1/1:.'Title \\072 eltiT': &amp;gt; a.ps"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这里的修改在于将"072"改成了"\072"，这样perl会将"\"解释为""，然后进行系统调用，因而此时传给psbasemap的参数实际上是&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psbasemap -R0/10/0/10 -JX6i -B1/1:.'Title \072 eltiT': &amp;gt; a.ps
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;一切罪恶的来源都来自于转义字符。由于需要使用一些特殊字符，就一定会需要转义字符，同时还需要方便的使用转义字符本身这个字符。因而什么时候会转义、什么时候不会转义，就显得额外重要了。对于多个不同语言或者不同命令相互调用的时候，转义就更加重要了。&lt;/p&gt;
&lt;p&gt;以Bash为例，bash本身是个空壳，基本不具有任何数据处理能力，因而常常需要借助于awk、grep、sed等命令。Bash中的变量以$作为标识符，awk的变量也以$作为标识符，当在bash中用awk时，就存在一个问题：眼前的$变量到底是bash去解释还是awk去解释。awk为了凑合bash，采用了如下的设计：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
awk '{print $1}' infile
&lt;/pre&gt;
&lt;p&gt;当在bash中调用awk时，由于单引号的存在，bash不会对$1进行解释，此时$1交给awk取解释，这也许是你想要的。但是有些时候，如果真的想要将bash的变量$par交给awk就会出现问题：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
awk '{print $par,$1}' infile
&lt;/pre&gt;
&lt;p&gt;由于单引号的存在，awk看到的是字符"$par"，而不是变量$par的值，所以$par交给了awk取解释，而awk又不认识变量$par，就会出现问题。为了解决bash向awk传递变量的问题，awk设计了-v选项，感觉问题一下子就被复杂化了。相反，perl是一个自给自足的体系，就不会存在类似的设计缺陷了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id24"&gt;参考来源&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;1.Perl的单引号字符直接量： &lt;a class="reference external" href="http://seisman.info/single-quoted-string-literals-in-perl.html"&gt;http://seisman.info/single-quoted-string-literals-in-perl.html&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="GMT选项"></category><category term="GMT4"></category><category term="Perl"></category></entry><entry><title>如何生成GMT网格数据(III)</title><link href="http://seisman.info/generate-arcinfo-file-for-gmt-grid.html" rel="alternate"></link><updated>2013-10-11T09:26:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-11:generate-arcinfo-file-for-gmt-grid.html</id><summary type="html">
&lt;p&gt;GMT支持ESRI ArcInfo ASCII格式的数据，这种数据格式是以ASCII方式写入文件的，因而速度上效率并不高；文件只写入了所有网格点的Z值以及一些头段信息，因而相对ASCII格式的XYZ数据来说，文件大小会小很多。&lt;/p&gt;
&lt;p&gt;最关键的一点在于，这种格式的数据，头段中包含了与网格有关的全部信息，利用xyz2grd进行转换时非常方便。因而这篇说说如何生成ArcInfo ASCII格式的数据，并将该数据转换为GMT可识别的网格文件并绘图。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;网格描述&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;要生成一个12*8的网格，网格间隔为0.5，每个网格点的值为1或者-1。(0,0)点位于网格区域的左下角。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="c-code"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;C Code&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ArcInfo ASCII数据有两种不同的格式，分别对应于GMT中所说的gridline registration和pixel registered。&lt;/p&gt;
&lt;p&gt;关于ArcInfo ASCII格式的具体信息，可以参考&lt;a class="reference external" href="http://help.arcgis.com/zh-cn/arcgisdesktop/10.0/help/index.html#//009t0000000z000000"&gt;ArcGIS的官方简短说明&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;该C代码同时生成两种格式的ArcInfo ASCII数据：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt; * Filename: grid.c&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#define NX 12&lt;/span&gt;
&lt;span class="cp"&gt;#define NY 8&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;// 为每个网格点赋值&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// 第一个文件，该网格采用gridline registration&lt;/span&gt;
    &lt;span class="n"&gt;fop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"ArcInfo1.dat"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"w"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"nclos %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"nrows %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"xllcenter %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;              &lt;span class="c1"&gt;// !!!!!&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"yllcenter %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;              &lt;span class="c1"&gt;// !!!!!&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"cellsize %f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"NODATA_VALUE %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;9999&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
        &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"%d "&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;fclose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="c1"&gt;// 第二个文件，该网格采用pixel registration&lt;/span&gt;
    &lt;span class="n"&gt;fop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"ArcInfo2.dat"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"w"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"nclos %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"nrows %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"xllcorner %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;            &lt;span class="c1"&gt;// !!!!&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"yllcorner %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;            &lt;span class="c1"&gt;// !!!!&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"cellsize %f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"NODATA_VALUE %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;9999&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
        &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"%d "&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;fclose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;文件转换方式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;由于ArcInfo ASCII格式的头段中已经包含了足够的信息，因而该格式的转换非常简单：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd ArcInfo.dat -GArcInfo.grd -E
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;完整示例&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/5.5/0/3.5

&lt;span class="c"&gt;# 生成数据&lt;/span&gt;
./grid

&lt;span class="c"&gt;# 转换并绘制第一个文件&lt;/span&gt;
xyz2grd ArcInfo1.dat -GArcInfo1.grd -E
grd2cpt ArcInfo1.grd -Cgray &amp;gt; ArcInfo1.cpt
grdimage ArcInfo1.grd -B1/1 -R&lt;span class="nv"&gt;$R&lt;/span&gt; -CArcInfo1.cpt -JX9i/6i -X1.2i &amp;gt; checkboard1.ps

&lt;span class="c"&gt;# 转换并绘制第二个文件&lt;/span&gt;
xyz2grd ArcInfo2.dat -GArcInfo2.grd -E
grd2cpt ArcInfo2.grd -Cgray &amp;gt; ArcInfo2.cpt
grdimage ArcInfo2.grd -B1/1 -R&lt;span class="nv"&gt;$R&lt;/span&gt; -CArcInfo2.cpt -JX9i/6i -X1.2i &amp;gt; checkboard2.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013101101.jpg"/&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013101102.jpg"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该方法的优点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;数据只写入Z值和头段，相对XYZ文件来说更小；&lt;/li&gt;
&lt;li&gt;所有必须的信息都位于头段中，数据转换简单。&lt;/li&gt;
&lt;li&gt;数据写入方式固定；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;该方法的缺点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;生成的数据文件虽然为ASCII文件，但是难以直接查看其细节。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="格式转换"></category><category term="网格"></category><category term="GMT4"></category></entry><entry><title>如何生成GMT网格文件(II)</title><link href="http://seisman.info/generate-z-file-for-gmt-grid.html" rel="alternate"></link><updated>2013-10-10T08:36:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-10:generate-z-file-for-gmt-grid.html</id><summary type="html">
&lt;p&gt;这篇说说如何生成二进制格式的Z数据，并将该数据转换为GMT可识别的网格文件并绘图。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;网格描述&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;要生成一个12*8的网格，网格间隔为0.5，每个网格点的值为1或者-1。(0,0)点位于网格区域的左下角。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="c-code"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;C Code&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该C代码生成二进制格式的Z数据：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#define NX 12&lt;/span&gt;
&lt;span class="cp"&gt;#define NY 8&lt;/span&gt;
&lt;span class="cp"&gt;#define DELTA 0.5&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;// 给网格点赋值&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;// 写二进制Z文件，起点位于(0,0)点，行优先格式写入&lt;/span&gt;
    &lt;span class="n"&gt;fop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"z.dat"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"wb"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;fwrite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;fclose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;文件转换方式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Z数据生成之后，需要转换成可被GMT识别的NetCDF格式。&lt;/p&gt;
&lt;p&gt;数据转换需要如下信息：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;数据范围是-R0/5.5/0/3.5，数据间隔为-I0.5/0.5；&lt;/li&gt;
&lt;li&gt;数据的第一个点位于区域的左下角；&lt;/li&gt;
&lt;li&gt;数据按照行优先方式写入，即先从左向右写入Y=0列，再从左向右写入Y=1列，如此类推。。。&lt;/li&gt;
&lt;li&gt;数据是以int型存储的，即4字节。&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="literal-block"&gt;
xyz2grd z.dat -Gz.grd -I0.5/0.5 -R0/5.5/0/3.5 -ZBLi
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;完整示例&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/5.5/0/3.5

&lt;span class="c"&gt;# 生成XYZ数据&lt;/span&gt;
./grid
&lt;span class="c"&gt;# xyz数据转换为NetCDF格式&lt;/span&gt;
xyz2grd z.dat -Gz.grd -I0.5/0.5 -R&lt;span class="nv"&gt;$R&lt;/span&gt; -ZBLi
&lt;span class="c"&gt;# 生成cpt文件&lt;/span&gt;
grd2cpt z.grd -Cgray &amp;gt; z.cpt
&lt;span class="c"&gt;# 利用生成的网格绘图&lt;/span&gt;
grdimage z.grd -B1/1 -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Cz.cpt -JX9i/6i -X1.2i &amp;gt; checkboard.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="checkboard" src="/images/2013101001.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该方法的优点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;数据以二进制格式保存，数据文件更小；&lt;/li&gt;
&lt;li&gt;数据以二进制文件写入磁盘，速度更快；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;该方法的缺点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;生成的数据文件为二进制文件，无法直接打开查看其细节。&lt;/li&gt;
&lt;li&gt;写数据文件时，第一个点可以选择左上、右上、左下、右下角，可以按行优先或列优先方式，因而共8种写数据的方式。&lt;/li&gt;
&lt;li&gt;数据中只有每个点的值，没有任何数据范围、网格间隔的信息；这些信息只能从其他地方获取；&lt;/li&gt;
&lt;li&gt;需要知道写数据时的数据类型；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="格式转换"></category><category term="网格"></category><category term="GMT4"></category></entry><entry><title>如何生成GMT网格数据(I)</title><link href="http://seisman.info/generate-xyz-file-for-gmt-grid.html" rel="alternate"></link><updated>2013-10-09T10:55:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-09:generate-xyz-file-for-gmt-grid.html</id><summary type="html">
&lt;p&gt;这个系列计划有四篇博文，讲述如何自己写程序生成网格数据，以供GMT的grdimage或者grdcontour命令绘图所用。&lt;/p&gt;
&lt;p&gt;四篇博文分别介绍四种可以用于GMT绘图的数据格式，分别为&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ASCII的XYZ数据&lt;/li&gt;
&lt;li&gt;二进制的Z数据&lt;/li&gt;
&lt;li&gt;ArcInfo ASCII交换网格格式&lt;/li&gt;
&lt;li&gt;NetCDF格式&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这篇先说说最简单的，如何生成ASCII格式的XYZ数据，并将该数据转换为GMT可识别的网格文件并绘图。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;网格描述&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;要生成一个12*8的网格，网格间隔为0.5，每个网格点的值为1或者-1。(0,0)点位于网格区域的左下角。&lt;/p&gt;
&lt;p&gt;这其实是在生成一个非常小的checkboard，12*8的网格很小，但是足以说明问题，X方向和Y方向网格点数不同、网格间隔为0.5，又稍稍增加了问题的复杂度。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="c-code"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;C Code&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该C代码生成ASCII格式的XYZ数据：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt; * Filename: grid.c&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
 &lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
 &lt;span class="cp"&gt;#define NX 12&lt;/span&gt;
 &lt;span class="cp"&gt;#define NY 8&lt;/span&gt;
 &lt;span class="cp"&gt;#define DELTA 0.5&lt;/span&gt;

 &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt;
 &lt;span class="p"&gt;{&lt;/span&gt;
     &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
     &lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

 &lt;span class="c1"&gt;// 给每个网格点赋值&lt;/span&gt;
     &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
       &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
         &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
             &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
             &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="p"&gt;}&lt;/span&gt;
     &lt;span class="p"&gt;}&lt;/span&gt;

 &lt;span class="c1"&gt;// 写入ASCII XYZ数据到文件xyz.dat&lt;/span&gt;
     &lt;span class="n"&gt;fop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"xyz.dat"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"w"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
     &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
       &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
         &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"%3.1f %3.1f %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;DELTA&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;DELTA&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
     &lt;span class="n"&gt;fclose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

     &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;文件转换方式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;生成的数据的前几列如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
0.0 0.0 1
0.5 0.0 -1
1.0 0.0 1
1.5 0.0 -1
2.0 0.0 1
2.5 0.0 -1
3.0 0.0 1
3.5 0.0 -1
4.0 0.0 1
&lt;/pre&gt;
&lt;p&gt;XYZ数据生成之后，需要转换成可被GMT识别的NetCDF格式。&lt;/p&gt;
&lt;p&gt;已知网格维度为12*8，网格间隔为0.5，因而可知数据的范围是-R0/5.5/0/3.5，数据间隔为-I0.5/0.5。因而使用如下命令进行转换：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd xyz.dat -Gxyz.grd -I0.5/0.5 -R0/5.5/0/3.5
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;完整示例&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/5.5/0/3.5

&lt;span class="c"&gt;# 生成XYZ数据&lt;/span&gt;
./grid
&lt;span class="c"&gt;# xyz数据转换为NetCDF格式&lt;/span&gt;
xyz2grd xyz.dat -Gxyz.grd -I0.5/0.5 -R&lt;span class="nv"&gt;$R&lt;/span&gt;
&lt;span class="c"&gt;# 生成cpt文件&lt;/span&gt;
grd2cpt xyz.grd -Cgray &amp;gt; xyz.cpt
&lt;span class="c"&gt;# 利用生成的网格绘图&lt;/span&gt;
grdimage xyz.grd -B1/1 -R&lt;span class="nv"&gt;$R&lt;/span&gt; -Cxyz.cpt -JX4i/2i &amp;gt; checkboard.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="checkboard" src="/images/2013100901.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该方法的优点在于：简单。&lt;/p&gt;
&lt;p&gt;该方法的缺点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;数据以ASCII格式保存，对于大型网格，数据文件会比较庞大，占用大量硬盘空间(比如1200*800的网格，文件大小大概是13M甚至更多)。&lt;/li&gt;
&lt;li&gt;数据以ASCII格式写入磁盘，读写速度相对二进制格式要慢很多，降低程序速度；&lt;/li&gt;
&lt;li&gt;数据生成与转换过程信息不共享，很难直观地知道网格的范围以及间隔。当网格发生变化时，转换命令也要变化。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="格式转换"></category><category term="网格"></category><category term="C"></category><category term="GMT4"></category></entry><entry><title>M_Map：在Matlab下绘制地图</title><link href="http://seisman.info/mmap-mapping-package-for-matlab.html" rel="alternate"></link><updated>2013-10-08T12:32:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-08:mmap-mapping-package-for-matlab.html</id><summary type="html">&lt;p&gt;M_Map是一个matlab下的工具包，用于绘制各种地图，在某种程序上是GMT的一个替代品。对于喜欢用matlab处理数据的人来说是个福音。&lt;/p&gt;
&lt;p&gt;matlab的图形窗口精度很差，看上去效果不好，幸好其输出支持eps、jpg、fig、pdf、png、tif等格式，转换之后的图形效果不错。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;主页：&lt;/strong&gt; &lt;a class="reference external" href="http://www.eos.ubc.ca/~rich/map.html"&gt;http://www.eos.ubc.ca/~rich/map.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;使用说明：&lt;/strong&gt; &lt;a class="reference external" href="http://www.eos.ubc.ca/~rich/private/mapug.html"&gt;http://www.eos.ubc.ca/~rich/private/mapug.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;M_Map还有一个附加包，叫做M_Namebox，其可以在M_Map绘图的基础上加上一些字符的操作。其主页位于： &lt;a class="reference external" href="http://www-2.nersc.no/~even/matlab/m_namebox/m_namebox.html"&gt;http://www-2.nersc.no/~even/matlab/m_namebox/m_namebox.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;一些效果图&lt;/strong&gt;&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100801.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100802.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100803.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100804.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100805.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fig" src="/images/2013100806.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100807.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100808.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100809.jpg" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013100810.jpg" /&gt;
&lt;/div&gt;
</summary><category term="Matlab"></category><category term="图像"></category></entry><entry><title>SAC ERROR 1303: Overwrite flag is not on for file</title><link href="http://seisman.info/sac-error-1303-overwrite-flag-is-not-on-for-file.html" rel="alternate"></link><updated>2013-10-07T10:55:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-07:sac-error-1303-overwrite-flag-is-not-on-for-file.html</id><summary type="html">&lt;p&gt;在修改SAC头段或者对SAC数据进行处理之后，想要将头段或处理结果写入原文件，有时会出现如下错误：&lt;/p&gt;
&lt;blockquote&gt;
&lt;span class="caps"&gt;ERROR&lt;/span&gt; 1303: Overwrite flag is not on for file xxx&lt;/blockquote&gt;
&lt;p&gt;SAC头段中有这样一个变量LOVROK，若其为false则文件不可被覆盖，类似于用户没有写权限，这应该算是一种数据保护机制。&lt;/p&gt;
&lt;p&gt;因而只要&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; ch lovrok true
&lt;/pre&gt;
&lt;p&gt;文件则可以被修改了。&lt;/p&gt;
</summary><category term="SAC技巧"></category></entry><entry><title>Python多版本共存之pyenv</title><link href="http://seisman.info/python-pyenv.html" rel="alternate"></link><updated>2013-10-04T00:27:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-04:python-pyenv.html</id><summary type="html">
&lt;p&gt;经常遇到这样的情况：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;系统自带的Python是2.6，自己需要Python 2.7中的某些特性；&lt;/li&gt;
&lt;li&gt;系统自带的Python是2.x，自己需要Python 3.x；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此时需要在系统中安装多个Python，但又不能影响系统自带的Python，即需要实现Python的多版本共存。&lt;a class="reference external" href="https://github.com/yyuu/pyenv"&gt;pyenv&lt;/a&gt;就是这样一个Python版本管理器。&lt;/p&gt;
&lt;div class="section" id="pyenv"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;安装pyenv&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;git clone git://github.com/yyuu/pyenv.git ~/.pyenv
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export PYENV_ROOT="$HOME/.pyenv"'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'export PATH="$PYENV_ROOT/bin:$PATH"'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;'eval "$(pyenv init -)"'&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;exec&lt;/span&gt; &lt;span class="nv"&gt;$SHELL&lt;/span&gt; -l
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="python"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;安装Python&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;查看可安装的版本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;pyenv install --list
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;该命令会列出可以用pyenv安装的Python版本，仅列举几个:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2.7.8   # Python 2最新版本
3.4.1   # Python 3最新版本
anaconda-2.0.1  # 支持Python 2.6和2.7
anaconda3-2.0.1 # 支持Python 3.3和3.4
&lt;/pre&gt;
&lt;p&gt;其中形如&lt;tt class="docutils literal"&gt;x.x.x&lt;/tt&gt;这样的只有版本号的为Python官方版本，其他的形如&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;xxxxx-x.x.x&lt;/span&gt;&lt;/tt&gt;这种既有名称又有版本后的属于“衍生版”或发行版。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;安装Python的依赖包&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在安装Python时需要首先安装其依赖的其他软件包，已知的一些需要预先安装的库如下。&lt;/p&gt;
&lt;p&gt;在CentOS/&lt;span class="caps"&gt;RHEL&lt;/span&gt;/Fedora下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install readline readline-devel readline-static
sudo yum install openssl openssl-devel openssl-static
sudo yum install sqlite-devel
sudo yum install bzip2-devel bzip2-libs
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;安装指定版本&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;使用如下命令即可安装python 3.4.1：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;pyenv install 3.4.1 -v
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;该命令会从github上下载python的源代码，并解压到/tmp目录下，然后在/tmp中执行编译工作。若依赖包没有安装，则会出现编译错误，需要在安装依赖包后重新执行该命令。&lt;/p&gt;
&lt;p&gt;对于科研环境，更推荐安装专为科学计算准备的Anaconda发行版，&lt;tt class="docutils literal"&gt;pyenv install &lt;span class="pre"&gt;anaconda-2.1.0&lt;/span&gt;&lt;/tt&gt;安装2.x版本，&lt;tt class="docutils literal"&gt;pyenv install &lt;span class="pre"&gt;anaconda3-2.1.0&lt;/span&gt;&lt;/tt&gt;安装3.x版本；&lt;/p&gt;
&lt;p&gt;Anacoda很大，用pyenv下载会比较慢，可以自己到Anaconda官方网站下载，并将下载得到的文件放在&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.pyenv/cache&lt;/span&gt;&lt;/tt&gt;目录下，则pyenv不会重复下载。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;更新数据库&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;安装完成之后需要对数据库进行更新：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;pyenv rehash
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;查看当前已安装的python版本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;pyenv versions
* system &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set &lt;/span&gt;by /home/seisman/.pyenv/version&lt;span class="o"&gt;)&lt;/span&gt;
3.4.1
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;其中的星号表示当前正在使用的是系统自带的python。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;设置全局的python版本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;pyenv global 3.4.1
&lt;span class="nv"&gt;$ &lt;/span&gt;pyenv versions
system
* 3.4.1 &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set &lt;/span&gt;by /home/seisman/.pyenv/version&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;当前全局的python版本已经变成了3.4.1。也可以使用&lt;tt class="docutils literal"&gt;pyenv local&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;pyenv shell&lt;/tt&gt;临时改变python版本。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;确认python版本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;python
Python 3.4.1 &lt;span class="o"&gt;(&lt;/span&gt;default, Sep &lt;span class="m"&gt;10&lt;/span&gt; 2014, 17:10:18&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;GCC 4.4.7 &lt;span class="m"&gt;20120313&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Red Hat 4.4.7-1&lt;span class="o"&gt;)]&lt;/span&gt; on linux
Type &lt;span class="s2"&gt;"help"&lt;/span&gt;, &lt;span class="s2"&gt;"copyright"&lt;/span&gt;, &lt;span class="s2"&gt;"credits"&lt;/span&gt; or &lt;span class="s2"&gt;"license"&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; more information.
&amp;gt;&amp;gt;&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;使用python&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;输入&lt;tt class="docutils literal"&gt;python&lt;/tt&gt;即可使用新版本的python；&lt;/li&gt;
&lt;li&gt;系统自带的脚本会以&lt;tt class="docutils literal"&gt;/usr/bin/python&lt;/tt&gt;的方式直接调用老版本的python，因而不会对系统脚本产生影响；&lt;/li&gt;
&lt;li&gt;使用&lt;tt class="docutils literal"&gt;pip&lt;/tt&gt;安装第三方模块时会安装到&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.pyenv/versions/3.4.1&lt;/span&gt;&lt;/tt&gt;下，不会和系统模块发生冲突。&lt;/li&gt;
&lt;li&gt;使用&lt;tt class="docutils literal"&gt;pip&lt;/tt&gt;安装模块后，可能需要执行&lt;tt class="docutils literal"&gt;pyenv rehash&lt;/tt&gt;更新数据库；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/yyuu/pyenv"&gt;https://github.com/yyuu/pyenv&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-10-04：初稿；&lt;/li&gt;
&lt;li&gt;2014-10-07：将Python依赖包一段的位置提前；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="安装"></category><category term="Python"></category><category term="版本"></category></entry><entry><title>全球地壳模型crust 1.0</title><link href="http://seisman.info/global-crustal-model-crust1.html" rel="alternate"></link><updated>2015-05-14T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-03:global-crustal-model-crust1.html</id><summary type="html">
&lt;p&gt;crust 1.0是一个全球的三维地壳模型，其分辨率是1度。更老的版本还有分辨率低一些的crust 5.1和crust 2.0。&lt;/p&gt;
&lt;p&gt;官方网址：&lt;a class="reference external" href="http://igppweb.ucsd.edu/~gabi/crust1.html"&gt;http://igppweb.ucsd.edu/~gabi/crust1.html&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;模型基本信息&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;模型将全球划分为1度x1度的网格，共计360x180=64800个单元；&lt;/li&gt;
&lt;li&gt;模型分为9层，每一层给出P和S波速度以及密度。这9层分别为&lt;ol class="arabic"&gt;
&lt;li&gt;水层；&lt;/li&gt;
&lt;li&gt;冰层；&lt;/li&gt;
&lt;li&gt;上沉积层；&lt;/li&gt;
&lt;li&gt;中沉积层；&lt;/li&gt;
&lt;li&gt;下沉积层；&lt;/li&gt;
&lt;li&gt;上地壳；&lt;/li&gt;
&lt;li&gt;中地壳；&lt;/li&gt;
&lt;li&gt;下地壳；&lt;/li&gt;
&lt;li&gt;地幔&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;模型中的海水深度和地形数据来自于NOAA的etopo1数据；etopo1是1分精度的全球地形起伏模型，crust1.0从该模型中提取海水深度和地形数据，做平均处理得到1度单元内的值；&lt;/li&gt;
&lt;li&gt;模型中的冰层厚度来源于etopo1的bedrock和ice surface两个模型的差值；&lt;/li&gt;
&lt;li&gt;地幔的参数，来自于LLNL-G3Dv3模型；&lt;/li&gt;
&lt;li&gt;模型中还包含了每个单元的地壳类型信息；地壳类型信息可能主要由地壳年龄决定；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;crust1.0提供了多个压缩包，分别包含了不同的内容：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;crust1.0.tar.gz：主压缩包，包含了全球地壳速度和密度模型；&lt;/li&gt;
&lt;li&gt;crust1.0-addon：附加包，包含了全球地壳类型模型；&lt;/li&gt;
&lt;li&gt;crsthk.xyz：地壳厚度的XYZ文件(不含水厚度)；&lt;/li&gt;
&lt;li&gt;depthtomoho.xyz：Moho深度的XYZ文件（相对于海平面）；&lt;/li&gt;
&lt;li&gt;sedthk.xyz：沉积层厚度的XYZ文件（单位km）；&lt;/li&gt;
&lt;li&gt;sedthk-m.xyz：沉积层厚度XYZ文件（单位为m）；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="crust1-0"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;crust1.0&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;crust1.0中含说明文档readme一份，模型文件四个，用于读取模型的Fortran代码三个。&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;模型&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;模型文件有四个，从模型文件的名字也可以猜出来，四个文件分别是Vp、Vs、密度和边界的深度。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;全球被划分为1度x1度的网格单元；&lt;/li&gt;
&lt;li&gt;网格点定义在单元的中心，即纬度5-6度、经度150-151度的单元的值位于网格点(5.5,150.5)处，也就是GMT中所说的像素配准；&lt;/li&gt;
&lt;li&gt;全球共计360*180个单元；&lt;/li&gt;
&lt;li&gt;数据点按照经度优先的准则保存，即在循环时先循环纬度，再循环经度；&lt;/li&gt;
&lt;li&gt;第一个点的坐标为(179.5W,89.5N)，第二个点的坐标是(178.5,89.5)，依次类推；&lt;/li&gt;
&lt;li&gt;每个模型文件中共有64800行，对应64800个单元，每行9列，对应每一层的值；&lt;/li&gt;
&lt;li&gt;crust1.0.bnds给出了每一层的上边界的海拔；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;程序&lt;/a&gt;&lt;/h3&gt;
&lt;div class="section" id="getcn1point"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id13"&gt;getCN1point&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;getCN1point&lt;/tt&gt;用于获取任意经纬度处的地壳模型，具体用法如下例:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./getCN1point
  .... reading all maps ...
 enter center lat, long of desired tile (q to quit)
50 100
ilat,ilon,crustal type:   41 281
 topography:    1.6400000
  layers: vp,vs,rho,bottom
   1.50   0.00   1.02   1.64
   3.81   1.94   0.92   1.64
   2.50   1.07   2.11   1.54
   0.00   0.00   0.00   1.54
   0.00   0.00   0.00   1.54
   6.10   3.55   2.74 -19.54
   6.30   3.65   2.78 -38.22
   7.00   3.99   2.95 -46.36
 pn,sn,rho-mantle:    7.99   4.44   3.30
 enter center lat, long of desired tile (q to quit)
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="getcn1maps"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id14"&gt;getCN1maps&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;getCN1maps&lt;/tt&gt;从4个模型文件中提取信息，生成多个Z文件。&lt;/p&gt;
&lt;p&gt;#. 生成各层的Vp、Vs、&lt;span class="math"&gt;\(\rho\)&lt;/span&gt;、边界深度，计4*9=36个文件，文件名map-vp[n]代表第n层的Vp，其他类似；
- 生成各层的厚度，计1*8个文件，文件名类似map-th[n]，第n层的厚度由第n+1个边界的深度减去第n个边界的深度的结果取负值得到；
- 生成沉积层厚度sedthk，由3-5层的厚度相加得到；
- 地壳厚度crsthk：冰层+沉积层+6-8层厚度&lt;/p&gt;
&lt;p&gt;生成的46个文件均为ASCII格式，只有Z值，没有经纬度坐标。可以通过GMT的&lt;tt class="docutils literal"&gt;xyz2grd&lt;/tt&gt;命令转换成GMT可识别的netCDF格式。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;GMT4&lt;/span&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd crsthk -Rd -I1/1 -Gout.grd -ZTLA -F -V
&lt;/pre&gt;
&lt;p&gt;&lt;span class="caps"&gt;GMT5&lt;/span&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt xyz2grd crsthk -Rd -I1/1 -Gout.grd -ZTLA -r -V
&lt;/pre&gt;
&lt;p&gt;说明：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Rd&lt;/span&gt;&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-R-180/180/-90/90&lt;/span&gt;&lt;/tt&gt;均可，但不可使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Rg&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;注意&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&lt;span class="caps"&gt;ZTLA&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;选项的含义；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GMT5&lt;/span&gt;.1.1的xyz2grd存在Bug，因而该命令仅在GMT5.1.2及其之后版本中可用。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="getcn1xyz"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id15"&gt;getCN1xyz&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;与&lt;tt class="docutils literal"&gt;getCN1maps&lt;/tt&gt;生成类似的文件，只是此时的文件为xyz文件，每行三列。文件名以xyz开头或结尾。XYZ文件相对来说更易读，因而推荐使用&lt;tt class="docutils literal"&gt;getCN1xyz&lt;/tt&gt;而不是&lt;tt class="docutils literal"&gt;getCN1maps&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;将xyz文件转换为GMT可识别的网格文件，使用&lt;tt class="docutils literal"&gt;xyz2grd&lt;/tt&gt;。注意与上面命令的区别。&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 4:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd crsthk.xyz -Rg -I1/1 -Gout.grd -F -V
&lt;/pre&gt;
&lt;p&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; 5:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gmt xyz2grd crsthk.xyz -Rg -I1/1 -Gout.grd -r -V
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;程序输出的地壳模型还是很让人困惑的，这里用&lt;tt class="docutils literal"&gt;getCN1point&lt;/tt&gt;获得的某一点的模型，并对输出结果做细致地解释。&lt;/p&gt;
&lt;p&gt;对于(100.5E, 50.5N)来说:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
 enter center lat, long of desired tile (q to quit)
50.5 100.5
ilat,ilon,crustal type:   40 281
 topography:    1.80999994
  layers: vp,vs,rho,bottom
   1.50   0.00   1.02   1.81
   3.81   1.94   0.92   1.81
   2.50   1.07   2.11   1.71
   0.00   0.00   0.00   1.71
   0.00   0.00   0.00   1.71
   6.10   3.55   2.74 -18.93
   6.30   3.65   2.78 -37.22
   7.00   3.99   2.95 -45.19
 pn,sn,rho-mantle:    7.96   4.43   3.28
&lt;/pre&gt;
&lt;p&gt;需要注意，第四列给出的是每一层的&lt;strong&gt;下边界&lt;/strong&gt;的海拔。记住这一点，就可以从输出中提取出很多信息：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;这一点的地形为1.64km，注意，这里实际上是一度范围内的平均地形；&lt;/li&gt;
&lt;li&gt;水层的下边界深度是1.81km，与地形相同，所以水层厚度为零；&lt;/li&gt;
&lt;li&gt;冰层的下边界深度是1.81km，与水层的下边界深度相同，所以冰层厚度为零；&lt;/li&gt;
&lt;li&gt;上沉积层的下边界深度厚度是1.71km，所以上沉积层厚度为0.1km；&lt;/li&gt;
&lt;li&gt;中沉积层和下沉积层厚度均为0 km；&lt;/li&gt;
&lt;li&gt;上地壳的下边界深度为18.93 km，算是地形并减去沉积层，上地壳的厚度是20.64km；&lt;/li&gt;
&lt;li&gt;中地壳厚度为18.29 km，下地壳的厚度为7.97 km；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;几个常见的疑问：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;为了中、下沉积层的速度和密度为零？&lt;/p&gt;
&lt;p&gt;因为此处中、下沉积层的厚度为零，即不存在这两层，不存在的东西当然不用给速度和密度了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;为何水层和冰层的厚度为零，但是却有速度和密度？&lt;/p&gt;
&lt;p&gt;虽然此处水层和冰层的厚度为零，但是因为水和冰的速度和密度在全球范围内是一个常数，所以虽然这里没有水和冰，还是可以给一个正确的速度和密度的。不像沉积层，不同地方的速度和密度差很大。这一点可以通过查看全球水层和冰层的速度和密度极值来验证。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;绘图示例&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
grd2cpt out.grd -Cpolar &amp;gt; out.cpt
grdimage out.grd -Rd -JN6i -B60/30 -Cout.cpt -V -K &amp;gt; a.ps
pscoast -R -J -W0.1p -O &amp;gt;&amp;gt; a.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;没有认真选择cpt文件，看上去效果不好，从细节上看，数据的转换是没有问题的。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="crust1.0 model" src="/images/2013100301.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-10-03：初稿；&lt;/li&gt;
&lt;li&gt;2014-06-10：加入了GMT5的命令；&lt;/li&gt;
&lt;li&gt;2015-05-14：重新整理了文章结构，并对模型做更细致解释；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="网格"></category><category term="模型"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>GMT之grdpaste合并网格文件</title><link href="http://seisman.info/gmt-grdpaste.html" rel="alternate"></link><updated>2013-10-02T01:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-10-02:gmt-grdpaste.html</id><summary type="html">&lt;p&gt;该命令语法如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
grdpaste file_a.grd file_b.grd −Goutfile.grd [ −V ] [ −f[i|o]colinfo ]
&lt;/pre&gt;
&lt;p&gt;该命令用于将两个grd文件合并到一个grd文件中。&lt;/p&gt;
&lt;p&gt;需要注意的是，该命令要求两个grid文件必须有相同的横向间隔、纵向间隔且拥有共同的一条边。若网格文件不满足此需要，可以使用grdcut、grdsample等命令修改网格文件以满足该要求。&lt;/p&gt;
&lt;p&gt;其他选项没啥好说的。&lt;/p&gt;
&lt;p&gt;该命令一次只能合并两个网格文件，因而若有多个网格文件需要合并，需要多次执行grdpaste，且极其需要注意grdpaste的顺序，相当繁琐。对于这种情况，可以考虑使用另一个合并网格文件的命令&amp;#8212;-grdblend。&lt;/p&gt;
</summary><category term="GMT命令"></category><category term="网格"></category><category term="GMT4"></category></entry><entry><title>全球地形起伏数据总结</title><link href="http://seisman.info/global-relief-models.html" rel="alternate"></link><updated>2013-09-30T00:20:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-30:global-relief-models.html</id><summary type="html">&lt;p&gt;这里有个概念是混乱的。有些数据只有陆地部分的地形，有些数据有陆地和海洋的地形，或许前者应该称为数字高程数据，后者称为地形起伏数据。做大地测量的应该更清楚这些专业名词。这里统称为地形数据。&lt;/p&gt;
&lt;p&gt;博客中提到的地形数据，按照分辨率从低到高排序如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;etopo5： &lt;a class="reference external" href="http://seisman.info/global-relief-model-etopo5.html"&gt;GMT网格数据之etopo5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;etopo2： &lt;a class="reference external" href="http://seisman.info/global-relief-model-etopo2.html"&gt;GMT网格数据之ETOPO2v2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;etopo1： &lt;a class="reference external" href="http://seisman.info/global-relief-model-etopo1.html"&gt;GMT网格数据之ETOPO1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GEBCO&lt;/span&gt;：  &lt;a class="reference external" href="http://seisman.info/gebco-global-bathymetry-data.html"&gt;&lt;span class="caps"&gt;GEBCO&lt;/span&gt;：全球水深数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GTOPO30&lt;/span&gt;： &lt;a class="reference external" href="http://seisman.info/global-digital-elevation-model-gtopo30.html"&gt;GMT网格数据之GTOPO30&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;SRTM30_PLUS： &lt;a class="reference external" href="http://seisman.info/srtm30-plus.html"&gt;全球地形起伏数据：SRTM30_PLUS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;SRTM15_PLUS： &lt;a class="reference external" href="http://seisman.info/srtm15-plus.html"&gt;全球地形起伏数据：SRTM15_PLUS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;SRTM3&lt;/span&gt;： &lt;a class="reference external" href="http://seisman.info/srtm.html"&gt;高精度地形网格数据SRTM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;ASTER&lt;/span&gt; &lt;span class="caps"&gt;GDEM&lt;/span&gt;： &lt;a class="reference external" href="http://seisman.info/aster-gdem.html"&gt;全球数字高程数据：&lt;span class="caps"&gt;ASTER&lt;/span&gt; &lt;span class="caps"&gt;GDEM&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;整理如下表：&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="25%" /&gt;
&lt;col width="27%" /&gt;
&lt;col width="25%" /&gt;
&lt;col width="22%" /&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head"&gt;数据源&lt;/th&gt;
&lt;th class="head"&gt;空间分辨率&lt;/th&gt;
&lt;th class="head"&gt;覆盖范围&lt;/th&gt;
&lt;th class="head"&gt;陆地/海洋&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;etopo5&lt;/td&gt;
&lt;td&gt;5弧分&lt;/td&gt;
&lt;td&gt;全球&lt;/td&gt;
&lt;td&gt;陆地+海洋&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;etopo2&lt;/td&gt;
&lt;td&gt;2弧分&lt;/td&gt;
&lt;td&gt;全球&lt;/td&gt;
&lt;td&gt;陆地+海洋&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;etopo1&lt;/td&gt;
&lt;td&gt;1弧分&lt;/td&gt;
&lt;td&gt;全球&lt;/td&gt;
&lt;td&gt;陆地+海洋&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;span class="caps"&gt;GEBCO&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;1弧分/30弧秒&lt;/td&gt;
&lt;td&gt;全球&lt;/td&gt;
&lt;td&gt;陆地+海洋&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;span class="caps"&gt;GTOPO30&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;30弧秒&lt;/td&gt;
&lt;td&gt;全球&lt;/td&gt;
&lt;td&gt;陆地&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;SRTM30_PLUS&lt;/td&gt;
&lt;td&gt;30弧秒(约1km)&lt;/td&gt;
&lt;td&gt;纬度[-81,81]&lt;/td&gt;
&lt;td&gt;陆地+海洋&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;SRTM15_PLUS&lt;/td&gt;
&lt;td&gt;15弧秒(约500m)&lt;/td&gt;
&lt;td&gt;纬度[-81,81]&lt;/td&gt;
&lt;td&gt;陆地+海洋&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;span class="caps"&gt;SRTM&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;3弧秒(约90m)&lt;/td&gt;
&lt;td&gt;纬度[-60,60]&lt;/td&gt;
&lt;td&gt;陆地&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;span class="caps"&gt;ASTER&lt;/span&gt; &lt;span class="caps"&gt;GDEM&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;1弧秒(约30m)&lt;/td&gt;
&lt;td&gt;纬度[-83,83]&lt;/td&gt;
&lt;td&gt;陆地&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;说明如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GEBCO是目前空间分辨率最高的全球地形起伏数据；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;ASTER&lt;/span&gt;&amp;nbsp;GDEM是目前空间分辨率最高的数字高程数据；&lt;/li&gt;
&lt;li&gt;对于全球尺度或者大尺度地形图来说，可以使用etopo1甚至etopo5数据；&lt;/li&gt;
&lt;li&gt;对于3度*3度-10度*10度的区域，可以使用SRTM30_PLUS数据；&lt;/li&gt;
&lt;li&gt;对于3度*3度以下的区域，可以使用SRTM或ASTER&amp;nbsp;GDEM数字数据。&lt;/li&gt;
&lt;li&gt;如果有特殊需求的话，可以用ASTER&amp;nbsp;GDEM绘制陆地地形，用GEBCO绘制海底地形；&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-09-30：初稿；&lt;/li&gt;
&lt;li&gt;2015-04-07：增加了SRTM15_PLUS；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="网格"></category><category term="地形"></category><category term="高程"></category></entry><entry><title>高精度地形网格数据SRTM</title><link href="http://seisman.info/srtm.html" rel="alternate"></link><updated>2013-09-29T11:45:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-29:srtm.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;SRTM&lt;/span&gt;，全称为Shuttle Radar Topography Mission，该项目获取了北纬60度至南纬60度之间的雷达影像数据，进一步处理制成了数字地形高程模型（&lt;span class="caps"&gt;DEM&lt;/span&gt;），即现在的SRTM地形产品数据。该数据产品2003年开始公开发布，经过多次修订，目前的数据修订版本为V4.1版本。更详细的介绍在 &lt;a class="reference external" href="http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1"&gt;http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1&lt;/a&gt; 。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;相关信息&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有很多机构或网站提供SRTM地形数据的下载；从不同网站下载的数据的文件名、文件格式等不同，因而后期的数据处理方式可能不同，但是一些基本的信息应该是相同的。&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;基本信息&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;SRTM地形数据主要包含两类数据：SRTM3和SRTM1。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;SRTM3精度为3弧秒，即90m一个点，包括非洲、北美、南美、欧亚、澳大利亚以及部分岛屿；&lt;/li&gt;
&lt;li&gt;SRTM1精度为1弧秒，即30m一个点，仅限美国地区；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="for-1x1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;数据信息 For 1x1&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;北纬60度到南纬60度的数据被分成了1度*1度的单元，共计上万个数据文件。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;文件名中包含了该单元左下角位置的信息；比如文件名&lt;strong&gt;类似&lt;/strong&gt;N37W105的数据文件，其单元左下角的坐标为(37N,105W)；&lt;/li&gt;
&lt;li&gt;每个SRTM3数据文件包含了1201*1201个采样点；&lt;/li&gt;
&lt;li&gt;高程数据单位为m，参考水准面为WGS84大地水准面模型；&lt;/li&gt;
&lt;li&gt;网格划分采用gridline registration方式，因而单元的南北边及左右边与相邻单元的边重合。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="for-5x5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;数据信息 For 5x5&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;部分网站将数据分割为5度*5度单元，其相对1度*1度单元使用起来免去了cut和paste的麻烦。在经度方向上，从-180度到180度，划分为72个区块；在纬度方向上，从60度到-60度，划分为24个区块，可以参考&lt;a class="reference external" href="http://srtm.csi.cgiar.org/SELECTION/inputCoord.asp"&gt;这里&lt;/a&gt;的图示，其文件名格式为“srtm_经度区块数_纬度区块数.zip”。&lt;/p&gt;
&lt;p&gt;或者也可以这样计算&lt;/p&gt;
&lt;pre class="literal-block"&gt;
x = int((lon+180.0)/5.0)+1;
y = int((60-lat)/5.0)+1;
&lt;/pre&gt;
&lt;p&gt;其中lon = [-180,180], lat= [-60,60], 文件名为&lt;tt class="docutils literal"&gt;srtm_x_y.zip&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;数据来源及格式转换（推荐）&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;推荐两个数据源。其中CGIAR-CSI为主站，中科院提供数据镜像。中科院的国内镜像速度更快，但近期一直无法访问，原因未知。&lt;/p&gt;
&lt;div class="section" id="cgiar-csi"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;&lt;span class="caps"&gt;CGIAR&lt;/span&gt;-&lt;span class="caps"&gt;CSI&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;网址：&lt;/strong&gt; &lt;a class="reference external" href="http://srtm.csi.cgiar.org/SELECTION/inputCoord.asp"&gt;http://srtm.csi.cgiar.org/&lt;span class="caps"&gt;SELECTION&lt;/span&gt;/inputCoord.asp&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;版本：&lt;/strong&gt;4.1&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;格式：&lt;/strong&gt;&lt;tt class="docutils literal"&gt;GeoTiff&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;ArcInfo &lt;span class="caps"&gt;ASCII&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;备注：&lt;/strong&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;数据为5度x5度一个单元；&lt;/li&gt;
&lt;li&gt;数据选择界面友好，简单易用，支持鼠标点选、拖曳或者直接输入经纬度范围；&lt;/li&gt;
&lt;li&gt;鼠标点选的注意事项：鼠标的真实点击位置与地图感知到的点击位置大概相差半个网格间距！点选时需要单击每个单元的下半部分才能选中。不知Bug来源，系统问题？浏览器问题？&lt;/li&gt;
&lt;li&gt;下载数据的时候选择HTTP下载方式。若使用FTP下载方式需要首先申请用户名和密码。&lt;/li&gt;
&lt;li&gt;提供&lt;tt class="docutils literal"&gt;ArcInfo &lt;span class="caps"&gt;ASCII&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;GeoTiff&lt;/tt&gt;两种数据格式，需要转换方可在GMT中使用。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;ArcInfo &lt;span class="caps"&gt;ASCII&lt;/span&gt;&lt;/tt&gt;格式的数据可以使用GMT自带的&lt;tt class="docutils literal"&gt;xyz2grd&lt;/tt&gt;命令转换成netCDF格式；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;Geotiff&lt;/tt&gt;格式的数据需要使用GDAL提供的命令&lt;tt class="docutils literal"&gt;gdal_translate&lt;/tt&gt;转换为netCDF格式；&lt;/li&gt;
&lt;li&gt;推荐使用&lt;tt class="docutils literal"&gt;GeoTiff&lt;/tt&gt;格式，文件尺寸相对于&lt;tt class="docutils literal"&gt;ArcInfo &lt;span class="caps"&gt;ASCII&lt;/span&gt;&lt;/tt&gt;文件要小很多；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;数据转换：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ArcInfo ASCII格式转GMT可识别的netCDF格式:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd srtm_63_02.asc -Gstrm_63_02.grd -E -V
&lt;/pre&gt;
&lt;p&gt;GeoTiff格式转netCDF格式（详情参考&lt;a class="reference external" href="http://seisman.info/convert-geotiff-to-gmt.html"&gt;本文&lt;/a&gt;）:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gdal_translate -of GMT srtm_56_05.tif srtm_56_05.grd
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;数据合并：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;有时需要将多个数据合并成更大区域的数据。常见的做法是先将每个GeoTiff文件转换成netCDF格式，然后利用grdcut和grdpaste进行裁剪与合并。实际操作时，合并总会遇到一些问题，可能是由于数据的转换过程中存在问题导致的。&lt;/p&gt;
&lt;p&gt;推荐的做法是先将多个GeoTiff文件合并起来，然将合并后的GeoTiff文件转换成netCDF格式。&lt;/p&gt;
&lt;p&gt;合并GeoTiff文件可以用&lt;a class="reference external" href="http://gdal.org/gdal_merge.html"&gt;gdal_merge.py&lt;/a&gt;，使用该命令需要安装GDAL的Python绑定。在CentOS下要安装&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;gdal-python&lt;/span&gt;&lt;/tt&gt;；Ubuntu下要安装&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;python-gdal&lt;/span&gt;&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;python3-gdal&lt;/span&gt;&lt;/tt&gt;。转换命令如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gdal_merge.py -init 255 -o out.tif srtm_56_07.tif srtm_57_07.tif
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;FTP批量下载：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;CGIAR&lt;/span&gt;-CSI提供了ftp地址，可以一次性下载全部数据，数据总大小约14G。有需要的可以&lt;a class="reference external" href="https://harvestchoice.wufoo.com/forms/download-cgiarcsi-srtm"&gt;申请&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;申请之后，网站会提供一个网址，以及用户名和密码，可以使用“Firefox+DownloadThemAll”下载，也可以使用如下命令下载:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
wget -c -r -np --user=xxx --password=xxxxx http://data.cgiar-csi.org/srtm/tiles
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Box网盘下载&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;CGIAR同时提供了Box网盘下载。Box网盘中包含了重采样之后的数据，数据精度有250m、500m和1km三种，以满足其他人的需求。&lt;/p&gt;
&lt;p&gt;网盘地址：&lt;a class="reference external" href="https://hc.box.com/shared/1yidaheouv"&gt;https://hc.box.com/shared/1yidaheouv&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;密码(注意感叹号)：&lt;tt class="docutils literal"&gt;ThanksCSI!&lt;/tt&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;中国科学院计算机网络信息中心&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;国际科学数据服务平台：&lt;/strong&gt; &lt;a class="reference external" href="http://datamirror.csdb.cn/dem/search.jsp"&gt;http://datamirror.csdb.cn/dem/search.jsp&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;版本：&lt;/strong&gt; V4和V4.1&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;格式：&lt;/strong&gt; Geotiff 和 ArcInfo &lt;span class="caps"&gt;ASCII&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;备注：&lt;/strong&gt;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;该网站需要注册才可下载数据；&lt;/li&gt;
&lt;li&gt;数据是5度*5度一个单元，而不是标准的1度*1度；&lt;/li&gt;
&lt;li&gt;在中国区域，还提供一些衍生数据，如坡度、坡向、坡位，数据格式为img格式，细节未知；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;其他数据来源及格式转换（不推荐）&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这里列举了其他的一些数据来源，不推荐在这些网站下载数据。这里列出来是基于其他方面的考虑。&lt;/p&gt;
&lt;div class="section" id="usgs"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id22"&gt;USGS未名网站&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;网址：&lt;/strong&gt;&lt;a class="reference external" href="http://dds.cr.usgs.gov/srtm"&gt;http://dds.cr.usgs.gov/srtm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;版本：&lt;/strong&gt;1.0和2.1版本&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;格式：&lt;/strong&gt;二进制z文件&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;高程数据文件的扩展名为hgt；&lt;/li&gt;
&lt;li&gt;二进制文件，以有符号二字节整型格式存储。&lt;/li&gt;
&lt;li&gt;无数据的点其值赋为-32768；&lt;/li&gt;
&lt;li&gt;字节序为big-endian。&lt;/li&gt;
&lt;li&gt;数据存储方式为行优先；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;数据转换：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这个例子选用的数据是N52E130.hgt，北纬、东经，-R=130/131/52/53，对于南纬或者西经要注意负号。-Z后使用TL是实践的结果，官方文档中没有给出相关信息。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd N52E130.hgt -GN52E130.grd -I3c/3c -R130/131/52/53 -N-32768 -ZTLhw
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="usgs-earthexplorer"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;&lt;span class="caps"&gt;USGS&lt;/span&gt; EarthExplorer&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;网址：&lt;/strong&gt;&lt;a class="reference external" href="http://earthexplorer.usgs.gov"&gt;http://earthexplorer.usgs.gov&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;版本：&lt;/strong&gt;?.?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;格式：&lt;/strong&gt;Geotiff、&lt;span class="caps"&gt;DTED&lt;/span&gt;、&lt;span class="caps"&gt;BIL&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;备注：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Geotiff、DTED需要专门软件处理；BIL格式本质上就是一般的二进制文件，因而处理方式与hgt文件类似，但是有一些细节上的差异：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;水平方向精度为6弧秒，而不是标准的3弧秒；&lt;/li&gt;
&lt;li&gt;字节序为little endian；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;数据转换：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将BIL格式转换为GMT grid格式:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd n52_e130_3arc_v1.bil -GN52E130.grd -I6c/3c -R$R -N-32768 -ZTLh
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id24"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;在5度x5度尺度下，SRTM3与GTOPO30的效果相当，因而当地图范围大于5度x5度时，没有必要使用SRTM3数据；&lt;/li&gt;
&lt;li&gt;当地图范围小于3度x3度时，GTOPO30成图粗糙，需要使用SRTM3或者更高精度的数据；&lt;/li&gt;
&lt;li&gt;中国科学院的数据源实际上是cgiar-csi数据源的一个镜像，其在国内下载速度相对较快。数据源以5度*5度的形式提供数据，免去了用户自己做网格合并的麻烦，推荐使用。（发文章的时候需要致谢数据来源）&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id25"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://dds.cr.usgs.gov/srtm/version2_1/Documentation/Quickstart.pdf"&gt;http://dds.cr.usgs.gov/srtm/version2_1/Documentation/Quickstart.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://dds.cr.usgs.gov/srtm/version2_1/Documentation/SRTM_Topo.pdf"&gt;http://dds.cr.usgs.gov/srtm/version2_1/Documentation/SRTM_Topo.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1"&gt;http://www.cgiar-csi.org/data/srtm-90m-digital-elevation-database-v4-1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://gdal.org/gdal_merge.html"&gt;gdal_merge&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id26"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-09-29：初稿；&lt;/li&gt;
&lt;li&gt;2014-01-01：“中国科学院计算机网络信息中心”一节代码存在问题，因网址无法访问，暂时无法修订；&lt;/li&gt;
&lt;li&gt;2014-01-08：增加了CGIAR-CSI数据源；&lt;/li&gt;
&lt;li&gt;2014-01-09：新增了三个下载数据源，重整文章结构，将数据源分为推荐和非推荐两类。&lt;/li&gt;
&lt;li&gt;2014-01-19：将CGIAR的ftp和Box下载移至不推荐来源中。&lt;/li&gt;
&lt;li&gt;2014-01-19：重新编排整个文章的结构，将正确性证明部分去除。当初做正确性证明是因为在将USGS未名网站提供的数据转换为网格文件时，官方文档提供的信息不充分，所以需要测试验证。现在SRTM存在更好的数据源，不必再考虑这个问题。&lt;/li&gt;
&lt;li&gt;2014-05-22：调整文章结构。由于中科院的数据源一直没有修复，因而仅推荐使用CGIAR的数据；&lt;/li&gt;
&lt;li&gt;2015-01-15：新增gdal_merge.py，用于合并GeoTiff文件；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="数据"></category><category term="格式转换"></category><category term="网格"></category><category term="地形"></category><category term="高程"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>GMT命令之xyz2grd生成网格数据</title><link href="http://seisman.info/gmt-xyz2grd.html" rel="alternate"></link><updated>2013-09-28T00:31:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-28:gmt-xyz2grd.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
xyz2grd xyzfile -Ggrdfile -Ixinc[unit][=|+][/yinc[unit][=|+]]
    -Rwest/east/south/north[r] [ -A[n|z|u|l] ]
    [ -Dxname/yname/zname/scale/offset/title/remark ] [ -E[nodata] ] [ -F ]
    [ -H[i][nrec] ] [ -Nnodata ] [ -S[zfile] ] [ -V ] [ -Z[flags] ] [ -:[i|o] ]
    [ -bi[s|S|d|D[ncol]|c[var1/...]] ] [ -fcolinfo ]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;文件格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;该命令的功能是将table文件转换为grid文件。&lt;/p&gt;
&lt;div class="section" id="grid"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;grid文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;网格文件的最大特色在于区域的&lt;strong&gt;等间隔&lt;/strong&gt;网格划分，网格的横向间隔和纵向间隔可以不同。网格化之后的每个点称为一个node。网格文件存储的是区域内每个node处的z值。因而给定区域的范围以及横向间隔和纵向间隔之后，就可以知道网格文件中包含的node数。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="table"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;table文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;table文件可以分为两种：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;xyz文件：文件中包含了(x,y,z)值对，其中(x,y)指定区域内的任意一点，z为该点的值；最常见的table文件格式是ASCII格式，即三列数据；也可以是二进制格式（需要使用-bi选项，不过一般二进制的xyz table文件不太常用）。注意xyz文件与grid文件最大的区别是：xyz数据不一定要等间隔分布，&lt;strong&gt;(x,y)并不一定要位于网格点上！&lt;/strong&gt;这意味着一个node上可以有多个(x,y,z)记录，或者没有记录，xyz数据不一定要按照顺序排列。当然最理想的情况是xyz数据是等间隔分布的。&lt;/li&gt;
&lt;li&gt;z文件：文件中只包含z值，没有(x,y)值。z文件必须是等间隔分布的，且每个点都必须有且只有一个值，数据必须按照一定的顺序排序（-Z选项指定数据格式）；当然z文件可以是ASCII格式或者二进制格式；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;选项说明&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;常用选项&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;-G：&lt;/strong&gt;要输出的网格文件名。一般给定网格文件名就可以，也可以加入进一步指定网格数据的格式，具体参考GMT Manual的网格数据文件格式；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-I：&lt;/strong&gt;指定网格的x间隔和y间隔；默认单位为度，其他单位包括m（弧分）、c（弧秒）、e（米）、k（千米）、i（英里）、n（海里）。若没有指定y_inc，则GMT自动计算y_inc，若指定y_inc=0，则设置y_inc=x_inc；x_inc后加“=”表示允许GMT对间隔进行微调以符合要求；x_inc后加“+”表示给出的x_inc不是网格间隔，而是x方向的数据点数。对于y_inc同理。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-R：&lt;/strong&gt;指定要研究的区域范围；要研究的区域范围不一定要与xyz文件的范围相等！也可以用-Rgrdfile指定某个网格文件，所需要的区域范围从网格文件中直接提取。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;不常用选项&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;-A：&lt;/strong&gt;如果某node有多个值，默认会将多个值的平均值作为该node的z值；该选项可以对多值问题进行特殊处理。-A或-Az将多个值的和作为该node的值；-An会将该node的数据点数作为该node的值（算是某种意义上的统计！）；-Al和-Au会将多个值中的最小/大值作为该node的值。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-D：&lt;/strong&gt;给定网格文件的xname, yname, zname, scale, offset, title, and remark，这相当于给网格文件加入了一些头段信息；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-E：&lt;/strong&gt;将ESRI ArcInfo &lt;span class="caps"&gt;ASCII&lt;/span&gt; interchange网格文件转换为GMT可读的文件格式。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-F：&lt;/strong&gt;设置网格为pixel node registration；默认为gridline registration；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-Nnodata：&lt;/strong&gt;对于无值的node，默认设置为NaN；该选项可以指定无值的node的值为nodata；对于z数据，若某node的值为nodata，则将其转换为NaN；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-Szfile：&lt;/strong&gt;仅对数据进行字节序交换，不产生网格文件；输出到z数据zfile中；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-H、-V、-：、-bi、-f：&lt;/strong&gt;GMT标准选项；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;特殊选项&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-Z选项是处理z数据时必须的选项。z数据必须等间隔分布、所有node必须有值、数据必须按照一定规律排序。-Zflags中的flags指定z数据的具体格式。&lt;/p&gt;
&lt;p&gt;根据GMT的一般定义，对于一个区域来说，由左到右为x轴增加方向，由下到上为y轴增加方向。网格数据可以以四个顶点中的任意一个为起点，对于每个顶点有两个方向可以选择，因而总共有八种情况，用Top、Bottom、Left、Right来表示如下：&lt;/p&gt;
&lt;p&gt;行优先：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;TL&lt;/span&gt;：第一点为左上角；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;TR&lt;/span&gt;：第一点为右上角；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;BL&lt;/span&gt;：第一点为左下角；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;BR&lt;/span&gt;：第一点为右上角；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;列优先：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;LT&lt;/span&gt;：第一点为左上角；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;RT&lt;/span&gt;：第一点为右上角；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;LB&lt;/span&gt;：第一点为左下角；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;RB&lt;/span&gt;：第一点为右上角；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于gridline registered网格数据，若数据是周期性的(比如经度的0度和360度实际上是一个点)，但是输入数据不包含xmax处的值，则要加入"x"；对于y方向同理；&lt;/p&gt;
&lt;p&gt;加入&lt;strong&gt;s&lt;/strong&gt;n可以跳过z数据的前几个记录（在z数据有头段的时候经常用到）；若需要交换字节序，则加入"w"；&lt;/p&gt;
&lt;p&gt;还需要指定z数据的具体数据类型：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A：数据为ASCII格式，每行包含一个或多个浮点型数据；&lt;/li&gt;
&lt;li&gt;a：数据为ASCII格式，每行一个数据；&lt;/li&gt;
&lt;li&gt;c：有符号 1-byte 字符；&lt;/li&gt;
&lt;li&gt;u：无符号 1-byte 字符；&lt;/li&gt;
&lt;li&gt;h：short整型；2字节；&lt;/li&gt;
&lt;li&gt;i：4字节整型；&lt;/li&gt;
&lt;li&gt;l：长整型；（4或8字节，与机器构架有关）；&lt;/li&gt;
&lt;li&gt;f：4字节单精度float型；&lt;/li&gt;
&lt;li&gt;d：8字节double型；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;默认值为-ZTLa。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;例子&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;将一个ASCII格式的三列数据文件转换成网格文件，数据区域范围已知，数据文件等间隔且已知：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd hawaii_grv.xyz -Ghawaii_grv_new.nc -R198/208/18/25 -I5m -V
&lt;/pre&gt;
&lt;p&gt;将常见的二进制高程数据转换为网格文件，常见的用法是：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
xyz2grd topo30. -Dm/m/m/1/0/=/= -Gustopo.nc -R234/294/24/50 -I30s -N-9999 -B -ZTLhw
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;注意事项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Q1：&lt;/strong&gt;若xyz数据不等间隔，该如何转换？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A1：&lt;/strong&gt;从源代码中可以看出，xyz2grd会将任意一点(x,y)的值赋给离其最近的node，如果(x,y)恰好在node上，直接赋值；如果(x,y)不在node上，则会引起误差。&lt;strong&gt;注意这种误差是由于错误赋值而不是插值导致的。&lt;/strong&gt;xyz2grd不要求数据等间隔分布，但是对于不等间隔分布的数据，建议用surface命令进行插值转换。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Q2：&lt;/strong&gt;若使用等间距xyz数据或者z数据，如何选择合适的-I？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A2：&lt;/strong&gt;等间隔xyz数据和z数据都是很好的网格化数据。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;若-I指定的网格间隔与输入数据的网格间隔相同，则生成的网格数据没有任何误差；&lt;/li&gt;
&lt;li&gt;若-I指定的间隔为输入数据网格间隔的整数倍，xyz2grd不是对数据直接进行减采样而是将网格点周围的一些数据进行求和平均，这也会引起一些误差（这个误差应该可以接受）；&lt;/li&gt;
&lt;li&gt;若-I指定的间隔小于输入数据网格间隔，则很多node处会被插值或者直接为NaN，一般都不会这样做。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Q3：&lt;/strong&gt;若使用等间距xyz数据或者z数据，如何选择合适的-R？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A3：&lt;/strong&gt;-R指定的范围是感兴趣的范围，可以比输入数据的范围要小。假定-I指定的网格间隔与输入数据的网格间隔相同，-Rwest/east/south/north给定的网格点应该恰好与输入数据中的点吻合，否则会导致数据的整体偏移。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="private-notes"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;Private Notes&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;GMT&lt;/span&gt; &lt;span class="mf"&gt;4.5.9&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;xyz2grd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;L538&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;L575&lt;/span&gt;&lt;span class="err"&gt;：读取&lt;/span&gt;&lt;span class="n"&gt;xyz数据&lt;/span&gt;&lt;span class="err"&gt;；&lt;/span&gt;
&lt;span class="n"&gt;L553&lt;/span&gt;&lt;span class="err"&gt;：&lt;/span&gt;&lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GMT_x_to_i&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;in&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;GMT_X&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;grd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x_inc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xy_off&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;gmt_grd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="err"&gt;：#&lt;/span&gt;&lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="n"&gt;GMT_x_to_i&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;GMT_LONG&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;irint&lt;/span&gt;&lt;span class="p"&gt;(((((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="数据"></category><category term="网格"></category><category term="GMT4"></category></entry><entry><title>图像格式转换工具convert</title><link href="http://seisman.info/convert-and-ps2raster.html" rel="alternate"></link><updated>2013-09-27T00:16:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-27:convert-and-ps2raster.html</id><summary type="html">&lt;p&gt;在&lt;a class="reference external" href="http://seisman.info/format-conversion-using-ps2raster.html"&gt;《GMT之利用ps2raster实现图像格式转换》&lt;/a&gt;中介绍了如何利用ps2raster将GMT的PS文件转换成其他常见的图片格式。&lt;/p&gt;
&lt;p&gt;一般情况下，如果只用GMT做图的话，ps2raster基本可以满足需求了。&lt;/p&gt;
&lt;p&gt;遇到几个特殊的情况如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GMT中设置纸张背景色PAGE_COLOR，此时ps2raster无法实现切边；&lt;/li&gt;
&lt;li&gt;用其他软件绘图，比如LaTeX的TikZ/PGF包，得到PS或PDF文件，无法使用ps2raster实现格式转换；&lt;/li&gt;
&lt;li&gt;&amp;#8230;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这个时候就需要使用convert命令。convert命令的选项非常多，学起来比ps2raster要复杂多了。&lt;/p&gt;
&lt;p&gt;ps2raster中常用的选项有-A、-E、-T、-P。convert众多选项中与之对应的选项如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;-trim：&lt;/strong&gt;切边，等效于ps2raster的-A选项；其可以解决上面的第一个问题；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-density&lt;/strong&gt;
&lt;em&gt;width&lt;/em&gt;&lt;strong&gt;x&lt;/strong&gt;&lt;em&gt;height&lt;/em&gt;：设置图像精度，等效于ps2raster的-E选项；按照GMT的惯例，width=300即可，height可以指定或不指定。注意width和height中间的字符是字母&amp;quot;x&amp;quot;；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-rotate&lt;/strong&gt;&lt;em&gt;degree&lt;/em&gt;：实现图像旋转，-rotate&amp;nbsp;90等效于ps2raster的-P选项，当然rotate可以旋转各种角度。&lt;/li&gt;
&lt;li&gt;convert没有与ps2raster中-T相应的选项，因为convert通过识别后缀直接进行转换；&lt;a class="reference external" href="http://www.imagemagick.org/script/formats.php"&gt;这里&lt;/a&gt;列出了convert支持的上百种图像/动画格式。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下面给出最常用的一个例子：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
convert -trim -density 300 -rotate 90 test.ps test.png
&lt;/pre&gt;
&lt;p&gt;其等效于&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ps2raster -A -E300 -P -Tg test.ps
&lt;/pre&gt;
</summary><category term="GMT技巧"></category><category term="GMT命令"></category><category term="图像"></category><category term="格式转换"></category><category term="GMT4"></category></entry><entry><title>地震学断层的定义</title><link href="http://seisman.info/faults-in-seismology.html" rel="alternate"></link><updated>2013-09-26T01:51:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-26:faults-in-seismology.html</id><summary type="html">
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;小序&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;地震学中最重要的源是double couple源，也就是常说的位错源，位错源的产生实质就是断层的滑动。&lt;/p&gt;
&lt;p&gt;断层及断层的滑动有几个基本参数：走向、倾角、滑移角以及滑移量。很多参数，地震学和地质学中的定义不同，即便是地震学里也有不同的定义。Aki and Richards (1980)的定义应该是用得最多的定义。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="aki-and-richards"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Aki and Richards 对断层的定义&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Aki and Richards (1980)对于断层参数的定义如下图:&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="fault" src="/images/2013092601.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;断层几何&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;断层的几何形态由走向（strike）和倾角（dip）两个量完全决定。&lt;/p&gt;
&lt;p&gt;一个断层有两个表面，分别称之为上盘（hanging wall）和下盘（foot wall），图中所示为断层的foot wall。&lt;/p&gt;
&lt;p&gt;断层面与水平地表面存在一交线，一条线存在两个方向，哪个方向才是真正的走向呢？地震学里的定义是“当观测者沿着走向方向看时，hanging wall位于观测者的右手边”。这样的定义唯一确定了一个方向为走向方向。走向（strike）的角度定义为正北方向顺时针旋转到走向方向的角度，即图中的&lt;span class="math"&gt;\(\phi_s\)&lt;/span&gt;，其中&lt;span class="math"&gt;\(\phi_s \in [0,2\pi)\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;倾角dip的定义为：从水平面向下旋转到断层面的角度，即图中的&lt;span class="math"&gt;\(\delta\)&lt;/span&gt;。因此有&lt;span class="math"&gt;\(0\le\delta\le\pi/2\)&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;断层滑动&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;断层的滑移&lt;span class="math"&gt;\(\mathbf{u}\)&lt;/span&gt;是一个矢量，定义为“断层上盘（hanging wall）相对于下盘（foot wall）的滑动”。一般取&lt;span class="math"&gt;\(\mathbf{u}\)&lt;/span&gt;的大小为滑移量u，取&lt;span class="math"&gt;\(\mathbf{u}\)&lt;/span&gt;的方向为滑动方向，而滑移角（rake）即定义为断层走向与滑动方向之间的夹角，即图中&lt;span class="math"&gt;\(\lambda\)&lt;/span&gt;。注意这里滑移角rake是逆时针计算的。rake的取值范围为&lt;span class="math"&gt;\(-\pi &amp;lt; \lambda &amp;lt; \pi\)&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;断层的命名&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;大部分断层属于正断层或者逆断层，一些特殊的断层是走滑或倾滑断层：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;逆断层（reversed fault）：&lt;span class="math"&gt;\(\lambda\in(0,\pi)\)&lt;/span&gt;且&lt;span class="math"&gt;\(\delta \ne 0 \ne \frac{\pi}{2}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;正断层（normal fault）：&lt;span class="math"&gt;\(\lambda\in(-\pi,0)\)&lt;/span&gt;且&lt;span class="math"&gt;\(\delta \ne 0 \ne \frac{\pi}{2}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;走滑断层（strike-slip fault）：&lt;span class="math"&gt;\(\lambda=0\)&lt;/span&gt;或&lt;span class="math"&gt;\(\lambda=\pi\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;倾滑断层（dip-slip fault）：断层滑动方向垂直于走向，即&lt;span class="math"&gt;\(\lambda=\frac{\pi}{2}\)&lt;/span&gt;或&lt;span class="math"&gt;\(\lambda=-\frac{\pi}{2}\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于走滑断层和倾滑断层，存在一些特例：&lt;/p&gt;
&lt;p&gt;对于走滑断层，有&lt;span class="math"&gt;\(\lambda=0\)&lt;/span&gt;或&lt;span class="math"&gt;\(\lambda=\pi\)&lt;/span&gt;，若&lt;span class="math"&gt;\(\delta=\frac{\pi}{2}\)&lt;/span&gt;，此时断层面垂直于地面，已经不存在断层上盘和下盘的概念。这里引入了左旋（left-lateral）和右旋（right-leteral）的概念。当观测者站在断层的其中一个块体并面对另一个块体，若对面的块体向右手边移动，则称之为右旋走滑断层；反之，若对面的块体向左手边移动，则称之为左旋走滑断层。根据这样的定义，对于垂直走滑断层，若&lt;span class="math"&gt;\(\lambda=0\)&lt;/span&gt;为左旋，&lt;span class="math"&gt;\(\lambda=\pi\)&lt;/span&gt;为右旋。&lt;/p&gt;
&lt;p&gt;对于垂直的倾滑断层（&lt;span class="math"&gt;\(\delta=\frac{\pi}{2}\)&lt;/span&gt;），定义下降块体为下盘，由此再定义走向方向，因而垂直倾滑断层永远有&lt;span class="math"&gt;\(\lambda=\frac{\pi}{2}\)&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;图中给出了北向，并未给出东向和垂直向，因而实际上断层参数定义是与坐标系的选取无关的。无论是左手系还是右手系，无论z轴是向上还是向下，断层参数的定义不变。在设计到辐射花样等问题时，坐标系的选取开始变得重要了，以后再说。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="名词解释"></category><category term="断层"></category><category term="震源机制解"></category></entry><entry><title>体力与等效体力</title><link href="http://seisman.info/body-force-equivalents.html" rel="alternate"></link><updated>2013-09-16T00:07:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-16:body-force-equivalents.html</id><summary type="html">&lt;p&gt;地震学里最基本的运动方程是&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\rho \ddot{u_i} = \sigma_{ij,j} + f_i
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(f_i\)&lt;/span&gt;是体力项，最常见的体力是重力。&lt;/p&gt;
&lt;p&gt;除非是研究地球的自由震荡，在一般的地震波传播问题中，重力都是可忽略的，因而运动方程简化为：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\rho \ddot{u_i} = \sigma_{ij,j}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;断层的破裂过程（即震源的激发过程）可以认为其在源区导致局部的本构关系发生变化。其中&lt;span class="math"&gt;\(\sigma_{ij}\)&lt;/span&gt;是真实的应力场，而&lt;span class="math"&gt;\(s_{ij}\)&lt;/span&gt;是根据原本构关系计算得到的应力场。&lt;/p&gt;
&lt;p&gt;定义&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
f_i \equiv (\sigma_{ij}-s_{ij})_{,j}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;此时运动方程重新变成&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\rho \ddot{u_i} = \sigma_{ij,j} + f_i
\end{equation*}
&lt;/div&gt;
&lt;p&gt;&lt;span class="math"&gt;\(s_{ij}\)&lt;/span&gt;是根据原本构关系计算得到的应力场，因而其在整个空间内是连续的。注意这里的&lt;span class="math"&gt;\(f_i\)&lt;/span&gt;已经不再是体力了，而是从被修改的本构关系中分解出的体力项，因而&lt;span class="math"&gt;\(f_i\)&lt;/span&gt;仅仅存在于震源区的一个点或者断层面上。&lt;/p&gt;
&lt;p&gt;根据Aki &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Richards&amp;nbsp;(1980)中的表示定理：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
u_n(x,t) = \int_{-\infty}^{\infty} d \tau \iiint_V f_p(\bm{\eta}, \bm{\tau}) G_{np}(\bm{x}, t-\tau, \bm{\eta},0) d V(\bm{\eta})&amp;#92;
\end{align*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
+ \int_{-\infty}^{\infty} d \tau \iint_{\Sigma} \left[ u_i(\bm{\xi}, \bm{\tau}) \right] c_{ijpq} \nu_j G_{np,q}(\bm{x}, t-\tau; \bm{\xi},0) d \Sigma(\bm{\xi})
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
- \int_{-\infty}^{\infty} d \tau \iint_{\Sigma} \left[ T_p(\bm{u}(\bm{\xi}, \tau), \bm{\nu}) G_{np}(\bm{x}, t-\tau; \bm{\xi},0) \right] d \Sigma(\bm{\xi})
\end{equation*}
&lt;/div&gt;
&lt;p&gt;位移分为三项，第一项为体力引起的位移，这一项在波传播中可忽略；&lt;/p&gt;
&lt;p&gt;第二项是位移不连续引起的位移，其等效体力为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
f_p^{[\bm{u}]}(\bm{\eta}, \tau) = - \iint_{\Sigma}[u_i(\bm{\xi}, \tau)]c_{ijpq} \nu_j \frac{\partial}{\partial \eta_q} \delta(\bm{\eta}-\bm{\xi}) d \Sigma
\end{equation*}
&lt;/div&gt;
&lt;p&gt;第三项是应力不连续引起的位移，其等效体力为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\bm{f}^{[\bm{T}]}(\bm{\eta}, \tau) = - \iint_{\Sigma}[\bm{T}(\bm{u}(\bm{\xi},\tau),\bm{\nu})] \delta(\bm{\eta}-\bm{\xi}) d \Sigma(\bm{\xi})
\end{equation*}
&lt;/div&gt;
&lt;p&gt;地震学研究中常用的源是位错源，即第二项。&lt;/p&gt;
&lt;p&gt;因而很多文献中的波动方程，&lt;span class="math"&gt;\(f_i\)&lt;/span&gt;都不是体力项，而是等效体力项。&lt;/p&gt;
&lt;p&gt;参考文献：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Julian, B. R., Miller, A. D., &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Foulger, &lt;span class="caps"&gt;G. R.&lt;/span&gt;(1998). Non‐double‐couple earthquakes 1. Theory. Reviews of Geophysics, 36(4),&amp;nbsp;525-549.&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="震源"></category></entry><entry><title>绘制波形对比图</title><link href="http://seisman.info/waveform-comparison-plot.html" rel="alternate"></link><updated>2013-09-15T00:29:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-15:waveform-comparison-plot.html</id><summary type="html">&lt;p&gt;波形对比图，经常出现在如下场合：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;发展新的计算理论地震图的方法，与前人的结果做Benchmark；&lt;/li&gt;
&lt;li&gt;理论地震图与实际数据做对比，比如反演；&lt;/li&gt;
&lt;li&gt;展示多个波形的相关性；如doublet；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如下图所示，红色的三个trace是某差分程序计算出的地震图，黑色的三个trace是fk计算出的地震图，也就是上面的第一种情况：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="pssac figure" src="/images/2013091501.jpg" /&gt;
&lt;/div&gt;
&lt;p&gt;画地震波形肯定是要用pssac的，当初的做法是先用psbasemap绘制整体的边框，然后用六个pssac命令分别绘制每个trace，并使用-Y选项分别微调每个trace的垂直位置，这显然是一种非常笨的方法，尤其是在有很多个trace的情况下。&lt;/p&gt;
&lt;p&gt;更好的绘图脚本如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;X6i/4i&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0.2/1WeSn&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0.4/2.0/0/4&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;traces.ps&amp;quot;&lt;/span&gt;

pssac -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -W1p/red -M1 -Ent-3 syn.* -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
pssac -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -W1p/black -M1 -Ent-3 homo.* -O -Y0.1i &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个脚本调用了两次pssac命令，第一个pssac绘制了三条红色的trace，同时绘制了底图和边框；第二个pssac命令绘制了三条黑色的trace，使用-Y选项实现垂直方位偏离。&lt;/p&gt;
&lt;p&gt;第二个pssac命令中另一个特殊的地方在于没有使用-B选项。若有-B选项，则会出现两个边框，看上去是两张图的重叠与交错；而没有-B选项，两张图重叠在一起，看上去却是一张图，实现了波形对比的效果。这里充分利用了-B选项功能，详情参见&lt;a class="reference external" href="http://seisman.info/abused-b-option.html"&gt;GMT进阶之被滥用的-B选项&lt;/a&gt;&lt;/p&gt;
</summary><category term="GMT技巧"></category><category term="pssac"></category><category term="GMT4"></category></entry><entry><title>GMT技巧之图像合并</title><link href="http://seisman.info/gmt-merge-images.html" rel="alternate"></link><updated>2013-09-14T19:50:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-14:gmt-merge-images.html</id><summary type="html">&lt;p&gt;为什么需要把多张图合并到一个PS文件中？&lt;/p&gt;
&lt;p&gt;这个问题起源于科研和写作对图件的要求不同。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="figure" src="/images/2013091401.jpg" style="width: 700px;" /&gt;
&lt;p class="caption"&gt;图片来源：&lt;a class="reference external" href="http://www.nature.com/ngeo/journal/v6/n6/full/ngeo1813.html"&gt;http://www.nature.com/ngeo/journal/v6/n6/full/ngeo1813.html&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;以上面这张图为例吧（虽然例子不太恰当）。上图实际上是由三个子图构成的，图a、图b和图c。在科研探索的过程中，一般一个PS文件中只会绘制一张图，为了看起来方便，图的尺寸会尽量大，尽可能填满整个纸张。而在写作的过程中，因为种种出版上的要求，可能需要将原本的多张图合并成一张图，对于上面的例子就是三合一。&lt;/p&gt;
&lt;p&gt;合并的方法大致分为两类，其一是借助强大的绘图软件，另一是修改绘图脚本。&lt;/p&gt;
&lt;p&gt;常用的矢量绘图软件有商业软件Photoshop和Illustrator，以及免费开源的GIMP和Inkscape。可以利用这些软件打开多个PS文件，然后复制粘贴图像到同一个文件中，最终生成的还是矢量文件。这种方法的优点在于简单且高效。缺点在于如果有大量图需要合并，或者合并完成之后发现图又需要修改，工作量就会很大；实践过程中发现，使用这些软件可能会导致图像的变形（原因未知）。&lt;/p&gt;
&lt;p&gt;下面主要说说修改绘图脚本的方法。&lt;/p&gt;
&lt;p&gt;GMT绘图的基本原理是：每个绘图命令产生一堆PS代码，代表图形的一个部分（一个图层？），一大堆PS代码就构成了一张图。&lt;/p&gt;
&lt;p&gt;对于上面的例子来说，理论上只要将绘制这三个图的所有GMT命令全部都放在一个脚本中即可，也就是“脚本合并=图像合并”。&lt;/p&gt;
&lt;p&gt;合并脚本过程中的一些要点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;所有绘图命令的输出要重定向到同一个PS文件中；&lt;/li&gt;
&lt;li&gt;注意-K、-O选项的正确使用；&lt;/li&gt;
&lt;li&gt;使用-X、-Y调节每个子图的位置；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果原脚本很复杂，脚本之间存在相同的变量，直接合并脚本可能会存在变量重复定义或者相互影响的问题，继而影响绘图结果。这种情况下多个脚本可以不必合并，另写一个脚本&lt;strong&gt;顺序执行&lt;/strong&gt;这几个脚本就好，单个脚本遵循上面的要点修改即可。&lt;/p&gt;
&lt;p&gt;脚本合并之后一个更重要的问题在于：原来每张图的尺寸都很大，多个子图合并之后，要么子图之间相互重叠，要么子图超过纸张范围。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决办法1：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;直接在脚本中修改每张图的尺寸（修改-JX什么的），将每个之图缩小到合适的尺寸。有些命令比如pstext、psscale是需要根据整体图的尺寸进行微调的，因而图尺寸修改之后，这些命令的选项可能都需要重新微调，稍显耗时。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决办法2：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;直接修改纸张尺寸，使用&lt;tt class="docutils literal"&gt;gmtset PAPER_MEDIA Custom_WxH&lt;/tt&gt;自定义纸张大小（W和H分别代表纸张的宽度和高度）。&lt;/p&gt;
&lt;p&gt;这样做的好处是不需要修改子图大小（前提是子图的“相对”大小比较合适），只需要对每个子图做整体平移（-X和-Y）。&lt;/p&gt;
&lt;p&gt;缺点是最后生成的图不是正常纸张大小，不过写文章的时候无论是Word还是LaTeX都可以指定图形大小，所以纸张尺寸或许不是个问题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决办法2升级版：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如果前一方法中的纸张大小是个问题，可以先按照上一步的方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;gmtset修改纸张尺寸；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;-X和-Y调整子图位置；&lt;/p&gt;
&lt;pre class="literal-block"&gt;
%%BeginPageSetup
0.24 0.24 scale
%%EndPageSetup
&lt;/pre&gt;
&lt;p&gt;调整0.24的大小，可以实现在保持纸张大小不变的前提下整体缩放图形的目的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这个时候应该就大功告成了。&lt;/p&gt;
</summary><category term="GMT技巧"></category><category term="图像"></category><category term="GMT4"></category></entry><entry><title>Intel 非商业开发工具安装记录</title><link href="http://seisman.info/intel-non-commercial-software.html" rel="alternate"></link><updated>2013-09-10T11:39:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-10:intel-non-commercial-software.html</id><summary type="html">
&lt;p&gt;Intel为学生提供了非商业的License，使得学生可以免费获取Intel开发工具一年的使用权。&lt;/p&gt;
&lt;p&gt;Linux和Windows用户可以申请Intel Parallel Studio XE的Professional版；对于OS X用户，则只能申请Composer版。&lt;/p&gt;
&lt;p&gt;Professional版包括：C/C++编译器、Inspector、VTune、&lt;span class="caps"&gt;IPP&lt;/span&gt;、&lt;span class="caps"&gt;MKL&lt;/span&gt;、Advisor，似乎不含Fortran编译器&lt;/p&gt;
&lt;p&gt;地址： &lt;a class="reference external" href="https://software.intel.com/en-us/qualify-for-free-software/student"&gt;https://software.intel.com/en-us/qualify-for-free-software/student&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;申请时需要填写edu邮箱，再填写其他一些必要的信息即可。然后Intel会向注册邮箱内发送license以及下载链接。License有效期一年，一年后需要重新申请。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;依赖关系&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;安装之前需要先安装如下包:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yum install gcc gcc-c++ gcc-gfortran pangox-compat-devel libunwind-devel
&lt;/pre&gt;
&lt;p&gt;除此之外，64位系统还需要安装一些32位的库文件:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
yum install glibc.i686 libgcc.i686 libstdc++.i686
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;解压&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;tar -zxvf parallel_studio_xe_2013_update3_intel64.tgz
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;parallel_studio_xe_2013_update3_intel64
&lt;span class="nv"&gt;$ &lt;/span&gt;su
&lt;span class="c"&gt;# ./install.sh&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;检测依赖性&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
Step 1 of 7 | Welcome &amp;gt; Missing Optional Prerequisite(s)
--------------------------------------------------------------------------------
There are one or more optional unresolved issues. It is highly recommended to
resolve them all before you continue the installation. You can fix them without
exiting from the installation and re-check. Or you can quit from the
installation, fix them and run the installation again.
--------------------------------------------------------------------------------
Missing optional prerequisites
-- Intel(R) VTune(TM) Amplifier XE 2013 Update 15: Unsupported OS
-- Intel(R) Inspector XE 2013 Update 9: Unsupported OS
-- Intel(R) Advisor XE 2013 Update 5: Unsupported OS
-- Intel(R) Fortran Composer XE 2013 SP1 Update 2 for Linux*: Unsupported OS
-- Intel(R) C++ Composer XE 2013 SP1 Update 2 for Linux*: Unsupported OS
--------------------------------------------------------------------------------
1. Skip missing optional prerequisites [default]
2. Show the detailed info about issue(s)
3. Re-check the prerequisites

h. Help
b. Back to the previous menu
q. Quit
--------------------------------------------------------------------------------
Please type a selection or press "Enter" to accept default choice [1]: 1
&lt;/pre&gt;
&lt;p&gt;检测过程中，intel给出“不支持当前操作系统”的错误，除非系统非常老，否则该错误都可以忽略。如果出现其他错误，需要“detailed info about issues”逐一排查。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;激活&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
Step no: 3 of 7 | Activation
--------------------------------------------------------------------------------
If you have purchased this product and have the serial number and a connection
to the internet you can choose to activate the product at this time. Activation
is a secure and anonymous one-time process that verifies your software licensing
rights to use the product. Alternatively, you can choose to evaluate the
product or defer activation by choosing the evaluate option. Evaluation software
will time out in about one month. Also you can use license file, license
manager, or remote activation if the system you are installing on does not
have internet access activation options.
--------------------------------------------------------------------------------
1. I want to activate my product using a serial number [default]
2. I want to evaluate my product or activate later
3. I want to activate either remotely, or by using a license file, or by using a
   license manager

h. Help
b. Back to the previous menu
q. Quit
--------------------------------------------------------------------------------
Please type a selection or press "Enter" to accept default choice [1]: 1

Please type your serial number (the format is XXXX-XXXXXXXX): 查看邮箱找激活码
--------------------------------------------------------------------------------
Activation completed successfully.
--------------------------------------------------------------------------------
Press "Enter" key to continue:
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;安装完成&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
Step no: 7 of 7 | Complete
--------------------------------------------------------------------------------
Thank you for installing and using the
Intel(R) Parallel Studio XE 2013 Update 3 for Linux*

Reminder: Intel(R) VTune(TM) Amplifier XE users must be members of the "vtune"
permissions group in order to use Event-based Sampling.

To register your product purchase, visit
https://registrationcenter.intel.com/RegCenter/registerexpress.aspx?clientsn=N43
3-3FHWSF85

To get started using Intel(R) VTune(TM) Amplifier XE 2013 Update 5:
    - To set your environment variables: source
/opt/intel/vtune_amplifier_xe_2013/amplxe-vars.sh
    - To start the graphical user interface: amplxe-gui
    - To use the command-line interface: amplxe-cl
    - For more getting started resources: /opt/intel/vtune_amplifier_xe_2013/
      documentation/en/welcomepage/get_started.html.
To get started using Intel(R) Inspector XE 2013 Update 5:
    - To set your environment variables: source
/opt/intel/inspector_xe_2013/inspxe-vars.sh
    - To start the graphical user interface: inspxe-gui
    - To use the command-line interface: inspxe-cl
    - For more getting started resources: /opt/intel/inspector_xe_2013/
      documentation/en/welcomepage/get_started.html.
To get started using Intel(R) Advisor XE 2013 Update 2:
    - To set your environment variables: source
/opt/intel/advisor_xe_2013/advixe-vars.sh
    - To start the graphical user interface: advixe-gui
    - To use the command-line interface: advixe-cl
    - For more getting started resources: /opt/intel/advisor_xe_2013/
      documentation/en/welcomepage/get_started.html.
To get started using Intel(R) Composer XE 2013 Update 3 for Linux*:
    - Set the environment variables for a terminal window using one of the
      following (replace "intel64" with "ia32" if you are using a 32-bit
      platform).
      For csh/tcsh:
           $ source /opt/intel/bin/compilervars.csh intel64
      For bash:
           $ source /opt/intel/bin/compilervars.sh intel64
      To invoke the installed compilers:
           For C++: icpc
           For C: icc
           For Fortran: ifort

      To get help, append the -help option or precede with the man command.
    - For more getting started resources:
           /opt/intel/composer_xe_2013/Documentation/en_US/get_started_lc.htm.
           /opt/intel/composer_xe_2013/Documentation/en_US/get_started_lf.htm.


To view movies and additional training, visit
http://www.intel.com/software/products.

--------------------------------------------------------------------------------
q. Quit [default]
--------------------------------------------------------------------------------
Please type a selection or press "Enter" to accept default choice [q]:
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;修改环境变量&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在.bashrc中加入如下语句&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# Intel&lt;/span&gt;
&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/vtune_amplifier_xe_2013/amplxe-vars.sh
&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/inspector_xe_2013/inspxe-vars.sh
&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/advisor_xe_2013/advixe-vars.sh
&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/bin/compilervars.sh intel64
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;使环境变量生效：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;. .bashrc
Copyright &lt;span class="o"&gt;(&lt;/span&gt;C&lt;span class="o"&gt;)&lt;/span&gt; 2009-2013 Intel Corporation. All rights reserved.
Intel&lt;span class="o"&gt;(&lt;/span&gt;R&lt;span class="o"&gt;)&lt;/span&gt; VTune&lt;span class="o"&gt;(&lt;/span&gt;TM&lt;span class="o"&gt;)&lt;/span&gt; Amplifier XE &lt;span class="m"&gt;2013&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;build 274450&lt;span class="o"&gt;)&lt;/span&gt;
Copyright &lt;span class="o"&gt;(&lt;/span&gt;C&lt;span class="o"&gt;)&lt;/span&gt; 2009-2013 Intel Corporation. All rights reserved.
Intel&lt;span class="o"&gt;(&lt;/span&gt;R&lt;span class="o"&gt;)&lt;/span&gt; Inspector XE &lt;span class="m"&gt;2013&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;build 278112&lt;span class="o"&gt;)&lt;/span&gt;
Copyright &lt;span class="o"&gt;(&lt;/span&gt;C&lt;span class="o"&gt;)&lt;/span&gt; 2009-2013 Intel Corporation. All rights reserved.
Intel&lt;span class="o"&gt;(&lt;/span&gt;R&lt;span class="o"&gt;)&lt;/span&gt; Advisor XE &lt;span class="m"&gt;2013&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;build 270011&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;出来一堆版权说明好烦人，再改.bashrc如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/vtune_amplifier_xe_2013/amplxe-vars.sh quiet
&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/inspector_xe_2013/inspxe-vars.sh quiet
&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/advisor_xe_2013/advixe-vars.sh quiet
&lt;span class="nb"&gt;source&lt;/span&gt; /opt/intel/bin/compilervars.sh intel64
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;搞定收工！&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-09-10：初稿for CentOS 6.5；&lt;/li&gt;
&lt;li&gt;2014-07-15：加入了依赖包for CentOS 7.0；&lt;/li&gt;
&lt;li&gt;2015-04-08：Intel非商业软件在停止一段时间后重新接受申请；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="安装"></category><category term="Intel"></category><category term="C"></category><category term="Fortran"></category></entry><entry><title>hk1.3编译</title><link href="http://seisman.info/compilation-of-hk.html" rel="alternate"></link><updated>2013-09-08T19:22:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-08:compilation-of-hk.html</id><summary type="html">
&lt;p&gt;hk是Prof. Lupei Zhu写的一个程序包，利用接收函数方法计算Moho厚度以及地壳波速比。整个程序包包含了接收函数所需的关键代码，但是想要高效地用于接收函数研究，还需要自己写一些代码作为补充。正由于程序本身的简洁，因而有助于理解接收函数的原理。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;下载与解压&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;wget http://www.eas.slu.edu/People/LZhu/downloads/hk1.3.tar
&lt;span class="nv"&gt;$ &lt;/span&gt;tar -xvf hk1.3.tar
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;hk
&lt;span class="nv"&gt;$ &lt;/span&gt;make clean
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="makefile"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;修改Makefile&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在Makefile中设置变量GMT_INC和GMT_LIB：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
GMT_INC = -I/opt/GMT/include -I/opt/netcdf/include
GMT_LIBS = -L/opt/GMT/lib -lgmt -lpsl -L/opt/netcdf/lib -lnetcdf -lm -s
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;修改代码&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;直接make进行编译可能会出现类似&lt;/p&gt;
&lt;pre class="literal-block"&gt;
k_stack.c:30: 错误：‘BOOLEAN’未声明(在此函数内第一次使用)
&lt;/pre&gt;
&lt;p&gt;这样的错误。&lt;/p&gt;
&lt;p&gt;解决办法是将k_stack.c和grdmin.c中的BOOLEAN改成GMT_LONG。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;编译&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ make
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;其他&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;与hk相关的另一个程序包是CCP，用于共转换点地震数据的叠加，安装过程在&lt;a class="reference external" href="http://seisman.info/compilation-of-ccp.html"&gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-09-08：初稿；&lt;/li&gt;
&lt;li&gt;2013-11-29：加入了CCP编译博文的链接；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="接收函数"></category><category term="编译"></category></entry><entry><title>SAC中与台站有关的头段</title><link href="http://seisman.info/headers-of-station-in-sac.html" rel="alternate"></link><updated>2013-09-03T23:40:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-03:headers-of-station-in-sac.html</id><summary type="html">&lt;p&gt;SAC头段中与台站有关的变量有：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;KNETWK&lt;/span&gt;：台网名；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;KSTNM&lt;/span&gt;：台站名；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;ISTREG&lt;/span&gt;：台站地理区域（未使用）；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;STLA&lt;/span&gt;：台站纬度（北为正）；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;STLO&lt;/span&gt;：台站经度（东为正）；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;STEL&lt;/span&gt;：台站高程（m，未使用）；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;STDP&lt;/span&gt;：台站相对地表深度（m，未使用）；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;CMPAZ&lt;/span&gt;：分量方位角；（从北开始顺时针度数）&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;CMPINC&lt;/span&gt;：分量入射角；（从垂直开始的角度）&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;KCMPNM&lt;/span&gt;：分量名称，比如BHE&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;LPSPOL&lt;/span&gt;：如果台站分量为正极性则为真（左手规则）；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中与台站分量有关的头段变量有四个，即CMPAZ、&lt;span class="caps"&gt;CMPINC&lt;/span&gt;、&lt;span class="caps"&gt;KCMPNM&lt;/span&gt;、&lt;span class="caps"&gt;LPSPOL&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;CMPAZ和CMPINC在进行波形旋转的时候很重要。根据CMPAZ和CMPINC的定义可知，对于标准三分量台站有：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;N向：&lt;span class="caps"&gt;CMPAZ&lt;/span&gt;=0；&lt;span class="caps"&gt;CMPINC&lt;/span&gt;=90；&lt;/li&gt;
&lt;li&gt;E向：&lt;span class="caps"&gt;CMPAZ&lt;/span&gt;=90；&lt;span class="caps"&gt;CMPINC&lt;/span&gt;=90；&lt;/li&gt;
&lt;li&gt;Z向：&lt;span class="caps"&gt;CMPAZ&lt;/span&gt;=0；&lt;span class="caps"&gt;CMPINC&lt;/span&gt;=0；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;KCMPNM标记了分量的名称，SEED格式中一般使用三个字符表示，比如BHE，第一个字符表示宽频带，第二个字符表示高增益，第三个字符表示E向分量。有兴趣的可以参考SEED中关于Channel命名的说明：&lt;a class="reference external" href="http://www.iris.edu/manuals/SEED_appA.htm"&gt;http://www.iris.edu/manuals/SEED_appA.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;变量LPSPOL是个很有意思的头段变量，若三分量的正极性方向符合左手规则则该变量为真。&lt;/p&gt;
&lt;p&gt;关于左手定则，可以参考维基百科的&lt;a class="reference external" href="http://zh.wikipedia.org/wiki/%E5%8F%B3%E6%89%8B%E5%AE%9A%E5%89%87"&gt;右手定则&lt;/a&gt;条目。&lt;/p&gt;
&lt;p&gt;下图简单给出了左手定则和右手定则的示意图，图中左图符合左手定则，右图符合右手定则。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="left-and-right" src="/images/2013090301.jpg" style="width: 400px;" /&gt;
&lt;/div&gt;
&lt;p&gt;在地震学中，一般取北向为x轴，东向为y轴，向上为z轴，即符合上图的左手定则，也就是常说的NEU坐标系。但是，在有些情况下，取向下为z轴正向，此时符合右手定则（倒过来看），也就是更常见的NED坐标系。&lt;/p&gt;
&lt;p&gt;目前已经搞清楚的一些事实是，Aki &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt;&amp;nbsp;Richards(1980)中的坐标主要以NED坐标系为主，而常用的计算理论地震图的程序fk采用的则是NEU坐标系。除此之外，还有其他坐标系，以后整理清楚再说。&lt;/p&gt;
</summary></entry><entry><title>Doule Couple辐射花样可视化</title><link href="http://seisman.info/doule-couple-radition-pattern.html" rel="alternate"></link><updated>2013-09-02T00:09:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-02:doule-couple-radition-pattern.html</id><summary type="html">&lt;p&gt;Aki &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Richards (1980) P118 给出了远场P、&lt;span class="caps"&gt;SV&lt;/span&gt;、SH波的辐射花样。一直想将辐射花样画出来，以更好的理解不同震源机制的辐射花样。无奈各种绘图软件都只知皮毛。&lt;/p&gt;
&lt;p&gt;下面给出用Mathematica写的两个辐射花样可视化的程序，可以下载封装好的cdf文件（用免费的&lt;a class="reference external" href="http://www.wolfram.com/cdf-player/"&gt;cdf-player&lt;/a&gt;打开）或者nb源文件（用商业软件Mathematica打开）。&lt;/p&gt;
&lt;p&gt;网址： &lt;a class="reference external" href="http://demonstrations.wolfram.com/RadiationPatternForDoubleCoupleEarthquakeSources/"&gt;http://demonstrations.wolfram.com/RadiationPatternForDoubleCoupleEarthquakeSources/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;效果图如下，可以调节strike、rake、dip的值，选择波类型，来获得相应的辐射花样。（有些复杂，没怎么看明白。）&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure1" src="/images/2013090201.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;网址： &lt;a class="reference external" href="http://demonstrations.wolfram.com/EarthquakeFocalMechanism/"&gt;http://demonstrations.wolfram.com/EarthquakeFocalMechanism/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;效果图如下，这张图实际是根据P波初动绘制震源球，算是上图的一个简化版，通过修改strike、rake、dip的值，可以很清晰地看到震源球的断层面的移动过程，有助于锻炼“看震源球确定断层机制”的能力。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 2" src="/images/2013090202.jpg" style="width: 600px;" /&gt;
&lt;/div&gt;
</summary><category term="震源机制解"></category><category term="震源球"></category><category term="Mathematica"></category></entry><entry><title>fk3.2编译</title><link href="http://seisman.info/fk-installation.html" rel="alternate"></link><updated>2014-10-22T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-09-01:fk-installation.html</id><summary type="html">
&lt;p&gt;fk是Prof. Lupei Zhu写的一个计算水平分层介质中理论地震图的小程序。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下载地址： &lt;a class="reference external" href="http://www.eas.slu.edu/People/LZhu/downloads/fk3.2.tar"&gt;http://www.eas.slu.edu/People/LZhu/downloads/fk3.2.tar&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;解压&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ tar -xvf fk3.2.tar
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="makefile"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;修改Makefile&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;fk3.2自带的Makefile有一堆问题，下面会说明遇到的问题以及如何解决。&lt;/p&gt;
&lt;p&gt;这里先提供我修改好的Makefile，读者可以直接下载这个文件，然后重命名为&lt;tt class="docutils literal"&gt;Makefile&lt;/tt&gt;，并覆盖fk自带的Makefile即可。&lt;/p&gt;
&lt;p&gt;修改版Makefile下载地址： &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/Makefile.fk.3.2"&gt;http://seisman.qiniudn.com/downloads/Makefile.fk.3.2&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="fortran"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;修改Fortran编译器选项&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;程序的大部分代码是用Fortran 77的语法写的，由于Fortran 77规定每行超过第72列的字符会被忽略，而代码中部分行超过了72列。因而要修改编译器选项，加入语句如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
FC=gfortran -ffixed-line-length-none
&lt;/pre&gt;
&lt;p&gt;其中&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-ffixed-line-length-none&lt;/span&gt;&lt;/tt&gt;表示不限制每一行的长度。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sac"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;SAC子程序支持&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;部分代码中调用了SAC提供的子程序，如果已经安装了SAC，那么可以将&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;CFLAGS&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SACLIB&lt;/span&gt;&lt;/tt&gt;两行去除注释，并根据自己的SAC安装路径做修改。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sachd"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;sachd链接数学库&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;按照上面所说进行修改，make之后出现如下错误：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cc -O    -o sachd sachd.o sacio.o
sacio.o: In function `read_sac2':
sacio.c:(.text+0x831): undefined reference to `rintf'
sacio.c:(.text+0x8e0): undefined reference to `rintf'
collect2: ld 返回 1
make: *** [sachd] 错误 1
&lt;/pre&gt;
&lt;p&gt;这是由于sachd在链接时没有链接数学库&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-lm&lt;/span&gt;&lt;/tt&gt;，将&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sachd: sachd.o sacio.o
    ${LINK.c} -o $@ $^
&lt;/pre&gt;
&lt;p&gt;改成:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sachd: sachd.o sacio.o
    ${LINK.c} -o $@ $^ -lm
&lt;/pre&gt;
&lt;p&gt;即可。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;编译&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
$ make
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;安装&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;为了使用的方便，建议将编译生成的二进制文件&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;st_fk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;syn&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;trav&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;sachd&lt;/tt&gt;以及脚本文件&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;复制到&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;HOME&lt;/span&gt;/bin&lt;/tt&gt;或者其他可搜索的路径中即可。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;：程序的核心，负责计算格林函数；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;st_fk&lt;/tt&gt;：与fk相似，负责计算静态位移；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;trav&lt;/tt&gt;：计算到时；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;syn&lt;/tt&gt;：利用&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;计算出的格林函数合成最终地震图；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;sachd&lt;/tt&gt;：用于修改SAC文件的头段信息；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;fk.pl&lt;/tt&gt;：&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;的Perl封装，相对&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;来说更易于使用，其调用了&lt;tt class="docutils literal"&gt;fk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;trav&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;sachd&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-09-01：初稿；&lt;/li&gt;
&lt;li&gt;2013-10-07：关于fk 3.2的一点修改；&lt;/li&gt;
&lt;li&gt;2014-10-22：更新至fk 3.2；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="理论地震图"></category><category term="编译"></category><category term="C"></category><category term="Fortran"></category><category term="Perl"></category></entry><entry><title>MoPaD:地震矩绘制和分析工具</title><link href="http://seisman.info/mopad-moment-tensor-plotting-and-decomposition.html" rel="alternate"></link><updated>2013-08-27T12:27:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-27:mopad-moment-tensor-plotting-and-decomposition.html</id><summary type="html">
&lt;p&gt;MoPaD，全称Moment tensor Plotting and Decomposition，是一个用于分析地震矩的小工具，主要功能包括地震矩与断层面参数的转换、地震矩分解以及震源球的绘制。该工具可控参数非常丰富，因而具有非常强的灵活性，可以满足大多数需求。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;基本信息&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;作者：&lt;/strong&gt;Lars Krieger and Sebastian Heimann&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;语言：&lt;/strong&gt;Python，需要安装numpy和matplotlib模块&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;官方主页：&lt;/strong&gt; &lt;a class="reference external" href="http://www.larskrieger.de/mopad/"&gt;http://www.larskrieger.de/mopad/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;下载地址：&lt;/strong&gt; &lt;a class="reference external" href="https://github.com/geophysics/MoPaD"&gt;https://github.com/geophysics/MoPaD&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;许可：&lt;/strong&gt;&lt;span class="caps"&gt;LGPL&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;引用：&lt;/strong&gt;Lars Krieger and Sebastian Heimann, MoPaD - moment tensor plotting and decomposition: &lt;em&gt;A tool for graphical and numerical analysis of seismic moment tensors&lt;/em&gt;, Seismol. Res. Lett., 83(3):589-595, 2012&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;基本语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
mopad &amp;lt;method&amp;gt; &amp;lt;source-mechanism&amp;gt; [options]
&lt;/pre&gt;
&lt;p&gt;source-mechanism可以取如下几种形式：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;strike,dip,rake&lt;/li&gt;
&lt;li&gt;strike,dip,rake,moment&lt;/li&gt;
&lt;li&gt;M11,M22,M33,M12,M13,M23&lt;/li&gt;
&lt;li&gt;M11,M22,M33,M12,M13,M23,moment&lt;/li&gt;
&lt;li&gt;M11,M12,M13,M21,M22,M23,M31,M32,M33&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;每种形式的参数个数不同，因而容易区分。各参数以逗号分隔。角度的单位为度，地震矩分量以及标量矩的单位为N.m。这里不直接支持矩震级Mw，有些可惜。地震矩的默认坐标系为1为北向（N），2为东向（E），3向下（D），符合右手定则，记为NED&lt;/p&gt;
&lt;p&gt;method可以取如下四种形式：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;plot&lt;/li&gt;
&lt;li&gt;describe&lt;/li&gt;
&lt;li&gt;decompose&lt;/li&gt;
&lt;li&gt;gmt&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;四种method，各自有自己独立的options，options太多，主要是调节一些细节参数，不细说。可以使用&lt;tt class="docutils literal"&gt;mapad method &lt;span class="pre"&gt;--help&lt;/span&gt;&lt;/tt&gt;查看每个method对应的选项。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="method"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Method&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="plot"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;Plot&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;用于绘制震源球。震源球默认使用立体等角度投影方式，垂向视角，下半球投影，压缩区为白色，拉伸区为红色，默认只绘制地震矩的偏张量部分。&lt;/p&gt;
&lt;p&gt;下面的例子使用矩张量的震源表示形式，-I选项表明绘制地震矩的各向同性部分，-f指定了输出图像文件名。若未指定文件后缀，默认为svg格式，目前支持的格式包括svg、png、ps、eps、pdf。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mopad plot 1,2,3,-4,-5,-10 -I -f FSD_xmpl.png
&lt;/pre&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="f1" src="http://www.larskrieger.de/mopad/FSD_xmpl.png" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;p&gt;这是个更复杂的例子，体现了mopad强大的可控性，具体选项参考&lt;tt class="docutils literal"&gt;mopad plot &lt;span class="pre"&gt;-h&lt;/span&gt;&lt;/tt&gt;：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mopad plot 1,2,3,-4,-5,-10 -s 10 -v -50,30,-0 -U
      -p o -f FSD_complex.svg -r 252,233,79 -w 117,80,123
      -d 1 3 red 0.5 -e 15 4 1 -b
&lt;/pre&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="http://www.larskrieger.de/mopad/FSD_complex.png" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;p&gt;mopad可以做地震矩分解，当然也就可以将矩张量不同部分绘制出来。目前可以绘制完整的矩张量、各向同性部分、偏张量部分、double couple部分以及clvd部分，下面5个命令为例子，不再秀图。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mopad plot 1,2,3,-4,-5,-10 -I -s 1 -f FSD_xmpl_full.png
mopad plot 1,2,3,-4,-5,-10 -P iso -s 0.36  -f FSD_xmpl_iso.png
mopad plot 1,2,3,-4,-5,-10 -s 0.93 -f FSD_xmpl_devi.png
mopad plot 1,2,3,-4,-5,-10 -P dc -s 0.74 -f FSD_xmpl_dc.png
mopad plot 1,2,3,-4,-5,-10 -P clvd -s 0.57 -f FSD_xmpl_clvd.png
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="describe"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;describe&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;对地震矩以及断层参数进行描述。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ mopad describe 1,2,3,-4,-5,-10 -i USE

Scalar Moment: M0 = 14.9031 Nm (Mw = -5.3)
Moment Tensor: Mnn =  0.200,  Mee =  0.300, Mdd =  0.100,
               Mne =  1.000,  Mnd = -0.400, Med =  0.500    [ x 10 ]

Fault plane 1: strike =  95°, dip =  67°, slip-rake = -163°
Fault plane 2: strike = 358°, dip =  74°, slip-rake =  -24°
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="decompose"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;decompose&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;矩张量分解。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ mopad decompose 1,2,3,-4,-5,-10 -o USE
&lt;/pre&gt;
&lt;p&gt;分解结果如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Basis system of the input:

NED

 Basis system of the output:

USE

 Decomposition type:

ISO + DC + CLVD

 Full moment tensor in USE-coordinates:

  /  0.30 -0.50  1.00 \
  | -0.50  0.10  0.40  |   x  10.000000
  \  1.00  0.40  0.20 /


 Isotropic part in USE-coordinates:

  /  2.00  0.00  0.00 \
  |  0.00  2.00  0.00  |
  \  0.00  0.00  2.00 /


 Isotropic percentage:

13

 Deviatoric part in USE-coordinates:

  /  0.10 -0.50  1.00 \
  | -0.50 -0.10  0.40  |   x  10.000000
  \  1.00  0.40  0.00 /


 Deviatoric part in USE-coordinates:

  /  0.10 -0.50  1.00 \
  | -0.50 -0.10  0.40  |   x  10.000000
  \  1.00  0.40  0.00 /


 Deviatoric percentage:

87

 Double Couple part in USE-coordinates:

  /  1.36 -2.97  7.30 \
  | -2.97 -1.77  1.95  |
  \  7.30  1.95  0.41 /


 Double Couple percentage:

55

 Second Double Couple part in USE-coordinates:

 not available in this decomposition type


 Second Double Couple's percentage:

 not available in this decomposition type


 Third Double Couple part in USE-coordinates:

 not available in this decomposition type


 Third Double Couple's percentage:

 not available in this decomposition type


 CLVD part in USE-coordinates:

  / -0.36 -2.03  2.70 \
  | -2.03  0.77  2.05  |
  \  2.70  2.05 -0.41 /


 CLVD percentage:

32

 Seismic moment (in Nm) :

14.9031089939

 Moment magnitude Mw:

-5.25114874821

 Eigenvalues T N P :

12.5907, 4.31243, -10.9031

 Eigenvectors T N P (in basis system USE):

  / -0.74 \
  |  0.09  |
  \ -0.67 /

  /  0.26 \
  | -0.88  |
  \ -0.40 /

  / -0.62 \
  | -0.47  |
  \  0.63 /


 Tension-axis in USE -coordinates:

  / -0.62 \
  | -0.47  |
  \  0.63 /


 Null-axis in USE -coordinates:

  /  0.26 \
  | -0.88  |
  \ -0.40 /


 Pressure-axis in USE -coordinates:

  / -0.74 \
  |  0.09  |
  \ -0.67 /
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;gmt&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT能绘制的震源球类型很有限，因而mopad可以作为一个补充。mopad gmt返回（x，y），其可以作为psxy命令的输入。输出的x、y值中心位于(0,0)，因而在利用GMT的psxy绘制的时候需要进行位置的转换。&lt;/p&gt;
&lt;p&gt;mopad与psxy联合需要使用一些cpt文件，以控制一些颜色。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
makecpt -Cpolar -Z &amp;gt; psxy_fill.cpt
&lt;/pre&gt;
&lt;p&gt;psxy_fill.cpt控制震源球压缩区（颜色代码为1）和拉伸区（颜色代码为0）的颜色，这个例子中分别为红色（1）和白色（0）。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
makecpt -I -Chot -Z &amp;gt;psxy_lines.cpt
&lt;/pre&gt;
&lt;p&gt;psxy_lines.cpt控制震源球边界和界面线的颜色，本例中为黑色。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mopad gmt 1,2,3,-4,-5,-10 -t fill -p s | psxy -Jx4/4 -R-2/2/-2/2 -P -Cpsxy_fill.cpt -M -K -L  &amp;gt; BB1.ps
mopad gmt 1,2,3,-4,-5,-10 -t lines -p s | psxy -Jx4/4 -R-2/2/-2/2 -W5 -P -Cpsxy_lines.cpt -M -O &amp;gt;&amp;gt; BB1.ps
&lt;/pre&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="figure" src="/images/2013082701.jpg" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;工具本身很强大，与GMT的结合不太完美，另外虽然是命令行工具，但是不太适合批量处理。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="震源机制解"></category><category term="震源球"></category><category term="Python"></category></entry><entry><title>一些精美的波场传播动画</title><link href="http://seisman.info/wave-propagation-animations.html" rel="alternate"></link><updated>2013-08-26T00:40:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-26:wave-propagation-animations.html</id><summary type="html">&lt;p&gt;预览一些静态图：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="F1" src="/images/2013082601.png" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="F2" src="/images/2013082602.png" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="F3" src="/images/2013082603.png" style="width: 600px;" /&gt;
&lt;/div&gt;
&lt;p&gt;作者：Michael S.&amp;nbsp;Thorne&lt;/p&gt;
&lt;p&gt;网址：&lt;a class="reference external" href="http://web.utah.edu/thorne/animations.html"&gt;http://web.utah.edu/thorne/animations.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;波场模拟代码：SHaxi，PSVaxi&lt;/p&gt;
&lt;p&gt;绘图工具：&lt;span class="caps"&gt;GMT&lt;/span&gt;、ImageMagick、POVRay&lt;/p&gt;
&lt;p&gt;其他软件：TauP&lt;/p&gt;
&lt;p&gt;文章：An Educational Resource for Visualizing the Global Seismic Wave&amp;nbsp;Field&lt;/p&gt;
&lt;p&gt;更多的动画可以前往官方网站下载观看。&lt;/p&gt;
&lt;p&gt;注意协议：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you download any of these animations you implicitly agree to give
proper credit to the authors. Acknowledgement should be given&amp;nbsp;to:&lt;/p&gt;
&lt;p&gt;Michael S. Thorne, H. Philip Crotwell, Gunnar Jahnke, and Heiner&amp;nbsp;Igel.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：图还是很精美的，作者没有给代码，不过自己写起来也不难。不清楚上面的第三张图是用什么软件做出来的。&lt;/p&gt;
</summary><category term="动画"></category><category term="射线"></category><category term="图像"></category></entry><entry><title>GMT之底图边框类型</title><link href="http://seisman.info/gmt-basemap-type.html" rel="alternate"></link><updated>2014-07-09T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-25:gmt-basemap-type.html</id><summary type="html">&lt;p&gt;BASEMAP_TYPE是GMT的默认参数中可以修改的一个，其可以取inside、graph、plain和fancy中的任意一个，默认为fancy（也就是GMT画图中常见的火车道边框）。&lt;/p&gt;
&lt;p&gt;下面给出例子：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/5/0/5
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;test.ps
&lt;span class="c"&gt;# 默认标题太大，影响效果，这里改小一点&lt;/span&gt;
gmtset HEADER_FONT_SIZE 15p

&lt;span class="c"&gt;# 设置类型为plain&lt;/span&gt;
gmtset BASEMAP_TYPE plain
psbasemap -JX1.8i -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B1/1&lt;span class="s2"&gt;&amp;quot;:.Plain:&amp;quot;&lt;/span&gt; -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 设置类型为fancy，后面的加号使得边框的四角为圆角&lt;/span&gt;
gmtset BASEMAP_TYPE fancy+
psbasemap -JM1.8i -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B1/1&lt;span class="s2"&gt;&amp;quot;:.Fancy:&amp;quot;&lt;/span&gt; -K -O -X2.5i &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 设置类型为inside&lt;/span&gt;
psbasemap -JX1.8i -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B1/1:&lt;span class="s2"&gt;&amp;quot;.inside:&amp;quot;&lt;/span&gt; -K -O -X2.5i --BASEMAP_TYPE&lt;span class="o"&gt;=&lt;/span&gt;inside &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# 设置类型为graph&lt;/span&gt;
psbasemap -JX1.8i -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B1/1WS&lt;span class="s2"&gt;&amp;quot;:.graph:&amp;quot;&lt;/span&gt; -O -X2.5i --BASEMAP_TYPE&lt;span class="o"&gt;=&lt;/span&gt;graph &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;可以用gmtset来修改GMT默认参数，也可以通过&amp;#8212;&lt;span class="caps"&gt;PAR&lt;/span&gt;=value这样的方式设置。&lt;/p&gt;
&lt;p&gt;在GMT4.5.9中，用gmtset设置BASEMAP_TYPE为inside或graph都会出现问题，这是bug，在4.5.10中已经修正。因而对于BASEMAP_TYPE为inside或者graph，目前只能采取&amp;#8212;&lt;span class="caps"&gt;PAR&lt;/span&gt;=value这样的方式修改参数。&lt;/p&gt;
&lt;p&gt;不同的投影方式，效果可能不同，比如-JX设置BASEMAP_TYPE=fancy则不起作用。最终效果如下：&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="BASEMAP TYPE" src="/images/2013082501.jpg" /&gt;
&lt;/div&gt;
&lt;p&gt;标题的位置没有做修改，是GMT自定义的结果。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;备注&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;psxyz不支持BASEMAP_TYPE=graph&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-08-25：初稿；&lt;/li&gt;
&lt;li&gt;2013-10-05：gmtset无法设置BASEMAP_TYPE为inside和graph：已确定为Bug；&lt;/li&gt;
&lt;li&gt;2013-10-05：psxyz支持graph类型；&lt;/li&gt;
&lt;li&gt;2014-07-09：&lt;tt class="docutils literal"&gt;psbasemap&lt;/tt&gt;命令不需要输入文件，修正了脚本中的错误；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="GMT4"></category></entry><entry><title>GMT进阶之-P选项</title><link href="http://seisman.info/gmt-option-p.html" rel="alternate"></link><updated>2013-08-24T14:08:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-24:gmt-option-p.html</id><summary type="html">
&lt;p&gt;一张标准A4纸的大小为210*297 mm，我们说其宽度是210 mm，高度为297 mm。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;模式介绍&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;一般定义A4纸的左下角那一点为坐标原点，从左向右为x轴增加方向，从下往上为y轴增加方向。如下面的左图所示。这个时候称为Portrait模式。Portrait译为“肖像”，显然一个人的高度要比宽度大很多。&lt;/p&gt;
&lt;p&gt;如果将坐标系原点从纸张的左下角平移（translate）至右下角，然后将坐标系逆时针旋转90度，得到下面的右图。这个时候x轴是从下往上为增加方向，看起来不太舒服。如果将右图的纸张顺时针旋转90度，这个时候纸张的宽度为297 mm，高度为210 mm。这种模式称为Landscape模式，因为风景（Landscape）一般都是绵延的山水画，宽度比高度要大多了。&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="mode" src="/images/2013082401.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;GMT默认使用的是Landscape模式，可以通过-P选项强制使用Portrait模式。那么究竟该选哪种模式呢？一般情况下，用GMT绘制的地图都是方方正正的，两种模式基本没有区别；在一些特殊的情况下，比如用pssac绘制地震波形剖面，X轴为时间，Y轴列出了多个地震波形，这个时候Y轴就需要更长一些，以免多个波形重合在一起。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;一些测试&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;解释完GMT的两种模式之后，还要再看看如何正确的使用-P选项。&lt;/p&gt;
&lt;p&gt;测试脚本如下:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

psxy -JX1i/2i -R0/5/0/10 -B1/1 -K -T &amp;gt; 01.ps
psxy -JX2i/1i -R0/10/0/5 -B1/1 -O -X2i -T &amp;gt;&amp;gt; 01.ps

psxy -JX1i/2i -R0/5/0/10 -B1/1 -K -P -T &amp;gt; 02.ps
psxy -JX2i/1i -R0/10/0/5 -B1/1 -O -P -X2i -T &amp;gt;&amp;gt; 02.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个例子绘制了两张图，第一张图的两个psxy命令没有使用-P选项，第二张图的两个psxy命令都使用了-P选项。用evince查看一下这两个文件，可以发现01.ps为landscape模式，02.ps为portrait模式，这个是预料之中的事情。gs默认所有ps文件都是portrait模式，所以查看landscape模式的ps文件会比较别扭。&lt;/p&gt;
&lt;p&gt;比较两个ps文件的源码可以发现，两个文件唯一的差别在于文件开头处的一些代码片段：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
%%BeginPageSetup
595 0 T 90 R
0.24 0.24 scale
%%EndPageSetup
&lt;/pre&gt;
&lt;p&gt;上面的代码片段是Landscape模式下的，Portrait模式下缺少了&lt;tt class="docutils literal"&gt;595 0 T 90 R&lt;/tt&gt;这一行。这是唯一的区别！！！这意味着-P选项不直接影响单个命令产生的代码片段，而是对整个页面的设置起作用。&lt;/p&gt;
&lt;p&gt;下面这个例子可能更有意思一些：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
psxy -JX1i/2i -R0/5/0/10 -B1/1 -K -P -T &amp;gt; 03.ps
psxy -JX2i/1i -R0/10/0/5 -B1/1 -O -X2i -T &amp;gt;&amp;gt; 03.ps

psxy -JX1i/2i -R0/5/0/10 -B1/1 -K -T &amp;gt; 04.ps
psxy -JX2i/1i -R0/10/0/5 -B1/1 -O -X2i -P -T &amp;gt;&amp;gt; 04.ps
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这两个例子中分别只有一个命令有-P选项。用evince查看一下，03.ps为Portrait模式，与02.ps完全相同；04.ps为Landscape模式，与01.ps完全相同。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在&lt;a class="reference external" href="http://seisman.info/gmt-option-ko.html"&gt;GMT进阶之深入理解-K和-O选项&lt;/a&gt;中已经说到，PS文件的源码包含了头段、正文和尾巴，每个命令产生的代码组成了正文。如果一个命令是产生一个ps文件的第一个命令，则有没有-P选项决定了整个ps文件的模式，后面其他的命令无论有-P或者没有-P都没有任何影响，不可能通过-P选项使得图中一部分呈landscape模式，一部分呈portrait模式。总之，如果需要使用-P选项，只要在第一个绘图命令里使用就可以了，后面的-P完全没有效果。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;20131024更新&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;关于-P选项，存在一个很大的误解，多数人认为如果一张图想要使用Portrait模式，则所有的命令都需要加上-P选项。上面的结果表明实际上根本不是这样。一个比较合理的做法是，如果需要portrait模式，则在脚本开始处使用&lt;tt class="docutils literal"&gt;gmtset PAGE_ORIENTATION  portrait&lt;/tt&gt;，最后删除.gmt*即可。这样就真的可以把-P选项给彻底扔了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;吐槽&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT为什么不设计成下面这样：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test.ps"&lt;/span&gt;

GMT_init -P -F&lt;span class="nv"&gt;$PS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c"&gt;# begin plot command&lt;/span&gt;
psxy .....
pscoast .....
&lt;span class="c"&gt;# end plot command&lt;/span&gt;

GMT_end；
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;GMT_init和GMT_end是两个单独的命令，其中GMT_init负责初始化GMT，主要是写入PS文件需要的头段信息，-P选项指定PS文件为Portrait模式，-F$PS指定PS文件名；GMT_end负责写入尾巴。这样设计的话中间的所有绘图命令都不再需要-K、-O选项，-P选项也可以废除了。GMT会在当前目录写入临时文件保留前面命令中-J和-R的信息，保留PS文件名应该也不是件难事。GMT的世界一下子就被简化了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-08-24：初稿；&lt;/li&gt;
&lt;li&gt;2013-10-24：增加“小结”；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT选项"></category><category term="GMT技巧"></category></entry><entry><title>GMT进阶之被滥用的-B选项</title><link href="http://seisman.info/abused-b-option.html" rel="alternate"></link><updated>2013-08-23T23:15:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-23:abused-b-option.html</id><summary type="html">
&lt;p&gt;GMT的官方文档里称“-B选项大概是GMT里最复杂的选项了，但多数情况下我们只需要使用其最最简单的语法”。这篇博文的目的不是介绍-B选项复杂的语法，而是说说在GMT中使用-B选项的一个误区。&lt;/p&gt;
&lt;p&gt;-J、-R、-B作为GMT最常用的三个选项，初学者印象深刻，不知不觉留下了“每个绘图命令都必须给出这三个选项”的印象。在前文《&lt;a class="reference external" href="http://seisman.info/gmt-option-j-and-r.html"&gt;GMT进阶之理解-J和-R的共生关系&lt;/a&gt;》中已经说到，-J和-R是一对好基友，几乎总是同时出现，并解释了一下二者关系那么好的原因（觉得没解释清，有些东西只可意会啊～）。&lt;/p&gt;
&lt;p&gt;-B选项的身份比较尴尬。在命令中可以使用-B来控制图形的边框，而当不使用-B选项时则不会绘制边框。所以，&lt;strong&gt;-B选项不是绘图命令所必须的&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;本文到这里基本就该结束了。没有兴趣看示例的可以直接跳到最后的总结。&lt;/p&gt;
&lt;p&gt;下面开始给一堆例子来说明这个问题。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;第0个例子&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个例子来自于前面的博文《&lt;a class="reference external" href="http://seisman.info/how-to-use-gmt-ko.html"&gt;GMT使用-K和-O的技巧&lt;/a&gt;》，两个psxy命令中间可以加上需要的各种命令，这里只是为了说明问题，所以就尽量简单。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10/0/10
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1/1
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;TestB0.ps

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这两条命令是用于开关GMT的，没有-B选项，其虽然生成了一些PS代码，但是实际却不显示任何内容。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;第1个例子&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10/0/10
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1/1
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;TestB1.ps

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个例子给第一个psxy命令加上了-B选项，当然也改了一下名字。看一下TestB1.ps会发现，&lt;strong&gt;-B的作用是给图形绘制边框&lt;/strong&gt;，这是唯一的区别。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;第2个例子&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10/0/10
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1/1
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;TestB2.ps

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个例子给第二个psxy命令也加上了-B选项。查看TestB2.ps会发现，这张图与TestB1.ps是一样的。这有两种可能：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;第二个命令中的-B选项没有发挥作用；&lt;/li&gt;
&lt;li&gt;两个命令的-B选项都绘制了边框，由于两个边框相互重合，所以看上去没有区别。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;想要验证究竟哪种假设是对的也很简单，用diff命令比较一下两个文件的差异就可以了。通过比较可以发现，此例生成的PS文件相对于上例生成的PS文件，多了很长的一段PS代码，因而可知，两个边框重合了，看上去没有区别。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;第3个例子&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/10/0/10
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1/1
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;TestB3.ps

psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -B&lt;span class="nv"&gt;$B&lt;/span&gt; -X1i -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这个例子在前一个例子的基础上加了个-X选项，将第二个psxy绘制的边框做了个偏移，可以看到ps文件中出现了两个边框，这个例子进一步证明了两个-B选项都是有绘制边框的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT的每个绘图命令都会生成一堆PS代码，这些PS代码表示了整张图的一个图层，众多的绘图命令将多个图层叠加在一起，形成了一个复杂的GMT图形。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;在不使用-X和-Y的情况下，这些绘图命令共享同一个图形边框，所以只需要&lt;strong&gt;第一个&lt;/strong&gt;或&lt;strong&gt;其中任意一个&lt;/strong&gt;命令有-B选项就可以了，其他命令的-B选项是多余的，甚至会有负效果的。&lt;/li&gt;
&lt;li&gt;若使用了-X和-Y，即一张图中包含多个子图，每个子图有自己的边框，此时每个&lt;strong&gt;子图的第一个命令&lt;/strong&gt;都需要-B选项，其他命令都不需要。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;正确的理解-B选项的用途是很有用的，下面列出一些滥用或活用-B选项的例子：&lt;/p&gt;
&lt;div class="section" id="b"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;活用-B选项&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/waveform-comparison-plot.html"&gt;绘制波形对比图&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/double-y-axis-plot.html"&gt;绘制双Y轴&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;滥用-B选项&lt;/a&gt;&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;重复使用-B选项，导致PS文件占据更多硬盘空间&lt;/p&gt;
&lt;p&gt;上面的四个示例，生成的PS文件的大小分别为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
TestB0.ps   16146
TestB1.ps   38562
TestB2.ps   60978
TestB3.ps   60993
&lt;/pre&gt;
&lt;p&gt;当脚本中存在循环，并多次重复使用-B时，浪费的硬盘空间会更多，不过现在硬盘都很大，也不在乎这点空间&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;重复使用-B选项，导致绘制出的图边框发虚，即看上去精度很低&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://seisman.info/blurry-frame-in-GMT.rst.html"&gt;GMT边框发虚的原因及解决办法&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-08-22：初稿；&lt;/li&gt;
&lt;li&gt;2013-09-15：增加了“活用-B选项的一个例子”；&lt;/li&gt;
&lt;li&gt;2014-12-09：增加了“GMT边框发虚”的链接；&lt;/li&gt;
&lt;li&gt;2015-05-12：新增“绘制双Y轴”的链接；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT选项"></category><category term="GMT技巧"></category><category term="GMT4"></category></entry><entry><title>GMT之利用minmax寻找数据极值</title><link href="http://seisman.info/gmt-minmax.html" rel="alternate"></link><updated>2013-08-22T14:23:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-22:gmt-minmax.html</id><summary type="html">
&lt;p&gt;GMT不仅仅具有强大的画图功能，同时也具有一定的数据处理能力，minmax就是其中之一。从命令的名字可以猜出，这个命令是用来寻找最大最小值的。很多时候，在GMT之外，这个命令用起来也很顺手。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
minmax [files] [-C] [-E&amp;lt;L|l|H|h&amp;gt;&amp;lt;col&amp;gt;] [-H[i][&amp;lt;nrec&amp;gt;]]
[-I[p]&amp;lt;dx&amp;gt;[/&amp;lt;dy&amp;gt;[/&amp;lt;dz&amp;gt;..]] [-S[x][y]] [-T&amp;lt;dz&amp;gt;[/&amp;lt;col&amp;gt;]] [-:[i|o]]
[-bi[s|S|d|D[&amp;lt;ncol&amp;gt;]|c[&amp;lt;var1&amp;gt;/...]]] [-f[i|o]&amp;lt;colinfo&amp;gt;]
[-m[i|o][&amp;lt;flag&amp;gt;]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;选项说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;minmax的输入可以来自于文件，也可以来自于标准输入。minmax用来处理数字型数据，对于字符串会当前NaN来处理。由于其寻找的是每列的极值，这要求数据格式统一，每个记录的列数相同，否则会有警告。当然minmax也可以通过-b选项处理二进制文件。&lt;/p&gt;
&lt;p&gt;C、E、I、S、T是minmax的特殊选项，其用法在例子中说明；其他选项都是GMT的标准选项，不再多说。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;示例文件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;示例文件test.txt内容如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
0       0       0
1       1       1
2       2       2
3       1       1
4       4       2
5       3       3
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;用法示例&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;最简单的例子&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
$ minmax test.txt
test.txt: N = 6 &amp;lt;0/5&amp;gt; &amp;lt;0/4&amp;gt; &amp;lt;0/3&amp;gt;
&lt;/pre&gt;
&lt;p&gt;minmax后直接加文件名，输出结果中给出了文件的记录数（N=6），以及每列的最大最小值（格式为&amp;lt;min/max&amp;gt;）。这个结果很直观，一目了然。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="c"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;-C选项示例&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
$ minmax -C test.txt
0 5 0 4 0 3
&lt;/pre&gt;
&lt;p&gt;-C选项将原始数据每列的极值分为两列输出，这样的输出方式在数据列数过多的情况下看起来容易眼花，但是却更易于用脚本来处理。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="e"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;-E选项示例&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
$ minmax -El2 test.txt
0 0 0
&lt;/pre&gt;
&lt;p&gt;test.txt有三列，标记为第0-2列，因而这个例子中的2实际代表的是第三列数据。选项-El2使得命令只关注数据的第三列，猜测其原理是这样的：首先将文件遍历一遍，获取第三列的最大和最小值，然后再遍历第二遍，如果某个记录的第三列包含了最小值，则返回该记录。显然，第三列数据最小值为0，数据的第一个记录的第三列包含了该最小值，故而返回该记录。如果遇到多个记录同时包含该列最小值，则只返回遇到的第一个记录。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ minmax -Eh1 test.txt
4 4 2
&lt;/pre&gt;
&lt;p&gt;-Eh1返回第二列含有最大值的记录。而L和H则表示返回绝对值最小或最大的记录。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="i"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;-I选项示例&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
$ minmax -I1 test.txt
-R0/5/0/4
&lt;/pre&gt;
&lt;p&gt;在使用-I选项后，默认情况下会处理前两列数据，获取其最大和最小值，并以-Rw/e/s/n的形式给出。至于-I后面的1的含义，下面会有例子说明。&lt;/p&gt;
&lt;p&gt;minmax这样的返回格式，就带来命令行上的一个技巧：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psxy `minmax -I1 test.txt` test.txt -Jx1 -B1 -P -Sc0.2 &amp;gt; test.ps
&lt;/pre&gt;
&lt;p&gt;这个例子利用bash的反引号功能将minmax的输出-R0/5/0/4直接作为psxy命令的一个选项，将两行命令合成了一行。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="minmax-example" src="/images/2013082201.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;这样的图也许不是你想要的效果，因为6个点中有3个在边框上，看不清，所以要把-R的范围加大一些。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ minmax -I3 test.txt
-R0/6/0/6
&lt;/pre&gt;
&lt;p&gt;-I3对原始数据的最大最小值做了些处理。比如原来第一列的最大值5，变成了现在3的倍数6；原来第二列的最大值是4，现在变成了3的倍数6；0由于其自身就是3的倍数，所以没被修改。如果某列的最小值为-1，那么加入-I3之后就会变成-3。总之都是使得-R的范围变大了。这样画出来的图效果会更好（这个例子里的最小值0永远是任意一个数的倍数，所以导致-R的下限没有被加大，这个例子不太好）。当然也可以通过-I3/5这样的方式分别指定每一列的倍数值，其返回值为-R0/6/0/5。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ minmax -I3 -C test.txt
0 6 0 6 0 3
&lt;/pre&gt;
&lt;p&gt;-I选项和-C选项联合，可以对多列数据都采取类似的措施，默认-I3中的3对所有列都有效，可以使用-Ip3强制只对第一列有效；&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ minmax -Ip3 -C test.txt
0 6 0 4 0 3
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="s"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;-S选项示例&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;没理解这个选项，占位待续。。。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="t"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;-T选项示例&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;-T与-I选项类似，其默认处理第一列数据，也可以在-T后指定要处理的列。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ minmax -T2 test.txt
-T0/6/2
&lt;/pre&gt;
&lt;p&gt;其输出可以作为makecpt等命令的选项。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="GMT4"></category></entry><entry><title>PPK标记震相到时的一些注意事项</title><link href="http://seisman.info/notes-of-ppk.html" rel="alternate"></link><updated>2013-08-20T00:22:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-20:notes-of-ppk.html</id><summary type="html">&lt;p&gt;SAC中的ppk命令用于拾取震相到时。在键入ppk命令之后，进入震相拾取模式，此时键入相应的选项即可拾取震相到时。从ppk的命令说明中可以看出，ppk支持的选项中与到时有关的有：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A：定义初至波到时；&lt;/li&gt;
&lt;li&gt;F：定义事件结束时间；&lt;/li&gt;
&lt;li&gt;P：定义P波到时；&lt;/li&gt;
&lt;li&gt;S：定义S波到时；&lt;/li&gt;
&lt;li&gt;Tn：用户自定义到时（n=0~9）；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在《&lt;a class="reference external" href="http://seisman.info/timing-of-sac.html"&gt;SAC的时间概念&lt;/a&gt;》一文中介绍了SAC中所有与时间有关的头段变量的一些细节。其中与标记到时有关的头段变量有：A、F、Tn。&lt;/p&gt;
&lt;p&gt;将这二者做一比较，很容易猜到：ppk的A选项标记的到时信息保存到头段变量A中；F选项标记的到时保存到头段变量F中；Tn选项标记的到时保存到对应的头段变量Tn中。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;疑问：&lt;/strong&gt;ppk的P和S选项分别标记了P波到时和S波到时，那么着两个震相的到时保存到哪里了？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;答：&lt;/strong&gt;经过简单的测试可以知道，P波到时信息保存到了头段变量A中；S波到时保存到头段变量T0中。&lt;/p&gt;
&lt;p&gt;需要注意的是，使用ppk的P选项标定的到时一定保存到头段变量A中，不管原来头段变量A中有没有记录其他有用信息。同理，ppk的S选项标定的到时一定保存到头段变量T0中，不会因为头段变量T0中已经有值而保存到T1中。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;疑问：&lt;/strong&gt;在用T0标记某震相（比如PcP）后，在使用p、p1、ppk绘图时，在相应时刻总是显示字符“T0”，如何显示震相名称“PcP”？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;答：&lt;/strong&gt;如果熟知SAC的头段变量，这个问题很容易解决。A、F、Tn（n=0~9）每个浮点型头段变量都对应一个字符型头段变量，即KA、&lt;span class="caps"&gt;KF&lt;/span&gt;、KTn，这些字符型头段变量中可以保持震相名。&lt;/p&gt;
&lt;p&gt;如下例所示:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; r file
SAC&amp;gt; ppk
# 用光标标记震相PcP的到时为T0，然后退出ppk模式
SAC&amp;gt; p   # 此时看到的震相到时处显示字符&amp;quot;T0&amp;quot;
SAC&amp;gt; ch kt0 PcP
SAC&amp;gt; p   # 此时看到的震相到时处显示字符&amp;quot;PcP&amp;quot;
SAC&amp;gt; wh  # 标记的到时要记得保存；
SAC&amp;gt; q
&lt;/pre&gt;
</summary><category term="走时"></category><category term="震相"></category><category term="SAC技巧"></category></entry><entry><title>与TeX相关的一些名词</title><link href="http://seisman.info/terms-about-tex.html" rel="alternate"></link><updated>2013-08-15T17:29:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-15:terms-about-tex.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;前言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在接触TeX两年之后，依然对于TeX的一些术语之间的关系表示不解。比如LaTeX、pdfLaTeX、XeLaTeX、TeX Live、CTeX等等。这些术语究竟代表什么？它们之间是怎样的关系？&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;TeX&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;TeX首先是一种宏语言，同时其也是一种排版引擎。基本的TeX系统只有300多个元命令 (primitive) ，十分精悍，但是很难读懂。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;引擎&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;引擎是真正干活的程序。引擎的基本功能就是解释TeX语法，把字排成行，把行排成页，涉及到断字、断行、分页等算法。最原始的引擎是TeX。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;TeX：1978年由Donald Erwin Knuth开发。是后来大部分TeX相关的基础。其生成dvi文件，然后经由其他程序转换为pdf文件。&lt;/li&gt;
&lt;li&gt;pdfTeX：Tex语言的又一个实现，将TeX代码直接编译成PDF文件。&lt;/li&gt;
&lt;li&gt;XeTeX：TeX 语言的新的实现，支持 Unicode 编码和直接访问操作系统字体。&lt;/li&gt;
&lt;li&gt;LuaTeX：TeX 语言的一个完整的有扩展的实现。LuaTeX支持Unicode、系统字体和内嵌语言扩展，能直接输出PDF格式文件，也可以仍然输出 &lt;span class="caps"&gt;DVI&lt;/span&gt; 格式。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;TeX语言本身只有300个命令，晦涩难懂，只适合非正常的人类。一个简单的符号可能就需要多个命令来实现，可以将这些最基本的命令封装起来做个简写（宏）以实现特殊的目的。一堆简写的合集就构成了格式。格式可以与不同的引擎相结合。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Plain TeX：由Don Knuth提供的最小的宏集合。&lt;/li&gt;
&lt;li&gt;LaTeX：更易于使用的宏集，最常见的一种格式。&lt;/li&gt;
&lt;li&gt;ConTeXt：另一种常见的格式。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;宏包&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;一些辅助文件，在LaTeX中叫做packages，在ConTeXt中叫做modules。在LaTeX格式中，导言区的\usepackage的作用就是引入各种宏包。宏包其实也是一堆基本的TeX命令的集合，只是其不够全，所以称之为宏包而不是格式。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;发行版&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;一个完整的TeX需要最基本的TeX引擎、格式支持、各种辅助宏包、一些转换程序、&lt;span class="caps"&gt;GUI&lt;/span&gt;、编辑器、文档查看器等等。通过选择不同的组合就构成了不同的发行版。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;TeX Live：支持Linux，Windows，Mac &lt;span class="caps"&gt;OS&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;MiKTeX：只支持Windows&lt;/li&gt;
&lt;li&gt;CTeX：CTeX基于MiKTeX，并加入了中文的支持，只支持Windows。同时CTEX是一个网站，ctex是可以很好支持中文的宏包。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;其他相关&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;METAFONT&lt;/span&gt;：TeX中用来生成字体的程序。&lt;/li&gt;
&lt;li&gt;MetaPost：用于生成图像。&lt;/li&gt;
&lt;li&gt;BibTeX：用于生成参考文献。&lt;/li&gt;
&lt;li&gt;dvipdf：dvi转换成pdf。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;相关命令&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在介绍了引擎以及格式之后，二者不同的搭配方式需要调用不同的命令：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="latex things" src="/images/2013081501.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;目前最常用的引擎是pdfTeX和XeTeX，其中XeTeX可以很好的支持中文，因而受到国人的青睐。格式方面LaTeX当仁不让。所以目前比较流行的编译命令是xelatex，同时在中文支持方面，几年前是CJK宏包，现在是ctex宏包。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;参考文章&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://blog.163.com/goldman2000@126/blog/static/1672968952012112645041621/"&gt;http://blog.163.com/goldman2000@126/blog/static/1672968952012112645041621/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/alt/tex-overview"&gt;https://github.com/alt/tex-overview&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;附录&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;附上该表的代码：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;\documentclass&lt;/span&gt;&lt;span class="na"&gt;[UTF8]&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;ctexart&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\usepackage&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;booktabs&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\usepackage&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;xltxtra&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\begin&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;document&lt;span class="nb"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;\begin&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;table&lt;span class="nb"&gt;}&lt;/span&gt;[h]
&lt;span class="k"&gt;\caption&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;&lt;span class="k"&gt;\TeX&lt;/span&gt;相关命令比较&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\centering&lt;/span&gt;
&lt;span class="k"&gt;\begin&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;tabular&lt;span class="nb"&gt;}{&lt;/span&gt;llll&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\toprule&lt;/span&gt;
命令 &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; 引擎 &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; 格式 &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; 输出 &lt;span class="k"&gt;\\&lt;/span&gt;
&lt;span class="k"&gt;\midrule&lt;/span&gt;
tex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; plain&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; DVI &lt;span class="k"&gt;\\&lt;/span&gt;
dviluatex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; Lua&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; plain&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; DVI &lt;span class="k"&gt;\\&lt;/span&gt;
etex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; plain&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; DVI &lt;span class="k"&gt;\\&lt;/span&gt;
luatex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; Lua&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; plain&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF &lt;span class="k"&gt;\\&lt;/span&gt;
pdftex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; plain&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF &lt;span class="k"&gt;\\&lt;/span&gt;
xetex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\XeTeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; plain&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; DVI &lt;span class="k"&gt;\\&lt;/span&gt;
&lt;span class="k"&gt;\midrule&lt;/span&gt;
latex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\LaTeX&lt;/span&gt;2e &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; DVI &lt;span class="k"&gt;\\&lt;/span&gt;
dvilualatex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; Lua&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\LaTeX&lt;/span&gt;2e &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; DVI &lt;span class="k"&gt;\\&lt;/span&gt;
lualatex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; Lua&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\LaTeX&lt;/span&gt;2e &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF &lt;span class="k"&gt;\\&lt;/span&gt;
pdflatex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF&lt;span class="k"&gt;\TeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\LaTeX&lt;/span&gt;2e &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF &lt;span class="k"&gt;\\&lt;/span&gt;
xelatex &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\XeTeX&lt;/span&gt; &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; &lt;span class="k"&gt;\LaTeX&lt;/span&gt;2e &lt;span class="nb"&gt;&amp;amp;&lt;/span&gt; PDF &lt;span class="k"&gt;\\&lt;/span&gt;
&lt;span class="k"&gt;\bottomrule&lt;/span&gt;
&lt;span class="k"&gt;\end&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;tabular&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;\end&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;table&lt;span class="nb"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;\end&lt;/span&gt;&lt;span class="nb"&gt;{&lt;/span&gt;document&lt;span class="nb"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
</summary><category term="名词解释"></category><category term="LaTeX"></category></entry><entry><title>GMT之gmtset与gmtget</title><link href="http://seisman.info/gmtset-gmtget.html" rel="alternate"></link><updated>2013-08-15T17:16:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-15:gmtset-gmtget.html</id><summary type="html">&lt;p&gt;gmtset用于修改当前目录下的.gmtdefaults4文件中的GMT参数，如果没有该文件，则会先创建。由于gmtset会修改当前目录下的参数文件，所以这个修改对接下来的命令都是有效的。在一个脚本中，首先执行了一些命令，然后gmtset修改了参数，再执行几个命令，这些绘制出自己想要的效果。但是当你再次执行该脚本时，由于当前目录下已经存在.gmtdefaults4文件，且参数已经被修改，绘制出的图可能不是你想要的效果。可以在脚本的结尾通过gmtset将参数改回原值或者直接删除.gmtdefaults4来避免这种情况。&lt;/p&gt;
&lt;p&gt;gmtget用于获取当前目录下的.gmtdefaults4中的参数值，其本质上是一个shell脚本，内容如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/sh&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# gmtget - Return the current setting of the specified parameter&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="si"&gt;${#}&lt;/span&gt; -ne &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;usage: gmtget PARAMETER&amp;quot;&lt;/span&gt; &amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;2
&lt;span class="nb"&gt;exit&lt;/span&gt; -1
&lt;span class="k"&gt;fi&lt;/span&gt;
gmtdefaults -L &lt;span class="p"&gt;|&lt;/span&gt; grep &lt;span class="s2"&gt;&amp;quot;^&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;1&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; awk &lt;span class="s1"&gt;&amp;#39;{print $3}&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="GMT命令"></category><category term="GMT4"></category></entry><entry><title>GMT之gmtdefaults</title><link href="http://seisman.info/gmtdefaults4.html" rel="alternate"></link><updated>2013-08-15T17:14:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-15:gmtdefaults4.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;前言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT中存在很多默认参数，这些参数会影响最后的绘图效果。gmtdefaults命令可以给出系统默认的参数以及用户自己的当前参数。关于GMT如何修改参数，可以看另一篇博文。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;命令及选项&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
gmtdefaults 4.5.9 [64-bit] - List GMT default parameters to stdout

usage: gmtdefaults [-D[s|u] | -L]

-D prints the default settings for the GMT system.
Append s to see the SI version of defaults.
Append u to see the US version of defaults.
-L prints the users current GMT default settings.
&lt;/pre&gt;
&lt;p&gt;命令和选项很简单，-D和-L一个是打印系统参数，一个打印用户自定义参数。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;默认参数&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;绘图介质参数：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;PAGE_COLOR = white  #纸张的背景色，不能透明&lt;/li&gt;
&lt;li&gt;PAGE_ORIENTATION = landscape # portrait或landscape&lt;/li&gt;
&lt;li&gt;PAPER_MEDIA = a4 #纸张大小&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;底图注释参数：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ANNOT_MIN_ANGLE = 20 #在倾斜投影中，若地图边界与注释的基线夹角小于该值，则无注释。在一般投影中地图边界与注释基线垂直&lt;/li&gt;
&lt;li&gt;ANNOT_MIN_SPACING = 0  #相邻注释之间的最小距离&lt;/li&gt;
&lt;li&gt;ANNOT_FONT_PRIMARY = Helvetica  #主注释字体，系统自带35种&lt;/li&gt;
&lt;li&gt;ANNOT_FONT_SIZE_PRIMARY = 14p  #主注释文字大小&lt;/li&gt;
&lt;li&gt;ANNOT_OFFSET_PRIMARY = 0.2c  #主注释与刻度之间的距离&lt;/li&gt;
&lt;li&gt;ANNOT_FONT_SECONDARY = Helvetica #次注释字体&lt;/li&gt;
&lt;li&gt;ANNOT_FONT_SIZE_SECONDARY = 16p #次注释大小&lt;/li&gt;
&lt;li&gt;ANNOT_OFFSET_SECONDARY = 0.2c #次注释的底部与主注释顶部的距离&lt;/li&gt;
&lt;li&gt;DEGREE_SYMBOL = ring   #如何表示度这个符号&lt;/li&gt;
&lt;li&gt;HEADER_FONT = Helvetica # 标题字体&lt;/li&gt;
&lt;li&gt;HEADER_FONT_SIZE = 36p #标题大小&lt;/li&gt;
&lt;li&gt;HEADER_OFFSET = 0.5c #标题与上边界的距离&lt;/li&gt;
&lt;li&gt;LABEL_FONT = Helvetica  #&lt;/li&gt;
&lt;li&gt;LABEL_FONT_SIZE = 24p #&lt;/li&gt;
&lt;li&gt;LABEL_OFFSET = 0.3c #&lt;/li&gt;
&lt;li&gt;OBLIQUE_ANNOTATION = 1 #&lt;/li&gt;
&lt;li&gt;PLOT_CLOCK_FORMAT = hh:mm:ss #绘图时间格式&lt;/li&gt;
&lt;li&gt;PLOT_DATE_FORMAT = yyyy-mm-dd #绘图日期格式&lt;/li&gt;
&lt;li&gt;PLOT_DEGREE_FORMAT = ddd:mm:ss #绘图度格式&lt;/li&gt;
&lt;li&gt;Y_AXIS_TYPE = hor_text  # y轴注释水平还是垂直&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;底图布局参数&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;BASEMAP_AXES = &lt;span class="caps"&gt;WESN&lt;/span&gt;  #控制在哪条边上注释&lt;/li&gt;
&lt;li&gt;BASEMAP_FRAME_RGB = black  #底图frame颜色&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/gmt-basemap-type.html"&gt;BASEMAP_TYPE&lt;/a&gt; = fancy  # inside会把注释和刻度放在图内部，graph用于线性投影，在坐标轴上加箭头，plain是最一般的类型,fancy是画地图常见的黑白相间的边框&lt;/li&gt;
&lt;li&gt;FRAME_PEN = 1.25p  # plain frame的宽度&lt;/li&gt;
&lt;li&gt;FRAME_WIDTH = 0.2c #fancy frame的宽度&lt;/li&gt;
&lt;li&gt;GRID_CROSS_SIZE_PRIMARY = 0c #主注释经纬度交线处十字叉的尺寸，0表示连续的网格线&lt;/li&gt;
&lt;li&gt;GRID_PEN_PRIMARY = 0.25p # 线的宽度&lt;/li&gt;
&lt;li&gt;GRID_CROSS_SIZE_SECONDARY = 0c  #&lt;/li&gt;
&lt;li&gt;GRID_PEN_SECONDARY = 0.5p #&lt;/li&gt;
&lt;li&gt;MAP_SCALE_HEIGHT = 0.2c  # 地图scale的高度&lt;/li&gt;
&lt;li&gt;POLAR_CAP = 85/90 #控制两极地区网格线&lt;/li&gt;
&lt;li&gt;TICK_LENGTH = 0.2c #tickmark的长度&lt;/li&gt;
&lt;li&gt;TICK_PEN = 0.5p  #tickmark的宽度&lt;/li&gt;
&lt;li&gt;X_AXIS_LENGTH = 25c&lt;/li&gt;
&lt;li&gt;Y_AXIS_LENGTH = 15c&lt;/li&gt;
&lt;li&gt;X_ORIGIN = 2.5c # 绘图相对于纸张左下角的X距离&lt;/li&gt;
&lt;li&gt;Y_ORIGIN = 2.5c #&lt;/li&gt;
&lt;li&gt;UNIX_TIME = &lt;span class="caps"&gt;FALSE&lt;/span&gt; #是否显示时间戳（-U）&lt;/li&gt;
&lt;li&gt;UNIX_TIME_POS = &lt;span class="caps"&gt;BL&lt;/span&gt;/-2c/-2c #时间戳位置&lt;/li&gt;
&lt;li&gt;UNIX_TIME_FORMAT = %Y %b %d %H:%M:%S #时间戳格式&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;颜色参数&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;COLOR_BACKGROUND = black   # z&amp;lt;cpt文件最小值时的背景色&lt;/li&gt;
&lt;li&gt;COLOR_FOREGROUND = white  # z&amp;gt;cpt文件最大值的前景色&lt;/li&gt;
&lt;li&gt;COLOR_NAN = 128      #图像中z=NaN部分的颜色&lt;/li&gt;
&lt;li&gt;COLOR_IMAGE = adobe   #控制PS渲染&lt;/li&gt;
&lt;li&gt;COLOR_MODEL = rgb     #默认cpt文件类型&lt;/li&gt;
&lt;li&gt;HSV_MIN_SATURATION = 1  #&lt;/li&gt;
&lt;li&gt;HSV_MAX_SATURATION = 0.1 #&lt;/li&gt;
&lt;li&gt;HSV_MIN_VALUE = 0.3 #&lt;/li&gt;
&lt;li&gt;HSV_MAX_VALUE = 1 #&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PostScript参数&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;CHAR_ENCODING = ISOLatin1+   #字符编码，用于绘制特殊字符&lt;/li&gt;
&lt;li&gt;DOTS_PR_INCH = 300   #绘图精度，每英寸的像素数&lt;/li&gt;
&lt;li&gt;GLOBAL_X_SCALE = 1  # ？？&lt;/li&gt;
&lt;li&gt;GLOBAL_Y_SCALE = 1  # ？？&lt;/li&gt;
&lt;li&gt;N_COPIES = 1 #每张图的copy数&lt;/li&gt;
&lt;li&gt;PS_COLOR = rgb #&lt;/li&gt;
&lt;li&gt;PS_IMAGE_COMPRESS = lzw # 图像压缩算法&lt;/li&gt;
&lt;li&gt;PS_IMAGE_FORMAT = ascii #生成的图像是ASCII还是二进制&lt;/li&gt;
&lt;li&gt;PS_LINE_CAP = butt #控制线段的端点&lt;/li&gt;
&lt;li&gt;PS_LINE_JOIN = miter #&lt;/li&gt;
&lt;li&gt;PS_MITER_LIMIT = 35 #&lt;/li&gt;
&lt;li&gt;PS_VERBOSE = &lt;span class="caps"&gt;FALSE&lt;/span&gt; #是否在PS文件中写更多的注释&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;TRANSPARENCY&lt;/span&gt; = 0  #控制透明度，基本没用&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;输入输出格式参数&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;D_FORMAT = %.12lg  #双精度浮点型的输出格式&lt;/li&gt;
&lt;li&gt;FIELD_DELIMITER = tab #GMT输出的每列的的分割符&lt;/li&gt;
&lt;li&gt;GRIDFILE_FORMAT = nf  # 默认网格文件格式&lt;/li&gt;
&lt;li&gt;GRIDFILE_SHORTHAND = &lt;span class="caps"&gt;FALSE&lt;/span&gt; #是否检查网格文件后缀&lt;/li&gt;
&lt;li&gt;INPUT_CLOCK_FORMAT = hh:mm:ss # 输入的时间格式&lt;/li&gt;
&lt;li&gt;INPUT_DATE_FORMAT = yyyy-mm-dd #输入的日期格式&lt;/li&gt;
&lt;li&gt;IO_HEADER = &lt;span class="caps"&gt;FALSE&lt;/span&gt; #输入输出文件是否有头段&lt;/li&gt;
&lt;li&gt;N_HEADER_RECS = 1 # 如果有头段的话，默认为1个&lt;/li&gt;
&lt;li&gt;NAN_RECORDS = pass #遇到NaN该如何处理&lt;/li&gt;
&lt;li&gt;OUTPUT_CLOCK_FORMAT = hh:mm:ss #输出时间格式&lt;/li&gt;
&lt;li&gt;OUTPUT_DATE_FORMAT = yyyy-mm-dd #输出日期格式&lt;/li&gt;
&lt;li&gt;OUTPUT_DEGREE_FORMAT = D #输出度的格式&lt;/li&gt;
&lt;li&gt;XY_TOGGLE = &lt;span class="caps"&gt;FALSE&lt;/span&gt; #经纬度互换&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;投影参数&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;ELLIPSOID&lt;/span&gt; = &lt;span class="caps"&gt;WGS&lt;/span&gt;-84  # 地球椭球模型&lt;/li&gt;
&lt;li&gt;MAP_SCALE_FACTOR = default #&lt;/li&gt;
&lt;li&gt;MEASURE_UNIT = cm  # 默认单位&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;日期时间参数&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;TIME_FORMAT_PRIMARY = full #&lt;/li&gt;
&lt;li&gt;TIME_FORMAT_SECONDARY = full #&lt;/li&gt;
&lt;li&gt;TIME_EPOCH = 2000-01-01T12:00:00 # 相对时间的参考点&lt;/li&gt;
&lt;li&gt;TIME_IS_INTERVAL = &lt;span class="caps"&gt;OFF&lt;/span&gt; #&lt;/li&gt;
&lt;li&gt;TIME_INTERVAL_FRACTION = 0.5 #&lt;/li&gt;
&lt;li&gt;TIME_LANGUAGE = us # 时间语言&lt;/li&gt;
&lt;li&gt;TIME_UNIT = d # 相对时间的单位&lt;/li&gt;
&lt;li&gt;TIME_WEEK_START = Sunday # 每周起始日&lt;/li&gt;
&lt;li&gt;Y2K_OFFSET_YEAR = 1950 #&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其他参数&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;HISTORY&lt;/span&gt; = &lt;span class="caps"&gt;TRUE&lt;/span&gt; # 是否记录历史命令中的参数&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;INTERPOLANT&lt;/span&gt; = akima # 一维插值算法&lt;/li&gt;
&lt;li&gt;LINE_STEP = 0.025c #绘制直线时取点的间隔&lt;/li&gt;
&lt;li&gt;VECTOR_SHAPE = 0 #矢量头部的形状。&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;VERBOSE&lt;/span&gt; = &lt;span class="caps"&gt;FALSE&lt;/span&gt; #&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="GMT4"></category></entry><entry><title>GMT之利用ps2raster实现图像格式转换</title><link href="http://seisman.info/format-conversion-using-ps2raster.html" rel="alternate"></link><updated>2013-08-15T17:11:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-15:format-conversion-using-ps2raster.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;前言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT中与绘图相关的大部分命令的输出都是PS代码，我们一般将输出通过"&amp;gt;"或者"&amp;gt;&amp;gt;"重定向到ps文件中，然后用gs查看。PS是矢量图像格式，因而可以任意放大而不失真，满足了出版社对高质量图像的要求。有时候在用word随便写点文章或者制作ppt时，ps图像无法直接插入，因而需要将ps文件转换为常见的其他图像格式。格式转换可以使用强大的convert命令，不过GMT提供的ps2raster命令已经足够了。&lt;/p&gt;
&lt;p&gt;ps2raster利用ghostscript程序将ps文件转换为多种格式，&lt;span class="caps"&gt;BMP&lt;/span&gt;, &lt;span class="caps"&gt;EPS&lt;/span&gt;, &lt;span class="caps"&gt;JPEG&lt;/span&gt;, &lt;span class="caps"&gt;PDF&lt;/span&gt;, &lt;span class="caps"&gt;PNG&lt;/span&gt;, &lt;span class="caps"&gt;PPM&lt;/span&gt;, &lt;span class="caps"&gt;TIFF&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;命令&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
ps2raster 4.5.9 [64-bit] - Converts one or several [E]PS file(s) toraster formats using GhostScript.
usage: ps2raster psfile1 psfile2... [-A[u][-]] [-Cgs_command] [-Ddir] [-Eresolution] [-Fout_name]
[-Gghost_path] [-Llistfile] [-N] [-P] [-Q[g\|t]1\|2\|4] [-S] [-Tb\|e\|f\|g\|G\|j\|m\|t] [-V]
[-W[+g][+k][+ttitle][+nname][+amode[alt]][+llodmin/lodmax][+fminfade/maxfade][+uURL&amp;amp;]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;需要关注的参数为-A、-E、-T和-P：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;psfiles：要进行转换的ps文件&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-A：&lt;/strong&gt;一般ps文件的尺寸为一张A4纸的大小（PAPER_MEDIA），很多时候绘图只占用了纸张的一小部分。这个选项可以重新定义BoudingBox，将空白的部分去除。-Au可以额外去除GMT的时间戳（-U）。（觉得这个选项去空白去得有点过了，图像周围基本一点空白都没有）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-E：&lt;/strong&gt;设置位图的精度。默认pdf格式dpi=720，其他格式dpi=300。pdf格式是矢量格式，但是其中的图案填充以及字体是以位图的格式存储的，-E选项对这部分是有效的。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-T：&lt;/strong&gt;指定输出格式，默认为jpeg格式。b指bmp，e代表eps，f代表pdf，j代表jpeg，g代表png，G代表透明的png，m代表ppm，t代表tiff。对于bgjt后可加-以产生灰度图。EPS是格式转换过程的中间文件，因而可以和其他格式同时生成，比如可以使用-Tef同时产生pdf和eps文件。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-P：&lt;/strong&gt;Portrait mode。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;比较小众的选项如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;-C：&lt;/strong&gt;传递额外的参数给ghostscript&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-D：&lt;/strong&gt;输出目录。-D.代表当前目录&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-F：&lt;/strong&gt;强制修改转换后的文件名，后缀不能改&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-G：&lt;/strong&gt;ghostscript的完整路径，Linux下一般用不到&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-L：&lt;/strong&gt;内含要转换的ps文件名。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-Q：&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-S：&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-V：&lt;/strong&gt;verbose&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-W：&lt;/strong&gt;这个选项有些复杂，可以用于生成geotiff文件以及KMZ文件。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;例子&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;最常用的一个例子，将ps文件转换为jpeg文件&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ps2raster -A -P test.ps
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;一些说明&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;该命令主要处理GMT生成的PS文件，对于其他程序生成的PS文件不能完美支持；&lt;/li&gt;
&lt;li&gt;该命令要求GMT生成的PS文件是完整的，即要求用户正确使用-K、-O。若PS文件未正确关闭，可以用gs查看ps文件，但是无法用ps2raster进行转换；&lt;/li&gt;
&lt;li&gt;如eyou所说，当设置纸张背景色时，该命令的-A选项无法实现切边；&lt;/li&gt;
&lt;li&gt;如果有更多需要的话可以使用ImageMagick的convert命令。&lt;a class="reference external" href="http://www.imagemagick.org/script/command-line-options.php"&gt;官方说明&lt;/a&gt;。本站博文在&lt;a class="reference external" href="http://seisman.info/convert-and-ps2raster.html"&gt;这里&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-08-15：初稿；&lt;/li&gt;
&lt;li&gt;2013-09-26：添加了一些说明，并挑出需要关注的选项；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT命令"></category><category term="图像"></category><category term="GMT4"></category><category term="格式转换"></category></entry><entry><title>GMT之用triangulate进行Delaunay三角剖分</title><link href="http://seisman.info/delaunay-triangulation.html" rel="alternate"></link><updated>2013-08-14T17:07:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-14:delaunay-triangulation.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;三角剖分简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;什么是Delaunay三角剖分？我也不清楚。想要知道细节可以看这篇&lt;a class="reference external" href="http://www.cnblogs.com/soroman/archive/2007/05/17/750430.html"&gt;博文&lt;/a&gt;、&lt;a class="reference external" href="http://en.wikipedia.org/wiki/Delaunay_triangulation"&gt;维基百科&lt;/a&gt;以及一堆相关文献。&lt;/p&gt;
&lt;p&gt;不负责任地简单概括一下：平面上有点集P，点集P中任意三个不共线的点就可以连成一个三角形DT(P)。Delaunay三角剖分使得点集P中没有点位于任意三角形DT(P)的外接圆内，同时保证三角形的所有角中的最小角度最大。&lt;/p&gt;
&lt;p&gt;下图摘自于维基百科，黑点代表平面上的点集，黑实线为Delaunay三角剖分的结果，灰色圆为三角形的外接圆，红点为外接圆的圆心。通过Delaunay三角剖分，利用平面上的点集构建了新的三角单元。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 1" src="/images/2013081401.png" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;点集的三角剖分，主要运用于数值分析（比如有限元分析中的单元划分）以及图形学。搜索了一下，发现其还可以用于生成Voronoi图、指纹匹配、成像、破洞修复、变电站选址。。。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
triangulate 4.5.9 [64-bit] - Optimal (Delaunay) triangulation of Cartesian xyz-data [Watson]

usage: triangulate &amp;lt;infiles&amp;gt; [-Dx|y] [-E&amp;lt;empty&amp;gt;] [-F] [-G&amp;lt;grdfile&amp;gt;]
[-H[i][&amp;lt;nrec&amp;gt;]] [-I&amp;lt;xinc&amp;gt;[u][=|+][/&amp;lt;yinc&amp;gt;[u][=|+]]] [-J&amp;lt;params&amp;gt;]
[-R&amp;lt;west&amp;gt;/&amp;lt;east&amp;gt;/&amp;lt;south&amp;gt;/&amp;lt;north&amp;gt;[r]] [-V] [-:[i|o]]
[-b[i|o][s|S|d|D[&amp;lt;ncol&amp;gt;]|c[&amp;lt;var1&amp;gt;/...]]]
[-f[i|o]&amp;lt;colinfo&amp;gt;] [-m[i|o][&amp;lt;flag&amp;gt;]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;选项说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;-H、-J、-R、-V、-：、-bi、-bo、-f选项与其他命令含义相同或相似。&lt;/p&gt;
&lt;p&gt;与文件相关的选项：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;infile：包含点坐标，每行代表一个点，第一行对应的点编号为0，可以是ASCII或二进制&lt;/li&gt;
&lt;li&gt;-Z：二进制文件是两列还是三列&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;默认输出的每个记录是每个三角形的三个顶点的id号（文件中第一个点id=0），可以通过下面两个选项修改输出：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-m：将整个三角剖分的结果以多个线段表示，每个线段记录的第一个字符为"&amp;gt;"，这样的输出可以用于psxy绘图&lt;/li&gt;
&lt;li&gt;-Q：输出Voronoi单元的边。（需要-m和-R）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下面的选项可以将三角剖分的结果保存为网格文件：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-G：将三角剖分的结果划分为等间距的网格文件（-R，-I）&lt;/li&gt;
&lt;li&gt;-D：不理解。。。&lt;/li&gt;
&lt;li&gt;-E：设置网格空node处的值，默认为NaN&lt;/li&gt;
&lt;li&gt;-F：设置网格为pixel node registration，默认为gridline registration&lt;/li&gt;
&lt;li&gt;-I：设置网格间距&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;例子&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;数据在这里：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/station.txt"&gt;station&lt;/a&gt;，貌似对应了一个地区的台站位置。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
triangulate station.txt &amp;gt; v.list
&lt;/pre&gt;
&lt;p&gt;v.list的内容大概如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
1 2 5
12 16 27
0 6 7
9 13 15
9 10 15
0 3 7
&lt;/pre&gt;
&lt;p&gt;每行三列，代表三角形的三个顶点的id，注意输入文件中第一个点的id为0。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
triangulate station.txt -m &amp;gt;v.list
&lt;/pre&gt;
&lt;p&gt;这个时候的输出为线段，如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
&amp;gt; Edge 0-3
120.065 30.153
120.1065 29.8935
&amp;gt; Edge 0-5
120.065 30.153
119.4813 29.9489
&amp;gt; Edge 0-6
120.065 30.153
120.05 30.386
&amp;gt; Edge 0-7
120.065 30.153
120.3765 30.3086
&lt;/pre&gt;
&lt;p&gt;以&amp;gt;开始的行代表一个新记录，Edge 0-3指定了顶点为0和3，然后给出这两个点的坐标。这个文件可以直接用于psxy绘图。&lt;/p&gt;
&lt;p&gt;可以利用psxy直接绘制v.list文件：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
psxy v.list -m -R118.4/122.5/27.4/30.9 -JM5i -W0.5p -B1 -V&amp;gt; voronoi.ps
&lt;/pre&gt;
&lt;p&gt;当然也可以利用管道，而不生成中间文件v.list：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
triangulate station.txt -m | psxy -m -R118.4/122.5/27.4/30.9 -JM5i -W0.5p -B1 -V delaunay.ps
&lt;/pre&gt;
&lt;p&gt;效果如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 2" src="/images/2013081402.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;可以用-Q选项生成Voronoi图：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
triangulate zj_stn.txt -m -Q -R118.4/122.5/27.4/30.9 | psxy -m -R -JM6.5i -W0.5p -B1 -V -P&amp;gt; voronoi.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 3" src="/images/2013081403.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;其他&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;-Q选项的输出可以用于绘制Voronoi图，但是这个选项依赖于另一个算法，在编译GMT时默认使用Watson[1982]，这个选项需要使用Shewchuk [1996]。&lt;/li&gt;
&lt;li&gt;关于-G选项生成网格，应该与一般网格没有区别。&lt;/li&gt;
&lt;li&gt;在使用triangulate命令时可以指定地图投影（-R和-J），这样数据点首先会进行投影，然后再进行三角剖分(这里可能是球面上的三角剖分)。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT命令"></category></entry><entry><title>SAC保存图像小结</title><link href="http://seisman.info/sac-save-image.html" rel="alternate"></link><updated>2013-08-13T16:30:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-13:sac-save-image.html</id><summary type="html">
&lt;p&gt;数据的处理很重要，数据的可视化更重要，数据可视化之后总会想把图保存起来，这里小结一下SAC中保存图像的方法。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;窗口绘图并截图&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC中的绘图窗口基于XWindows。XWindows大概是Linux下非常常见的视窗系统。在SAC中可以通过plot，plot1，plot2，plotpk等命令实现SAC数据的绘制以及各种交互动作（主要就是标记震相）。最简单粗暴的方法大概就是截屏了。截屏的话gnome下有个screenshot，可以截取整个屏幕；推荐安装ImageMagick，其中的import命令可以通过鼠标拖曳一个区域进行截图，貌似支持保存为很多种格式。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sgf"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;生成SGF文件再转换&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SGF是SAC Graphic File的简称，这是SAC自己设计的图像格式，里面包含了SAC图像的基本信息。在SAC中打开SGF设备-&amp;gt;绘图产生SGF文件-&amp;gt;退出SAC-&amp;gt;利用sgftops将sgf文件转换为ps文件-&amp;gt;ps2pdf转换为pdf文件。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;[&lt;/span&gt;seisman@info ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sac
SEISMIC ANALYSIS CODE &lt;span class="o"&gt;[&lt;/span&gt;02/01/2012 &lt;span class="o"&gt;(&lt;/span&gt;Version 101.5c&lt;span class="o"&gt;)]&lt;/span&gt;
Copyright &lt;span class="m"&gt;1995&lt;/span&gt; Regents of the University of California

SAC&amp;gt; &lt;span class="nb"&gt;fg &lt;/span&gt;seis
SAC&amp;gt; bd sgf
SAC&amp;gt; p
SAC&amp;gt; q
&lt;span class="o"&gt;[&lt;/span&gt;seisman@info ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sgftops f001.sgf f001.ps &lt;span class="m"&gt;2&lt;/span&gt; si
First translates &lt;span class="o"&gt;(&lt;/span&gt;x and y&lt;span class="o"&gt;)&lt;/span&gt;, &lt;span class="k"&gt;then&lt;/span&gt; rotates, &lt;span class="k"&gt;then&lt;/span&gt; scales:
&lt;span class="o"&gt;[&lt;/span&gt;Default&lt;span class="o"&gt;]&lt;/span&gt; landscape: &lt;span class="m"&gt;8&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; to prompts
Sample portrait: 0.5 0.5 &lt;span class="m"&gt;0&lt;/span&gt; 0.75

x translation : 0.5
y translation : 0.5
rotation angle: 0
scale........ : 0.75
&lt;span class="o"&gt;[&lt;/span&gt;seisman@info ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="saveimg"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;SAVEIMG直接保存图形文件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt; 101.5之后的版本加入了新功能，可以直接保存图形文件，这是个神器～目前支持的格式为ps、pdf、png、xpm。ps和pdf是矢量格式，因而是绘图的首选格式，png和xpm是位图图形格式，绘图精度较差，因而不建议使用。考虑到图像不清晰，且png和xpm需要格外的库文件，在SAC 101.6发布的二进制文件中不再支持png和xpm。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;SAC&amp;gt; fg seis
SAC&amp;gt; p
SAC&amp;gt; saveimg foo.ps
save file foo.ps [PS]
SAC&amp;gt; q
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="pssacps"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;pssac绘制ps文件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;pssac利用GMT的ps库直接绘制SAC文件，pssac的具体细节可以站内搜索"pssac"。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Xwindows窗口最快最省事，截图的话平时看看还行，见不了大世面；&lt;/li&gt;
&lt;li&gt;sgf转换有点麻烦，生成的ps文件线条看上去有点模糊，偶尔会出现bug，ps文件上多出了额外的线条；&lt;/li&gt;
&lt;li&gt;saveimg是后起之秀，建议使用；&lt;/li&gt;
&lt;li&gt;pssac功能强大，在需要设计复杂图形时有用，当然用起来需要花点时间学。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="SAC技巧"></category><category term="图像"></category></entry><entry><title>Linux下的GMT中文支持</title><link href="http://seisman.info/gmt-chinese-under-linux.html" rel="alternate"></link><updated>2014-10-14T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-13:gmt-chinese-under-linux.html</id><summary type="html">
&lt;p&gt;原生GMT是不支持中文的，想要让GMT支持中文，需要进行一番配置。想要理解整个问题，需要对PostScript、CID字体有更深刻的理解，这未免有些过于复杂。所以这篇博文只介绍一些基本的原理，不一定准确但是却够用。&lt;/p&gt;
&lt;p&gt;修改配置这个事情本身不难，麻烦的是不同的发行版对ghostscript的打包方式不同，不同的ghostscript版本之间也会有一些差异。这里列出我在使用的系统信息，对于其他发行版以及gs版本，也有一些参考意义。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;操作系统：CentOS 7.0&lt;/li&gt;
&lt;li&gt;ghostscript：9.07&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt;：4.5.12或5.1.1（以4.5.12为例）&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;准备工作&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="gs"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;安装gs&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;对于大多数发行版而言，gs都是默认安装的。相关的文件位于&lt;tt class="docutils literal"&gt;/usr/share/ghostscript&lt;/tt&gt;目录下。除此之外，还需要安装简体中文配置文件。&lt;/p&gt;
&lt;p&gt;不同的发行版中，中文配置文件所在的包是不同的：&lt;/p&gt;
&lt;p&gt;CentOS 7:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sudo yum install ghostscript-chinese-zh_CN
&lt;/pre&gt;
&lt;p&gt;CentOS 6:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sudo yum install cjkuni-fonts-ghostscript
&lt;/pre&gt;
&lt;p&gt;Ubuntu 14.04:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sudo apt-get install poppler-data
&lt;/pre&gt;
&lt;p&gt;Ubuntu 12.04:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ sudo apt-get install gs-cjk-resource
&lt;/pre&gt;
&lt;p&gt;安装完相应的包之后，中文配置文件所在的目录也不同，下面统称为&lt;tt class="docutils literal"&gt;conf.d&lt;/tt&gt; 目录：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;CentOS 6、7：&lt;tt class="docutils literal"&gt;/usr/share/ghostscript/conf.d&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Ubuntu 12.04、14.04： &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/etc/ghostscript/cidfmap.d/90gs-cjk-resource-gb1.conf&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;安装GMT&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这步就不用再多说了。安装后的GMT位于&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/opt/&lt;span class="caps"&gt;GMT&lt;/span&gt;-4.5.12&lt;/span&gt;&lt;/tt&gt;，其中与字体有关的文件为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/opt/&lt;span class="caps"&gt;GMT&lt;/span&gt;-4.5.12/share/pslib/PS_font_info.d&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;使gs支持中文&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下文的说明中，所有路径以CentOS发行版为准。&lt;/p&gt;
&lt;div class="section" id="cidfmap"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;cidfmap&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;进入&lt;tt class="docutils literal"&gt;conf.d&lt;/tt&gt;目录下，有文件&lt;tt class="docutils literal"&gt;cidfmap.zh_CN&lt;/tt&gt;（该目录下还有&lt;tt class="docutils literal"&gt;CIDFnmap.zh_CN&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;FAPIcidfmap.zh_CN&lt;/tt&gt;，不管） ，其内容为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
/BousungEG-Light-GB &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/wqy-zenhei/wqy-zenhei.ttc) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
/GBZenKai-Medium    &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/wqy-zenhei/wqy-zenhei.ttc) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
/MSungGBK-Light     /BousungEG-Light-GB ;
/Adobe-GB1      /BousungEG-Light-GB ;
&lt;/pre&gt;
&lt;p&gt;其中的细节可能看不懂，但是可以大概总（xia）结（cai）如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;第一行定义了字体名为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/BousungEG-Light-&lt;span class="caps"&gt;GB&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;，对应的字体文件为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/usr/share/fonts/wqy-zenhei/wqy-zenhei.ttc&lt;/span&gt;&lt;/tt&gt;，也就是文泉驿正黑；&lt;/li&gt;
&lt;li&gt;第二行定义了字体名为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/GBZenKai-Medium&lt;/span&gt;&lt;/tt&gt;，对应的字体文件也是文泉驿正黑；&lt;/li&gt;
&lt;li&gt;第三行和第四行分别定义了字体名&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/MSungGBK-Light&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/Adobe-&lt;span class="caps"&gt;GB1&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;，这两种都对应于&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/BousungEG-Light-&lt;span class="caps"&gt;GB&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;，相当于给字体定义了别名。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;关于这个文件需要说的几点是：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;字体名是任意的，比如可以把字体名取为&lt;tt class="docutils literal"&gt;/&lt;span class="caps"&gt;ABC&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;字体文件似乎只能是&lt;tt class="docutils literal"&gt;ttc&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;ttf&lt;/tt&gt;格式的，当然修改参数也有可能可以使用其他格式的字体；&lt;/li&gt;
&lt;li&gt;由于Linux下中文字体并不统一，所以要注意检查配置文件中的字体文件路径是否正确；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="cmap"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;CMap&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;CMap位于&lt;tt class="docutils literal"&gt;/usr/share/ghostscript/9.07/Resource/CMap&lt;/tt&gt;目录下，可以看到其中有很多文件，CMap文件的具体含义不知。暂且留在这里。只需要知道有&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;UniGB-&lt;span class="caps"&gt;UTF8&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;这两个CMap即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;测试gs对中文字体的支持&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Linux的中文字体比较少，可能很多人都会将Windows下的中文字体复制到Linux下使用。假设已经将Windows下的中文字体复制到&lt;tt class="docutils literal"&gt;/usr/share/fonts/winfonts/&lt;/tt&gt;目录下，对gs的配置文件&lt;tt class="docutils literal"&gt;cidfmap.zh_CN&lt;/tt&gt;做一些修改，使gs在Linux下可以使用Windows中文字体:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
% cidfmap.zh_CN的原内容保持不变
/BousungEG-Light-GB &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/wqy-zenhei/wqy-zenhei.ttc) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
/GBZenKai-Medium    &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/wqy-zenhei/wqy-zenhei.ttc) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
/MSungGBK-Light     /BousungEG-Light-GB ;
/Adobe-GB1      /BousungEG-Light-GB ;

% 新增Windows字体的支持
/STSong-Light &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/winfonts/simsun.ttc) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
/STFangsong-Light &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/winfonts/simfang.ttf) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
/STHeiti-Regular &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/winfonts/simhei.ttf) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
/STKaiti-Regular &amp;lt;&amp;lt; /FileType /TrueType /Path (/usr/share/fonts/winfonts/simkai.ttf) /SubfontId 0 /CSI [(GB1) 4] &amp;gt;&amp;gt; ;
&lt;/pre&gt;
&lt;p&gt;用&lt;strong&gt;编辑器&lt;/strong&gt;新建一个PS文件（是的，PS文件其中就是纯文本，可以直接用编辑器编辑!），名为&lt;tt class="docutils literal"&gt;gs_test.ps&lt;/tt&gt;，其内容为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
%! PS-Adobe-3. 0
/STSong-Light--UniGB-UTF8-H findfont 20 scalefont setfont
150 400 moveto
(Song Typeface 宋体) show

/STFangsong-Light--UniGB-UTF8-H findfont 20 scalefont setfont
150 375 moveto
(Fangsong Typeface 仿宋体) show

/STHeiti-Regular--UniGB-UTF8-H findfont 20 scalefont setfont
150 350 moveto
(Hei Typeface 黑体) show

/STKaiti-Regular--UniGB-UTF8-H findfont 20 scalefont setfont
150 325 moveto
(Kai Typeface 楷体) show

showpage
%%Trailer
%%EOF
&lt;/pre&gt;
&lt;p&gt;用gs查看该PS文件，若正确显示中文如下图，则表明gs的中文配置没有问题。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="gs-chinese" src="/images/2013081301.jpg" style="width: 500px;"/&gt;
&lt;/div&gt;
&lt;p&gt;需要说明如下几点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;这里仅仅以Windows字体为例，对于其他中文甚至日韩字体来说，方法类似；&lt;/li&gt;
&lt;li&gt;PS文件中的中文字体为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;CIDFont--CMap&lt;/span&gt;&lt;/tt&gt;，这里CMap选择的是&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;UniGB-&lt;span class="caps"&gt;UTF8&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;，在Windows下似乎应该选择&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&lt;span class="caps"&gt;GB&lt;/span&gt;-&lt;span class="caps"&gt;EUC&lt;/span&gt;-H&lt;/span&gt;&lt;/tt&gt;，尚不清楚原理；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;使GMT支持中文&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;修改配置文件&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;打开GMT中文配置文件&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/opt/&lt;span class="caps"&gt;GMT&lt;/span&gt;-4.5.12/share/pslib/PS_font_info.d&lt;/span&gt;&lt;/tt&gt;，在文件最后加入如下语句（以Windows字体为例）:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
STSong-Light--UniGB-UTF8-H  0.700    1
STFangsong-Light--UniGB-UTF8-H  0.700    1
STHeiti-Regular--UniGB-UTF8-H   0.700   1
STKaiti-Regular--UniGB-UTF8-H   0.700   1
&lt;/pre&gt;
&lt;p&gt;第一列为字体名，第二列为字母A的高度，第三列与编码有关。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;查看GMT当前支持的字体&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;用&lt;tt class="docutils literal"&gt;pstext &lt;span class="pre"&gt;-L&lt;/span&gt;&lt;/tt&gt;命令查看GMT当前的字体配置：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;pstext -L
Font &lt;span class="c"&gt;#  Font Name&lt;/span&gt;
------------------------------------
&lt;span class="m"&gt;0&lt;/span&gt;   Helvetica
&lt;span class="m"&gt;1&lt;/span&gt;   Helvetica-Bold
...    ......
&lt;span class="m"&gt;32&lt;/span&gt;  Palatino-BoldItalic
&lt;span class="m"&gt;33&lt;/span&gt;  ZapfChancery-MediumItalic
&lt;span class="m"&gt;34&lt;/span&gt;  ZapfDingbats
&lt;span class="m"&gt;35&lt;/span&gt; STSong-Light--UniGB-UTF8-H
&lt;span class="m"&gt;36&lt;/span&gt; STFangsong-Light--UniGB-UTF8-H
&lt;span class="m"&gt;37&lt;/span&gt; STHeiti-Regular--UniGB-UTF8-H
&lt;span class="m"&gt;38&lt;/span&gt; STKaiti-Regular--UniGB-UTF8-H
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;其中0-34为GMT/gs默认支持的西文字体，35至38为新添加的中文字体。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;GMT中文测试&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GMT4测试脚本：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
gmtset HEADER_FONT 35

pstext -R0/7/0/7 -JX6i/6i -B1/1:.&lt;span class="s2"&gt;"GMT中文支持"&lt;/span&gt;: -P &amp;gt; cn.ps &lt;span class="s"&gt;&amp;lt;&amp;lt;EOF&lt;/span&gt;
&lt;span class="s"&gt;1.5 5 35 0 35 LM GMT宋体&lt;/span&gt;
&lt;span class="s"&gt;1.5 4 35 0 36 LM GMT仿宋&lt;/span&gt;
&lt;span class="s"&gt;1.5 3 35 0 37 LM GMT黑体&lt;/span&gt;
&lt;span class="s"&gt;1.5 2 35 0 38 LM GMT楷体&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

rm .gmt*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;成图效果如下&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="gmt4-chinese" src="/images/2013081302.jpg" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;p&gt;GMT5测试脚本：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
gmt gmtset FONT_TITLE 40p,35,black

gmt pstext -R0/7/0/7 -JX6i/6i -Bafg -B+t&lt;span class="s2"&gt;"GMT中文支持"&lt;/span&gt; -F+a+c+f -P &amp;gt; gmt5_cn.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;3.5 5 0 LM 45p,35,red   GMT宋体&lt;/span&gt;
&lt;span class="s"&gt;3.5 4 0 LM 45p,36,blue  GMT仿宋&lt;/span&gt;
&lt;span class="s"&gt;3.5 3 0 LM 45p,37,black GMT黑体&lt;/span&gt;
&lt;span class="s"&gt;3.5 2 0 LM 45p,38,green GMT楷体&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

rm gmt.*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;成图效果如下&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="gmt5-chinese" src="/images/2013081303.jpg" style="width: 400px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;可移植性的一些测试&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;本机：用vi打开PS文件，中文正常显示；&lt;/li&gt;
&lt;li&gt;本机：gs查看正常；&lt;/li&gt;
&lt;li&gt;本机：ps2raster转换为PDF，用evince、zathura查看正常；&lt;/li&gt;
&lt;li&gt;本机：ps2pdf转换为PDF，用evince、zathura查看正常；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由于目前无其他机器可用，因而暂时不测试可移植性。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;参考资料&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;GMT软件显示汉字的技术原理与实现&lt;em&gt;，赵桂儒，《测绘通报》&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;ghostscript中文打印经验：&lt;a class="reference external" href="http://guoyoooping.blog.163.com/blog/static/13570518320101291442176"&gt;http://guoyoooping.blog.163.com/blog/static/13570518320101291442176&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;GMT中文支持 &lt;a class="reference external" href="http://xxqhome.blog.163.com/blog/static/1967330202011112810120598/"&gt;http://xxqhome.blog.163.com/blog/static/1967330202011112810120598/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; chinese support &lt;a class="reference external" href="http://hi.baidu.com/guyueshuiming/item/0052df53852ee4494fff20c3"&gt;http://hi.baidu.com/guyueshuiming/item/0052df53852ee4494fff20c3&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id24"&gt;更新历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-05-15：修正了中文测试脚本的一个bug。&lt;/li&gt;
&lt;li&gt;2013-05-16：系统默认未安装ghostscript的中文字体包，conf.d文件夹为空，通过安装相应中文包解决该问题。&lt;/li&gt;
&lt;li&gt;2013-08-17：添加了字体以及ghostscript可能需要的几个安装包的信息；以及在新增字体后要重建字体缓存。&lt;/li&gt;
&lt;li&gt;2014-10-14：重写整个文档，使其更具有普遍性；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT技巧"></category><category term="中文"></category><category term="GMT4"></category><category term="GMT5"></category></entry><entry><title>GMT之psmeca绘制震源机制解</title><link href="http://seisman.info/use-psmeca-to-plot-mechanisms.html" rel="alternate"></link><updated>2014-06-20T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-12:use-psmeca-to-plot-mechanisms.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;写在前面&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT中包含了很多补充包，meca就是其中一个，这个软件包包含了四个命令：pscoupe、psmeca、pspolar和psvelo，主要用于绘制震源机制解、误差椭圆、速度矢量等，这篇博文只介绍其中之一，用于绘制震源球的psmeca命令。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;语法&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
psmeca &amp;lt;infiles&amp;gt; -J&amp;lt;params&amp;gt; -R&amp;lt;west&amp;gt;/&amp;lt;east&amp;gt;/&amp;lt;south&amp;gt;/&amp;lt;north&amp;gt;[r]
   -S&amp;lt;format&amp;gt;&amp;lt;scale&amp;gt;[/fontsize[/justify/offset/angle/form]]
   [-B&amp;lt;params&amp;gt;] [-C[&amp;lt;pen&amp;gt;][P&amp;lt;pointsize&amp;gt;]]
   [-Ddepmin/depmax] [-E&amp;lt;fill&amp;gt;] [-G&amp;lt;fill&amp;gt;]
   [-H[&amp;lt;nrec&amp;gt;]] [-K] [-L&amp;lt;pen&amp;gt;] [-M] [-N] [-O] [-P] [-r]
   [-Tnplane[/&amp;lt;pen&amp;gt;]] [-U[&amp;lt;just&amp;gt;/&amp;lt;dx&amp;gt;/&amp;lt;dy&amp;gt;/]]
   [-V] [-W&amp;lt;pen&amp;gt;] [-X[a|c|r]&amp;lt;x_shift&amp;gt;[u]] [-Y[a|c|r]&amp;lt;x_shift&amp;gt;[u]]
   [-Z&amp;lt;cpt&amp;gt;] [-z] [-a[size[/Psymbol[Tsymbol]]]
   [-p&amp;lt;pen&amp;gt;] [-t&amp;lt;pen&amp;gt;] [-e&amp;lt;fill&amp;gt;] -g&amp;lt;fill&amp;gt;]
   [-o] [-c&amp;lt;ncopies&amp;gt;] [-:[i|o]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;选项说明&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;infiles：一个或多个文件名，文件内包含特定格式的震源机制文件，若未给定文件，则从stdin中读入震源机制解&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-J&lt;/strong&gt;和&lt;strong&gt;-R&lt;/strong&gt;：指定地图投影以及地图区域。（本质上，这个命令只绘制震源球，区域地图、地形以及其他都需要使用其他命令绘制。这个命令需要-J和-R的原因在于，通过指定地图投影、绘图尺寸、区域范围等，就可以将唯一的经纬度位置定位在纸上的某一点上。从而保证震源球可以精确得绘制在某个指定位置，而不需要通过-X和-Y去调整位置。这也就是前面所说的pssac和pssac2在地图上绘制地震图的最大区别。）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-S&lt;/strong&gt;&amp;lt;format&amp;gt;&amp;lt;scale&amp;gt;[/fontsize[/justify/offset/angle/form]]：选择震源机制解格式，指定数据文件中每列的含义。关于具体的format放在后面说。scale指定了震级为5的震源球的大小，fontsize等指定了震源球标题的文本属性。默认fontsize为9，offset=0.04；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-B&lt;/strong&gt;：设置地图边界的注释和刻度标记间隔&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;−C&lt;/strong&gt;[&lt;em&gt;pen&lt;/em&gt;][&lt;strong&gt;P&lt;/strong&gt;&lt;em&gt;pointsize&lt;/em&gt;]：在震源机制解文件中会给出地震的经纬度信息。有些时候也可以在特定列（参见具体格式中的newX和newY）给出震源球要放置的经纬度信息（有些情况下不希望震源球把地震的地形信息掩盖）。-C选项在初始位置绘制一个小圆，并绘制一条直线连接小圆和震源球。pen指定直线的属性，pointsize指定圆的大小。默认值线宽=1，颜色=0/0/0,实线；圆大小为0。&lt;strong&gt;注意：如果想要将震源球放在地震位置以外的地方，需要将newX和newY设置为新的经纬度值，同时必须有-C选项，震源球才会放在newX和newY指定的位置。&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-D&lt;/strong&gt;&lt;em&gt;depmin/depmax&lt;/em&gt;：只绘制某深度范围内的地震&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-E&lt;/strong&gt;&lt;em&gt;fill&lt;/em&gt;和&lt;strong&gt;-G&lt;/strong&gt;&lt;em&gt;fill&lt;/em&gt; ：设定震源球的拉伸象限和压缩象限的颜色，默认分别为白和黑。可以指定shade值（0-255）或颜色（rgb）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;−L&lt;/strong&gt;[&lt;em&gt;pen&lt;/em&gt;]：设置震源球外部轮廓的线条属性，默认为width = 1, color = 0/0/0, texture = solid&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-M&lt;/strong&gt;：默认震源球大小与震级大小成正比，该选项强制所有震源球大小相同，具体大小由-S给出&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-N&lt;/strong&gt; ：对地图区域外的震源球也要绘制，默认不绘制。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-r&lt;/strong&gt;：在文本周围加上方框&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;−T&lt;/strong&gt;[&lt;em&gt;num_of_planes&lt;/em&gt;]：num_of_planes可以取0,1,2，分别代表绘制两个节面和只绘制第一个节面、只绘制第二个节面。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-Z&lt;/strong&gt;&lt;em&gt;cptfile&lt;/em&gt; ：指定cpt文件，根据数据文件中第三列的值（也就是地震深度）以及cpt文件决定震源球的压缩部分的颜色。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-z ：&lt;/strong&gt;覆盖零秩地震矩&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;−a&lt;/strong&gt;[&lt;em&gt;size&lt;/em&gt;/[&lt;em&gt;P_axis_symbol&lt;/em&gt;[&lt;em&gt;T_axis_symbol&lt;/em&gt;]]]：计算并绘制P轴和T轴，可以指定大小以及P和T轴的符号，其中符号可以取 (&lt;strong&gt;c&lt;/strong&gt;) circle, (&lt;strong&gt;d&lt;/strong&gt;) diamond, (&lt;strong&gt;h&lt;/strong&gt;) hexagon, (&lt;strong&gt;i&lt;/strong&gt;) inverse triangle, (&lt;strong&gt;p&lt;/strong&gt;) point, (&lt;strong&gt;s&lt;/strong&gt;) square, (&lt;strong&gt;t&lt;/strong&gt;) triangle, (&lt;strong&gt;x&lt;/strong&gt;) cross，默认是0.2&lt;strong&gt;c&lt;/strong&gt;/&lt;strong&gt;cc&lt;/strong&gt;或0.08&lt;strong&gt;i&lt;/strong&gt;/&lt;strong&gt;cc&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-e&lt;/strong&gt;&lt;em&gt;fill&lt;/em&gt;和&lt;strong&gt;-g&lt;/strong&gt;&lt;em&gt;fill&lt;/em&gt; ：与-E和-G类似，分别指定T轴（拉伸部分）和P轴（压缩部分）的符号颜色&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-o&lt;/strong&gt; ：兼容前版的&lt;strong&gt;psvelomeca&lt;/strong&gt;命令，输入文件中不包含第三列的地震深度&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;−p&lt;/strong&gt;[&lt;em&gt;pen&lt;/em&gt;]和&lt;strong&gt;−t&lt;/strong&gt;[&lt;em&gt;pen&lt;/em&gt;] ：指定p轴和t轴的线条属性&lt;/li&gt;
&lt;li&gt;-K，-O，-P，-H，-U，-V，-W，-X，-Y，-：，-c：GMT常见命令选项，参见GMT手册&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="s"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;震源机制解格式-S选项说明&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="sc"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;−Sc&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Harvard CMT格式（现在的Global &lt;span class="caps"&gt;CMT&lt;/span&gt;）&lt;/p&gt;
&lt;pre class="literal-block"&gt;
X Y depth strike1 dip1 rake1 strike2 dip2 rake2 mantissa exponent newX newY title
&lt;/pre&gt;
&lt;p&gt;这里给出了两个strike、dip、rake，分别代表两个不同的节面。mantissa和exponent分别代表地震矩的尾数和指数部分（这里地震矩的单位为dyne-cm）。同样scale指定的是震级为5的震源球大小（相当于地震矩为&lt;span class="math"&gt;\(4.0\times 10^{23} dyne \cdot cm\)&lt;/span&gt;，此处mantissa=4.0，exponent=23）。（exponent这里可能有bug，因为当其值为0或者其他比较小的整数时，其震源球反而很大）&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sa"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;−Sa&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Aki &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Richards (1980)约定，根据书中约定的机制解格式。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
X Y depth strike dip rake mag newX newY title
&lt;/pre&gt;
&lt;p&gt;其中X和Y为地震经纬度；dep为地震深度，单位为km；strike、dip、rake参照Aki书中的定义，单位为度；mag为震级；newX和newY为放置震源球的经纬度，其值为0，0代表震源球放在地震震中处；title为在震源球上出现的标题。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sp"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;-Sp&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="literal-block"&gt;
X Y depth strike1 dip1 strike2 fault mag newX newY title
&lt;/pre&gt;
&lt;p&gt;其中fault=-1/+1，分别代表正断层和逆断层。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sm-d-z"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;-Sm|d|z&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Harvard CMT解，矩阵迹为0&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;m表示绘制地震矩的零迹部分&lt;/li&gt;
&lt;li&gt;d表示仅绘制地震矩的double couple部分&lt;/li&gt;
&lt;li&gt;z表示仅绘制地震矩的各向异性部分&lt;/li&gt;
&lt;li&gt;三个选项的格式相同，不同的选项提取出地震矩中的不同部分，关于地震矩的分解以及具体名词参见相关书籍。&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="literal-block"&gt;
X Y depth mrr mtt mff mrt mrf mtf exp newX newY title
&lt;/pre&gt;
&lt;p&gt;mrr等为地震矩的六个分量，exp代表地震矩的指数部分，例如mtt=2.0，exp=26，则代表实际的&lt;span class="math"&gt;\(mtt=2.0 \times 10^{26}dyne \cdot cm\)&lt;/span&gt;。GCMT所使用的rtf坐标，实际上是USE坐标系。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sx-y-t"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;-Sx|y|t&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;指定主坐标轴的方位，即T、N、P轴&lt;/p&gt;
&lt;pre class="literal-block"&gt;
X Y depth Tvalue Tazim Tplunge Nvalue Nazim Nplunge Pvalue Pazim Pplunge exp newX newY title
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;x：根据标准的机制解绘制&lt;/li&gt;
&lt;li&gt;y：只绘制地震矩的double couple部分&lt;/li&gt;
&lt;li&gt;z：绘制0迹地震矩&lt;/li&gt;
&lt;li&gt;这种格式应该不太常用吧&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;绘图&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;常用的震源机制解来自于Global &lt;span class="caps"&gt;CMT&lt;/span&gt;（&lt;a class="reference external" href="http://www.globalcmt.org/CMTsearch.html"&gt;http://www.globalcmt.org/CMTsearch.html&lt;/a&gt; ），其可以指定输出类型，满足大多数情况的需要。&lt;/p&gt;
&lt;p&gt;这里用的例子如下：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;010176A&lt;/strong&gt;&lt;span class="caps"&gt;KERMADEC&lt;/span&gt; &lt;span class="caps"&gt;ISLANDS&lt;/span&gt; &lt;span class="caps"&gt;REGION&lt;/span&gt;&lt;/p&gt;
&lt;div class="figure align-right"&gt;
&lt;img alt="Meca" src="/images/2013081201.png" style="width: 50px;"/&gt;
&lt;/div&gt;
&lt;pre class="literal-block"&gt;
Date: 1976/ 1/ 1   Centroid Time:  1:29:53.4 GMT
Lat= -29.25 Lon=-176.96
Depth= 47.8   Half duration= 9.4
Centroid time minus hypocenter time: 13.8
Moment Tensor: Expo=26  7.680 0.090 -7.770 1.390 4.520 -3.260
Mw = 7.3    mb = 6.2    Ms = 0.0   Scalar Moment = 9.56e+26
Fault plane:  strike=202    dip=30   slip=93
Fault plane:  strike=18    dip=60   slip=88
&lt;/pre&gt;
&lt;p&gt;将其改写为-Sc所需要的格式为：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
-176.96 -29.25 47.8 202 30 93 18 60 88 9.56 26 0 0 010176A
&lt;/pre&gt;
&lt;p&gt;注：在Global CMT选择输出类型Output type时，最好选择GMT psmeca input而不是GMT psvelomeca input，psvelomeca是旧版GMT的命令，两种格式的主要差别在于psvelomeca格式中没有地震深度信息，绘制这种格式的机制解需要额外添加-o选项。&lt;/p&gt;
&lt;p&gt;另外GMT psmeca input类型给出的结果如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
-176.96 -29.25 48 7.68 0.09 -7.77 1.39 4.52 -3.26 26 X Y 010176A
&lt;/pre&gt;
&lt;p&gt;其对应的格式是-Sm，注意与-Sc的区别。格式中的newX和newY被替换成了X和Y，这个在程序中好像会被认为是0值，因而可以正常运行。&lt;/p&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;最简单的图&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;meca1.ps

pscoast -Rg -JQ10i -B60/30 -A10000 -Wthin -G200 -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
psmeca -R -J -Sc1 -W1p -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;span class="s"&gt;-176.96 -29.25 47.8 202 30 93 18 60 88 9.56 26 0 0 010176A&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果图如下，这里与GCMT给的结果不同，因为使用strike、rake、dip所决定的double couple地震矩仅仅只是地震矩的一部分。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="meca" src="/images/2013081202.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;一个稍稍复杂的版本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;meca2.ps

pscoast -Rg -JQ10i -B60/30 -A10000 -Wthin -G200 -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;
&lt;span class="c"&gt;#plot mechanism&lt;/span&gt;
psmeca -R -J -Sc1/12/0.2 -C0.5pP2p -Egrey -Gred -L1p -W1p -O &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; $PS&lt;/span&gt;
&lt;span class="s"&gt;-176.96 -29.25 47.8 202 30 93 18 60 88 9.56 26 -160 -10 010176A&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;效果如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="meca" src="/images/2013081203.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;最后说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个命令其实还是比较简单的，从第一张图来看，默认效果已经很不错了，关键还是要对地震矩的概念及地震矩分解有更进一步的了解。一个不错的文章是：&lt;/p&gt;
&lt;p&gt;Jost M L, Herrmann R B. A student’s guide to and review of moment tensors[J]. Seismological Research Letters, 1989, 60(2): 37-57.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-05-10：初稿；&lt;/li&gt;
&lt;li&gt;2013-05-14：在例子中简单解释了GCMT的默认GMT输入格式。&lt;/li&gt;
&lt;li&gt;2013-06-05：若要将震源球移动到新位置，需要设定newX和newY为新的经纬度，且给出-C选项。&lt;/li&gt;
&lt;li&gt;2013-06-20：去除了第一个例子中的-T0选项。&lt;/li&gt;
&lt;li&gt;2014-06-09：修正了示例中-K和-O的错误；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="震源机制解"></category></entry><entry><title>全球数字高程模型GTOPO30</title><link href="http://seisman.info/global-digital-elevation-model-gtopo30.html" rel="alternate"></link><updated>2013-08-11T23:43:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-11:global-digital-elevation-model-gtopo30.html</id><summary type="html">
&lt;p&gt;GTOPO30是USGS公布的全球数字高程模型，其采样间隔为30弧秒。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用&lt;tt class="docutils literal"&gt;wget&lt;/tt&gt;批量下载所有数据文件:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
wget -r -c -np -nd ftp://edcftp.cr.usgs.gov/data/gtopo30/global/
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;解压&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
for i in *.tar.gz;
do
    tar -zxvf $i;
done
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在README里有详细说明，重点归纳如下&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;将全球分为33个区块，如下图所示，北纬90度到南纬60度分为3份，每份纬向50度，经向40度，共计3*9=27个区块；南极附近为南纬60度到90度，经向60度，计6个区块，共计33个区块。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="gtopo30" src="/images/2013081101.png" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;采样间隔30弧秒，即0.008333333333333度，全球分为21600行、43200列。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;坐标参考为WGS84；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;其值为垂直方向高出海平面的距离，即海拔，单位为m；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;海拔范围-407到8752，这里不包含海洋深度信息，负值应该是大陆架的海拔；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;海洋处海拔标记为-9999，海岸线以为大陆海拔至少为1；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;小于1平方千米的岛不考虑；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;文件以该区块的左上角坐标为文件名；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;文件后缀：DEM为数据高程模型；其他的文件都是一些辅助信息；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;纬度50度*经度40度文件大小：57600000 bytes&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;纬度30度*经度60度文件大小：28800000 bytes&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;复制&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;将所有DEM文件拷贝至&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;GMTHOME&lt;/span&gt;/share/dbase&lt;/tt&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="grdraster-info"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;修改grdraster.info&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
# GTOPO30 N90-N40
11 "GTOPO30 W180N90"            "m"     -R-180/-140/40/90       -I0.5m          PG i 1           0    -9999      W180N90.DEM B
12 "GTOPO30 W140N90"            "m"     -R-140/-100/40/90       -I0.5m          PG i 1           0    -9999      W140N90.DEM B
13 "GTOPO30 W100N90"            "m"     -R-100/-60/40/90        -I0.5m          PG i 1           0    -9999      W100N90.DEM B
14 "GTOPO30 W060N90"            "m"     -R-60/-20/40/90         -I0.5m          PG i 1           0    -9999      W060N90.DEM B
15 "GTOPO30 W020N90"            "m"     -R-20/20/40/90          -I0.5m          PG i 1           0    -9999      W020N90.DEM B
16 "GTOPO30 E020N90"            "m"     -R20/60/40/90           -I0.5m          PG i 1           0    -9999      E020N90.DEM B
17 "GTOPO30 E060N90"            "m"     -R60/100/40/90          -I0.5m          PG i 1           0    -9999      E060N90.DEM B
18 "GTOPO30 E100N90"            "m"     -R100/140/40/90         -I0.5m          PG i 1           0    -9999      E100N90.DEM B
19 "GTOPO30 E140N90"            "m"     -R140/180/40/90         -I0.5m          PG i 1           0    -9999      E140N90.DEM B

# GTOPO30 N40-S10
20 "GTOPO30 W180N40"            "m"     -R-180/-140/-10/40      -I0.5m          PG i 1           0    -9999      W180N40.DEM B
21 "GTOPO30 W140N40"            "m"     -R-140/-100/-10/40      -I0.5m          PG i 1           0    -9999      W140N40.DEM B
22 "GTOPO30 W100N40"            "m"     -R-100/-60/-10/40       -I0.5m          PG i 1           0    -9999      W100N40.DEM B
23 "GTOPO30 W060N40"            "m"     -R-60/-20/-10/40        -I0.5m          PG i 1           0    -9999      W060N40.DEM B
24 "GTOPO30 W020N40"            "m"     -R-20/20/-10/40         -I0.5m          PG i 1           0    -9999      W020N40.DEM B
25 "GTOPO30 E020N40"            "m"     -R20/60/-10/40          -I0.5m          PG i 1           0    -9999      E020N40.DEM B
26 "GTOPO30 E060N40"            "m"     -R60/100/-10/40         -I0.5m          PG i 1           0    -9999      E060N40.DEM B
27 "GTOPO30 E100N40"            "m"     -R100/140/-10/40        -I0.5m          PG i 1           0    -9999      E100N40.DEM B
28 "GTOPO30 E140N40"            "m"     -R140/180/-10/40        -I0.5m          PG i 1           0    -9999      E140N40.DEM B

# GTOPO30 S10-S60
29 "GTOPO30 W180S10"            "m"     -R-180/-140/-60/-10     -I0.5m          PG i 1           0    -9999      W180S10.DEM B
30 "GTOPO30 W140S10"            "m"     -R-140/-100/-60/-10     -I0.5m          PG i 1           0    -9999      W140S10.DEM B
31 "GTOPO30 W100S10"            "m"     -R-100/-60/-60/-10      -I0.5m          PG i 1           0    -9999      W100S10.DEM B
32 "GTOPO30 W060S10"            "m"     -R-60/-20/-60/-10       -I0.5m          PG i 1           0    -9999      W060S10.DEM B
33 "GTOPO30 W020S10"            "m"     -R-20/20/-60/-10        -I0.5m          PG i 1           0    -9999      W020S10.DEM B
34 "GTOPO30 E020S10"            "m"     -R20/60/-60/-10         -I0.5m          PG i 1           0    -9999      E020S10.DEM B
35 "GTOPO30 E060S10"            "m"     -R60/100/-60/-10        -I0.5m          PG i 1           0    -9999      E060S10.DEM B
36 "GTOPO30 E100S10"            "m"     -R100/140/-60/-10       -I0.5m          PG i 1           0    -9999      E100S10.DEM B
37 "GTOPO30 E140S10"            "m"     -R140/180/-60/-10       -I0.5m          PG i 1           0    -9999      E140S10.DEM B

# GTOPO30 S60-S90
38 "GTOPO30 W180S60"            "m"     -R-180/-120/-90/-60     -I0.5m          PG i 1           0    -9999      W180S60.DEM B
39 "GTOPO30 W120S60"            "m"     -R-120/-60/-90/-60      -I0.5m          PG i 1           0    -9999      W120S60.DEM B
40 "GTOPO30 W060S60"            "m"     -R-60/0/-90/-60         -I0.5m          PG i 1           0    -9999      W060S60.DEM B
41 "GTOPO30 W000S60"            "m"     -R0/60/-90/-60          -I0.5m          PG i 1           0    -9999      W000S60.DEM B
42 "GTOPO30 E060S60"            "m"     -R60/120/-90/-60        -I0.5m          PG i 1           0    -9999      E060S60.DEM B
43 "GTOPO30 E120S60"            "m"     -R120/180/-90/-60       -I0.5m          PG i 1           0    -9999      E120S60.DEM B
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;其他说明&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;这些DEM文件为Pixel Registration格式&lt;/li&gt;
&lt;li&gt;数据值存储为有符号16位整型&lt;/li&gt;
&lt;li&gt;这些数据都是Big-endian的&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;绘图测试&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;ID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;11
&lt;span class="nv"&gt;Range&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-180/-140/40/90
&lt;span class="nv"&gt;B&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;a10g10
&lt;span class="nv"&gt;Inc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0.5m
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;ID&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.ps

grdraster &lt;span class="nv"&gt;$ID&lt;/span&gt; -R&lt;span class="nv"&gt;$Range&lt;/span&gt; -I&lt;span class="nv"&gt;$Inc&lt;/span&gt; -Gout.grd
makecpt -Ctopo -T1/8000/1000 -Z &amp;gt; colors.cpt
grdimage out.grd -B&lt;span class="nv"&gt;$B&lt;/span&gt; -R&lt;span class="nv"&gt;$Range&lt;/span&gt; -JQ15c -Ccolors.cpt &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

rm out.grd colors.cpt
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;这里只绘制一个第一个区块的地形，若需要同时绘制多个区块，需要多次调用grdraster从不同的网格文件中提取网格，然后用grdpaste粘贴成一个网格再绘图。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;南极区域&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在南极区域还有一个特殊的高程数据ANTARCPS.&lt;span class="caps"&gt;DEM&lt;/span&gt;，其包含了S60-S90区域的六个区块的数据，但是是经过极坐标方位立体投影的。因而横坐标范围为（-2700，2700），纵坐标范围为（-2700，2700）。这个处理起来要麻烦一点。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="地形"></category><category term="数据"></category><category term="网格"></category><category term="高程"></category></entry><entry><title>全球地形起伏模型ETOPO1</title><link href="http://seisman.info/global-relief-model-etopo1.html" rel="alternate"></link><updated>2013-08-11T15:53:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-11:global-relief-model-etopo1.html</id><summary type="html">
&lt;p&gt;ETOPO1是分辨率为1弧分的全球地形起伏模型，其包含了陆地地形和海洋水深的数据，是目前已知的分辨率最高的地形起伏数据。&lt;/p&gt;
&lt;p&gt;官方主页位于： &lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/global/"&gt;http://www.ngdc.noaa.gov/mgg/global/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其分为两个版本，Ice Surface和Bedrock，两个版本基本一致。不同之处在于在处理南极洲和Greenland地形时，前者给出的是加上冰盖层之后的高程，后者给出的是岩床的高程。&lt;/p&gt;
&lt;p&gt;对于每个版本又细分为grid-registered和cell-registered，其中grid-registered是权威版本，cell-registered是衍生版本，因而&lt;strong&gt;推荐下载使用grid-registered版本&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;在每个子版本下又有多种数据格式，netCDF，binary，xyz，tiff。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;本文使用的是&lt;strong&gt;grid-registered版本&lt;/strong&gt;的&lt;strong&gt;binary格式&lt;/strong&gt;的数据文件：&lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/global/relief/ETOPO1/data/ice_surface/grid_registered/binary/etopo1_ice_g_i2.zip"&gt;etopo1_ice_g_i2.zip&lt;/a&gt; 。&lt;/p&gt;
&lt;p&gt;下面的说明也只针对binary格式有效。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;解压&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
7za e etopo1_ice_g_i2.zip
&lt;/pre&gt;
&lt;p&gt;解压之后的&lt;tt class="docutils literal"&gt;.bin&lt;/tt&gt;文件为二进制网格文件，&lt;tt class="docutils literal"&gt;.hdr&lt;/tt&gt;文件为头段文件&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;拷贝&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
sudo cp etopo1_ice_g_i2.bin /usr/local/GMT-4.5.12/share/dbase
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="grdraster-info"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;修改grdraster.info&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;直接将下面的语句复制到&lt;tt class="docutils literal"&gt;grdraster.info&lt;/tt&gt;中即可。关于语句为什么要这么写，需要参考hdr文件的内容。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
9 "ETOPO1 Ice Surface"          "m"     -R-180/180/-90/90       -I1m            GG i 1          0       -32768  etopo1_ice_g_i2.bin     L
&lt;/pre&gt;
&lt;p&gt;同理，对于bedrock版本的网格数据，其&lt;tt class="docutils literal"&gt;grdraster.info&lt;/tt&gt;为&lt;/p&gt;
&lt;pre class="literal-block"&gt;
10 "ETOPO1 Bedrock"             "m"     -R-180/180/-90/90       -I1m            GG i 1          0       -32768  etopo1_bed_g_i2.bin     L
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;如果下载的是netCDF格式的网格文件，需要利用如下命令将数据转换为binary格式：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
grdreformat ETOPO1_Ice_g_gmt4.grd etopo1_ice_g_i2.bin=bs -N -V
&lt;/pre&gt;
&lt;p&gt;当然对于netCDF格式的网格文件，也可以直接用grdcut做裁剪，用grdimage画图，省去了grdraster的步骤。哪个方便用哪个。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="地形"></category><category term="数据"></category><category term="网格"></category><category term="高程"></category></entry><entry><title>全球地形起伏模型ETOPO2</title><link href="http://seisman.info/global-relief-model-etopo2.html" rel="alternate"></link><updated>2013-08-11T15:50:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-11:global-relief-model-etopo2.html</id><summary type="html">&lt;p&gt;ETOPO2与ETOPO5类似，也是陆地高程+海底地形数据，其采样间隔为2弧分。&lt;/p&gt;
&lt;p&gt;官方地址： &lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/global/etopo2.html"&gt;http://www.ngdc.noaa.gov/mgg/global/etopo2.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;官方提供了提供了很多版本，&lt;strong&gt;ETOPO2v2c&lt;/strong&gt;和&lt;strong&gt;ETOPO2v2g&lt;/strong&gt;分别代码pixel registration和gridline registartion两种不同的网格表示方式。其中&lt;strong&gt;ETOPO2v2c&lt;/strong&gt;是权威版本，建议选择&lt;strong&gt;ETOPO2v2c&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ETOPO2v2c&lt;/strong&gt;下又有许多格式可以选择，如下所示&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ETOPO2v2c
 ├── GRD98：ETOPO2v2c_i2_LSB_GRD98.zip
 ├── HDF：ETOPO2v2c_HDF.zip
 ├── netCDF：ETOPO2v2c_f4_netCDF.zip
 └── raw_binary：ETOPO2v2c_f4_LSB.zip和ETOPO2v2c_i2_LSB.zip
&lt;/pre&gt;
&lt;p&gt;其中&lt;tt class="docutils literal"&gt;netCDF&lt;/tt&gt;，&lt;tt class="docutils literal"&gt;grd98&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;raw_binary&lt;/tt&gt;格式的网格文件都可以直接在GMT中使用。由于&lt;tt class="docutils literal"&gt;grdraster&lt;/tt&gt;命令只能使用&lt;tt class="docutils literal"&gt;raw_binary&lt;/tt&gt;格式的数据，所以下面仅使用&lt;tt class="docutils literal"&gt;raw_binary&lt;/tt&gt;格式网格数据。&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;下载Little-endian，16位整型的二进制网格文件&lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/global/relief/ETOPO2/ETOPO2v2-2006/ETOPO2v2c/raw_binary/ETOPO2v2c_i2_LSB.zip"&gt;ETOPO2v2c_i2_LSB.zip&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;解压&lt;/p&gt;
&lt;pre class="literal-block"&gt;
7za e ETOPO2v2c_i2_LSB.zip
&lt;/pre&gt;
&lt;p&gt;解压之后的&lt;tt class="docutils literal"&gt;.bin&lt;/tt&gt;文件为二进制网格文件，&lt;tt class="docutils literal"&gt;.hdr&lt;/tt&gt;文件为头段文件&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;拷贝&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo cp ETOPO2v2c_i2_LSB.bin ${GMTHOME}/share/dbase
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;修改&lt;tt class="docutils literal"&gt;grdraster.info&lt;/tt&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
8 &amp;quot;ETOPO2 global topography&amp;quot;    &amp;quot;m&amp;quot;     -R-180/180/-90/90       -I2m            PG i 1          0       -32768  ETOPO2v2c_i2_LSB.bin    L
&lt;/pre&gt;
&lt;p&gt;其中的很多细节参考了&lt;tt class="docutils literal"&gt;.hdr&lt;/tt&gt;文件中关于格式的说明，不细说。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;画图测试&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

grdraster &lt;span class="m"&gt;8&lt;/span&gt; -Rg -I2m -Gout.grd
makecpt -Cglobe -T-10500/8000/1000 -Z &amp;gt; colors.cpt
grdimage out.grd -Ba60g30 -Rg -Yc -Xc -JN0/25c -Ccolors.cpt -K &amp;gt; etopo5.ps
psscale -Ba2500f500::/:&lt;span class="s2"&gt;&amp;quot;m&amp;quot;&lt;/span&gt;: -Ccolors.cpt -D12.5c/-2c/15c/.35ch -O &amp;gt;&amp;gt; etopo5.ps

rm out.grd colors.cpt
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="地形"></category><category term="数据"></category><category term="网格"></category><category term="高程"></category></entry><entry><title>全球地形起伏模型etopo5</title><link href="http://seisman.info/global-relief-model-etopo5.html" rel="alternate"></link><updated>2013-08-10T00:10:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-10:global-relief-model-etopo5.html</id><summary type="html">
&lt;p&gt;etopo5是全球高程及水深数据，其空间分辨率是5弧分，目前已被更高精度的etopo2和etopo1所取代。但在绘制全球地形时，若觉得用etopo2得到的图形文件过大，也可使用低精度的etopo5，但还是不建议用etopo5。&lt;/p&gt;
&lt;p&gt;官方页面： &lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/global/etopo5.html"&gt;http://www.ngdc.noaa.gov/mgg/global/etopo5.html&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;下载地址&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/global/relief/ETOPO5/TOPO/ETOPO5/"&gt;http://www.ngdc.noaa.gov/mgg/global/relief/&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;/&lt;span class="caps"&gt;TOPO&lt;/span&gt;/&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其中，&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;.&lt;span class="caps"&gt;DAT&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;.&lt;span class="caps"&gt;DOS&lt;/span&gt;&lt;/tt&gt;包含了相同的高程数据，只是二者的字节序不同。&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;.&lt;span class="caps"&gt;DOS&lt;/span&gt;&lt;/tt&gt;为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;little-endian&lt;/span&gt;&lt;/tt&gt;，&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;.&lt;span class="caps"&gt;DAT&lt;/span&gt;&lt;/tt&gt;为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;big-endian&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;网格数据的说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;官方说明位于 &lt;a class="reference external" href="http://www.ngdc.noaa.gov/mgg/global/relief/ETOPO5/TOPO/ETOPO5/ETOPO5.txt"&gt;http://www.ngdc.noaa.gov/mgg/global/relief/&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;/&lt;span class="caps"&gt;TOPO&lt;/span&gt;/&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;/&lt;span class="caps"&gt;ETOPO5&lt;/span&gt;.txt&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;简单归纳一下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;数据采样间隔为5弧分&lt;/li&gt;
&lt;li&gt;经度上0度到359度55分共计4320个采样点（注意不是0到360度），维度方向-90度到90度为2161个点&lt;/li&gt;
&lt;li&gt;每个数据用16位整数表示，即占用两字节，共计4320*2161*2=18671040字节&lt;/li&gt;
&lt;li&gt;实际数据中只有18662400字节，这是因为数据中把-90度的南极给丢了，后面会做简单处理，把南极点补回来；&lt;/li&gt;
&lt;li&gt;数据在文件中的排序很简单，从北纬90度，东经0度0分开始，接下来是360度*12采样点/度=4320采样点，即8640个字节，一直到北纬90度，东经359度55分；第4321个点为北纬89度55分，东经0度0分，按照这样的顺序不断排下去。每个纬度带4320个点，共计2160个纬度带。&lt;/li&gt;
&lt;li&gt;北纬90度即北极，4320个点具有相同的值，为-4290m；南纬-90度即南极，没有包含在这个数据中，其海拔为2810 m。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;数据的小修改&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;如前所说，数据中把南极丢了，这是个小问题，当绘制全球数据时会出现类似“南极海拔不一致”的警告，虽说不是致命错误，还是改了吧，源代码如下：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt; * A simple C code to add the elevation of south pole to the ETOPO5 data&lt;/span&gt;
&lt;span class="cm"&gt; * Date:   04/30/2013&lt;/span&gt;
&lt;span class="cm"&gt; * Author: SeisMan&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * Input:  ETOPO5.DOS&lt;/span&gt;
&lt;span class="cm"&gt; * Output: etopo5.i2&lt;/span&gt;
&lt;span class="cm"&gt; * Note: ETOPO5.DOS is little-endian;&lt;/span&gt;
&lt;span class="cm"&gt; *       ETOPO5.DAT is big-endian;&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;

&lt;span class="cp"&gt;#include&amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#define NX 4320&lt;/span&gt;
&lt;span class="cp"&gt;#define NY 2160&lt;/span&gt;

&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nf"&gt;imatrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nrl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nrh&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ncl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nch&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
  &lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kt"&gt;FILE&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;imatrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;fip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;fopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"ETOPO5.DOS"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"rb"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;fread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;fip&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2810&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;fopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"etopo5.i2"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"wb"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;NY&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;NX&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
      &lt;span class="n"&gt;fwrite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ix&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;iy&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="c1"&gt;//      printf("%d %d %d\n",ix,iy,topo[ix][iy]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fip&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fop&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nf"&gt;imatrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nrl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nrh&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;ncl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;nch&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nrh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nrl&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"allocation failure 1 in imatrix()&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;nrl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nrl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="n"&gt;nrh&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nch&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ncl&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="k"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="n"&gt;fprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;"allocation failure 2 in imatrix()&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;ncl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;编译并运行:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ gcc etopo5_mod.c -o etopo5_mod
$ ./etopo5_mod
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;复制&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;将修改后的&lt;tt class="docutils literal"&gt;etopo5.i2&lt;/tt&gt;拷贝至&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;${&lt;span class="caps"&gt;GMTHOME&lt;/span&gt;}/share/dbase&lt;/span&gt;&lt;/tt&gt;下，并在&lt;tt class="docutils literal"&gt;grdraster.info&lt;/tt&gt;中加入如下语句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
1 "ETOPO5 global topography" "m" -R0/359:55/-90/90 -I5m GG i 1 0 none etopo5.i2
&lt;/pre&gt;
&lt;p&gt;这其实也就是默认的&lt;tt class="docutils literal"&gt;grdraster.info&lt;/tt&gt;中的内容，只是GMT没有自带etopo5的数据。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;画图检查&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;

grdraster &lt;span class="m"&gt;1&lt;/span&gt; -Rg -I5m -Gout.grd
makecpt -Cglobe -T-10500/8000/1000 -Z &amp;gt; colors.cpt
grdimage out.grd -Ba60g30 -Rg -Yc -Xc -JN0/25c -Ccolors.cpt -K &amp;gt; etopo5.ps
psscale -Ba2500f500::/:&lt;span class="s2"&gt;"m"&lt;/span&gt;: -Ccolors.cpt -D12.5c/-2c/15c/.35ch -O &amp;gt;&amp;gt; etopo5.ps

rm out.grd colors.cpt
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="etopo map" src="/images/2013081001.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;p&gt;绘图代码参考了石木说的&lt;a class="reference external" href="http://hawkman.geoidea.org/2011/04/20/gmt%E7%BB%98%E5%9B%BE%E5%AD%A6%E4%B9%A0%EF%BC%9A%E7%BB%98etopo5%E4%B8%8E-etopo2%E7%BB%8F%E5%BA%A6%E7%9A%84%E5%9C%B0%E5%BD%A2%E5%9B%BE/"&gt;博文&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="地形"></category><category term="数据"></category><category term="网格"></category><category term="高程"></category></entry><entry><title>GMT网格数据之grdraster.info</title><link href="http://seisman.info/grdraster-info-of-gmt-grid.html" rel="alternate"></link><updated>2013-08-10T00:05:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-10:grdraster-info-of-gmt-grid.html</id><summary type="html">&lt;p&gt;GMT可以绘制各种各样的地图，只要有网格数据，就可以在地图上叠加地形、海洋深度、重力、地磁等等彩色图像。&lt;/p&gt;
&lt;p&gt;一般来说是从一个网格数据文件中利用grdraster命令抽取研究区域的网格数据，再用grdimage等命令绘制。一切绘制的前提是GMT可以找到各种各样的网格数据文件。&lt;/p&gt;
&lt;p&gt;在GMT/share/dbase是储存数据文件的地方，grdraster.info包含了这些数据文件的信息。grdraster.info中的每一条分别代表一个网格数据，其格式如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
file_number &amp;quot;title string&amp;quot; &amp;quot;z units&amp;quot; -R -I GorP type scale offset NaNflag filename [L|B] [H&amp;lt;bytes&amp;gt;]
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;file_number :&amp;nbsp;文件号，为整数，分别对应每个文件；&lt;/li&gt;
&lt;li&gt;title_string :&amp;nbsp;对数据的简单描述，需要用引号；&lt;/li&gt;
&lt;li&gt;z_unit :&amp;nbsp;数据在经过比例缩放和偏移之后的单位；&lt;/li&gt;
&lt;li&gt;-R :&amp;nbsp;网格代表的区域范围，参见GMT的-R；&lt;/li&gt;
&lt;li&gt;-I :&amp;nbsp;网格横向和纵向采样间隔，参见GMT的-I；&lt;/li&gt;
&lt;li&gt;G或者P：代表两种Grid和Pixel两种网格方式，具体参见GMT网格的说明，其后可接G（表示地理坐标）或C（表示笛卡尔坐标）；&lt;/li&gt;
&lt;li&gt;type :&amp;nbsp;可以取b（位数据，非0即1）、u（无符号字符类型）、c（有符号字符类型）、d（无符号两位整型）、i（有符号两位整型）、l（有符号四位整型）&lt;/li&gt;
&lt;li&gt;scale：读取网格文件之后需要乘以scale才是真实值；&lt;/li&gt;
&lt;li&gt;offset：读取网格文件，并乘以scale之后需要加上的值；&lt;/li&gt;
&lt;li&gt;NaNflag：网格文件中无值的点怎样表示，若所有点都有值，则为none&lt;/li&gt;
&lt;li&gt;filename：网格文件名，若以“/”开头则代表绝对路径，否则代表$(GMT_GRIDDIR)/filename&lt;/li&gt;
&lt;li&gt;L | B&amp;nbsp;：网格文件的字节序，若你的系统和该网格数据字节序不同，则命令会自动进行转换。参见big-endian和little-endian；&lt;/li&gt;
&lt;li&gt;H：如果网格文件前有头段，则给出头段的字节数。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下面给出一个例子：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
1 &amp;quot;ETOPO5 global topography&amp;quot; &amp;nbsp;&amp;quot;m&amp;quot;  -R0/359:55/-90/90 -I5m  GG i 1 &amp;nbsp;0 none  etopo5.i2
&lt;/pre&gt;
&lt;p&gt;这是全球地形网格数据，间隔为5分，单位为m，数据为有符号两位整型。&lt;/p&gt;
&lt;p&gt;这些网格数据都需要自己寻找，下载以及格式转换。&lt;/p&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="数据"></category><category term="网格"></category></entry><entry><title>pssac2之在地图上绘制地震图</title><link href="http://seisman.info/plot-traces-on-maps-with-pssac.html" rel="alternate"></link><updated>2013-08-09T00:10:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-09:plot-traces-on-maps-with-pssac.html</id><summary type="html">
&lt;p&gt;依然利用《&lt;a class="reference external" href="http://seisman.info/plot-profile-with-pssac.html"&gt;pssac绘图之地震剖面图&lt;/a&gt;》中生成的数据。&lt;/p&gt;
&lt;p&gt;看上去pssac可以实现的功能pssac2也都可以实现，有兴趣的可以把前面的那些命令用pssac2试试。这里还是主要把精力放在如何在地图上绘制地震图上吧。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;脚本&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# An simple example bash shell script to show&lt;/span&gt;
&lt;span class="c"&gt;# how to use pssac2 to plot traces on maps&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# Author: SeisMan @ seisman.info&lt;/span&gt;
&lt;span class="c"&gt;# E-mail: seisman.info@gmail.com&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;

pscoast -JM6i -R-120/-60/40/65 -B15/5 -Glightblue -W0.01p -A1000 -K -V &amp;gt; a.ps

psxy -J -R -B -Sa10p -Gblack -K -O -V &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;-114.5917 62.4797&lt;/span&gt;
&lt;span class="s"&gt;-74.5300 44.5483&lt;/span&gt;
&lt;span class="s"&gt;-93.7022 50.8589&lt;/span&gt;
&lt;span class="s"&gt;-104.0362 44.1204&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;

pssac2 -J -R -Ent-5 -M1 -L1000 -D0.1/0.1 -O -V &amp;gt;&amp;gt; a.ps &lt;span class="s"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;span class="s"&gt;ntkm.z -114.5917 62.4797 0.1p,red&lt;/span&gt;
&lt;span class="s"&gt;nykm.z -74.5300 44.5483 0.1p,black&lt;/span&gt;
&lt;span class="s"&gt;onkm.z -93.7022 50.8589 0.1p,blue&lt;/span&gt;
&lt;span class="s"&gt;sdkm.z -104.0362 44.1204 0.1p,yellow&lt;/span&gt;
&lt;span class="s"&gt;EOF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div class="figure"&gt;
&lt;img alt="Map" src="/images/2013080901.jpg" style="width: 700px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;简单解释&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;pscoast用于绘制背景，-G指定海洋颜色，-W指定海岸线线宽，-A指定只绘制面积1000km^2以上的岛屿（不然就密密麻麻一片黑了）。&lt;/li&gt;
&lt;li&gt;psxy在四个台站位置分别绘制一个黑色五角星&lt;/li&gt;
&lt;li&gt;pssac2不再显式指定-J和-R了，直接继承前面命令的参数，pssac中是不能这样的，因为pssac中横轴是时间。&lt;/li&gt;
&lt;li&gt;通过指定-L1000选项，设定地图上MEASURE_UNIT长度代表1000s，即给出了地图的经度坐标与地震图的时间坐标之间的对应关系。我的系统中的默认MEASURE_UNIT是cm，前面-JM6i强制指定了地图大小的单位为6英寸，理论上这个单位只适用于投影方式，不会改变MEASURE_UNIT的，但是看上去trace的1000s好像长度的确是1 inch，这是个小问题（也许是我看错了），实际画图的时候肯定要不断修改-L的值以达到最好的效果的。&lt;/li&gt;
&lt;li&gt;在pssac中-E和-M是可选的，但在pssac2中-E和-M好像是必须的，-M指定振幅，-E好像用处不大。&lt;/li&gt;
&lt;li&gt;本来想使用-l来看看timescale是什么的，但是一直没有调出来，暂时放弃。&lt;/li&gt;
&lt;li&gt;要绘制的地震图通过给出文件名，x、y位置以及画笔属性来指定。实际应用中x、y通常是台站的经纬度。&lt;/li&gt;
&lt;li&gt;-D指定了trace相对于给定的x、y位置的偏移量。由于一般x、y是台站经纬度，将trace直接画在台站那里总是不太好看的，稍微偏一点点位置视觉效果会更好。&lt;/li&gt;
&lt;li&gt;pssac2自己的选项中所有的距离或长度的单位都是MEASURE_UNIT，你可以指定-D1/1，但是不能像GMT那样指定-D1i/1i。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;pssac2在绘制单个地震图以及地图剖面上与pssac差不多，用法上稍微多一些，也许掌握起来会麻烦一点；在地图上绘制地震图这一点，pssac必须通过自己手动指定-X和-Y偏移量，或者通过台站位置以及地图范围计算偏移量的方式将trace放在合适的位置，pssac2在这一点上要方便非常多。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="pssac2"></category></entry><entry><title>pssac2之用法</title><link href="http://seisman.info/usage-of-pssac2.html" rel="alternate"></link><updated>2013-08-09T00:05:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-09:usage-of-pssac2.html</id><summary type="html">&lt;pre class="literal-block"&gt;
pssac2: Plot seismograms
Usage: pssac2 &amp;lt;infiles&amp;gt; -C&amp;lt;cut0/cut1&amp;gt; -J&amp;lt;params&amp;gt; -R&amp;lt;w/e/s/n&amp;gt;
      [-B&amp;lt;tickinfo&amp;gt;] [-E(k|d|a|n|b)(t(0-9,-5(b),-3(o),-2(a))|vel)] [-K] [-V]
      [-Msize/alpha] [-Gr/g/b/c/t1/t2] [-O] [-P] [-Sshift] [-U[&amp;lt;label&amp;gt;]]
      [-W&amp;lt;pen&amp;gt;] [-#&amp;lt;ncopies&amp;gt;] [-X&amp;lt;x_shift&amp;gt;] [-Y&amp;lt;y_shift&amp;gt;] [-r]

      sacfiles may be given on either the command line or
      if none are given they will be expected using standard in (stdin)
      Using stdin indicate (sacfile,x,y,pen)
          if x and y are given, it will override the position
               taken from the sacfile
          if pen is given the pen on the command line will be overridden

      All options are in the same meaning as standard GMT EXCEPT:
      -C &amp;lt;cut_begin/cut_end&amp;gt;
              windowing data
              -Ct[0-9]/t[0-9] will use the t[0-9] header values
              or -Ct[0-9]/cut_end or -Ccut_begin/t[0-9]
      -E option determines
        (1) profile type:
      a: azimuth profile
      b: back-azimuth profile
      d: distance profile with x in degrees
      k: distance profile with x in kilometers
      n: traces are numbered from 1 to N in y-axis
        (2) time alignment:
      tn: align up with time mark tn in SAC head
            n= -5(b), -3(o), -2(a), 0-9 (t0-t9)
      vel: use reduced velocity
              Examples: -Ek8.0 -Eat-2 -Ed4.4 -Ent-3
      -M vertical scaling in sacfile_unit/MEASURE_UNIT = size&amp;lt;required&amp;gt;
          size: each trace will normalized to size (in MEASURE_UNIT)
              scale =  (1/size) * [data(max) - data(min)]
          size/alpha: plot absolute amplitude multiplied by (1/size)*r^alpha
              where r is the distance range in km across surface
              specifying alpha = 0.0 will give absolute amplitudes
              scale = (1/size) * r^alpha
          size/s: plot absolute amplitude multiplied by (1/size)*sqrt(sin(gcarc))
              where gcarc is the distance in degrees.
              scale = (1/size) * sqrt(sin(gcarc))
      -Gr/g/b/zero_line/t0/t1 positive phase painting
              paints the positive portion of the trace in color r/g/b
              from the zero_line to the top and between times t0 and t1
      -gr/g/b/zero_line/t0/t1 negative phase painting
              paints the negative portion of the trace in color r/g/b
              from the zero_line to the bottom and between times t0 and t1
      -N turn clipping off, data will be plotted outside the bounds
              clipping is on by default in X/Y plots and maps
      -S &amp;lt;seconds&amp;gt; shift the trace by seconds
              u: if next character after S is a u
                 then shift using the user variable
                 i.e. -Su9 will use 'user9' for shifting
                 positive shifts move the plot backwards in time
      -L &amp;lt;seconds per MEASURE_UNIT&amp;gt; while poltting on maps &amp;lt;required for maps&amp;gt;
              If your seismograms look choppy and pixelated
              Check the value of DOTS_PR_INCH in gmtdefaults
              and increase the value using gmtset
      -l &amp;lt;x/y/length/bar_length/font_size&amp;gt;
              plot a timescale in seconds per MEASURE_UNIT at (x,y)
              Only works while plotting on maps
      -D &amp;lt;dx/dy&amp;gt; shifts position of seismogram in MEASURE_UNIT
              Only works while plotting on maps
      -W &amp;lt;pen&amp;gt; the pen may be specified on the command line
              or it may be specified with individual files using stdin
      -n Distances and Great Circle Arcs may be negative, don't complain
      -r remove the mean value
      -s byte swap the data before plotting
      -v plot the traces vertically
      -V Verbose (use more for more information)
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;在sac文件方面与pssac相同，可以直接在命令行中指定或者在标准输入通过给出&lt;tt class="docutils literal"&gt;sacfile [x [y &lt;span class="pre"&gt;[pen]]]&lt;/span&gt;&lt;/tt&gt;来指定。若给出了x、y，则x、y会覆盖sacfile文件指定的位置；若给定pen，则命令行中-W指定的pen选项会被覆盖。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-C&amp;lt;cut_begin/cut_end&amp;gt;&lt;/span&gt;&lt;/tt&gt;截取部分数据用于绘图，与pssac相似；特殊之处在于cut_begin和cut_end在这里可以使用头段变量T0-T9，这样相对更灵活一些。&lt;/li&gt;
&lt;li&gt;-E选项与pssac相同，貌似-E和-M选项在pssac2中是必须的。&lt;/li&gt;
&lt;li&gt;-M选项和pssac相似，说明方面要详细很多，多了一个-Msize/s选项，这里的yscale=(1/size)*sqrt(sin(gcarc))，其实gcarc是震中距，大概也相当于几何扩散的振幅校正，原理不知。从代码中看还有一个-Msize/b选项，是根据J-B表进行振幅校正。&lt;/li&gt;
&lt;li&gt;-Gr/g/b/zero_line/t0/t1将t0到t1时间段内振幅大于zero_line的部分根据rgb涂色。&lt;/li&gt;
&lt;li&gt;-gr/g/b/zero_line/t0/t1将t0到t1时间段内振幅小于zero_line的部分根据rgb涂色。&lt;/li&gt;
&lt;li&gt;-N当地震图振幅过大时，则将超过部分切除&lt;/li&gt;
&lt;li&gt;-S时间平移，-Su9表示按照头段变量user9进行平移&lt;/li&gt;
&lt;li&gt;-L在地图上绘制地震图时，指定每个MEASURE_UNIT代表的地震图秒数，MEASURE_UNIT可能是cm也可能是inch；如果波形看起来很“像素化”，那就要检查一下GMT参数中的DOTS_PR_INCH，可以适当地增大这个值。&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-l&amp;lt;x/y/length/bar_length/font_size&amp;gt;&lt;/span&gt;&lt;/tt&gt;在位置x、y处绘制一个timescale，即MEASURE_UNIT所代表的时间秒数，仅对地图有用。&lt;/li&gt;
&lt;li&gt;-D&amp;lt;dx/dy&amp;gt;对trace做整体偏移&lt;/li&gt;
&lt;li&gt;-W画笔属性&lt;/li&gt;
&lt;li&gt;-n&amp;nbsp;表示震中距是负的（为什么要设计这个？）&lt;/li&gt;
&lt;li&gt;-r去均值&lt;/li&gt;
&lt;li&gt;-s对数据进行byte swap，参见big endian 和 little&amp;nbsp;endian&lt;/li&gt;
&lt;li&gt;-v垂直绘制trace&lt;/li&gt;
&lt;li&gt;-V&amp;nbsp;GMT的verbose模式&lt;/li&gt;
&lt;/ul&gt;
</summary><category term="pssac2"></category></entry><entry><title>pssac2的安装</title><link href="http://seisman.info/install-pssac2.html" rel="alternate"></link><updated>2015-04-01T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-09:install-pssac2.html</id><summary type="html">&lt;p&gt;pssac2是由Brian Savage基于Lupei&amp;nbsp;Zhu的pssac修改得到的，其继承了pssac的优质特性，同时在很多方面又有了进一步的提高。比如选项更加符合GMT的风格，且支持直接在地图上绘制地震图（这个在pssac中很困难），目前pssac2有两个版本，分别支持GMT4和GMT5。&lt;/p&gt;
&lt;div class="section" id="gmt4"&gt;
&lt;h2&gt;GMT4版&lt;/h2&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;下载&lt;/h3&gt;
&lt;p&gt;GMT4下的pssac2貌似没有更官方的下载地址，specfem3d中包含了pssac2的源码：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;git clone --recursive https://github.com/geodynamics/specfem3d.git
&lt;span class="nv"&gt;$ &lt;/span&gt;mv specfem3d/utils/ADJOINT_TOMOGRAPHY_TOOLS/measure_adj/UTIL/pssac2 .
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;pssac2
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;修改&lt;/h3&gt;
&lt;p&gt;在&lt;tt class="docutils literal"&gt;pssac2.c&lt;/tt&gt;中&lt;tt class="docutils literal"&gt;#include &amp;lt;gmt.h&amp;gt;&lt;/tt&gt;语句后添加如下语句:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
typedef GMT_LONG BOOLEAN;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;编译&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;./configure --with-gmt&lt;span class="o"&gt;=&lt;/span&gt;/opt/GMT-4.5.13
&lt;span class="nv"&gt;$ &lt;/span&gt;make
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt5"&gt;
&lt;h2&gt;GMT5版&lt;/h2&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;下载&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;git clone https://github.com/savage13/pssac2.git
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;编译&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;./configure --with-gmt&lt;span class="o"&gt;=&lt;/span&gt;/opt/GMT-5.1.1
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-08-09：初稿；&lt;/li&gt;
&lt;li&gt;2015-01-03：添加了pssac2的GMT5版本并简化了GMT4版本的说明；&lt;/li&gt;
&lt;li&gt;2015-04-01：更新了pssac2的GMT4版本的地址；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="pssac2"></category><category term="编译"></category></entry><entry><title>地震学入门简易指南</title><link href="http://seisman.info/simple-guide-to-seismology.html" rel="alternate"></link><updated>2014-07-07T22:12:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-08:simple-guide-to-seismology.html</id><summary type="html">
&lt;p&gt;写下标题《地震学入门指南》之后，觉得这个标题写得太大，我有些hold不住，所以加上了“简易”二字。这里所说的地震学，专指天然地震学（勘探地震学不在讨论之列）。进入地震学，需要掌握地震学相关的基础知识、了解地震学的前沿进展，同时需要掌握一些数据处理、分析相关的工具。这里只谈一谈天然地震学需要掌握的一些工具与计算机技能。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;写在前面&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;受众&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这篇博文的主要受众是还没开始正式接触科研或刚刚接触科研的人，即大三大四的本科生以及研一新生，希望能够在方向上给予指引；已经入门的人，或许可以看看有没有提到一些你还不知道的工具；地震学的牛人们，如果有其他的想法和建议，也欢迎不断完善。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;为什么要学习工具？&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;有些人认为，做科研最重要的是idea，工具什么的都不重要。我个人是很反对这样一个观点的。idea本身是很重要的，但是如何将idea快速、准确地转换成科研成果，则需要自己有足够的知识积累以及足够的工具支持。&lt;/p&gt;
&lt;p&gt;同样要完成一件事情，没有工具的人可能需要做一天的重复劳动，有工具的人则可能借助于工具几分钟解决问题，这就是效率上的差异，很多时候科研成果也是要拼速度的，不是吗？&lt;/p&gt;
&lt;p&gt;因为&lt;strong&gt;工具可以提高我们的效率&lt;/strong&gt;，所以值得学习。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;要学习哪些工具？&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;各类工具那么多，究竟要学习哪些？要学习多少工具？&lt;/p&gt;
&lt;p&gt;这其实是个很难回答的问题。过分地关注于工具的学习，会导致科研的时间被压缩；而不去认真学习这些工具，科研的效率又无法提升上去。这是一个矛盾，需要自己去权衡。&lt;/p&gt;
&lt;p&gt;我个人的态度是，首先掌握最基础的工具，在此基础上，多接触其它工具、软件和代码，不求每个工具都搞明白，至少花一点点时间看看README，了解&lt;strong&gt;其可以做什么&lt;/strong&gt;。在需要的时候第一时间判断哪个工具可以满足当前的需求。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="linux"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;Linux基础&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;选择Linux还是Windows？这个话题曾经在网上吵得很热，也许现在还有人在争论。就地震学而言，使用Linux的优势要远远高于使用Windows，原因简单列举如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;大多数地震学专用的软件都是在Linux下开发的，然后再移植到Windows下，因而这类软件在Windows下相对来说有更多的Bug；&lt;/li&gt;
&lt;li&gt;很多开源的代码是在Linux下写的，然后用&lt;tt class="docutils literal"&gt;gcc&lt;/tt&gt;或&lt;tt class="docutils literal"&gt;gfotran&lt;/tt&gt;编译的。理论上，只要程序写的时候考虑的可移植性，在Windows下编译是没有问题的，但实际上大多数代码都需要经过一番修改；&lt;/li&gt;
&lt;li&gt;Windows自带了批处理工具（Batch）以及Shell（PowerShell），可以用于完成数据的批处理；但前者功能太单一，后者用的人又很少，所以两者都不是合适的选择；&lt;/li&gt;
&lt;li&gt;Linux下自带了多种Shell（Bash、csh、zsh），以及多个适合数据处理的工具，非常适合用于科研。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;要学习Linux，首先要选择合适的发行版：Ubuntu、Debian和Fedora应该算是比较适合新手的发行版。刚接触Linux的新手可以考虑在虚拟机中安装不同的发行版，每个都尝试一下，找到最适合自己的就好。选择好发行版之后，还要对发行版的版本代号有一些了解。以Ubuntu为例，对于12.04和14.04是长期支持版，支持周期为5年，而其他版本的支持周期只有一年多。我遇到不少目前还在用Ubuntu 13.10的人，（13.10在2014年7月便不再被支持）。这就是在给自己挖坑，系统用的时间越长，重装的代价就越高，想要重装的欲望就越低，重装时数据丢失的风险也越大。&lt;/p&gt;
&lt;p&gt;接下来要选择合适的入门书籍：国内推荐的比较多的是《鸟哥的Linux私房菜—基础学习篇》，个人觉得其语言过于啰嗦，知识点对于新手来说稍显繁杂；另一本推荐的比较多的是开源的《The Linux Command Line》，该书有&lt;a class="reference external" href="http://billie66.github.io/TLCL/"&gt;中文译本&lt;/a&gt;。注意，要读的是介绍Linux的书，而不是任何介绍Linux发行版的书。&lt;/p&gt;
&lt;p&gt;对于Linux入门需要了解的知识点包括：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;了解Linux的历史，以及Linux与各个发行版之间的联系；&lt;/li&gt;
&lt;li&gt;熟悉Linux的目录树，习惯使用命令行，掌握基本命令&lt;tt class="docutils literal"&gt;cd&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;pwd&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;mkdir&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;rmdir&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;ls&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;cp&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;rm&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;mv&lt;/tt&gt;的基本用法；&lt;/li&gt;
&lt;li&gt;理解绝对路径和相对路径；&lt;/li&gt;
&lt;li&gt;理解环境变量&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PATH&lt;/span&gt;&lt;/tt&gt;的作用；&lt;/li&gt;
&lt;li&gt;理解Linux文件权限&lt;tt class="docutils literal"&gt;rwx&lt;/tt&gt;，掌握&lt;tt class="docutils literal"&gt;chmod&lt;/tt&gt;命令；&lt;/li&gt;
&lt;li&gt;其他几个有用的命令：&lt;tt class="docutils literal"&gt;cat&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;touch&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;head&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;tail&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;which&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;locate&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;符号链接&lt;tt class="docutils literal"&gt;ln&lt;/tt&gt;与挂载&lt;tt class="docutils literal"&gt;mount&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;了解最基本的vi编辑器的使用，因为很多时候vi是服务器上唯一能使用的编辑器；&lt;/li&gt;
&lt;li&gt;掌握至少一种高级编辑器的使用，如vim、emacs、sublime text。怎样才叫掌握？这个问题没有标准答案，选择其中一个一直用下去，遇到需要重复劳动或者不顺心的地方就去找各种插件配置一下。像gedit这种编辑器不用也罢，用它来写程序效率太低；&lt;/li&gt;
&lt;li&gt;理解&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;文件的作用；&lt;/li&gt;
&lt;li&gt;理解并学会使用数据流重定向；&lt;/li&gt;
&lt;li&gt;理解管道的作用及其用途；&lt;/li&gt;
&lt;li&gt;Linux通配符；&lt;/li&gt;
&lt;li&gt;掌握压缩相关命令&lt;tt class="docutils literal"&gt;tar&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;gzip&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;bzip2&lt;/tt&gt;，其实最主要的是tar命令的两种常用方式：&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-zxvf&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-jxvf&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;与数据处理相关的命令：&lt;tt class="docutils literal"&gt;awk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;cut&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;grep&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;wc&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;sort&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;uniq&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：严格地说，&lt;tt class="docutils literal"&gt;awk&lt;/tt&gt;已经不单单是一个命令，更像是一种微型语言了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;高级编程语言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;C应该是目前地震学界目前最常用的编程语言，一些老的代码可能用Fortran比较多，现在也有一些人使用Java。&lt;/p&gt;
&lt;p&gt;使用哪种高级编程语言并不重要。高级编程语言至少需要熟练使用一种，同时最好能够了解一些其它语言的语法，这样可以更轻松的阅读别人的代码。&lt;/p&gt;
&lt;p&gt;大学阶段应该都学过谭浩强写的C语言，这本书过分强调了一些不重要的东西，有些错误和误导之处，因而找一本权威的C语言书籍重新复习、巩固和整理编程知识是很重要的。&lt;/p&gt;
&lt;p&gt;在掌握了语言的基本语法的同时，还要确定自己的编程风格、注释风格以及代码管理方式，同时需要了解一些编译相关的知识：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;最基本的编译器选项，比如&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-c&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-o&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-g&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-I&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-L&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-l&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;编译、链接及运行的基础知识，理解头文件、库文件在编译、链接和执行过程中的作用。这部分很重要，因为平常编译源码过程中出现最多的错误除了语法问题就是编译链接问题；&lt;/li&gt;
&lt;li&gt;makefile：实现编译的自动化，比较流行的入门手册是《&lt;a class="reference external" href="http://seisman.info/how-to-write-makefile.html"&gt;跟我一起学Makefile&lt;/a&gt;》，基本上前8章的内容就已经足够了；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;脚本语言&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="bash"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;Bash及其相关&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Bash其实本身只是一个空壳，具有最基本的条件判断和循环功能。除此之外，日常需要的数据处理、字符串处理，都需要借助于Linux下的其他命令，比如&lt;tt class="docutils literal"&gt;cat&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;awk&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;grep&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;cut&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;paste&lt;/tt&gt; 等等。因而除了bash脚本自身的功能以外，还需要了解的工具包括:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;awk&lt;/tt&gt;：文本处理工具；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;sed&lt;/tt&gt;：流编辑器&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;printf&lt;/tt&gt;：格式打印；&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;grep&lt;/tt&gt;：正则表达式匹配；&lt;/li&gt;
&lt;li&gt;正则表达式；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在科研过程中不推荐使用Bash脚本，因为Bash Shell与awk等命令本质上是独立的个体，二者在设计上有很多不一致的地方，且awk等命令在设计的时候明显有向Shell妥协的意味。总之，Bash脚本中坑比较多，仅仅适合用几行就可以搞定的情况。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="perl-python"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;Perl或/和Python&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Perl和Python是另外两种常见的脚本语言。在学会了Bash脚本以及相关的各种工具之后为什么还要学习新的脚本语言呢？因为Bash虽然作为Linux下最底层最常用的脚本语言，但是其功能过于依赖于外部工具，且难以实现更加复杂的功能。Perl和Python可以完全自给自足，其内部完全实现了awk、grep等工具的功能，且速度很快，更重要的是Perl和Python具有模块功能，可以从网上下载各种别人已经写好的模块来实现几乎所有自己想要的功能。因而Perl/Python实际上比Bash功能更强大，学起来也并不难。如果有心学习Perl/Python的话，可以简单了解bash相关知识，然后直接进入更高级的脚本语言。&lt;/p&gt;
&lt;p&gt;就目前的情况来看，Perl适合日常的简单的数据处理，而Python适合完成各种复杂的工作同时也适合进行科学计算。对于新手，更推荐学习Python。当然最好Perl也懂一些，技多不压身嘛。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="sac"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC是地震学的最常用的数据处理软件。关于SAC，可以参考本博客的《SAC参考手册》。&lt;/p&gt;
&lt;p&gt;SAC基础：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;阅读SAC文件格式，理解SAC文件的二进制存储，理解SAC头段变量的含义；&lt;/li&gt;
&lt;li&gt;SAC常用基本命令；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;SAC进阶：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;SAC变量；&lt;/li&gt;
&lt;li&gt;SAC内置函数；&lt;/li&gt;
&lt;li&gt;SAC宏以及脚本调用；&lt;/li&gt;
&lt;li&gt;调用SAC提供的库读写SAC文件；&lt;/li&gt;
&lt;li&gt;利用Prof. Lupei Zhu的sacio.c读写SAC文件；&lt;/li&gt;
&lt;li&gt;学习并掌握saclst的用法；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GMT是地震学领域最常用的绘图软件。GMT很重要，但是又没那么重要。其重要之处在于数据处理的最终结果要通过图像的形式表现出来，而GMT在某些时候是最佳的工具，其不重要之处在于入门前期基本不太需要绘图。&lt;/p&gt;
&lt;p&gt;GMT基础：&lt;/p&gt;
&lt;p&gt;GMT入门的最好方法大概就是阅读《&lt;span class="caps"&gt;GMT&lt;/span&gt; Technical Reference and Cookbook》了；&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;掌握最常用的GMT选项；&lt;/li&gt;
&lt;li&gt;将所有的投影方式看一遍，对每种投影方式的结果有些印象即可；&lt;/li&gt;
&lt;li&gt;简单浏览所有命令，大概知道每个命令的功能；&lt;/li&gt;
&lt;li&gt;浏览GMT提供的30个例子，对每个例子有印象，必要的时候再翻看，同时巩固bash脚本的知识；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;GMT进阶：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;熟悉GMT的常用命令及其每个选项；&lt;/li&gt;
&lt;li&gt;熟悉GMT的全部命令；&lt;/li&gt;
&lt;li&gt;查看相关代码，理解一下内部机制&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id24"&gt;其他计算机技能&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="git"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id25"&gt;Git&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;对于经常写代码的人来说，在修改代码之前都会把原始代码备份一下，以防止一时糊涂把好代码给改坏了。备份的次数多了，自己也就乱了。所以经常写代码的人，需要学会版本控制。&lt;/p&gt;
&lt;p&gt;Git是目前最流行的版本控制软件。学会使用Git之后，就可以随心所欲的修改代码而不必担心把代码改坏了。&lt;/p&gt;
&lt;p&gt;Git学起来很简单，几乎几分钟就可以学会使用基本功能，当然高级些的功能还是需要看看教程的。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.bootcss.com/p/git-guide/"&gt;Git 简易指南&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000"&gt;廖雪峰的Git教程&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://git-scm.com/book/zh"&gt;Pro Git 中文版&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id26"&gt;其他相关&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;pssac：利用GMT的绘图库绘制SAC文件的命令；&lt;/li&gt;
&lt;li&gt;TauP：计算到时等等信息的工具；&lt;/li&gt;
&lt;li&gt;仪器响应：理解仪器响应是正确数据处理的基础；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Guide"></category></entry><entry><title>pssac绘图之读stdin读入文件</title><link href="http://seisman.info/read-files-from-stdin-with-pssac.html" rel="alternate"></link><updated>2013-08-08T00:28:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-08:read-files-from-stdin-with-pssac.html</id><summary type="html">&lt;p&gt;前几篇中提到，pssac有一个-W选项，其实际上是GMT的选项，可以控制trace的粗细颜色等特性。其相当于是一个全局的控制，所有的trace都会遵从-W给出的选项。如果你想要对每个trace有更灵活的控制，可以通过下面的方式来实现。&lt;/p&gt;
&lt;p&gt;当在pssac的命令行中不指定文件名时，可以通过在stdin输入&lt;tt class="docutils literal"&gt;sac_file [x [y &lt;span class="pre"&gt;[pen]]]&lt;/span&gt;&lt;/tt&gt;的方式获取对trace的更多控制。其中x指trace的水平位置，y指trace的垂直位置，pen与-W选项的作用相同。依然使用前面的几个数据。命令或脚本如下:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i -R0/2000/-10/10 -B200/2 -M1 &amp;gt; a.ps &amp;lt;&amp;lt;EOF
ntkm.z 100 -8 0.25p,red,-
nykm.z 200 -3 0.5p,blue,..-
onkm.z 0 0 0.1p,black
sdkm.z 300 5 0.5p,green,.
EOF
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013080801.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这里分别指定了不同trace的水平和垂直位置，并分别指定了每条trace的粗细、颜色及线条。&lt;/p&gt;
&lt;p&gt;到了这里，你可能会想用这样的方法来绘制下面这种图：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013080802.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;先用pscoast绘制一下后面的背景，然后再利用pssac并对每个trace指定其位置以及pen属性。想法是好的，实际上是不行的。原因在于pscoats使用了-J指定投影类型，-R指定了经纬度范围，而pssac也需要指定-J和-R，且pssac的-R横轴必须是时间，这两者是无法统一的（至少目前程序中无法统一）。因而你不可能通过指定经纬度的方式将某个trace放在你想要的经纬度上，因为pssac会使用自己的-R。总之就是此路不通，一个可行的方式是直接绘制单个地震图，然后利用-X和-Y选项进行位置的偏移，如果trace很多觉得很麻烦的话，或许可以根据台站的经纬度以及地图的-R的范围来计算每个trace的偏移量。这个工作量有点大，就不说啦。&lt;/p&gt;
&lt;p&gt;至此，pssac应该就没啥问题了，接下来也许会看看pssac2。&lt;/p&gt;
</summary><category term="pssac"></category></entry><entry><title>pssac绘图之reduce velocity对齐</title><link href="http://seisman.info/reduce-velocity-alignment-with-pssac.html" rel="alternate"></link><updated>2013-08-07T00:18:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-07:reduce-velocity-alignment-with-pssac.html</id><summary type="html">&lt;p&gt;不晓得Reduce Velocity翻译成中文该怎么翻，Peter Shearer的Introduction to Seismology 中的一张图很好的解释了reduce&amp;nbsp;velocity的概念：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Reduce Velocity" src="/images/2013080701.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;左图是标准的时距曲线X-T（也有人称走时图），左图的效果不甚理想，几条曲线斜率相近，密密麻麻放在一起看不清，由此得到了右图Reduced的时距曲线X-（T-X/8），其中8就是这里的reduce&amp;nbsp;velocity，在这种图下，走时曲线更容易看了。&lt;/p&gt;
&lt;p&gt;还是利用上一篇中生成的那些地震数据做实验。&lt;/p&gt;
&lt;p&gt;先看看一个正常的不做任何时间对齐的剖面图（其实按照文件起始时间对齐了）：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX5i -R0/1420/10/40 -B200/5 -Edt-5 -M0.5/-1 \*.z &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013080702.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;再来看看reduce&amp;nbsp;velocity的效果：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX5i -R0/1420/10/40 -B200/5 -Ed12 -M0.5/-1 \*.z &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure" src="/images/2013080703.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这里reduce取了12，然后就大概把初至波给对齐了。reduce velocity的实质是将所有trace的起始时间都减去“X/V”，其中X是震中距，V是reduce&amp;nbsp;速度。&lt;/p&gt;
</summary><category term="pssac"></category></entry><entry><title>pssac绘图之地震剖面图</title><link href="http://seisman.info/plot-profile-with-pssac.html" rel="alternate"></link><updated>2013-08-06T00:08:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-06:plot-profile-with-pssac.html</id><summary type="html">&lt;p&gt;绘制剖面图首先需要一堆数据，这里使用SAC自带的一些数据作为例子（v101.4里面没有这些地震数据）：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; datagen sub tele ntkm.z nykm.z onkm.z sdkm.z
SAC&amp;gt; w ntkm.z nykm.z onkm.z sdkm.z
&lt;/pre&gt;
&lt;p&gt;用saclst命令看看这些数据的头段：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ saclst gcarc b e f *.z
ntkm.z      23.4372    199.8647   1600.1013
nykm.z      38.4145    199.8622   1600.1178
onkm.z      25.3798    199.7684   1600.0247
sdkm.z      17.4213    199.9976   1600.0104
&lt;/pre&gt;
&lt;p&gt;从上面的显示可以看出来，这四个数据的震中距位于15-40度，文件起始时间约为200s，文件结束时间约为1600s。&lt;/p&gt;
&lt;p&gt;下图给出了这几张地震图在SAC中画出来的效果：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; r *.z
ntkm.z nykm.z onkm.z sdkm.z
SAC&amp;gt; sort gcarc
SAC&amp;gt; p1
SAC&amp;gt; saveimg a.pdf
save file a.pdf [PDF]
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 1" src="/images/2013080601.png" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;SAC画出来的图质量会比较差，效果不太好。&lt;/p&gt;
&lt;p&gt;按照上篇博文中绘制单个地震图的方法同时画这几个地震图（注意-R的范围）：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./pssac -JX6i -R200/1600/-10/10 -B100/5 *.z &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 2" src="/images/2013080602.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;可以看出来，四个trace在y=0处重叠在一起，完全不是想要的效果，下面画一个真正的剖面图（注意-R的范围）：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./pssac -JX6i -R0/1420/10/40 -B100/5 -Edt-5 -M1 *.z &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 3" src="/images/2013080603.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;此处多了两个选项-E和-M，其中-Edt-5，d表示剖面类型为震中距，即y轴为震中距，所以-R中给出的y轴范围为（10，40），t-5代表所有的数据以文件起始时间对齐，上一篇博文中已经说过，这意味着所有trace的文件起始时间都是0，那么-R中的x轴范围就应该是（0，1400）。关于为什么为-5代表b，用-3代表o，这个是程序中的一些技巧决定的，习惯就好。如前所说，仅仅使用-E是无法实现真正的剖面图的，这就需要-M选项了。&lt;/p&gt;
&lt;p&gt;如pssac的使用说明所说，-M选项有两种使用方式，一种是-Msize，另一种是-Msize/alpha。当使用-Msize时，在算法中的实现是所有数据点都乘以yscale，其中yscale=size*fabs((north-south)/(h.depmax-h.depmin)/project_info.pars[1])，其中north和south就是-R中给出的y方向的范围，h.depmax和h.depmin就是这个trace的最大和最小值，project_info.pars[1]就是-J中指定的尺寸了，在这个例子中就是6。这样做使得所有的trace的最大值和最小值的差相等，且都等于y方向的一个单位长度，这里就是size英寸。比如上图大小为6英寸，y方向为40-10=30，即图上的每英寸代表y方向的5度（这里y轴是震中距，所以是度），那么size=1的时候，所有trace的最值之差也应该是1英寸，也就是5度的单位，上图证明了一切。这样的做法使得trace失去了绝对振幅和相对振幅。当使用-Msize/alpha时，若alpha&amp;lt;0，则根据第一个trace计算出yscale，以后所有的trace都会乘以相同的yscale，这样做使得各个trace失去了绝对振幅，但是却保持了相对振幅；若alpha&amp;gt;0，那么yscale=pow(fabs(h.dist),alpha)*size。对于一个正常的地震来说，震中距越大，由于几何扩散和衰减的原因，振幅越小，这个选项就是为了将“丢失”的振幅找回来用的。&lt;/p&gt;
&lt;p&gt;其他的选项与绘制单个地震图没有什么区别，下面就以一个比较完整的例子结束这篇博文吧：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ ./pssac -JX5i -R0/1420/10/40 -B200/5 -Edt1 -M0.5/-1 -G0/0/0/0 -r -S150 *.z &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 4" src="/images/2013080604.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这个例子中，我首先用sac大概将初至波到时标记了一下，并保存在头段变量T1中，-Edt1选项使得trace按照T1对齐，所以所有trace的初至对应的时刻是0，这样其实会很难看，所以又利用了-S选项将整个数据平移了150s，现在所有的初至大概都在150s那里了，当然你也可以选择不用-S选项而采用-R-150/1300/10/40这样的方法应该也是可以的。&lt;/p&gt;
&lt;p&gt;关于pssac差不多就是这些了，还有两个小细节没有研究，一个是reduce_velocity，一个是在命令行不指定文件名，而在stdin中给出&lt;tt class="docutils literal"&gt;sacfile [x [y [pen]]&lt;/tt&gt;。这两个会放在下面两篇博文中说。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-08-06：初稿；&lt;/li&gt;
&lt;li&gt;2014-01-11：修正&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Edt-1&lt;/span&gt;&lt;/tt&gt;为&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Edt1&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;2015-03-26：SAC新版本中&lt;tt class="docutils literal"&gt;saveimg&lt;/tt&gt;默认只支持PS和PDF格式，此处将PNG改成PDF；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="pssac"></category></entry><entry><title>pssac绘图之单个地震图</title><link href="http://seisman.info/plot-single-trace-with-pssac.html" rel="alternate"></link><updated>2013-08-05T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-05:plot-single-trace-with-pssac.html</id><summary type="html">&lt;p&gt;pssac中从GMT继承的选项都很简单，不再多说。pssac自己的选项中，上一篇博文中介绍了-I、-Q、-r这三个简单的选项，本文将通过一系列例子去理解pssac的其他几个选项在绘制单个地震图时会有什么样的效果。&lt;/p&gt;
&lt;p&gt;首先找个顺手的地震图试试，SAC自带的样本地震就是个不错的选择：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; fg seis
SAC&amp;gt; lh b e depmax depmin

FILE: SEISMOGR - 1
--------------
b = 9.459999e+00
e = 1.945000e+01
depmax = 1.520640e+00
depmin = -1.569280e+00
SAC&amp;gt; w seis
&lt;/pre&gt;
&lt;p&gt;这个数据的横坐标范围大概是(9.4,19.5)，纵坐标范围大概(-1.6,1.6)。&lt;/p&gt;
&lt;p&gt;使用如下命令即可得到下图：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R9/20/-2/2 seis &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="图1" src="/images/2013080501.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这个命令是使用pssac需要的最简单的命令了，画出来的图和想象中的一样。为了更清楚地看到其他选项对于地震图的影响，先给这张图加个边框。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R9/20/-2/2 -B1/0.4 seis &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="图2" src="/images/2013080502.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;为了更效果明显一些，所以横纵坐标都选的偏大了一点。&lt;/p&gt;
&lt;p&gt;下面利用pssac自带的选项来进一步修改这个图：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R9/20/-2/2 -B1/0.4 -C11/16 -G0/255/0/0 -Wblue seis &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="图3" src="/images/2013080503.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;-C选项指定要绘制的区域，-C11/16代表只绘制11s到16s之间的数据，这个相当于实现了SAC中的cut命令，随便一个地震数据，需要哪段画哪段。&lt;/p&gt;
&lt;p&gt;-G0/255/0/0表示将所有振幅&amp;gt;0的区域都涂上绿色，这个在剖面图中用的会比较多一点。-Wblue指定线条颜色为蓝色（其实这是GMT的选项，只是在pssac源程序中当作一般选项来处理了）。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R9/20/-2/2 -B1/0.4 -S3 seis &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 4" src="/images/2013080504.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;-S选项给出的是trace的shift量，由上图可以看出，trace整体向右平移了3s。（为什么要设计这个选项？我不太清楚。）这里引入了-S和-C的优先级问题。即先是数据平移再截取数据，还是先截取数据再进行平移。&lt;/p&gt;
&lt;p&gt;下面的例子可以给出答案：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R9/20/-2/2 -B1/0.4 -C11/16 -S3 seis &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 5" src="/images/2013080505.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;与前面两张图对比一下可以看出来，数据首先整体平移了3s，即当前的数据x范围为（12，21），而-C指定的范围为（11，16），所以实际画出的区域是（12，16）。所以-S的优先级要大于-C。（可以得出结论-S是用来修改文件起始时间的吗？）&lt;/p&gt;
&lt;p&gt;下面看一下-V选项（为了图看起来方便，这里-J、-R、-B都改了）：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX3i/6i -R-2/2/9//20 -B0.4/1 seis -V &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 6" src="/images/2013080506.jpg" style="width: 300px;" /&gt;
&lt;/div&gt;
&lt;p&gt;由这个例子可以看出-V的功能跟GMT中的-P可不一样，-V导致的结果是横轴变成了振幅，纵轴变成了时间。一个可能的用途上，某些具体情况下，地震图中的某个震相到时可能与某个界面的深度成正比，通过垂直绘制地震图并将多个地震图排在一起，并把纵坐标通过某个关系改成相应的深度，那么一张界面变化图就出来了。一个常见的例子是接收函数。&lt;/p&gt;
&lt;p&gt;-E选项和-M选项一般在绘制单个地震图时不会使用，当然只要你理解了其中的细节，用了也不会出什么大事。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R9/20/-2/2 -B1/0.4 seis -M1 &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 7" src="/images/2013080507.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;可以很明显的看到振幅变小了。&lt;/p&gt;
&lt;p&gt;下面的例子展示了-E单独使用时出现的问题：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R9/20/-2/2 -B1/0.4 -Edt-5 seis &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 8" src="/images/2013080508.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;-E选项指定了要使用剖面。t代表按照某个时间对齐，-5代表文件起始时间，这意味着所有的文件都要按照文件起始时间对齐，即所有文件的b对应的时间为0。&lt;/p&gt;
&lt;p&gt;下面修改R的范围来显示全部的地震图：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R0/11/-2/2 -B1/0.4 -Edt-5 seis &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 9" src="/images/2013080509.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这下地震图都显示出来了，另一个问题在于，剖面类型在这里究竟起到了怎么的效果？事实是没有效果。剖面类型d指定了y轴为震中距，那么这个地震图应该在y=3.4附近。而实际上地震图在0附近。&lt;/p&gt;
&lt;p&gt;下面的例子解决了单个地震图的剖面类型无效的问题，这里y轴的范围取为(3,4):&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./pssac -JX6i/3i -R0/11/3/4 -B1/0.4 -Edt-5 seis -M1 &amp;gt; a.ps
&lt;/pre&gt;
&lt;div class="figure"&gt;
&lt;img alt="Figure 10" src="/images/2013080510.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;这里地震图的位置对了，是一个最简单的剖面图了，如前所说，剖面图实际上丢弃了地震图的绝对振幅信息，你可以试试通过-M选项修改其振幅，不过，剖面图的相对信息还是在的，这些应该会在下一篇博文中说。&lt;/p&gt;
&lt;p&gt;至此，如何利用pssac绘制单个地震图就说完啦。&lt;/p&gt;
</summary><category term="pssac"></category></entry><entry><title>pssac之使用</title><link href="http://seisman.info/usage-of-pssac.html" rel="alternate"></link><updated>2013-08-04T15:18:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:usage-of-pssac.html</id><summary type="html">&lt;p&gt;直接键入pssac，会得到pssac的使用说明：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Usage: pssac standardGMToptions [SACfiles] [-C[t1/t2]] [-E(k|d|a|n|b)(t[n]|vel)] [-Gr/g/b/c] [-I] [-Msize[/alpha]] [-Q] [-r] [-Sshift] [-V]

pssac plots SAC traces. If no SAC file names is provided in the command line, it expects (sacfile,[x,[y [pen]]) from stdin.
      -C only plot data between t1 and t2
      -E option determines
        (1) profile type:
     a: azimuth profile
     b: back-azimuth profiel
     d: epicentral distance (in degs.) profile
     k: epicentral distance (in km.) profile
     n: traces are numbered from 1 to N in y-axis
        (2) time alignment:
     tn: align up with time mark tn in SAC head
             default is the reference time. Others are
         n= -5(b), -3(o), -2(a), 0-9 (t0-t9)
     vel: use reduced velocity
      -G paint amplitudes larger than c with color r/g/b
      -I integrate the trace before plotting
      -M multiple traces
     size: each trace will normalized to size (in y-unit)
     size/alpha: if alpha&amp;lt;0, use same scale for all traces
         else plot absolute amplitude multiplied by size*r^alpha
         where r is the distance range in km
      -Q square the trace
      -r remove the mean value in the trace
      -S shift traces by shift seconds
      -V plot traces vertically
&lt;/pre&gt;
&lt;p&gt;想要彻底理解这个程序还要看看源代码。&lt;/p&gt;
&lt;p&gt;pssac从GMT中继承的选项包括：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
J R  # 必须
B K O U X x Y y # \0  #可选
&lt;/pre&gt;
&lt;p&gt;这些选项都是GMT的常见选项，具体含义参见GMT，这里不再介绍这几个选项的用法。J和R是必须的，可选参数中不太常见的选项有四个，x、y、#、\0，其中x、y和X、Y是一样的，这是GMT中为数不多的几个不区分大小写的选项，#和\0的含义不明，个人猜测是代表注释行和空文件名。&lt;/p&gt;
&lt;p&gt;pssac特有的选项包括：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
C E G I M Q r S V W
&lt;/pre&gt;
&lt;p&gt;其中-I表示画图之前先积分（比如数据是速度，你想要画的是位移）。-Q先平方再画图（这个处理有点诡异，不知道什么场合会用到）。-r先去均值再画图。从源代码中可以看出，当三个选项同时存在时，先积分，再平方，最后去均值。这三个选项非常简单，其他的选项会在后面详细介绍。&lt;/p&gt;
&lt;p&gt;利用pssac绘制的图大致分为两类，一类是绘制单个地震图，另一类是绘制剖面图。所谓剖面图，又分为5种剖面图，即-E选项所指定的a、b、d、k、n。剖面图的特点在于你需要给出多个文件（当然一个也可以），一旦剖面类型给定了，地震图的相对位置也就给定了，比如当你的R选项的y轴范围给定为0-90时，选取剖面类型为d时，那么震中距为1度的地震图就会放在1那个位置，震中距为30的地震图放在30那个位置，这个时候y轴只表示震中距了，跟地震图的振幅一点关系也没有。所谓单个地震图，并不意味着一张图里就只有一个trace，可能有很多个trace，但是这些trace之间不像剖面图那样关系密切。&lt;/p&gt;
&lt;p&gt;《&lt;a class="reference external" href="http://seisman.info/plot-single-trace-with-pssac.html"&gt;pssac绘图之单个地震图&lt;/a&gt;》介绍了如何使用pssac绘制单个地震图。&lt;/p&gt;
&lt;p&gt;《&lt;a class="reference external" href="http://seisman.info/plot-profile-with-pssac.html"&gt;pssac绘图之地震剖面图&lt;/a&gt;》介绍了如何使用pssac绘制地震剖面图。&lt;/p&gt;
</summary><category term="pssac"></category><category term="用法"></category></entry><entry><title>pssac之安装</title><link href="http://seisman.info/install-pssac.html" rel="alternate"></link><updated>2014-07-16T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:install-pssac.html</id><summary type="html">
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt; pssac仅支持GMT4。&lt;/p&gt;
&lt;p&gt;pssac是Prof. Lupei Zhu根据GMT的psxy命令改写的一个小程序，利用GMT强大的绘图功能来绘制SAC文件。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;下载&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;mkdir pssac
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;pssac
&lt;span class="nv"&gt;$ &lt;/span&gt;wget http://www.eas.slu.edu/People/LZhu/downloads/pssac.tar
&lt;span class="c"&gt;#下载基于GMT4.0的pssac包&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;wget http://www.eas.slu.edu/People/LZhu/downloads/pssac.c
&lt;span class="c"&gt;#下载基于GMT4.5的pssac源码&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;tar xvf pssac.tar
&lt;span class="nv"&gt;$ &lt;/span&gt;cp pssac.c pssac &lt;span class="c"&gt;#用新的pssac.c替换旧的&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd &lt;/span&gt;pssac
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="makefile"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;修改Makefile&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;用编辑器打开Makefile文件，在文件头部加上1-5行的内容，并根据自己的情况稍作修改：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;安装GMT4时必须用系统自带的软件包管理器安装netcdf3或netcdf4&lt;/li&gt;
&lt;li&gt;Makefile中的命令必须使用Tab键作为separator；&lt;/li&gt;
&lt;/ol&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;GMTHOME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/opt/GMT-4.5.13
&lt;span class="nv"&gt;GMT_INC&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-I&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GMTHOME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;/include
&lt;span class="nv"&gt;GMT_LIBS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-L&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GMTHOME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;/lib -lgmt -lpsl -lgmtps -lnetcdf -lm

&lt;span class="nv"&gt;CFLAGS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; -O &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GMT_INC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;

&lt;span class="nf"&gt;pssac&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;pssac&lt;/span&gt;.&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="n"&gt;sacio&lt;/span&gt;.&lt;span class="n"&gt;o&lt;/span&gt;
     &lt;span class="k"&gt;$(&lt;/span&gt;LINK.c&lt;span class="k"&gt;)&lt;/span&gt; -o &lt;span class="nv"&gt;$@&lt;/span&gt; &lt;span class="nv"&gt;$@&lt;/span&gt;.o sacio.o &lt;span class="k"&gt;$(&lt;/span&gt;GMT_LIBS&lt;span class="k"&gt;)&lt;/span&gt;

&lt;span class="nf"&gt;clean&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
     rm -f pssac *.o
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMTHOME&lt;/span&gt;&lt;/tt&gt;为你安装的GMT的路径，需要根据自己的情况修改&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;GMT_INC&lt;/tt&gt;指定了GMT的头文件位置&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;GMT_LIBS&lt;/tt&gt;指定了编译过程中所需要的库文件&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-L&lt;/span&gt;&lt;/tt&gt;指定了在编译过程中要在哪些路径下寻找库文件&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-lgmt&lt;/span&gt; &lt;span class="pre"&gt;-lpsl&lt;/span&gt; &lt;span class="pre"&gt;-lgmtps&lt;/span&gt;&lt;/tt&gt;为&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt;/lib&lt;/tt&gt;下的几个库文件&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-lnetcdf&lt;/span&gt;&lt;/tt&gt;是netcdf的库文件&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;编译&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;make
cc -O -I/opt/GMT-4.5.13/include   -c -o pssac.o pssac.c
cc -O -I/opt/GMT-4.5.13/include   -c -o sacio.o sacio.c
cc -O -I/opt/GMT-4.5.13/include    -o pssac pssac.o sacio.o -L/opt/GMT-4.5.13/lib -lgmt -lpsl -lgmtps -lnetcdf -lm
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;编译过程就是简单的make，如果没有错误的话应该会出现下面三行。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;执行&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;直接./pssac应该就会出来关于pssac的使用说明，如果报其他错，可以向我反馈。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;对旧版本的说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在编译旧版本的pssac的时候，可能会出现类似“BOOLEAN类型未定义”这样的错误，这是因为在C99标准之前是没有bool类型的定义，C99标准中增加了_Bool类型作为布尔类型，而BOOLEAN应该是用户自己定义的。具体可以参考下面两个维基条目：&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://zh.wikipedia.org/wiki/%E5%B8%83%E7%88%BE_%28%E6%95%B8%E6%93%9A%E9%A1%9E%E5%9E%8B%29#C"&gt;http://zh.wikipedia.org/wiki/%E5%B8%83%E7%88%BE_%28%E6%95%B8%E6%93%9A%E9%A1%9E%E5%9E%8B%29#C&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://zh.wikipedia.org/wiki/C%E8%AF%AD%E8%A8%80#C99"&gt;http://zh.wikipedia.org/wiki/C%E8%&lt;span class="caps"&gt;AF&lt;/span&gt;%&lt;span class="caps"&gt;AD&lt;/span&gt;%E8%A8%80#C99&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;可以通过在pssac.c重定义数据类型来修正整个错误。在pssac.c代码的前部加上如下两个typedef语句中的任何一个都可以：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="kt"&gt;_Bool&lt;/span&gt; &lt;span class="n"&gt;BOOLEAN&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;typedef&lt;/span&gt; &lt;span class="n"&gt;GMT_LONG&lt;/span&gt; &lt;span class="n"&gt;BOOLEAN&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;其中GMT_LONG是Prof. Zhu 的新pssac.c代码中的用法。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-04-17：初稿；&lt;/li&gt;
&lt;li&gt;2013-04-19：加入了对旧版本pssac.c的讨论。&lt;/li&gt;
&lt;li&gt;2014-06-24：GMT4的最近几个版本，都不再建议自己安装netcdf3了，最好还是自己利用系统自带的软件包管理器安装netcdf4。在这种情况下，netcdf会被安装到系统默认路径中，因而Makefile中不需要再指明netcdf的安装路径；&lt;/li&gt;
&lt;li&gt;2014-07-16：在某些系统下，GMT_LIBS需要加上&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-lm&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="pssac"></category><category term="编译"></category><category term="GMT4"></category></entry><entry><title>GMT修改默认参数</title><link href="http://seisman.info/modify-default-parameters.html" rel="alternate"></link><updated>2013-08-04T15:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:modify-default-parameters.html</id><summary type="html">&lt;p&gt;GMT的默认参数文件为&lt;tt class="docutils literal"&gt;.gmtdefaults4&lt;/tt&gt;，其系统默认值位于文件&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;GMTHOME&lt;/span&gt;/share/conf/gmtdefaults_SI&lt;/tt&gt;中。GMT查找参数文件的顺序是&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./gmtdefaults4 &amp;gt; ~/.gmt/.gmtdefaults4 &amp;gt; ~/.gmtdefaults4
&lt;/pre&gt;
&lt;p&gt;GMT手册中给出了修改GMT参数的几种方法，具体总结起来如下：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;在单个命令行上使用“+filename”这样的语法来指定要使用的参数文件，该法仅对当前命令有效。&lt;/li&gt;
&lt;li&gt;将要使用的参数文件.gmtdefaults4拷贝到当前路径，执行相关绘图命令，然后删除该参数文件，这要求写脚本时要特别小心。&lt;/li&gt;
&lt;li&gt;通过gmtset命令显式修改参数，具体参见gmtset的manual&lt;/li&gt;
&lt;li&gt;在命令行上直接显式修改单个参数，仅对当前命令有效&lt;/li&gt;
&lt;li&gt;使用GMT的isolation模式，将所有的参数文件存储到临时目录中&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;可以将上面的5种方法分成三类：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;法1和法4为一类，都是在当前命令上加参数修改，效果仅限于当前命令，不同之处仅在于一个指定文件一个指定参数&lt;/li&gt;
&lt;li&gt;法2和法5都是使用临时参数文件，不同之处在于法2需要将参数文件拷贝到当前目录，法5则在指定的临时目录中直接读取参数文件&lt;/li&gt;
&lt;li&gt;法3很特别，其修改了当前路径下的参数文件（或者新建），这会带来一个潜在的问题：假若在一个脚本中，你首先执行了一堆命令，这个时候使用GMT默认的参数文件，然后使用gmtset修改了参数，再继续执行另外几个命令，当整个脚本执行结束之后，当前路径下的.gmtdefaults是已经被修改后的参数文件了，因而当你再次执行这个脚本的时候，前面执行的一堆命令将会读取当前路径下的参数文件（即读取已经被修改的那个，而实际上它们需要的是GMT系统参数文件）。当你没有意识到这个问题的时候，你可能会莫名其妙的得到奇怪的结果。所以一个比较好的做法是在脚本结束时删除当前路径下的参数文件。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;个人感觉，GMT参数设计的不够合理。isolation模式不错，但是总觉得用起来不是那么方便，gmtset这里也容易产生问题。比较合理的解决办法是用gmtset，然后在脚本结束的时候删除当前路径下的参数文件。&lt;/p&gt;
</summary><category term="GMT4"></category><category term="GMT技巧"></category></entry><entry><title>GMT单位制</title><link href="http://seisman.info/units-of-gmt.html" rel="alternate"></link><updated>2013-08-04T14:50:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:units-of-gmt.html</id><summary type="html">&lt;p&gt;GMT提供了两种单位制，即SI和US。默认情况下GMT使用国际单位制SI。若想要使用US单位制，在安装GMT时可以在configure后在参数&amp;#8212;enable-US即可。&lt;/p&gt;
&lt;p&gt;若在安装之后想要修改单位制也很简单，直接修改GMT/share/conf/gmt.conf文件即可。&lt;/p&gt;
&lt;p&gt;SI单位制和US单位制分别对应不同的默认参数文件，即share/conf下的gmtdefaults_SI和gmtdefaults_US。&lt;/p&gt;
&lt;p&gt;下面简单看看这两个单位制默认参数文件的差异&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;diff gmtdefaults_SI gmtdefaults_US
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;diff给出的结果为：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
1c1
&amp;lt; # $Id: gmtdefaults_SI.in 9545 2011-07-27 19:31:54Z pwessel $
---
&amp;gt; # $Id: gmtdefaults_US.in 9545 2011-07-27 19:31:54Z pwessel $
4c4
&amp;lt; # SI Version
---
&amp;gt; # US Version
9c9
&amp;lt; PAPER_MEDIA = a4
---
&amp;gt; PAPER_MEDIA = letter
15c15
&amp;lt; ANNOT_OFFSET_PRIMARY = 0.2c
---
&amp;gt; ANNOT_OFFSET_PRIMARY = 0.075i
18c18
&amp;lt; ANNOT_OFFSET_SECONDARY = 0.2c
---
&amp;gt; ANNOT_OFFSET_SECONDARY = 0.075i
22c22
&amp;lt; HEADER_OFFSET = 0.5c
---
&amp;gt; HEADER_OFFSET = 0.1875i
25c25
&amp;lt; LABEL_OFFSET = 0.3c
---
&amp;gt; LABEL_OFFSET = 0.1125i
36,37c36,37
&amp;lt; FRAME_WIDTH = 0.2c
&amp;lt; GRID_CROSS_SIZE_PRIMARY = 0c
---
&amp;gt; FRAME_WIDTH = 0.075i
&amp;gt; GRID_CROSS_SIZE_PRIMARY = 0i
39c39
&amp;lt; GRID_CROSS_SIZE_SECONDARY = 0c
---
&amp;gt; GRID_CROSS_SIZE_SECONDARY = 0i
41c41
&amp;lt; MAP_SCALE_HEIGHT = 0.2c
---
&amp;gt; MAP_SCALE_HEIGHT = 0.075i
43c43
&amp;lt; TICK_LENGTH = 0.2c
---
&amp;gt; TICK_LENGTH = 0.075i
45,48c45,48
&amp;lt; X_AXIS_LENGTH = 25c
&amp;lt; Y_AXIS_LENGTH = 15c
&amp;lt; X_ORIGIN = 2.5c
&amp;lt; Y_ORIGIN = 2.5c
---
&amp;gt; X_AXIS_LENGTH = 9i
&amp;gt; Y_AXIS_LENGTH = 6i
&amp;gt; X_ORIGIN = 1i
&amp;gt; Y_ORIGIN = 1i
50c50
&amp;lt; UNIX_TIME_POS = BL/-2c/-2c
---
&amp;gt; UNIX_TIME_POS = BL/-0.75i/-0.75i
63c63
&amp;lt; CHAR_ENCODING = ISOLatin1+
---
&amp;gt; CHAR_ENCODING = Standard+
93c93
&amp;lt; MEASURE_UNIT = cm
---
&amp;gt; MEASURE_UNIT = inch
107c107
&amp;lt; LINE_STEP = 0.025c
---
&amp;gt; LINE_STEP = 0.01i
&lt;/pre&gt;
&lt;p&gt;由上面显示的结果可以看出，两种单位制的不同主要体现在默认纸张大小(PAPER_MEDIA)的不同以及字符编码方式的不同(CHAR_ENCODING)。&lt;/p&gt;
&lt;p&gt;由于1 inch = 2.54&amp;nbsp;cm，其他参数在两种单位制下的效果基本相同。&lt;/p&gt;
&lt;p&gt;GMT手册中给出了两种指定单位的方法，参见GMT 4.5.9 Technical Reference and Cookbook Section 4.1&amp;nbsp;P49，即显式指定和隐式指定，GMT建议使用显式指定的方法。&lt;/p&gt;
&lt;p&gt;默认情况下，GMT使用的是国际单位制，但是由于GMT的手册上的例子大多使用US单位制，导致大部分人在显式指定单位时都使用US单位制，比如习惯使用-JM6i而不是-JM15c。对于国人来说，由于对US单位制没有概念，所以在使用的时候是不方便的，比如想要使用-X将图整体上移一定距离时，由于A4纸张的大小是已知的，所以肉眼很容易判断是该上调2cm左右而不是5cm左右，但是如果使用US单位制的时候，却不那么容易判断究竟是1英寸还是3英寸。&lt;/p&gt;
&lt;p&gt;所以国人在GMT中或许应该更多地使用SI国际单位制。&lt;/p&gt;
</summary><category term="GMT4"></category></entry><entry><title>闰年的判断</title><link href="http://seisman.info/leap-year.html" rel="alternate"></link><updated>2013-08-04T14:36:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:leap-year.html</id><summary type="html">&lt;p&gt;判定某年为闰年的标准是：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;能被4整除且不能被100整除的&lt;/li&gt;
&lt;li&gt;能被400整除的&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;用C语言实现代码就是&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
   &lt;span class="c1"&gt;//输出该年是闰年;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
   &lt;span class="c1"&gt;//输出该年是平年;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;一种更简单的写法是&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#define ISLEAP(yr) ((!((yr) % 4) &amp;amp;&amp;amp; (yr) % 100) || !((yr) % 400))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="C"></category></entry><entry><title>SAC的时间概念</title><link href="http://seisman.info/timing-of-sac.html" rel="alternate"></link><updated>2013-08-04T14:30:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:timing-of-sac.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;时间变量&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC用于处理时间序列，其头段变量中与时间有关的也很多，总的来说分为2类：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;strong&gt;GMT时间&lt;/strong&gt;：绝对时间，或参考时间，包括NZYEAR、&lt;span class="caps"&gt;NZJDAY&lt;/span&gt;、&lt;span class="caps"&gt;NZHOUR&lt;/span&gt;、&lt;span class="caps"&gt;NZMIN&lt;/span&gt;、&lt;span class="caps"&gt;NZSEC&lt;/span&gt;、&lt;span class="caps"&gt;NZMSEC&lt;/span&gt;，分别代表年、日、时、分、秒、毫秒。注意这里没有月的概念，NZJDAY代表该年的第多少天。这6个变量构成了一个绝对时间，这个绝对时间以更易读的形式保存在变量KZDATE和 KZTIME中（这两个变量虽然说是头段变量，但是在文件中实际上并不对应这两个变量的存储空间），其是整个SAC文件中唯一的绝对时间，因而用作为参考时间去定义相对时间。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;相对时间&lt;/strong&gt;：包括B、E、O、A、F、Tn等等，这些相对时间的值都是相对于绝对时间来定义的。O=100即意味着发震时刻为参考时间加上100秒所对应的GMT时间。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;测试&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下面针对这些时间变量做一些测试，试着更深刻地理解SAC的时间。&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;原始数据&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;选取了一个地震的三分量，列出其kzdate、kztime、b、e如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:46:23.019
b = 5.380000e-04
e = 4.499951e+03
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="b"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;修改文件起始时间b&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;用如下命令直接修改文件起始时间&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ch b 10
&lt;/pre&gt;
&lt;p&gt;得到结果如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:46:23.019
b = 1.000000e+01
e = 4.509950e+03
&lt;/pre&gt;
&lt;p&gt;文件的参考时间没有发生变化，b和e都向后推迟了10s，这意味着整段SAC数据任一点的绝对时间延迟了10s，因而这一点可以用来校正时间零飘以及时区差异（但是前提是当前文件中o、a、f、tn未定义）。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="e"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;修改文件结束时间e&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;用如下命令直接修改文件结束时间&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ch e 0
&lt;/pre&gt;
&lt;p&gt;得到结果如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:46:23.019
b = 5.380000e-04
e = 4.499951e+03
&lt;/pre&gt;
&lt;p&gt;文件的参考时间以及e均没有发生变化，这意味着e的值不是可以任意改变的，而是根据b、delta及npts动态决定的，尝试修改delta，e值随之改变；尝试修改npts以达到类似“cut”的效果时，出现警告：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
WARNING: NVHDR, NPTS, NWFID, NORID, and NEVID cannot be changed with CHNHDR
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="oaftn"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;修改o、a、f、tn&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;这些变量是用于标记时刻的变量，不是必须的，用户可以随意修改，不会对参考时间等产生任何的影响。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;修改参考时间&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;随便定义了几个o、a、f、t0的值，以验证修改参考时间对这些时间变量的影响，原始变量值如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:46:23.019
b = 5.380000e-04
e = 4.499951e+03
o = 2.000000e+01
a = 4.000000e+01
f = 9.000000e+01
t0 = 6.000000e+01
&lt;/pre&gt;
&lt;p&gt;用如下命令修改参考时间&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ch nzmin 50
&lt;/pre&gt;
&lt;p&gt;得到结果如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:50:23.019
b = 5.380000e-04
e = 4.499951e+03
o = 2.000000e+01
a = 4.000000e+01
f = 9.000000e+01
t0 = 6.000000e+01
&lt;/pre&gt;
&lt;p&gt;整个SAC文件中除参考时间外其他时间都没有发生变化。参考时间变化了而相对时间没有变化，这导致SAC数据点的绝对时间发生了平移，与第一条中直接修改b的情况类似。可以通过修改参考时间的方式来校正时钟漂移和时区差异，当然一般不这么做。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;修改参考时间为发震时刻&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;很多情况下，需要将参考时间修改为发震时刻，从第四条可以看出，直接修改参考时间的方案是不可行的。&lt;/p&gt;
&lt;p&gt;当我们将参考时间提前10s的时候，为了保证其他时间变量所对应的绝对时间不发生变化，我们需要同时将各个相对时间加上10s（这样才能保证在某个参考时间下标记的震相到时等信息可以完全映射到另一个参考时间下的震相到时，这或许可以理解为时间坐标系下的坐标变换）。&lt;/p&gt;
&lt;p&gt;因为修改参考时间，而使得每个相对时间都要一一修改，这工作量有点大。SAC自身提供了一个更为简单的选项帮助我们实现了这一功能，如manaul中所说：“你可以使用alltt选项改变这个参考时间和其他所有的相对时间，这个秒数t增加到每个给定的相对时间上，同样的秒数也从参考时间中减去，这样就使数据实际的GMT时间保持不变”。&lt;/p&gt;
&lt;p&gt;还是上面那个例子，使用&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ch allt 10
&lt;/pre&gt;
&lt;p&gt;得到结果如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:46:13.019
b = 1.000054e+01
e = 4.509951e+03
o = 3.000000e+01
a = 5.000000e+01
f = 1.000000e+02
t0 = 7.000000e+01
&lt;/pre&gt;
&lt;p&gt;相对时间都增加了10s，参考时间减少了10s。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gmt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;直接使用GMT时间&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;为方便起见，你可以输入一个GMT时间而不是输入一个相对时间。当输入GMT时间时，SAC首先将其变为相对时间再存储到头段变量中。已知某事件的发震时刻，想要将发震时刻作为参考时间，其他所有的相对时间都变成相对这个参考时间的秒数，可以使用&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ch o gmt 2011 070 05 50 23 019
&lt;/pre&gt;
&lt;p&gt;得到如下结果：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:46:23.019
b = 5.380000e-04
e = 4.499951e+03
o = 2.400000e+02
a = 4.000000e+01
f = 9.000000e+01
t0 = 6.000000e+01
&lt;/pre&gt;
&lt;p&gt;发震时刻被转换为相对时间240存储在头段变量o中，为了修改参考时间为发震时刻，需要将所有相对时间减去240s，参考时间加上240s，命令为&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ch allt －240 iztype io
&lt;/pre&gt;
&lt;p&gt;结果如下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
kzdate = MAR 11 (070), 2011
kztime = 05:50:23.019
b = -2.399995e+02
e = 4.259951e+03
o = 0.000000e+00
a = -2.000000e+02
f = -1.500000e+02
t0 = -1.800000e+02
&lt;/pre&gt;
&lt;p&gt;由结果可以看出，这么做达到了我们想要的目的。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;将SAC中的时间变量可以细分为三类：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;第一类为参考时间，即NZYEAR、&lt;span class="caps"&gt;NZJDAY&lt;/span&gt;、&lt;span class="caps"&gt;NZHOUR&lt;/span&gt;、&lt;span class="caps"&gt;NZMIN&lt;/span&gt;、&lt;span class="caps"&gt;NZSEC&lt;/span&gt;、&lt;span class="caps"&gt;NZMSEC&lt;/span&gt;；&lt;/li&gt;
&lt;li&gt;第二类为相对时间，即o、a、f、tn；&lt;/li&gt;
&lt;li&gt;第三类为特殊的相对时间，即b、e。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在第三类中e是不能随意改变的，所以可以不考虑。单独修改这三类时间变量都不会影响其他时间变量，修改第二类时间不会造成整个数据的绝对时间的改变，修改第一、三类时间变量时数据绝对时间会发生改变（该特性可用于校正时间零漂或时区不一致）。为了保证数据的绝对时间不发生改变，通常使用allt选项来实现。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="SAC技巧"></category><category term="时间"></category></entry><entry><title>利用Web Service Fetch scripts申请和下载数据</title><link href="http://seisman.info/web-service-fetch-scripts.html" rel="alternate"></link><updated>2013-08-04T14:19:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:web-service-fetch-scripts.html</id><summary type="html">
&lt;div class="section" id="iris-web-service"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;&lt;span class="caps"&gt;IRIS&lt;/span&gt; Web Service&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;IRIS&lt;/span&gt; DMC提供了一系列网页服务，用于获取台站数据、仪器响应、走时以及波形数据等。简而言之，其原理大概就是根据某种特定的格式要求发送网页请求，然后IRIS会返回相应的信息供用户解析。&lt;/p&gt;
&lt;p&gt;IRIS网页服务的主页位于：&lt;a class="reference external" href="http://service.iris.edu/"&gt;http://service.iris.edu/&lt;/a&gt; ，有兴趣的可以研究一下。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="web-service-fetch-script"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Web Service Fetch Script&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;主页：&lt;a class="reference external" href="https://seiscode.iris.washington.edu/projects/ws-fetch-scripts"&gt;https://seiscode.iris.washington.edu/projects/ws-fetch-scripts&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这是一个利用IRIS提供的网页服务来实现数据下载的工具，其源代码用perl写成，因而几乎可以在任何平台上直接运行。整个工具包含了三个perl脚本：FetchData、FetchEvent和FetchMetadata。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="fetchdata"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;FetchData&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;功能：获取时间序列文件，或/和与之相关的元数据、SAC零极点文件、响应文件。其中时间序列文件为miniSEED格式，元数据为ASCII格式。&lt;/p&gt;
&lt;p&gt;用法：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
FetchData: collect time series and related metadata (version 2013.198)
http://service.iris.edu/clients/

Usage: FetchData [options]

 Options:
 -v                Increase verbosity, may be specified multiple times
 -N,--net          Network code, list and wildcards (* and ?) accepted
 -S,--sta          Station code, list and wildcards (* and ?) accepted
 -L,--loc          Location ID, list and wildcards (* and ?) accepted
 -C,--chan         Channel codes, list and wildcards (* and ?) accepted
 -Q,--qual         Quality indicator, default is best
 -s starttime      Specify start time (YYYY-MM-DD,HH:MM:SS.ssssss)
 -e endtime        Specify end time (YYYY-MM-DD,HH:MM:SS.ssssss)
 --lat min:max     Specify a minimum and/or maximum latitude range
 --lon min:max     Specify a minimum and/or maximum longitude range
 --radius lat:lon:maxradius[:minradius]
                     Specify circular region with optional minimum radius
 -l listfile       Read list of selections from file
 -b bfastfile      Read list of selections from BREQ_FAST file
 -msl length       Limit returned data to a minimum segment length
 -lso              Limit returned data to the longest segment only
 -A appname        Application/version string for identification
 -a user:pass      User and password for access to restricted data

 -o outfile        Fetch time series data and write to output file
 -sd sacpzdir      Fetch SAC P&amp;amp;Zs and write files to sacpzdir
 -rd respdir       Fetch RESP and write files to respdir
 -m metafile       Write basic metadata to specified file
&lt;/pre&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;p&gt;获取2011年第一个小时GSN所有台站的BHZ分量的数据&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ FetchData -N _GSN -C BHZ -s 2011-01-01T00:00:00 -e 2011-01-01T01:00:00 -o GSN.mseed -m GSN.metadata
&lt;/pre&gt;
&lt;p&gt;下载得到的数据为miniSEED格式，因而需要用mseed2sac进行格式转换。&lt;/p&gt;
&lt;p&gt;说明：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;台网、台站等支持通配符；&lt;/li&gt;
&lt;li&gt;可以通过—lat和—lon划定矩形区域或通过—radius划定圆形区域来指定台站；&lt;/li&gt;
&lt;li&gt;可以直接从特定格式的文件中读取要下载的波形信息；&lt;/li&gt;
&lt;li&gt;可以下载相关SAC PZ文件或/和RESP文件；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="fetchevent"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;FetchEvent&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;功能：获得满足一定条件的所有事件信息&lt;/p&gt;
&lt;p&gt;用法：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
FetchEvent: collect event information (2013.198)
http://service.iris.edu/clients/

Usage: FetchEvent [options]

 Options:
 -v                More verbosity, may be specified multiple times (-vv, -vvv)

 -s starttime      Limit to origins after time (YYYY-MM-DD,HH:MM:SS.sss)
 -e endtime        Limit to origins before time (YYYY-MM-DD,HH:MM:SS.sss)
 --lat min:max     Specify a minimum and/or maximum latitude range
 --lon min:max     Specify a minimum and/or maximum longitude range
 --radius lat:lon:maxradius[:minradius]
                     Specify circular region with optional minimum radius
 --depth min:max   Specify a minimum and/or maximum depth in kilometers
 --mag min:max     Specify a minimum and/or maximum magnitude
 --magtype type    Specify a magnitude type for magnitude range limits
 --cat name        Limit to origins from specific catalog (e.g. ISC, PDE, GCMT)
 --con name        Limit to origins from specific contributor (e.g. ISC, NEIC)
 --ua date         Limit to origins updated after date (YYYY-MM-DD,HH:MM:SS)

 --allorigins      Return all origins, default is only primary origin per event
 --allmags         Return all magnitudes, default is only primary magnitude per event
 --orderbymag      Order results by magnitude instead of time

 --evid id         Select a specific event by DMC event ID
 --orid id         Select a specific event by DMC origin ID

 -X xmlfile        Write raw returned XML to xmlfile
 -A appname        Application/version string for identification

 -o outfile        Write event information to specified file, default: console
&lt;/pre&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ FetchEvent -s 2011-03-11 --radius 38.2:142.3:20 --mag 6
&lt;/pre&gt;
&lt;p&gt;说明：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;这个脚本功能齐全，值得一用&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="fetchmetadata"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;FetchMetadata&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;功能：获取台站元数据&lt;/p&gt;
&lt;p&gt;用法：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
FetchMetadata: collect channel metadata (2013.198)
http://service.iris.edu/clients/

Usage: FetchMetadata [options]

 Options:
 -v                Increase verbosity, may be specified multiple times
 -N,--net          Network code, list and wildcards (* and ?) accepted
 -S,--sta          Station code, list and wildcards (* and ?) accepted
 -L,--loc          Location ID, list and wildcards (* and ?) accepted
 -C,--chan         Channel codes, list and wildcards (* and ?) accepted
 -s starttime      Specify start time (YYYY-MM-DD,HH:MM:SS)
 -e endtime        Specify end time (YYYY-MM-DD,HH:MM:SS)
 -ua date          Limit to metadata updated after date (YYYY-MM-DD,HH:MM:SS)
 -X xmlfile        Write raw returned FDSN StationXML to xmlfile
 -l listfile       Read list of selections from file
 -b bfastfile      Read list of selections from BREQ_FAST file
 -sta              Print station level information, default is channel
 -resp             Request response level information, no details printed
 -A appname        Application/version string for identification

 -o outfile        Write basic metadata to specified file instead of printing
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;其他&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;整个脚本还有一些其他功能，具体参考 &lt;a class="reference external" href="https://seiscode.iris.washington.edu/projects/ws-fetch-scripts/wiki/Running_the_scripts_and_examples"&gt;https://seiscode.iris.washington.edu/projects/ws-fetch-scripts/wiki/Running_the_scripts_and_examples&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</summary><category term="IRIS"></category><category term="数据"></category><category term="Perl"></category></entry><entry><title>SAC不同格式间的转换</title><link href="http://seisman.info/conversion-of-different-sac-formats.html" rel="alternate"></link><updated>2013-08-04T01:11:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:conversion-of-different-sac-formats.html</id><summary type="html">
&lt;p&gt;SAC文件格式包括二进制格式和ASCII格式，平常接触的都是二进制格式的，毕竟二进制格式相对于ASCII格式有很多优点，比如读写速度更快、文件大小更小。下面讨论SAC的两种格式以及另外一种常见的数据格式(自变量+因变量两列数据)之间的转换。&lt;/p&gt;
&lt;div class="section" id="ascii"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;二进制转ASCII&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; r sacfile
SAC&amp;gt; w alpha sacfile.ascii
&lt;/pre&gt;
&lt;p&gt;有时数据遇到问题的时候，可以转换成ASCII格式，看看里面的内容。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;ASCII转二进制&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; r alpha sacfile.ascii
SAC&amp;gt; w sacfile
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;单列数据转二进制&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;数据文件中只含一列数据，包含了因变量的信息。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; readtable data1
SAC&amp;gt; w sacfile
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;两列数据转二进制&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;数据文件中含两列数据，包含了自变量和因变量的信息。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; readalpha content xy data2
SAC&amp;gt; w sacfile
&lt;/pre&gt;
&lt;p&gt;非时间序列数据（任意的xy数据）都可以用SAC来处理以实现相应的功能，这也就是SAC自称其为“一个用于处理连续信号尤其是时间序列数据的通用交互式程序”的原因。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;二进制转时间序列&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;没法用命令直接做到，比较合适的做法是写一个C或FORTRAN调用读取SAC文件，然后以数组形式写入文件。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="格式转换"></category></entry><entry><title>地震数据申请</title><link href="http://seisman.info/iris-data-request.html" rel="alternate"></link><updated>2013-08-04T00:28:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-04:iris-data-request.html</id><summary type="html">
&lt;p&gt;地震数据的最主要来源是IRIS。从IRIS申请并获取数据的方式有很多，比如Wilber &lt;span class="caps"&gt;III&lt;/span&gt;、BREQ_FAST、&lt;span class="caps"&gt;SOD&lt;/span&gt;、irisFetch、SUDS等等，如何选择合适的数据申请方式是个不好回答的问题。坚持固守某种申请方法也没什么问题，数据还是可以申请到，不过，也许换一种方式会节省更多的时间和精力。&lt;/p&gt;
&lt;p&gt;数据的获取大概分为如下几个阶段：&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;选择地震事件&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;选择地震事件之前首先要有的是地震目录，比如Global &lt;span class="caps"&gt;CMT&lt;/span&gt;，或者USGS &lt;span class="caps"&gt;PDE&lt;/span&gt;。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;选取某个特定地震；&lt;/li&gt;
&lt;li&gt;根据研究的需要，指定区域范围、震级范围、时间范围、深度范围等信息，得到符合条件的一个或多个地震；如果是先选定台站，也可限定地震与台站的震中距范围；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;选择台网或/和台站&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;选取某个台网（可以是虚拟台网）内的所有台站；&lt;/li&gt;
&lt;li&gt;根据地震位置选取距地震一定震中距的台站；&lt;/li&gt;
&lt;li&gt;对台站的方位角分布进行限制（0-360）；&lt;/li&gt;
&lt;li&gt;选择合适的通道，比如宽频带(B)还是长周期(L)；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;限定波形信息&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;限制需要申请的波形数据的起始时刻以及结束时刻或波形长度；&lt;ul&gt;
&lt;li&gt;将发震时刻作为波形起始时刻；&lt;/li&gt;
&lt;li&gt;计算P波到时，并将其前1分钟作为起始时刻；&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;选择数据格式，比如seed还是SAC&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;数据下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;数据获取的过程大概就分为上面4个阶段，各种申请工具的目的在于减少上面四个过程中繁琐程度。&lt;/p&gt;
&lt;/div&gt;
</summary><category term="数据申请"></category><category term="IRIS"></category></entry><entry><title>SAC文件修改事件经纬度后震中距的自动计算</title><link href="http://seisman.info/calculate-gcarc-after-adding-event-location.html" rel="alternate"></link><updated>2013-08-03T16:58:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-08-03:calculate-gcarc-after-adding-event-location.html</id><summary type="html">&lt;p&gt;地震目录中包含震中的经度、纬度、深度等信息，有些时候下载的数据中没有这些事件信息，就需要自己手动添加进去。&lt;/p&gt;
&lt;p&gt;很基础的操作:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC &amp;gt; r *.BH*
SAC &amp;gt; ch evla 30.5 evlo 120.5 evdp 5.0
SAC &amp;gt; wh
SAC &amp;gt; q
&lt;/pre&gt;
&lt;p&gt;修改了地震经纬度及深度信息之后，一般来说，震中距dist、gcarc以及方位角az、baz也会随着一起改变。但是，有些时候这些量却没有随着事件位置的变化而变化，这是为什么呢？&lt;/p&gt;
&lt;p&gt;在SAC的头段中有一个逻辑型变量LCALDA（L代表logical型变量，CAL代表calculate，D代表dist以及gcarc，a代表az以及gaz）。这个逻辑型变量决定了gcarc等参数是否会随着震源或台站的位置的改变而改变。LCALDA为TURE则会随着改变，为FALSE则不会改变。&lt;/p&gt;
&lt;p&gt;下面用一些测试来深入了解一下：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SAC&amp;gt; fg seis
SAC&amp;gt; lh dist gcarc az baz                     #看看原始文件的震中距和方位角

  FILE: SEISMOGR - 1
 --------------

      dist = 3.730627e+02
     gcarc = 3.357465e+00
        az = 8.814721e+01
       baz = 2.718528e+02

SAC&amp;gt; lh evla evlo evdp lcalda                 #看看事件位置信息和LCALDA变量

  FILE: SEISMOGR - 1
 --------------

       evla = 4.800000e+01
       evlo = -1.250000e+02
       evdp = 1.500000e+01
     lcalda = TRUE
SAC&amp;gt; ch evla 55                               #修改事件位置
SAC&amp;gt; lh dist gcarc az baz                     #震中距方位角马上就变了

  FILE: SEISMOGR - 1
 --------------

      dist = 8.521611e+02
     gcarc = 7.670734e+00
        az = 1.539900e+02
       baz = 3.379012e+02
SAC&amp;gt; ch lcalda false                         #修改lcalda为false
SAC&amp;gt; ch evla 60
SAC&amp;gt; lh dist gcarc az baz                    #震中距方位角没有变化

  FILE: SEISMOGR - 1
 --------------

      dist = 8.521611e+02
     gcarc = 7.670734e+00
        az = 1.539900e+02
       baz = 3.379012e+02
SAC&amp;gt; ch lcalda true                          #再次把lcalda修改为true
SAC&amp;gt; lh dist gcarc az baz                    #震中距信息马上就修改了。
                                             #这意味着在修改lcalda为真时
                                             #SAC会自动检查某些变量值

  FILE: SEISMOGR - 1
 --------------

      dist = 1.374330e+03
     gcarc = 1.237276e+01
        az = 1.641464e+02
       baz = 3.482054e+02
&lt;/pre&gt;
</summary><category term="SAC技巧"></category><category term="震中距"></category></entry><entry><title>Perl的单引号字符直接量</title><link href="http://seisman.info/single-quoted-string-literals-in-perl.html" rel="alternate"></link><updated>2013-07-30T14:57:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-30:single-quoted-string-literals-in-perl.html</id><summary type="html">&lt;p&gt;Perl的字符串直接量分为两种：单引号内的和双引号内的。单引号与双引号最大的区别在于单引号限制了转义字符的功能，但是又存在一些例外。&lt;/p&gt;
&lt;p&gt;比如字符串fred用单引号字符串直接量表示为&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'fred'
&lt;/pre&gt;
&lt;p&gt;也可以用单引号直接量表示一个空字符串&lt;/p&gt;
&lt;pre class="literal-block"&gt;
''
&lt;/pre&gt;
&lt;p&gt;单引号作为字符串的分界符，其具有特别的含义，但有些字符串中需要它，比如&lt;tt class="docutils literal"&gt;Don't be late&lt;/tt&gt;.如果表示为&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'Don't be late.'
&lt;/pre&gt;
&lt;p&gt;就错了，Perl会将第一个和第二个单引号作为分界符，Don后面的字符都被忽略了。这个时候就需要用反斜杠去转义单引号：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'Don\'t late.'
&lt;/pre&gt;
&lt;p&gt;转义单引号会带来另外一个问题，比如字符串ABC\，表达成单引号字符串直接量为&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'ABC\'
&lt;/pre&gt;
&lt;p&gt;根据前面所说，这样写的话，第二个单引号会被反斜杠转义，因而这个单引号直接量没有结束标识。为了解决这个问题，应该让反斜杠转义反斜杠&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'ABC\\'
&lt;/pre&gt;
&lt;p&gt;由此，在单引号内反斜杠可以转义的字符只有单引号以及反斜杠。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'Hello\n'
&lt;/pre&gt;
&lt;p&gt;将表示长度为7的字符串&lt;tt class="docutils literal"&gt;Hello\n&lt;/tt&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'\'\\'
&lt;/pre&gt;
&lt;p&gt;将表示长度为2的字符串&lt;tt class="docutils literal"&gt;'\&lt;/tt&gt;&lt;/p&gt;
</summary><category term="Perl"></category></entry><entry><title>Perl发送邮件到BREQ_FAST</title><link href="http://seisman.info/send-email-in-perl.html" rel="alternate"></link><updated>2013-07-26T21:15:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-26:send-email-in-perl.html</id><summary type="html">
&lt;p&gt;BREQ_FAST的优势在于可脚本化生成数据申请文件，要真正申请数据还得将这些文件作为邮件内容发送过去，因而想要解放双手，利用脚本自动发送邮件是必须的。&lt;/p&gt;
&lt;p&gt;本文给出如何用Perl发送邮件到BREQ_FAST，另一篇博文《Python发送邮件到BREQ_FAST》给出了同样功能的Python脚本。相比而言，Python版本更简单、简洁。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;脚本&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下面的Perl脚本利用Net::SMTP模块实现了邮件的脚本发送：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/perl -w&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Perl Script to send emails to IRIS&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Author:  SeisMan @ seisman.info&lt;/span&gt;
&lt;span class="c1"&gt;#  Date:    2013/07/22&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Net::&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;MIME::&lt;/span&gt;&lt;span class="n"&gt;Base64&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nv"&gt;@ARGV&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;die&lt;/span&gt; &lt;span class="s"&gt;"  Usage: perl $0 mailfiles \n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'smtp.163.com'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;          &lt;span class="c1"&gt;# host domain&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$sender&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'xxxxxx@163.com'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;                  &lt;span class="c1"&gt;# my email&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$passwd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"xxxxxxxx"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;            &lt;span class="c1"&gt;# password&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$recipient&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;'breq_fast@iris.washington.edu'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;# BREQ_FAST email&lt;/span&gt;

&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;@ARGV&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$smtp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nn"&gt;Net::&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;Host&lt;/span&gt;    &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="nv"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Timeout&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;Debug&lt;/span&gt;   &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;# Log in&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'AUTH LOGIN'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$userpass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;encode_base64&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$sender&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;  &lt;span class="nb"&gt;chomp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$userpass&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$userpass&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="nv"&gt;$userpass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;encode_base64&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$passwd&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="nb"&gt;chomp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$userpass&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$userpass&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="c1"&gt;# send mail&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;"Sending mailfile $_\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$sender&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$recipient&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;datasend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"To:$recipient \n"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;datasend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"\n"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"&amp;lt; $_"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;die&lt;/span&gt; &lt;span class="s"&gt;"Error in opening $_\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;datasend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;&amp;lt;IN&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IN&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;dataend&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="nv"&gt;$smtp&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;#   unlink "$_";&lt;/span&gt;

    &lt;span class="nb"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;其中MIME::Base64模块对邮件内容进行编码，$host为邮件服务器的ip或者域名，$sender为邮箱，$passwd为明文密码。&lt;/p&gt;
&lt;p&gt;脚本首先向邮件服务器申请身份验证，然后分别读取每个mailfile中的内容作为邮件正文发送到$recipient。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;功能及限制&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;支持一次性发送多封邮件（一次登录可以发送的邮件数是有限制的，所以采取多次登录的方式；频繁发送邮件可能会导致ip被封，因而每封邮件之间等待10s）；&lt;/li&gt;
&lt;li&gt;密码明文存储，不太安全；&lt;/li&gt;
&lt;li&gt;没有判断身份验证失败的情况；&lt;/li&gt;
&lt;li&gt;可以通过Debug=&amp;gt;1的方式获取调试信息以确定身份验证是否成功，但调试信息过多；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;perl发送邮件真正可用版本：&lt;a class="reference external" href="http://blog.sina.com.cn/s/blog_541a3cf10100ji64.html"&gt;http://blog.sina.com.cn/s/blog_541a3cf10100ji64.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;CPAN&lt;/span&gt; Net::&lt;span class="caps"&gt;SMTP&lt;/span&gt;：http://search.cpan.org/=gbarr/libnet-1.22/Net/&lt;span class="caps"&gt;SMTP&lt;/span&gt;.pm&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-07-26：初稿；&lt;/li&gt;
&lt;li&gt;2013-11-22：修正了脚本复制过程中的一个bug。Thanks to cxh757.&lt;/li&gt;
&lt;li&gt;2014-01-13：注释&lt;tt class="docutils literal"&gt;unlink &lt;span class="pre"&gt;"$\_";&lt;/span&gt;&lt;/tt&gt;，该句会在脚本执行完毕后删除邮件，由于脚本未做邮件发送是否成功的检测，贸然删除邮件对于用户不够友好。&lt;/li&gt;
&lt;li&gt;2014-08-24：加入了Python版本的链接。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="breq_fast"></category><category term="邮件"></category><category term="Perl"></category></entry><entry><title>BREQ_FAST脚本实现</title><link href="http://seisman.info/breqfast-script.html" rel="alternate"></link><updated>2013-07-26T14:56:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-26:breqfast-script.html</id><summary type="html">
&lt;div class="section" id="perl"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Perl代码&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#!/usr/bin/perl -w&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Perl script to generate mail content for BREQ_FAST&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#  Author:  SeisMan @ seisman.info&lt;/span&gt;
&lt;span class="c1"&gt;#  Date:    2013/07/22&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;Time::&lt;/span&gt;&lt;span class="n"&gt;Local&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nv"&gt;@ARGV&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;die&lt;/span&gt; &lt;span class="s"&gt;"Usage: perl $0 Event(e.g.,2008_05_12_06_28_02) Mailfile\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;##  Private Information Here&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$NAME&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'FirstName LastName'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$INST&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'University of XXXX'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$MAIL&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'Dept. of Geophysics,xxxxxx'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$EMAIL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'xxx@xxx.xxx'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$PHONE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'86-xxxxxxxxxx'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$FAX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"xxx-xxx-xxxx"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;##  Other Information&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$MEDIA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"FTP"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$ALTERNATEMEDIA&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"exabyte"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$STATIONS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"US_TA.list"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$timespan&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3600&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;# time window of one hour&lt;/span&gt;

&lt;span class="c1"&gt;##  DO NOT MODIFY BELOW&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'_'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nv"&gt;$ARGV&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="nv"&gt;$sec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"00"&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nb"&gt;defined&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$sec&lt;/span&gt; &lt;span class="p"&gt;));&lt;/span&gt;   &lt;span class="c1"&gt;# second=00&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$mailfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$ARGV&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="nb"&gt;unlink&lt;/span&gt; &lt;span class="nv"&gt;$mailfile&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="nv"&gt;$mailfile&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$LABEL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"${year}_${month}_${day}_${hour}_${min}_${sec}"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$begintime&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"$year $month $day $hour $min $sec.0"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nv"&gt;$month&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;timegm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$sec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$month&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nv"&gt;$time&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nv"&gt;$timespan&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$sec1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$year1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$wday1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$yday1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$isdast1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;gmtime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$time&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nv"&gt;$year1&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1900&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;$mon1&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$endtime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;sprintf&lt;/span&gt; &lt;span class="s"&gt;"%4d %02d %02d %02d %02d %02d.0"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$year1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$mon1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$day1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$hour1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$min1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$sec1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;OUT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"&amp;gt;$mailfile"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".NAME $NAME\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".INST $INST\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".MAIL $MAIL\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".EMAIL $EMAIL\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".PHONE $PHONE\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".FAX $FAX\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".MEDIA $MEDIA\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".ALTERNATE MEDIA 1/2\" tape - 6250\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".ALTERNATE MEDIA $ALTERNATEMEDIA\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".LABEL $LABEL\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".QUALITY B\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;".END\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;"\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"&amp;lt; $STATIONS"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;foreach&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;&amp;lt;IN&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
   &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;@c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;split&lt;/span&gt; &lt;span class="s"&gt;","&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$begin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$junk1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$junk2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;split&lt;/span&gt; &lt;span class="s"&gt;"/"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="c1"&gt;# start time of station&lt;/span&gt;
   &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$end&lt;/span&gt;  &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$junk3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$junk4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;split&lt;/span&gt; &lt;span class="s"&gt;"/"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;$c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="c1"&gt;# start time of station&lt;/span&gt;
   &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$sta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
   &lt;span class="k"&gt;my&lt;/span&gt; &lt;span class="nv"&gt;$net&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
   &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="nv"&gt;$begin&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="nv"&gt;$year&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="nv"&gt;$end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
       &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;OUT&lt;/span&gt; &lt;span class="s"&gt;"$sta $net $begintime $endtime 1 BH?\n"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IN&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nb"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;OUT&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;首先要根据个人情况修改个人信息；&lt;/li&gt;
&lt;li&gt;其他信息中，&lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;STATIONS&lt;/span&gt;&lt;/tt&gt;为台站列表文件，&lt;tt class="docutils literal"&gt;$timespan&lt;/tt&gt;为要申请的数据长度，即从发震时刻到发震后的&lt;tt class="docutils literal"&gt;$timespan&lt;/tt&gt;秒（更常用的是从P波前几秒开始申请，这里没实现）&lt;/li&gt;
&lt;li&gt;$STATIONS文件为台站列表文件，US_TA.list来自于 &lt;a class="reference external" href="http://www.iris.edu/vnets?vnet=_US-TA"&gt;http://www.iris.edu/vnets?vnet=_US-&lt;span class="caps"&gt;TA&lt;/span&gt;&lt;/a&gt; ，取CSV格式；（需要将CSV文件的前几行删除，只留下与台站有关的行）&lt;/li&gt;
&lt;li&gt;程序中判断了发震时刻是否在台站的有效期内，这样的判断可以减小文件内容；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-07-26：原始版本；&lt;/li&gt;
&lt;li&gt;2013-08-02：CSV格式要稍做编辑才可使用；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="breq_fast"></category><category term="Perl"></category><category term="数据申请"></category></entry><entry><title>IRIS数据申请之BREQ_FAST</title><link href="http://seisman.info/iris-breq-fast.html" rel="alternate"></link><updated>2013-07-23T01:40:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-23:iris-breq-fast.html</id><summary type="html">
&lt;p&gt;IRIS提供了很多申请地震数据的软件或方法，比如Wilber &lt;span class="caps"&gt;III&lt;/span&gt;、&lt;span class="caps"&gt;SOD&lt;/span&gt;、JWeed等等。&lt;/p&gt;
&lt;p&gt;BREQ_FAST是众多方法中的一个，喜欢它的人爱得死去活来，不喜欢它的人对它不屑一顾。其实每种方法都有自己的优点和缺点，每种方法都有自己擅长和不擅长的领域。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;BREQ_FAST是Batch REQuests FAST的简称。简单来说，就是通过发送一封邮件到指定的邮箱来申请数据，邮件的内容要按照规定的格式来写。这种数据申请的方法不同于常见的交互式方法，因而特别适合写脚本自动生成邮件内容、自动发送邮件、自动下载数据。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;优点&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;简单易用，写一次脚本基本就一劳永逸了&lt;/li&gt;
&lt;li&gt;速度快，不受网速限制&lt;/li&gt;
&lt;li&gt;从申请到下载可以完全脚本化，适合数据批量申请&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;缺点&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;需要自己准备事件信息（即地震目录）以及台站列表；&lt;/li&gt;
&lt;li&gt;非交互式，不像其他方法那样可以在线获得事件信息，根据事件选择符合一定条件的台站；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;邮件内容格式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;BREQ_FAST只对邮件内容有严格要求，不要求邮件主题。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
.NAME
.INST
.MAIL
.EMAIL
.PHONE
.FAX
.MEDIA:
.ALTERNATE MEDIA:
.ALTERNATE MEDIA:
.LABEL
.SOURCE     ---
.HYPO         | optional
.MAGNITUDE  ---
.QUALITY
.END
 request line-1
 request line-2
 ...
 ...
 ...
 request line-n
&lt;/pre&gt;
&lt;p&gt;要保证所有以“.”开头的标记行左对齐！！！&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;.Name：用户姓名，IRIS会根据此标记在ftp上建立相关文件夹；&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;INST&lt;/span&gt;：单位或者机构信息（应该没啥用）；&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;MAIL&lt;/span&gt;：邮寄地址；（不会寄东西的）&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;EMAIL&lt;/span&gt;：邮箱。IRIS会向这个邮箱发送有关数据状态的邮件，可以与发送该邮件的邮箱地址不同；&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;PHONE&lt;/span&gt;：电话；（没用）&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;FAX&lt;/span&gt;：传真；（没用）&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;MEDIA&lt;/span&gt;：数据获取介质。有如下几种方式可以选择（按照倾向性排序），现在常用的方式是FTP，要求指定第一、第二、第三介质；&lt;ul&gt;
&lt;li&gt;Electronic (&lt;span class="caps"&gt;FTP&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;EXABYTE&lt;/span&gt; – 2 gigabyte&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;EXABYTE&lt;/span&gt; – 5 gigabyte&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;DAT&lt;/span&gt; (digital audio tape)&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;DLT&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;DVD&lt;/span&gt;-R&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;LABEL&lt;/span&gt;：申请的SEED数据将会以该LABEL命名，SEED文件内部也会包含这个LABEL的信息，应该选择合适的LABEL以保证文件名的唯一性和可区分性；（以发震时刻命名是个不错的选择）&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;SOURCE&lt;/span&gt;、.HYPO和.MAGNITUDE是可选的，其指定了震源的一些信息，这些信息最终会被写入SEED文件中；若未指定这三个标记，SEED解压出的SAC文件时没有震源信息的；若指定了这三个标记，解压出来的SAC文件时有震源信息的（只是猜测，没试过）。这几行写起来有些复杂，不要也罢，震源信息可以后期再写入。这三个标记的详细信息可以参考最后给出的链接。&lt;/li&gt;
&lt;li&gt;.&lt;span class="caps"&gt;QUALITY&lt;/span&gt;：数据质量；一般默认B；&lt;ul&gt;
&lt;li&gt;B：最好的数据（首选Q，没有Q则选择D，没有D则选择R）&lt;/li&gt;
&lt;li&gt;E：所有数据（Q &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; D &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; R）&lt;/li&gt;
&lt;li&gt;Q：标记了QC的数据（即进行了质量控制）&lt;/li&gt;
&lt;li&gt;D：中等质量数据；&lt;/li&gt;
&lt;li&gt;R：最原始数据；&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;request line是真正的数据申请信息，前面的那些都只是辅助信息；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="request-line"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;Request Line格式&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="literal-block"&gt;
STA NN YYYY MM DD HH MM SS.TTTT YYYY MM DD HH MM SS.TTTT #_CH CH1 CH2 CHn LI
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="caps"&gt;STA&lt;/span&gt;：台站名&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;NN&lt;/span&gt;：台网或虚拟台网名&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;YYYY&lt;/span&gt;、&lt;span class="caps"&gt;MM&lt;/span&gt;、&lt;span class="caps"&gt;DD&lt;/span&gt;、&lt;span class="caps"&gt;HH&lt;/span&gt;、&lt;span class="caps"&gt;MM&lt;/span&gt;：年份（四位）、月、日、时、分&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;SS&lt;/span&gt;.&lt;span class="caps"&gt;TTTT&lt;/span&gt;：秒；小数点后为毫秒，可以省略；&lt;/li&gt;
&lt;li&gt;日期和时间出现了两次，分别代表要申请的数据的开始时间和结束时间；&lt;/li&gt;
&lt;li&gt;#_CH：接下来出现的通道标识的数目；&lt;/li&gt;
&lt;li&gt;CHn：通道标识符，可以包含通配符；&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;LI&lt;/span&gt;：位置号，可选&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;每行最多包含100个字符。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;通配符&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;通道标识符支持通配符，目前仅支持通配符"?"，代表任意单个字符，比如"&lt;span class="caps"&gt;BH&lt;/span&gt;?"代表所有宽频带（Broadband）高增益（High gain）的通道，可能包含BHE、&lt;span class="caps"&gt;BHN&lt;/span&gt;、&lt;span class="caps"&gt;BHZ&lt;/span&gt;、&lt;span class="caps"&gt;BH1&lt;/span&gt;、BH2等等；通道列表可以包含多个字段，比如 &lt;tt class="docutils literal"&gt;3 &lt;span class="caps"&gt;LHZ&lt;/span&gt; &lt;span class="caps"&gt;BH&lt;/span&gt;? &lt;span class="pre"&gt;S??&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;一般通道名长度为三个字符，第一个字符为Band Code，第二个字符为Source Code，第三个字符为Orientation Code。&lt;/p&gt;
&lt;p&gt;台网和台站也可使用通配符，但是不建议台网和台站同时使用通配符；单个"?"可以匹配该台网的所有台站。&lt;/p&gt;
&lt;p&gt;如果不指定位置号，则获取该台站的全部location的数据。&lt;/p&gt;
&lt;p&gt;对于每个台站可以分别指定数据窗范围，因而可以根据到时信息确定需要的数据窗，最大程度减少数据量。不过长一点也无所谓。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;例子&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;给出了SOURCE、&lt;span class="caps"&gt;HYPO&lt;/span&gt;、MAGNITUDE的例子，request line给出了尽可能多的写法：&lt;/p&gt;
&lt;pre class="literal-block"&gt;
.NAME Joe Seismologist
.INST Podunk University
.MAIL 101 Fast Lane, Middletown, KS  89432
.EMAIL joe@podunk.edu
.PHONE 555 555-1212
.FAX   555 555-1213
.MEDIA FTP
.ALTERNATE MEDIA 1/2" tape - 6250
.ALTERNATE MEDIA EXABYTE
.LABEL Joe's FIRST Request
.SOURCE =NEIC PDE=Jan 1990 PDE=National Earthquake Information Center - USGS DOI=
.HYPO =1999 01 02 20 21 32.62= 13.408= 144.439=135.0=18=216=Mariana Islands=
.MAGNITUDE =5.7=mb=
.QUALITY B
.END
GRFO IU 1999 01 02 00 18 10.4 1999 01 02 00 20 10.4  1 SHZ
ANTO IU 1999 01 02 02 10 36.6 1999 01 02 02 12 36.6  1 SH?
AFI  IU 1999 01 02 02 10 37.1 1999 01 02 02 12 37.1  1 BH? 00
SEE  CD 1999 01 02 14 45 08.9 1999 01 02 14 47 08.9  1 SHZ
CASY IU 1999 01 04 02 42 13.4 1999 01 04 02 44 13.4  1 BHZ 10
NNA  II 1999 01 04 02 41 57.5 1999 01 04 02 43 57.5  1 BHZ
PFO  TS 1999 01 04 02 41 57.5 1999 01 04 02 43 57.5  1 BHZ
PFO  II 1999 01 04 02 41 57.5 1999 01 04 02 43 57.5  1 BHZ
KMI  CD 1999 01 04 02 41 57.5 1999 01 04 02 43 57.5  1 BHZ
SSE  CD 1999 01 04 02 18 25.4 1999 01 04 02 20 25.4  2 B?? SHZ
PAS  TS 1999  1  4  2 10 49   1999  1  4  2 12 49    3 BH? SHZ L??
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;发送邮件到这里&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;根据上面的规则生成了邮件内容，直接将内容作为邮件正文（不是附件）发送到指定邮箱，不同的邮箱功能不同；&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="mailto:breq_fast@iris.washington.edu"&gt;breq_fast@iris.washington.edu&lt;/a&gt;：申请完整的SEED文件，最常用的方式；&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="mailto:DATALESS@iris.washington.edu"&gt;&lt;span class="caps"&gt;DATALESS&lt;/span&gt;@iris.washington.edu&lt;/a&gt;：无数据的SEED文件，包含仪器响应、仪器坐标等台站信息，一般与miniSEED数据联合使用；&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="mailto:miniseed@iris.washington.edu"&gt;miniseed@iris.washington.edu&lt;/a&gt;：miniSEED数据，只有数据没有台站信息；&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="mailto:sync@iris.washington.edu"&gt;sync@iris.washington.edu&lt;/a&gt;：合成数据&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;申请回应&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;IRIS在收到申请邮件后会检查格式，通过邮件方式通知发件人邮件内容是否正确、是否被接收；待数据准备完毕后，发送邮件，给出FTP地址供用户下载。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bug"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;Bug和限制&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;无法识别超过正常范围的时间，比如分钟数大于59，这要求用户自己认真处理时间问题；&lt;/li&gt;
&lt;li&gt;每行必须左对齐；&lt;/li&gt;
&lt;li&gt;通配符只支持"?"&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;BREQ_FAST Manaul：&lt;a class="reference external" href="http://www.iris.edu/dms/nodes/dmc/manuals/breq_fast/"&gt;http://www.iris.edu/dms/nodes/dmc/manuals/breq_fast/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;SEED通道命名规则：&lt;a class="reference external" href="http://www.iris.edu/manuals/SEED_appA.htm"&gt;http://www.iris.edu/manuals/SEED_appA.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Location ID命名规则：&lt;a class="reference external" href="http://www.iris.edu/dms/newsletter/vol1/no1/specification-of-seismograms-the-location-identifier/"&gt;http://www.iris.edu/dms/newsletter/vol1/no1/specification-of-seismograms-the-location-identifier/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="breq_fast"></category><category term="IRIS"></category><category term="数据申请"></category></entry><entry><title>JPlotResp：绘制地震仪器响应</title><link href="http://seisman.info/jplotresp.html" rel="alternate"></link><updated>2013-07-19T14:13:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-19:jplotresp.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;前言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;要理解仪器响应，就要看RESP的格式，更重要是直观地看仪器响应的振幅相位谱。&lt;/p&gt;
&lt;p&gt;前面介绍的&lt;a class="reference external" href="http://seisman.info/simple-analysis-of-resp.html"&gt;Resp文件&lt;/a&gt;和&lt;a class="reference external" href="http://seisman.info/simple-analysis-of-sac-pz.html"&gt;&lt;span class="caps"&gt;SAC&lt;/span&gt; &lt;span class="caps"&gt;PZ&lt;/span&gt;&lt;/a&gt;文件都只是给出了一堆零极点以及放大系数等各种参数。JPlotResp是用来绘制地震仪器响应的软件，可以帮助直观地看到任意台站的仪器响应。&lt;/p&gt;
&lt;p&gt;主页：&lt;a class="reference external" href="http://www.isti2.com/JPlotResp/"&gt;http://www.isti2.com/JPlotResp/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Java语言&lt;/li&gt;
&lt;li&gt;底层由JEvalResp计算仪器响应&lt;/li&gt;
&lt;li&gt;JEvalResp是evalresp的Java版本&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;功能&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;支持在线查询，指定台网、台站以及时间即可；&lt;/li&gt;
&lt;li&gt;直接绘制本地Resp文件；&lt;/li&gt;
&lt;li&gt;支持多种仪器响应：速度、加速度、位移；&lt;/li&gt;
&lt;li&gt;绘制振幅相位谱、复数谱；&lt;/li&gt;
&lt;li&gt;指数坐标或者线性坐标；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;截图&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;启动界面：&lt;/p&gt;
&lt;p&gt;比较实用的是读取本地文件，然后Plot。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="软件界面" src="/images/2013071901.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;读取本地Resp文件：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="读取RESP文件" src="/images/2013071902.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;p&gt;绘制的振幅响应谱：&lt;/p&gt;
&lt;p&gt;Display可以选择显示仪器响应的哪些部分以获得更清晰或者更多的信息，还可以将图直接保存为高质量的jpg文件。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="振幅响应谱" src="/images/2013071903.jpg" style="width: 600px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="Java"></category><category term="仪器响应"></category></entry><entry><title>由矩张量计算双力偶断层参数</title><link href="http://seisman.info/from-moment-tensor-to-double-couple.html" rel="alternate"></link><updated>2013-07-16T17:01:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-16:from-moment-tensor-to-double-couple.html</id><summary type="html">&lt;p&gt;Double Couple由四个参数描述：Strike、Dip、Rake、Moment；Moment&amp;nbsp;Tensor由9个量描述，由于对称性，减少到六个。&lt;/p&gt;
&lt;p&gt;任意一个double couple都可以写成moment tensor的形式，但并非所有的moment tensor都可以写成double couple形式。double couple只是moment&amp;nbsp;tensor的一个子集而已。&lt;/p&gt;
&lt;p&gt;若干月前，有人问到如何将moment tensor转换成double&amp;nbsp;couple，搜了一下，发现了一个别人写的代码。做了一下排版，试了一个例子，结果是对的，没有再看细节。&lt;/p&gt;
&lt;p&gt;代码分为三个部分：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ten2axe：将moment&amp;nbsp;tensor转换成主轴坐标系；&lt;/li&gt;
&lt;li&gt;axe2dc：将主轴坐标系下的结果转换为double&amp;nbsp;couple解；&lt;/li&gt;
&lt;li&gt;ten2dc.pl：我写的perl脚本，实现两个程序的衔接（作者给的是shell脚本）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;原文链接： &lt;a class="reference external" href="http://www.fcaglp.unlp.edu.ar/~esuarez/gmt/1998/0102.html"&gt;http://www.fcaglp.unlp.edu.ar/~esuarez/gmt/1998/0102.html&lt;/a&gt;&amp;nbsp;（死链）&lt;/p&gt;
&lt;p&gt;代码下载： &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/ten2dc.tar.gz"&gt;http://seisman.qiniudn.com/downloads/ten2dc.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;：没看过代码，不确定原理，不确定正确性。&lt;/p&gt;
</summary><category term="震源机制解"></category><category term="断层"></category></entry><entry><title>GMT进阶之理解-J和-R的共生关系</title><link href="http://seisman.info/gmt-option-j-and-r.html" rel="alternate"></link><updated>2013-07-15T01:35:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-15:gmt-option-j-and-r.html</id><summary type="html">
&lt;p&gt;-J和-R是GMT的标准命令行选项中很重要的两个。这里“标准”的意思是“在所有具有该选项的命令中，其含义和用法相同”，而不是“所有命令都有这个选项”。&lt;/p&gt;
&lt;p&gt;既然博文名字叫做"GMT进阶"，那么选项的具体用法在这里就不讨论了，这里想要思考的是“这两个选项为什么要同时存在？”的问题。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;地图投影&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;根据维基百科中&lt;a class="reference internal" href="#id1"&gt;地图投影&lt;/a&gt;的解释，由于地球是一个不可展的球体，使用物理方法将其展平会引起褶皱、拉伸和断裂，因此要使用数学方法实现由曲面向平面的转化。地图投影，是指按照一定的数学法则将地球椭球面上的经纬网转换到平面上，使地面的地理坐标&lt;span class="math"&gt;\((\varphi,\lambda)\)&lt;/span&gt;与平面直角坐标&lt;span class="math"&gt;\((x,y)\)&lt;/span&gt;建立起函数关系。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="函数关系" src="/images/2013071501.jpg" style="width: 100px;"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="r"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;-R选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;-R选项很简单，给出要绘制的地图的范围。&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Rxmin/xmax/ymin/ymax&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="j"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;-J选项&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;-J选项指定投影方式以及地图的尺寸。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="jr"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;J和R结合&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下面以最简单的笛卡尔坐标系（-&lt;span class="caps"&gt;JX&lt;/span&gt;）为例，谈一谈J和R为什么必须同时指定。&lt;/p&gt;
&lt;p&gt;GMT默认的纸张大小为A4纸，也就是大小为210mm*297mm。假定要研究的范围是-R0/10/0/5，那么这个时候(2,2)这个点在什么地方呢？这就需要-J给出的尺寸信息了。假定-JX10c图形的水平方向长度为10cm，那么易知x方向的1个单位在纸上代表的实际距离为1cm。假定以纸张的左下角作为原点（实际上有X_ORIGIN和Y_ORIGIN两个参数控制，这里简化一下），那么很容易知道x方向上，0位于纸张的最左下角，10位于原点右方10cm的地方。如果y方向的尺寸安装比例算，应该是5cm，那么可以知道y的5位于原点上方5cm的地方。当然也可以强制指定y方向的尺寸为10cm，那么y的5则位于原点上方10cm的地方了。这样，就在笛卡尔坐标系中绘制了一个矩形，也就是我们感兴趣的区域。由此，纸张上任意一个点（包括矩形内和矩形外的所有点，甚至包括纸张外的所有点）都对应了一个坐标，同理任意一个坐标都对应了纸张上（或者纸张外）的一个位置。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;理解这个有什么意义？&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;纯粹个人兴趣，瞎折腾；&lt;/li&gt;
&lt;li&gt;想要在某个地方用pstext加个文字，不再盲目地调节xy位置，一眼就可以计算出那个地方的坐标；&lt;/li&gt;
&lt;li&gt;在一张纸上画多张图的时候，整个参考系是随之移动的，即坐标原点的移动，因而在计算某点坐标时确定原点很重要；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="GMT选项"></category></entry><entry><title>从SAC 101.6的一个bug谈起</title><link href="http://seisman.info/development-of-sac.html" rel="alternate"></link><updated>2013-07-15T00:50:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-15:development-of-sac.html</id><summary type="html">&lt;p&gt;2013年5月6日，SAC的维护者之一Arthur&amp;nbsp;Snoke在邮件组中宣布101.6即将发布，提前公布了101.6的测试版，供感兴趣的人测试bug。&lt;/p&gt;
&lt;p&gt;2013年5月16日，Arthur&amp;nbsp;Snoke再次发送了类似的邮件。&lt;/p&gt;
&lt;p&gt;2013年7月9日，IRIS宣布了SAC&amp;nbsp;101.6版正式发布。&lt;/p&gt;
&lt;p&gt;5月21日，在使用101.6测试版的时候发现了一个bug，提交了Issue，Brain&amp;nbsp;Savage在12个小时之后给我回复，说已经修复了这个bug。&lt;/p&gt;
&lt;p&gt;7月13日，也就是在101.6正式版发布几天之后，再次发现了一个bug。本来信息完整的数据经过sort之后台站的所有信息都丢了。本来以为是我的误操作，查了一遍之后确认自己的脚本没有问题，最终将bug锁定在sort命令上。这个bug已经影响到了SAC的正常使用。我有些抱怨这些开发者的不负责任，怎么能将一个有这么明显bug的版本随随便便发布出来。从测试版到正式版之间2个月的时间居然没有把bug找出来。&lt;/p&gt;
&lt;p&gt;翻看了一下关于101.6的所有邮件，在Arthur Snoke&amp;nbsp;5月16日的那封邮件中看到这样一句话：&lt;/p&gt;
&lt;blockquote&gt;
We hope that this time we will not need to got to v101.6b because
there was a bug we missed.&lt;/blockquote&gt;
&lt;p&gt;这不禁让我想起了上一个版本，101.5&amp;#8212;&amp;gt;101.5b&amp;#8212;&amp;gt;101.5c，短短几天的时间内SAC就更新了两次，两次都是修正bug。突然理解了Arthur&amp;nbsp;Snoke那句话的意思，理解了他话语中的无奈。&lt;/p&gt;
&lt;p&gt;就目前看来，SAC还是存在很多的问题的。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;SAC的版本混乱。从SAC的历史来看，最初由LLNL开发，使用的是Fortran，代码是非开源的，这个程序在地震学开始流行起来；后来LLNL不再维护SAC，IRIS与LLNL签订了某某协议，SAC的开发就交给了IRIS，从此以后SAC的版本号开始以10x.x这样的形式出现。在这期间或者更早，SAC的源代码由Fortran改成了C，这个改变很不彻底，比如现在的C源代码中还有很多数组是从1开始的。&lt;/li&gt;
&lt;li&gt;SAC的代码很难看。没有条理，头文件太多，想看源码完全找不到头绪。&lt;/li&gt;
&lt;li&gt;SAC的读写子程序很落后，在实际应用中很难满足用户的需求。&lt;/li&gt;
&lt;li&gt;子程序不够开放。目前用户可以调用的子程序包括滤波、相关、包络函数等几个，还有很多有用的子程序无法直接调用。&lt;/li&gt;
&lt;li&gt;程序的开发思路不够清晰。SAC的版本在不断更新，似乎只是在一味的添加新功能，而忽略了对旧代码的审查。新功能的增加必然导致版本间的不兼容，而为了兼容旧版本又导致了代码更加混乱。&lt;/li&gt;
&lt;li&gt;文档不清晰。官方的英文文档大多是几十年前写的，很多重要的内容都没有加进去，因为文档本身的含金量不足。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;SAC最大的一个问题在于，缺乏专业的开发者以及专业的用户。开发者本身是地震学家，了解地震学家需要SAC做什么，但是其不可能花太多的时间去修改SAC的代码，精力有限，科研任务还是很重的。SAC的用户很多，搞地震学的基本都要用，专业的用户却很少，很多人只是使用SAC的几个命令，完全不关心其细节，这点从SAC邮件组的冷清就可以看出来，基本上一个月难得有人会提点问题。在测试的两个月内，几乎没有人提出bug（至少邮件组里没有看到），所有的bug都需要开发者自己去找。有写代码经验的人都知道，自己写的程序找bug是很困难。&lt;/p&gt;
&lt;p&gt;SAC想要继续发展下去，还有很长的路要走，这个过程中需要更多的开发人员的付出，也需要更多用户的反馈。所以搞地震学的家伙们，下个最新版用一用，找找bug，为SAC的发展贡献一点力量吧。&lt;/p&gt;
</summary><category term="Bug"></category><category term="SAC"></category></entry><entry><title>Linux下安装TeXLive 2014</title><link href="http://seisman.info/install-texlive-under-linux.html" rel="alternate"></link><updated>2015-03-08T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-11:install-texlive-under-linux.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;依赖包&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;安装过程中需要调用Perl的模块&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;Digest::&lt;span class="caps"&gt;MD5&lt;/span&gt;&lt;/span&gt;&lt;/tt&gt;来检测ISO文件的完整性；&lt;/li&gt;
&lt;li&gt;升级过程中界面需要调用Perl的模块&lt;tt class="docutils literal"&gt;Tk&lt;/tt&gt;；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CentOS:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo yum install perl-Digest-MD5 perl-Tk
&lt;/pre&gt;
&lt;p&gt;Ubuntu:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo apt-get install libdigest-perl-md5-perl perl-tk
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;安装&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;下载&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;下载地址：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;USTC镜像： &lt;a class="reference external" href="http://mirrors.ustc.edu.cn/CTAN/systems/texlive/Images/texlive2014.iso"&gt;http://mirrors.ustc.edu.cn/&lt;span class="caps"&gt;CTAN&lt;/span&gt;/systems/texlive/Images/texlive2014.iso&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;阿里云镜像： &lt;a class="reference external" href="http://mirrors.aliyun.com/CTAN/systems/texlive/Images/texlive2014.iso"&gt;http://mirrors.aliyun.com/&lt;span class="caps"&gt;CTAN&lt;/span&gt;/systems/texlive/Images/texlive2014.iso&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Linux下可以用wget、axel，windows下可以用迅雷，怎么快怎么来。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="iso"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;挂载ISO镜像&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;su
&lt;span class="c"&gt;# mount -o loop texlive2014.iso  /mnt/&lt;/span&gt;
&lt;span class="c"&gt;# cd /mnt&lt;/span&gt;
&lt;span class="c"&gt;# ./install-tl&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;出现选项后，输入&lt;tt class="docutils literal"&gt;I&lt;/tt&gt;直接安装（也可以更改选项）。不出意外的话，5分钟应该就OK了，然后退出root用户；&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;环境变量&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;在当前用户的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.bashrc&lt;/span&gt;&lt;/tt&gt;中加入如下语句：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# TeX Live 2014&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;MANPATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MANPATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;:/usr/local/texlive/2014/texmf-dist/doc/man
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;INFOPATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;INFOPATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;:/usr/local/texlive/2014/texmf-dist/doc/info
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;:/usr/local/texlive/2014/bin/x86_64-linux
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;卸载ISO镜像&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo umount /mnt/
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="texlive"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;更新TeXLive&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;可以使用如下命令更新TeX包，&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--repository&lt;/span&gt;&lt;/tt&gt;选项指定了要使用哪一个CTAN镜像，这里使用了阿里云的CTAN镜像，也可指定其他CTAN镜像。若不使用该选项，则默认使用官方CTAN镜像，速度较慢。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;su
&lt;span class="c"&gt;# 更新TeXLive包管理器tlmgr&lt;/span&gt;
&lt;span class="c"&gt;# tlmgr update --self --repository http://mirrors.aliyun.com/CTAN/systems/texlive/tlnet/&lt;/span&gt;
&lt;span class="c"&gt;# 更新TeXLive的全部包&lt;/span&gt;
&lt;span class="c"&gt;# tlmgr update --all --repository http://mirrors.aliyun.com/CTAN/systems/texlive/tlnet/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;如果希望在图形界面下升级，可以使用如下命令调出tlmgr的中文图形界面：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;su
&lt;span class="c"&gt;# tlmgr --gui --gui-lang zh_CN&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;安装额外的字体&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;将字体文件复制到&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.fonts&lt;/span&gt;&lt;/tt&gt;目录下即可。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-07-11：初稿；&lt;/li&gt;
&lt;li&gt;2014-07-06：修改为TeXLive2014，并删除中文字体部分；&lt;/li&gt;
&lt;li&gt;2015-03-08：新增“安装依赖”；&lt;/li&gt;
&lt;li&gt;2015-03-15：使用命令行更新包；&lt;/li&gt;
&lt;li&gt;2015-03-20：指定更新源以及GUI更新；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="安装"></category><category term="LaTeX"></category></entry><entry><title>Firefox安装Java插件</title><link href="http://seisman.info/java-plugin-of-firefox.html" rel="alternate"></link><updated>2013-07-11T00:43:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-11:java-plugin-of-firefox.html</id><summary type="html">&lt;p&gt;由于某个变态网站，需要Java插件才能使用，所以需要在Firefox上安装Java插件。在Oracle的网站上搜到解决办法，原文在&lt;a class="reference external" href="http://www.oracle.com/technetwork/java/javase/manual-plugin-install-linux-136395.html"&gt;这里&lt;/a&gt;，排版难看的要死，故而重新排版。&lt;/p&gt;
&lt;p&gt;我的计算机环境如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;操作系统：CentOS 6.4&amp;nbsp;Final&lt;/li&gt;
&lt;li&gt;Firefox版本：17.0.7&lt;/li&gt;
&lt;li&gt;Java版本：OpenJDK&amp;nbsp;1.7.0&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;安装步骤如下：&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;退出Firefox；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;卸载原来安装的Java插件（没装过就不卸了）；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;找到Java自带的浏览器插件的位置；&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ locate libnpjp2
/usr/java/jre1.7.0_21/lib/amd64/libnpjp2.so
/usr/local/cuda-5.0/jre/lib/amd64/libnpjp2.so
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;在firefox插件目录中建立到Java插件文件的软链接；&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ cd ~/.mozilla/plugins/
$ ln -s /usr/java/jre1.7.0_21/lib/amd64/libnpjp2.so libnpjp2.so
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;启动firefox，在地址栏输入&lt;strong&gt;about:plugins&lt;/strong&gt;，查看插件是否正常加载；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;搞定收工。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="Firefox"></category><category term="Java"></category></entry><entry><title>走时计算软件TauP</title><link href="http://seisman.info/taup-toolkit.html" rel="alternate"></link><updated>2015-01-25T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-10:taup-toolkit.html</id><summary type="html">
&lt;p&gt;TauP是一个用于计算震相走时等相关信息的软件包。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;基本信息&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;开发者：&lt;a class="reference external" href="http://sc.edu/"&gt;University of South Carolina&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;语言：Java&lt;/li&gt;
&lt;li&gt;平台：跨平台，Windows、Linux、Mac等&lt;/li&gt;
&lt;li&gt;与ttimes一样，其原理基于Buland和Chapman于1983年提出的方法&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;功能与特色&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;相对于ttimes而言，TauP具有更多的功能和特色：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;可以计算震相走时、射线参数、反射点、穿透点、射线路径、走时曲线等；&lt;/li&gt;
&lt;li&gt;支持自定义速度模型；&lt;/li&gt;
&lt;li&gt;内置震相解析器，支持不常见的震相名；&lt;/li&gt;
&lt;li&gt;自带多个预定义地球模型：iasp91、prem、ak135、jb、1066a、1066b、pwdk、sp6、herrin。&lt;/li&gt;
&lt;li&gt;部分兼容ttimes，比如用ttp表示常见P波震相，除此之外，还有tts、ttp+、tts+、ttbasic、ttall。&lt;/li&gt;
&lt;li&gt;采用线性插值，可能带来0.01秒的误差；&lt;/li&gt;
&lt;li&gt;直接在球坐标系下求解方程，不必做展平变换；与部分震相的解析解相比，最大误差为0.01秒，而ttimes的最大误差为0.05秒；&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;工具&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;TauP提供了多个工具，包括有图形界面的taup，交互式的taup_console，以及命令行工具taup_time、taup_pierce、taup_setsac、taup_path、taup_curve、taup_create、taup_table、taup_wavefront。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;TauP系列博文&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/install-taup.html"&gt;安装TauP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/calculate-travel-time-using-taup.html"&gt;用taup_time计算震相走时及射线信息&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/calculate-pierce-points-using-taup.html"&gt;用taup_pierce计算射线的界面的穿透点&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.info/mark-travel-time-using-taup.html"&gt;用taup_setsac将走时信息写入SAC文件&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary><category term="走时"></category><category term="TauP"></category></entry><entry><title>Perl多版本共存之Perlbrew</title><link href="http://seisman.info/perlbrew-for-multiple-versions-of-perl.html" rel="alternate"></link><updated>2013-07-09T00:41:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-09:perlbrew-for-multiple-versions-of-perl.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;说明&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;推荐使用plenv作为Perl版本管理工具，不再推荐PerlBrew。plenv相比于PerlBrew更加简单也更有优势。关于plenv的介绍，参考博文《&lt;a class="reference external" href="http://seisman.info/perl-plenv.html"&gt;Perl多版本共存之plenv&lt;/a&gt;》。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;缘由&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;目前在使用的Linux发行版是CentOS 6.4，自带的Perl版本为5.10.1，这一版本是2009年发行的，平时随便写点脚本还行，想用点高级的模块实现点高级功能的时候就开始掉链子了。不是这个模块找不到，就是那个模块依赖性搞不定，于是就有了安装新版Perl的想法。Google了一下，有人建议系统自带的Perl还是不要升级比较好，因为各种杂七杂八的东西都依赖于Perl，Perl的升级比glibc的升级还麻烦。试敲了一下&lt;tt class="docutils literal"&gt;yum remove perl&lt;/tt&gt;，哗哗地列出了一堆东西，这些都是因为Perl被删除依赖性无法满足而无法使用的包。想到当初升级glibc导致系统崩溃的惨痛回忆，还是决定不动系统的Perl比较好。于是开始寻找Perl如何实现多版本共存。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="perlbrew"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;Perlbrew&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Perlbrew模块的作者是台湾人&lt;a class="reference external" href="http://gugod.org/"&gt;劉康民&lt;/a&gt;。该模块是以Ruby的RVM概念出发，也就是使用者可以使用Perlbrew將不同版本的Perl安裝在$HOME路径内，并且使用Perlbrew来切换不同版本的Perl。目前Perlbrew的最新版是0.64。（CentOS中epel库的版本是0.28。）&lt;/p&gt;
&lt;p&gt;Perlbrew的几个优点：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;不需要使用sudo来安裝CPAN模块&lt;/li&gt;
&lt;li&gt;可以使用每个月不断释出的新的Perl&lt;/li&gt;
&lt;li&gt;可尝试新的程式语言功能&lt;/li&gt;
&lt;li&gt;可以不再被Vendor Perl限制(平台內建的Perl)&lt;/li&gt;
&lt;li&gt;可在不同版本的Perl下测试模块&lt;/li&gt;
&lt;li&gt;可整合至bash,zsh,csh环境变量&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;安装Perlbrew&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;按照默认的安装方法，会将Perlbrew以及新版本Perl安装在&lt;tt class="docutils literal"&gt;~/perl5&lt;/tt&gt;下。Home是我家，干净整洁很重要，还是换了地方吧。&lt;/p&gt;
&lt;p&gt;先声明环境变量&lt;tt class="docutils literal"&gt;PERLBREW_ROOT&lt;/tt&gt;，然后切换到root（使用sudo是没用的），然后下载安装&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;PERLBREW_ROOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/perl5 &lt;span class="c"&gt;# 这句直接敲入终端&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;su &lt;span class="c"&gt;# 切换root&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;wget -O - http://install.perlbrew.pl &lt;span class="p"&gt;|&lt;/span&gt; bash &lt;span class="c"&gt;# 安装&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;向.bashrc中加入语句：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# Perlbrew&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;PERLBREW_ROOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/perl5
&lt;span class="nb"&gt;source&lt;/span&gt; /usr/local/perl5/etc/bashrc
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;重新开一个终端使得环境变量生效。由于安装到了/usr/local/下，后面的操作都需要root权限才能完成。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;寻找合适的源&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;perlbrew init
&lt;span class="nv"&gt;$ &lt;/span&gt;perlbrew mirror
Fetching mirror list
&lt;span class="o"&gt;[&lt;/span&gt; 1&lt;span class="o"&gt;]&lt;/span&gt; Africa, South Africa, Cape Town &lt;span class="o"&gt;(&lt;/span&gt;mirror.ac.za&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 2&lt;span class="o"&gt;]&lt;/span&gt; Africa, South Africa, Cape Town &lt;span class="o"&gt;(&lt;/span&gt;wa.co.za&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 3&lt;span class="o"&gt;]&lt;/span&gt; Africa, South Africa, Gauteng, Johannesburg &lt;span class="o"&gt;(&lt;/span&gt;is.co.za&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 4&lt;span class="o"&gt;]&lt;/span&gt; Africa, South Africa, Western Cape, Parow &lt;span class="o"&gt;(&lt;/span&gt;saix.net&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 5&lt;span class="o"&gt;]&lt;/span&gt; Africa, Tunisia, Tunis &lt;span class="o"&gt;(&lt;/span&gt;cpan.mirror.tn&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 6&lt;span class="o"&gt;]&lt;/span&gt; Africa, Uganda, Mukono &lt;span class="o"&gt;(&lt;/span&gt;ucu.ac.ug&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 7&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, AnHui, Hefei &lt;span class="o"&gt;(&lt;/span&gt;ustc.edu.cn&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 8&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Beijing &lt;span class="o"&gt;(&lt;/span&gt;sohu.com&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 9&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Chaoyang, BeiJing &lt;span class="o"&gt;(&lt;/span&gt;idc.btte.net&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 10&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Fujian, Xiamen &lt;span class="o"&gt;(&lt;/span&gt;xmu.edu.cn&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 11&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Hong Kong SAR, Hong Kong &lt;span class="o"&gt;(&lt;/span&gt;communilink.net&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 12&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Hong Kong SAR, Hong Kong &lt;span class="o"&gt;(&lt;/span&gt;cuhk.edu.hk&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 13&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Hong Kong SAR, Hong Kong &lt;span class="o"&gt;(&lt;/span&gt;devlib.org&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 14&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Hubei, Wuhan &lt;span class="o"&gt;(&lt;/span&gt;hust.edu.cn&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 15&lt;span class="o"&gt;]&lt;/span&gt; Asia, China, Liaoning, Dalian &lt;span class="o"&gt;(&lt;/span&gt;neusoft.edu.cn&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 16&lt;span class="o"&gt;]&lt;/span&gt; Asia, India, Maharashtra, Mumbai &lt;span class="o"&gt;(&lt;/span&gt;indialinks.com&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 17&lt;span class="o"&gt;]&lt;/span&gt; Asia, Indonesia, Depok &lt;span class="o"&gt;(&lt;/span&gt;kambing.ui.ac.id&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 18&lt;span class="o"&gt;]&lt;/span&gt; Asia, Indonesia, East Java, Surabaya &lt;span class="o"&gt;(&lt;/span&gt;sby.datautama.net.id&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 19&lt;span class="o"&gt;]&lt;/span&gt; Asia, Indonesia, Jakarta &lt;span class="o"&gt;(&lt;/span&gt;mwn-tlkm.archive.or.id&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt; 20&lt;span class="o"&gt;]&lt;/span&gt; Asia, Indonesia, Jakarta &lt;span class="o"&gt;(&lt;/span&gt;pesat.net.id&lt;span class="o"&gt;)&lt;/span&gt;
Select a mirror by number or press enter to see the rest &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;248&lt;/span&gt; more&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;q to quit, m &lt;span class="k"&gt;for&lt;/span&gt; manual entry&lt;span class="o"&gt;]&lt;/span&gt; 7
Selected Asia, China, AnHui, Hefei &lt;span class="o"&gt;(&lt;/span&gt;ustc.edu.cn&lt;span class="o"&gt;)(&lt;/span&gt;http://mirrors.ustc.edu.cn/CPAN/&lt;span class="o"&gt;)&lt;/span&gt; as the mirror
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="perl"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;查看可用的Perl版本&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;perlbrew available
perl-5.18.1
perl-5.16.3
perl-5.14.4
perl-5.12.5
perl-5.10.1
perl-5.8.9
perl-5.6.2
perl5.005_04
perl5.004_05
perl5.003_07
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="perl-5-18-1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;安装Perl 5.18.1&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;perlbrew install perl-5.18.1 --thread --multi --64int --64all
Fetching perl 5.18.1 as /usr/local/perl5/dists/perl-5.18.1.tar.bz2
Download http://www.cpan.org/src/5.0/perl-5.18.1.tar.bz2 to /usr/local/perl5/dists/perl-5.18.1.tar.bz2
Installing /usr/local/perl5/build/perl-5.18.1 into /usr/local/perl5/perls/perl-5.18.1

This could take a &lt;span class="k"&gt;while&lt;/span&gt;. You can run the following &lt;span class="nb"&gt;command &lt;/span&gt;on another shell to track the status:

tail -f /usr/local/perl5/build.perl-5.18.1.log
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;加入—thread等选项是为了使perl支持并行等特性，perlbrew提供了6种编译选项，根据系统的编译选项选择了如上4种。&lt;/p&gt;
&lt;p&gt;某个版本的perlbrew会一直处于Fetching的阶段，无法下载所需版本的perl，目前在perlbrew的新版本中已经解决。&lt;/p&gt;
&lt;p&gt;如果觉得perlbrew下载perl包的速度太慢，可以自己用其他方式下载相应的tar.bz2包，比如perl-5.18.1.tar.bz2，然后复制到/usr/local/perl5/dists/再尝试安装。&lt;/p&gt;
&lt;p&gt;下面开始就没动静了，不过这个时候真的是在安装，不信的话可以看看build.perl-5.18.1.log，里面的内容一行一行往外冒啊。耐心的等待吧。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;使用新版本&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;perlbrew switch perl-5.18.1
&lt;span class="nv"&gt;$ &lt;/span&gt;perl -v
This is perl 5, version 18, subversion &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;v5.18.1&lt;span class="o"&gt;)&lt;/span&gt; built &lt;span class="k"&gt;for&lt;/span&gt; x86_64-linux

Copyright 1987-2013, Larry Wall

Perl may be copied only under the terms of either the Artistic License
or the GNU General Public License, which may be found in the Perl &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="nb"&gt;source &lt;/span&gt;kit.

Complete documentation &lt;span class="k"&gt;for&lt;/span&gt; Perl, including FAQ lists, should be found on
this system using &lt;span class="s2"&gt;"man perl"&lt;/span&gt; or &lt;span class="s2"&gt;"perldoc perl"&lt;/span&gt;. If you have access to
the Internet, point your browser at http://www.perl.org/, the Perl Home Page.
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;也可以仅在当前shell中使用新版perl:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;perlbrew use perl-5.18.1
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;还可以回到系统自带的perl：&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;perlbrew switch-off
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="cpanm"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;安装cpanm&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;安装好的新Perl在使用模块时依然是到系统默认的路径中去寻找的，这点可以通过&lt;tt class="docutils literal"&gt;perl &lt;span class="pre"&gt;-V&lt;/span&gt;&lt;/tt&gt;显示的@INC看出来。可以通过安装cpanm来实现将模块安装到新目录中，并在新目录中寻找。&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;perlbrew install-cpanm
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;重新开一个终端，再看&lt;tt class="docutils literal"&gt;perl &lt;span class="pre"&gt;-V&lt;/span&gt;&lt;/tt&gt;的@INC已经不一样了。cpanm可以代替系统perl的cpan安装各种最新模块，默认安装在perlbrew的那个目录下，在没有权限的情况下会安装到HOME下。也可以通过local::lib模块指定安装路径，我觉得没必要。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Perlbrew主页：&lt;a class="reference external" href="http://perlbrew.pl/"&gt;http://perlbrew.pl/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Perlbrew中文简介：&lt;a class="reference external" href="http://perlbrew.pl/Perlbrew-%E4%B8%AD%E6%96%87%E7%B0%A1%E4%BB%8B.html"&gt;http://perlbrew.pl/Perlbrew-中文簡介.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;定制自己的多版本Perl环境：&lt;a class="reference external" href="http://www.php-oa.com/2011/02/25/perl-appperlbrew.html"&gt;http://www.php-oa.com/2011/02/25/perl-appperlbrew.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CPAN文档：&lt;a class="reference external" href="https://metacpan.org/module/App::perlbrew"&gt;https://metacpan.org/module/App::perlbrew&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;命令文档：perlbrew help&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-07-09：初稿；&lt;/li&gt;
&lt;li&gt;2013-08-17：perlbrew更新了，修正了其中下载过程中的一个bug；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="Perl"></category><category term="安装"></category><category term="版本"></category></entry><entry><title>SAC源代码安装</title><link href="http://seisman.info/install-sac-from-source-code.html" rel="alternate"></link><updated>2013-07-08T22:06:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-08:install-sac-from-source-code.html</id><summary type="html">&lt;p&gt;本文不再更新维护！&lt;/p&gt;
&lt;p&gt;从源码编译SAC的方法，《&lt;a class="reference external" href="http://seisman.info/sac-manual.html"&gt;SAC参考手册&lt;/a&gt;》的“安装SAC”一节中有详细说明。&lt;/p&gt;
</summary><category term="编译"></category></entry><entry><title>SAC二进制版的安装</title><link href="http://seisman.info/install-sac-from-binary-package.html" rel="alternate"></link><updated>2013-07-08T20:30:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-08:install-sac-from-binary-package.html</id><summary type="html">&lt;p&gt;本文不再更新维护！&lt;/p&gt;
&lt;p&gt;安装二进制版SAC的流程，在《&lt;a class="reference external" href="http://seisman.info/sac-manual.html"&gt;SAC参考手册&lt;/a&gt;》的“安装SAC”一节中有详细说明。&lt;/p&gt;
</summary><category term="安装"></category></entry><entry><title>GMT使用-K和-O的技巧</title><link href="http://seisman.info/how-to-use-gmt-ko.html" rel="alternate"></link><updated>2013-07-07T11:30:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-07:how-to-use-gmt-ko.html</id><summary type="html">
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;是GMT的17个标准选项中最常用但最容易出错的两个。&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;用法回顾&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;如果一张图只需要一个命令就可以画出来，则不需要&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;选项；&lt;/li&gt;
&lt;li&gt;如果一张图由两个命令绘制出来，第一个命令需要使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;，第二个命令需要使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;如果一张图由多个命令组成，第一个命令使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;，中间命令使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;，最后一个命令使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;第一个命令使用重定向符号&lt;tt class="docutils literal"&gt;&amp;gt;&lt;/tt&gt;创建新文件并写入PS命令；&lt;/li&gt;
&lt;li&gt;余下所有命令绘图命令使用重定向符号&lt;tt class="docutils literal"&gt;&amp;gt;&amp;gt;&lt;/tt&gt;向PS文件中追加新的PS命令；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;经典错误&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;根据上面所说的用法去写绘图脚本，经常会出现各种错误，列出常见的错误如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;已经写好的一个绘图脚本，想要在往图里加点东西。在脚本的最后加了个命令，使用了&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;，但是却忘了把原来最后一个命令的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt; &lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;。这样最后一个命令应该没有效果，或者gs直接报错。&lt;/li&gt;
&lt;li&gt;第一个命令绘制海岸线，第二个命令绘制地形，导致地形把海岸线覆盖了，想要交换两个命令的顺序，结果忘记将第一个命令的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;，忘记将第二个命令的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;。这样应该完全没结果吧。&lt;/li&gt;
&lt;li&gt;想要在第一个命令前再加一个绘图命令，也记得把原来第一个命令的&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt; &lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;，但是忘记把&lt;tt class="docutils literal"&gt;&amp;gt;&lt;/tt&gt;改成&lt;tt class="docutils literal"&gt;&amp;gt;&amp;gt;&lt;/tt&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;新手常犯的错误太多，一时想不起了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;完全避免犯错的技巧&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;下面的技巧可以几乎完全避免使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;以及&lt;tt class="docutils literal"&gt;重定向符号&lt;/tt&gt;过程中可能出现的错误（前提是要理解这个简单的技巧为什么可以帮助你避免犯错）。下面分别给出GMT4和GMT5下bash脚本中使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;的技巧。&lt;/p&gt;
&lt;p&gt;在理解了如下脚本后，很容易将其修改到bat、Perl、Python中。&lt;/p&gt;
&lt;div class="section" id="gmt4-bash"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;&lt;span class="caps"&gt;GMT4&lt;/span&gt; Bash脚本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# GMT template&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;example.ps
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/1/0/1

&lt;span class="c"&gt;# Begin GMT Plot&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# now begin your real plot commands&lt;/span&gt;
&lt;span class="c"&gt;# every command should be with "-K" "-O" and "&amp;gt;&amp;gt;"&lt;/span&gt;

&lt;span class="c"&gt;# End GMT Plot&lt;/span&gt;
psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# Plot finished. Now you can convert PS to other format&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="gmt5-bash"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;&lt;span class="caps"&gt;GMT5&lt;/span&gt; Bash脚本&lt;/a&gt;&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# GMT template&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="nv"&gt;PS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;example.ps
&lt;span class="nv"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;X6i
&lt;span class="nv"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0/1/0/1

&lt;span class="c"&gt;# Begin GMT Plot&lt;/span&gt;
gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -K &amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# now begin your real plot commands&lt;/span&gt;
&lt;span class="c"&gt;# every command should be with "-K" "-O" and "&amp;gt;&amp;gt;"&lt;/span&gt;

&lt;span class="c"&gt;# End GMT Plot&lt;/span&gt;
gmt psxy -J&lt;span class="nv"&gt;$J&lt;/span&gt; -R&lt;span class="nv"&gt;$R&lt;/span&gt; -T -O &amp;gt;&amp;gt; &lt;span class="nv"&gt;$PS&lt;/span&gt;

&lt;span class="c"&gt;# Plot finished. Now you can convert PS to other format&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;一点点解释&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-T&lt;/span&gt;&lt;/tt&gt;选项忽略所有输入，即输入为空，相当于&lt;tt class="docutils literal"&gt;/dev/null&lt;/tt&gt;。因而这两个&lt;tt class="docutils literal"&gt;psxy&lt;/tt&gt;命令实际上不会写入任何图像相关的代码到PS文件中。第一个&lt;tt class="docutils literal"&gt;psxy&lt;/tt&gt;命令生成了PS头部信息，最后的&lt;tt class="docutils literal"&gt;psxy&lt;/tt&gt;命令生成了尾巴。&lt;/p&gt;
&lt;p&gt;可以在这两个&lt;tt class="docutils literal"&gt;psxy&lt;/tt&gt;命令中间添加任意数目真正用于绘图的命令。这些（零个、一个或者多个）命令既不需要头段也不需要尾巴，因而所有的中间绘图命令都需要&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;、&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;选项，并使用重定向&lt;tt class="docutils literal"&gt;&amp;gt;&amp;gt;&lt;/tt&gt;。&lt;/p&gt;
&lt;p&gt;这样带来的好处在于，中间所有命令具有统一的风格，都使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt; &lt;span class="pre"&gt;-O&lt;/span&gt; &amp;gt;&amp;gt;&lt;/tt&gt;。因而可以任意增加、删除命令或调整任意命令的相对顺序。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;印象中这个技巧在官方文档的脚本中出现过，但是没有将其作为一种技巧来说，所以貌似未得到推广；&lt;/li&gt;
&lt;li&gt;每个GMT命令默认都会输出头段和尾巴，这样的设计合理吗？为什么不是绘图命令完全抛弃头段和尾巴，由两个单独的命令向PS文件中写头段和尾巴？这样的设计也许不太符合GMT命令的整体风格；&lt;/li&gt;
&lt;li&gt;究竟有没有效果？用过之后才有评价的资格。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-07-07：初稿；&lt;/li&gt;
&lt;li&gt;2013-08-24：修订了bash脚本中的一个笔误；&lt;/li&gt;
&lt;li&gt;2013-11-06：修订脚本，使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-T&lt;/span&gt;&lt;/tt&gt;选项，不再使用&lt;tt class="docutils literal"&gt;/dev/null&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;2014-07-06：删除了Perl版脚本，增加了GMT5版本的脚本；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="GMT选项"></category><category term="GMT技巧"></category></entry><entry><title>SAC参考手册中文版</title><link href="http://seisman.info/sac-manual.html" rel="alternate"></link><updated>2015-05-02T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-06:sac-manual.html</id><summary type="html">
&lt;p&gt;征集《SAC参考手册》维护者，有意者点&lt;a class="reference external" href="http://seisman.info/maintainers-for-sac-manual-wanted.html"&gt;这里&lt;/a&gt;，长期有效。&lt;/p&gt;
&lt;div class="section" id="dev"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;3.3 dev版&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;此文档使用Git进行版本控制，文档会不定期修复bug以及添加新内容。读者可以下载已定稿的3.2版或正在修订中的3.3-dev版。&lt;/p&gt;
&lt;p&gt;注意：由于LaTeX本身的一些限制，3.3-dev版在新增内容的情况下，部分含图/表的页面在排版的时候可能会留出一些空白。我一般只会在某个正式版本发布之前整体检查一下排版情况，所以dev版的排版无法保证。&lt;/p&gt;
&lt;p&gt;下载地址： &lt;a class="reference external" href="http://home.ustc.edu.cn/~dongzhi/SAC_Docs.pdf"&gt;3.3-dev版&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;2015-05-02 3.2版&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;对于用户:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;修复bugs和typos；&lt;/li&gt;
&lt;li&gt;命令整理：&lt;ul&gt;
&lt;li&gt;&lt;cite&gt;systemcommand&lt;/cite&gt;&lt;/li&gt;
&lt;li&gt;&lt;cite&gt;transfer&lt;/cite&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;新增内容&lt;ul&gt;
&lt;li&gt;波形排序&lt;/li&gt;
&lt;li&gt;标记震相理论走时的三种方法&lt;/li&gt;
&lt;li&gt;图像格式转换&lt;/li&gt;
&lt;li&gt;SAC初始化宏文件&lt;/li&gt;
&lt;li&gt;SAC命令的长度上限&lt;/li&gt;
&lt;li&gt;字节序&lt;/li&gt;
&lt;li&gt;新增附录“仪器响应”，整理了“去仪器响应”一节&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;新增示例&lt;ul&gt;
&lt;li&gt;调用SAC的Hilbert函数&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于维护者:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;新增ChangeLog；&lt;/li&gt;
&lt;li&gt;更新README，可根据说明自行编译源码生成PDF；&lt;/li&gt;
&lt;li&gt;修改Makefile，对依赖的检测更加智能；&lt;/li&gt;
&lt;li&gt;英文使用TeX默认字体；中文使用开源中文字体Fandol；&lt;/li&gt;
&lt;li&gt;使用&lt;tt class="docutils literal"&gt;minted&lt;/tt&gt;实现代码的语法高亮，替代&lt;tt class="docutils literal"&gt;listings&lt;/tt&gt;；&lt;/li&gt;
&lt;li&gt;datetime宏包升级至datetime2；&lt;/li&gt;
&lt;li&gt;简化了绘图脚本的Makefile；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址: &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v3.2.pdf"&gt;SAC参考手册v3.2.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;2014-09-25 3.1版&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;重新整理了大部分命令的语法说明；&lt;/li&gt;
&lt;li&gt;对“SAC图像”一章进行了修订；&lt;/li&gt;
&lt;li&gt;新增“信号迭加子程序”一章；&lt;/li&gt;
&lt;li&gt;新增“谱估计子程序”一章；&lt;/li&gt;
&lt;li&gt;新增“在Python中调用SAC”一节；&lt;/li&gt;
&lt;li&gt;Bug修订；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址: &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v3.1.pdf"&gt;SAC参考手册v3.1.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;2014-04-18 3.0版&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;重新设计了整个文档的结构&lt;/li&gt;
&lt;li&gt;重写了教程部分的大多数内容&lt;/li&gt;
&lt;li&gt;教程部分根据SAC v101.6a进行修正&lt;/li&gt;
&lt;li&gt;Bug修订&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址: &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v3.0.pdf"&gt;SAC参考手册v3.0.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;2014-02-22 2.3版&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;使用Git管理源码&lt;/li&gt;
&lt;li&gt;整理结构和布局的修改&lt;/li&gt;
&lt;li&gt;新的小节: “&lt;span class="caps"&gt;SAC&lt;/span&gt; IO升级版”、“黑板变量的读写”、“SAC保存图像”&lt;/li&gt;
&lt;li&gt;Bug修订&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址: &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v2.3.pdf"&gt;SAC帮助文档中文版v2.3.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;2013-04-12 2.2版&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;命令已经整理完毕，排版上基本已经没有问题了，重新设计了封面，在接下来很长一段时间应该都不会有大的改动了。如果有时间，会加一些SAC其他方面的东西。如果有读者反馈，命令方面也可能会有更新。&lt;/p&gt;
&lt;p&gt;下载地址： &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v2.2.pdf"&gt;SAC帮助文档中文版v2.2.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;2013-04-06 2.1版&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;重新细致整理了手册的第一章，基本达到了我认为可以打印的地步。命令部分还没有整，200多个，需要很长一段时间才能出来。&lt;/p&gt;
&lt;p&gt;下载地址： &lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v2.1.pdf"&gt;SAC帮助文档中文版v2.1.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;2013-03-29 2.0版&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;花了两天的时间重新制作了整个文档，内容及排版部分有很多bug，草草结束是因为接下来的一段时间要好好干活了，先把v2.0的细节总结如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;操作系统：CentOS 6.4 (Final)&lt;/li&gt;
&lt;li&gt;编译环境：TeX Live 2012&lt;/li&gt;
&lt;li&gt;编译命令：xeLaTeX&lt;/li&gt;
&lt;li&gt;中文实现：CTEX宏包&lt;/li&gt;
&lt;li&gt;中文字体：宋体+黑体&lt;/li&gt;
&lt;li&gt;英文主字体：Liberation Sans&lt;/li&gt;
&lt;li&gt;代码字体：Courier 10 Pitch&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v2.0.pdf"&gt;SAC帮助文档中文版v2.0.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;2012-09-18 1.2版&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;增加了封面配图。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v1.2.pdf"&gt;SAC帮助文档中文版v1.2.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id11"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;2012-09-03 1.1版&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;重新格式化整个文档，使得其看上去更规范，也易于以后的修改；&lt;/li&gt;
&lt;li&gt;文档中的所有C或Fortran代码从notepad++中直接导出，代码支持语法高亮；&lt;/li&gt;
&lt;li&gt;代码及正文英文字体采用Consolas字体。&lt;/li&gt;
&lt;li&gt;增加了“在脚本中调用SAC”一节；&lt;/li&gt;
&lt;li&gt;新增了transfer、traveltime、saveimg、datagen命令（依赖于SAC v101.5c）；&lt;/li&gt;
&lt;li&gt;公式用公式编辑器编辑&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v1.1.pdf"&gt;SAC帮助文档中文版v1.1.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id12"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id23"&gt;2012-01-08 1.0版&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;自学SAC是在2010年的寒假，看的是1995年出版的《数字地震波形分析》的电子版以及SAC自带的英文文档。《数字地震波形分析》大概是当时唯一一本介绍SAC的中文书，电子版很不清晰而且有些命令已经过时了。我一直希望能有一个新版本出现。&lt;/p&gt;
&lt;p&gt;这个SAC中文手册最初翻译于2011年暑假，用了20天左右的时间，完成了大部分的翻译工作。这个版本主要参考了《数字地震波形分析》一书。包含了大部分的用户指南以及几乎全部的命令。这个版本的优点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;结合了SAC101.4版本，增加、删除和修改了一些命令；&lt;/li&gt;
&lt;li&gt;更清晰；&lt;/li&gt;
&lt;li&gt;增加了书签，方便定位，支持全文搜索。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这个版本的缺点在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;与matlab引擎相关的几个命令未加入；&lt;/li&gt;
&lt;li&gt;SAC的两个子程序部分暂时还没有翻译；&lt;/li&gt;
&lt;li&gt;由于没有时间和心思检查，中间可能会出现一些错误；&lt;/li&gt;
&lt;li&gt;关于命令的简写还有一些细节没有做；&lt;/li&gt;
&lt;li&gt;在某些linux版本下，pdf打开后看到的是完全颠倒的字（比如悲摧的CentOS…）希望这些可以在以后的版本中得到改善和加强。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址：&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/sac-manual-v1.0.pdf"&gt;SAC帮助文档中文版v1.0.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</summary><category term="书籍"></category><category term="PDF"></category></entry><entry><title>GMT进阶之深入理解-K和-O选项</title><link href="http://seisman.info/gmt-option-ko.html" rel="alternate"></link><updated>2013-07-06T00:39:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-06:gmt-option-ko.html</id><summary type="html">&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;是GMT的两个标准选项，其用法很简单，一张图和一段文字就可以明白一切。但是同时&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;选项却是日常GMT绘图中最常出错的地方，很多时候这样的错误很让人摸不着头脑。这里首先简单介绍&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;选项，然后试着去探究一下&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;和&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;选项在代码中代表什么，在下一篇博文中给出使用-K和-O选项的一个技巧。&lt;/p&gt;
&lt;p&gt;如GMT Technical Reference and&amp;nbsp;Cookbook中第4.4.6节所说，任意一个完整的PS文件都必须包含头段（初始化），正文（绘图部分），尾巴（输出图像）。&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="-K -O" src="/images/2013070601.jpg" style="width: 700px;" /&gt;
&lt;/div&gt;
&lt;p&gt;GMT的每个绘图命令默认都会同时输出头段、正文以及尾巴。如左图所示，如果一张图只需要一个命令就可以画出来，那么就不需要-K和-O选项。如中图所示，如果一张图由两个命令绘制出来，第一个命令需要省略尾巴部分（使用-K），第二个命令需要省略头段部分（使用-O）。更常见的情况如右图所示，一张图由多个命令组成，第一个命令省略尾巴（-K），中间命令省略头段和尾巴（-K&amp;nbsp;-O），最后一个命令省略头段（-O）。另外一个需要注意的地方是重定向符号，第一个命令使用&amp;quot;&amp;gt;&amp;quot;，后面所有的命令使用&amp;quot;&amp;gt;&amp;gt;&amp;quot;。&lt;/p&gt;
&lt;p&gt;研究一下生成的PS文件就可以发现：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-K&lt;/span&gt;&lt;/tt&gt;选项，省略的尾巴部分内容为:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
%%PageTrailer

-295.276 -295.276 T 4.16667 4.16667 scale -90 R -595 0 T 0 A
showpage

%%Trailer

end
%%EOF
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;使用&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-O&lt;/span&gt;&lt;/tt&gt;选项，省略的头部部分内容如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;BoundingBox以及HiResBoundingBox&lt;/li&gt;
&lt;li&gt;创建时间&lt;/li&gt;
&lt;li&gt;landscape还是portrait&lt;/li&gt;
&lt;li&gt;总页码&lt;/li&gt;
&lt;li&gt;ISOLatin1+支持的特殊符号&lt;/li&gt;
&lt;li&gt;所有GMT可用的字体&lt;/li&gt;
&lt;li&gt;页面设置&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;修订历史&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-07-06：初稿；&lt;/li&gt;
&lt;li&gt;2014-07-06：删除了一些细节的描述；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="GMT4"></category><category term="GMT5"></category><category term="GMT选项"></category></entry><entry><title>震中距、方位角和反方位角的计算</title><link href="http://seisman.info/calculate-dist-az-baz.html" rel="alternate"></link><updated>2014-10-28T10:55:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-03:calculate-dist-az-baz.html</id><summary type="html">
&lt;p&gt;给定震中经纬度以及球面上任意一点（一般是台站）的经纬度，计算震中距、方位角以及反方位角。这是地震学的一个基本问题。&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;名词解释&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;震中距：&lt;strong&gt;地面&lt;/strong&gt;上任意一点到&lt;strong&gt;震中&lt;/strong&gt;的球面距离；&lt;/li&gt;
&lt;li&gt;方位角：震中到台站的连线与地理北向的夹角；&lt;/li&gt;
&lt;li&gt;反方位角：台站到震中的连线与地理北向的夹角；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一张图可以说明一切:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="震中距、方位角(az)、反方位角(baz)示意图" src="/images/2013070301.jpg" style="width: 600px;"/&gt;
&lt;p class="caption"&gt;图1：震中距、方位角(az)、反方位角(baz)示意图&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;数学推导&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;公式的推导需要简单的球面三角函数的知识。具体的推导可以参考Robert B. Herrmann的作业题。&lt;/p&gt;
&lt;p&gt;网址如下： &lt;a class="reference external" href="http://www.eas.slu.edu/People/RBHerrmann/Courses/EASA462"&gt;http://www.eas.slu.edu/People/RBHerrmann/Courses/&lt;span class="caps"&gt;EASA462&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;作业题中的Ass06、Ass07、Ass08给出了计算震中距和方位角的原理。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;相关代码&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;广为流传的一个程序是&lt;tt class="docutils literal"&gt;distaz&lt;/tt&gt;。在GMT、SAC等的源码里都可以找到。&lt;tt class="docutils literal"&gt;distaz&lt;/tt&gt;代码很短，简单易懂，其采用的地球模型为椭球模型，精度上可以满足需求。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;C、Fortran、Java、Python以及CGI版本： &lt;a class="reference external" href="http://www.seis.sc.edu/software/distaz/"&gt;由The lithospheric seismology program at USC整理&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Matlab版本： &lt;a class="reference external" href="https://github.com/geodynamics/specfem3d_globe/blob/master/utils/Visualization/VTK_ParaView/matlab/distaz.m"&gt;由specfem3d_globe提供&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;使用方法&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;仅以C语言版本的&lt;tt class="docutils literal"&gt;distaz&lt;/tt&gt;为例，用如下命令即可编译:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
cc distaz.c -o cdistaz -lm
&lt;/pre&gt;
&lt;p&gt;其输入为&lt;tt class="docutils literal"&gt;sta_lat sta_lon evt_lat evt_lon&lt;/tt&gt;，输出为&lt;tt class="docutils literal"&gt;Delta Baz Az&lt;/tt&gt;。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ distaz 10 14 40 50
43.731 40.781 236.882
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-07-03：初稿；&lt;/li&gt;
&lt;li&gt;2014-07-06：加入了对&lt;tt class="docutils literal"&gt;distaz&lt;/tt&gt;的用法的说明；删除了CPS330的部分；&lt;/li&gt;
&lt;li&gt;2014-10-28：新增matlab版本；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="C"></category><category term="Fortran"></category><category term="Java"></category><category term="Python"></category><category term="Matlab"></category><category term="名词解释"></category></entry><entry><title>标量矩与矩震级转换关系</title><link href="http://seisman.info/scalar-moment-and-moment-magnitude.html" rel="alternate"></link><updated>2013-07-02T01:11:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-02:scalar-moment-and-moment-magnitude.html</id><summary type="html">
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;公式&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;地震的标量矩&lt;span class="math"&gt;\(M_0\)&lt;/span&gt;与矩震级&lt;span class="math"&gt;\(M_W\)&lt;/span&gt;的关系为：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_W =\frac{2}{3}(log M_0 -16.1)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(M_0\)&lt;/span&gt;的单位为dyne-cm。当&lt;span class="math"&gt;\(M_0\)&lt;/span&gt;单位不同时，后面的常数16.1也要发生变化。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;参考文章&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Kanamori H. The energy release in great earthquakes[J]. Journal of Geophysical Research, 1977, 82(20): 2981-2987.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="震级"></category></entry><entry><title>Global CMT信息整理</title><link href="http://seisman.info/global-cmt.html" rel="alternate"></link><updated>2013-07-01T00:15:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-07-01:global-cmt.html</id><summary type="html">
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;简介&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Global CMT全称Global Centroid-Moment-Tensor Project，前身是Harvard &lt;span class="caps"&gt;CMT&lt;/span&gt;，是地震学常用的地震目录和震源机制之一。其给出了自1976年以来上万个地震的地震目录以及震源机制。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;主页&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.globalcmt.org/"&gt;http://www.globalcmt.org/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="catalog"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;Catalog在线查询&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.globalcmt.org/CMTsearch.html"&gt;http://www.globalcmt.org/CMTsearch.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;可以指定时间段、震级范围、震中范围、深度范围，也可以对震源时间函数以及T轴和N轴进行限制。并支持多种输出格式，其中的&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GMT&lt;/span&gt; psmeca input&lt;/tt&gt;格式可以直接用于GMT绘图。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Catalog直接下载&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.globalcmt.org/CMTfiles.html"&gt;http://www.globalcmt.org/CMTfiles.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;很多时候我们需要根据其他条件对catalog进行筛选，得到符合自定义条件的地震事件，所以ASCII格式的目录文件就很重要了。GCMT提供了1976年到现在的地震目录，其中1976-2004年的地震目录为dek格式，包含在一个文件中。2005年以后的地震目录为ndk格式，每月一个文件。对于2005年以后的地震目录可以将一年的目录合并到一个文件中，方便管理且不会导致文件过大。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;1976-2004目录下载： &lt;a class="reference external" href="http://www.ldeo.columbia.edu/~gcmt/projects/CMT/catalog/jan76_dec04.dek"&gt;http://www.ldeo.columbia.edu/~gcmt/projects/&lt;span class="caps"&gt;CMT&lt;/span&gt;/catalog/jan76_dec04.dek&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2005以后目录下载： &lt;a class="reference external" href="http://www.ldeo.columbia.edu/~gcmt/projects/CMT/catalog/NEW_MONTHLY/"&gt;http://www.ldeo.columbia.edu/~gcmt/projects/&lt;span class="caps"&gt;CMT&lt;/span&gt;/catalog/NEW_MONTHLY/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ndk格式说明： &lt;a class="reference external" href="http://www.ldeo.columbia.edu/~gcmt/projects/CMT/catalog/allorder.ndk_explained"&gt;http://www.ldeo.columbia.edu/~gcmt/projects/&lt;span class="caps"&gt;CMT&lt;/span&gt;/catalog/allorder.ndk_explained&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;dek格式说明： &lt;a class="reference external" href="http://www.ldeo.columbia.edu/~gcmt/projects/CMT/catalog/allorder.dek_explained"&gt;http://www.ldeo.columbia.edu/~gcmt/projects/&lt;span class="caps"&gt;CMT&lt;/span&gt;/catalog/allorder.dek_explained&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="gcmt"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;关于GCMT的文章&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;1981： &lt;a class="reference external" href="http://www.agu.org/pubs/crossref/1981/JB086iB04p02825.shtml"&gt;http://www.agu.org/pubs/crossref/1981/JB086iB04p02825.shtml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;1983： &lt;a class="reference external" href="http://www.agu.org/pubs/crossref/1983/JB088iB04p03247.shtml"&gt;http://www.agu.org/pubs/crossref/1983/JB088iB04p03247.shtml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2012： &lt;a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0031920112000696"&gt;http://www.sciencedirect.com/science/article/pii/S0031920112000696&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;GCMT中给出的地震矩单位是dyne-cm，而不是国际单位制的N-m。&lt;/li&gt;
&lt;li&gt;GCMT目录的ASCII文件中震级采用mb和/或MS，为什么不用矩震级？使用面波和体波震级的最大问题是震级饱和，导致震级基本不会超过8级。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="地震目录"></category><category term="震源机制解"></category><category term="震级"></category></entry><entry><title>仪器响应实例分析</title><link href="http://seisman.info/deep-analysis-of-response.html" rel="alternate"></link><updated>2014-06-10T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-30:deep-analysis-of-response.html</id><summary type="html">
&lt;p&gt;仪器响应水很深，用起来容易，弄明白每一个参数却不简单，幸好SEED的manual提供了一个例子，可以帮助理解，不过其写得太复杂、毫无重点且有些地方打印有错误，故而这里整理并改写一下。&lt;/p&gt;
&lt;p&gt;这个仪器响应依然是标准的三个阶段：地震仪（运动信号转电压信号）、离散器（模电转换器）、FIR滤波器。&lt;/p&gt;
&lt;div class="section" id="stage-1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Stage 1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;假定仪器的自然频率为&lt;span class="math"&gt;\(f_0=1Hz\)&lt;/span&gt;，阻尼常数为&lt;span class="math"&gt;\(\lambda=0.7\)&lt;/span&gt;，该仪器的加速度传递函数为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
H(s) = \frac{s}{s^2+2\lambda \omega_0 s + \omega_0^2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;对于这样一个传递函数，需要注意如下几点：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;该传递函数仅表示某一类地震仪的传递函数，现代地震仪的传递函数可能比这个更复杂；&lt;/li&gt;
&lt;li&gt;根据该传递函数，很容易计算出它的一个零点和两个极点；&lt;/li&gt;
&lt;li&gt;该仪器在&lt;span class="math"&gt;\(f_s=1 Hz\)&lt;/span&gt;时的Sensitivity为&lt;span class="math"&gt;\(S_d=150V/m\cdot s^{-2}\)&lt;/span&gt;。即地震仪接收到的地面运动加速度，如果1 Hz时加速度为&lt;span class="math"&gt;\(1 m/s^2\)&lt;/span&gt;，则地震仪的输出电压为150V。&lt;/li&gt;
&lt;li&gt;仪器真实的传递函数应该是&lt;span class="math"&gt;\(G(f)=R(f)*S_d=A_0*H(s)*S_d\)&lt;/span&gt;。其中&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;为归一化因子，即保证在频率&lt;span class="math"&gt;\(f=f_s\)&lt;/span&gt;时有&lt;span class="math"&gt;\(|R(f_s)|=1.0\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="stage-2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Stage 2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;使用的模数转换器ADC为24bit的，即输出最大值可以为&lt;span class="math"&gt;\(\pm 2^{23}\)&lt;/span&gt;，如果ADC所能转换的电压范围为&lt;span class="math"&gt;\(\pm 20V\)&lt;/span&gt;，则ADC的放大系数为&lt;span class="math"&gt;\(S_d=\frac{2^{23}}{20}=4.1943*10^{5} counts/V\)&lt;/span&gt;。这样一个ADC在输入电压为1V的情况下，其输出为&lt;span class="math"&gt;\(4.1943*10^{5}\)&lt;/span&gt;counts。结合地震仪的放大系数，&lt;span class="math"&gt;\(1 m/s^2\)&lt;/span&gt;的地面运动加速度将导致输出为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
1 m/s^2 * 150 \frac{V}{m/s^2} * 4.1943\times 10^5 \frac{counts}{V} = 6.29145*10^7 counts
\end{equation*}
&lt;/div&gt;
&lt;p&gt;另一方面，ADC的输入电压上限为20V，这似乎也限制了该仪器所能记录到的最大加速度为&lt;span class="math"&gt;\(20/150=0.13 m/s^2\)&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="stage-3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Stage 3&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个阶段的FIR滤波器通过给定多项式系数来实现。给定系数之后即可计算其响应函数，并计算该响应函数在1 Hz处的振幅，然后得到归一化因子即为该阶段的放大系数为1.9938。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="stage-0"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;Stage 0&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;最终得到的放大系数为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
Sd= 150 \frac{V}{m/s^2} \cdot 4.1943\times 10^5 \frac{counts}{V} \cdot 1.9938 \frac{counts}{counts}=1.25439\times 10^8 \frac{counts}{m/s^2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;最后不要忘了第一阶段的无单位的归一化因子&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.fdsn.org/seed_manual/SEEDManual_V2.4.pdf"&gt;&lt;span class="caps"&gt;SEED&lt;/span&gt; Reference Manual&lt;/a&gt;, Version 2.4, August 2012, P162-169&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-06-30：初稿；&lt;/li&gt;
&lt;li&gt;2014-06-10：修订关于自然频率和归一化频率的问题；Thanks to 张申健；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="仪器响应"></category></entry><entry><title>用RESP和PZ去除仪器响应的差别</title><link href="http://seisman.info/difference-between-resp-and-pz-while-deconvolution.html" rel="alternate"></link><updated>2013-07-06T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-29:difference-between-resp-and-pz-while-deconvolution.html</id><summary type="html">
&lt;p&gt;前面介绍了&lt;a class="reference external" href="http://seisman.info/simple-analysis-of-resp.html"&gt;仪器响应文件RESP&lt;/a&gt;和&lt;a class="reference external" href="http://seisman.info/simple-analysis-of-sac-pz.html"&gt;仪器响应文件SAC_PZ&lt;/a&gt;，下面分别用两种响应文件进行去仪器响应，比较二者的区别。&lt;/p&gt;
&lt;p&gt;样例下载地址：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/2013.144.05.40.09.0195.IU.COLA.00.BHZ.M.SAC"&gt;SAC数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/RESP.IU.COLA.00.BHZ"&gt;RESP文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/SAC_PZs_IU_COLA_BHZ_00"&gt;PZ文件&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;RESP去除仪器响应&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sac
SEISMIC ANALYSIS CODE &lt;span class="o"&gt;[&lt;/span&gt;02/01/2012 &lt;span class="o"&gt;(&lt;/span&gt;Version 101.5c&lt;span class="o"&gt;)]&lt;/span&gt;
Copyright &lt;span class="m"&gt;1995&lt;/span&gt; Regents of the University of California

SAC&amp;gt; r ./2013.144.05.40.09.0195.IU.COLA.00.BHZ.M.SAC
SAC&amp;gt; rmean&lt;span class="p"&gt;;&lt;/span&gt; rtr&lt;span class="p"&gt;;&lt;/span&gt; taper
SAC&amp;gt; trans from evalresp fname ./RESP.IU.COLA.00.BHZ to none freq 0.01 0.05 &lt;span class="m"&gt;5&lt;/span&gt; 7
Using response from user-specified file: &lt;span class="o"&gt;(&lt;/span&gt;./RESP.IU.COLA.00.BHZ&lt;span class="o"&gt;)&lt;/span&gt;.
Extracting evresp response &lt;span class="k"&gt;for&lt;/span&gt; COLA, BHZ...
Station &lt;span class="o"&gt;(&lt;/span&gt;COLA &lt;span class="o"&gt;)&lt;/span&gt;, Channel &lt;span class="o"&gt;(&lt;/span&gt;BHZ &lt;span class="o"&gt;)&lt;/span&gt;
SAC&amp;gt; w RESP.SAC
SAC&amp;gt; q
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;PZ去除仪器响应&lt;/a&gt;&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sac
SEISMIC ANALYSIS CODE &lt;span class="o"&gt;[&lt;/span&gt;02/01/2012 &lt;span class="o"&gt;(&lt;/span&gt;Version 101.5c&lt;span class="o"&gt;)]&lt;/span&gt;
Copyright &lt;span class="m"&gt;1995&lt;/span&gt; Regents of the University of California

SAC&amp;gt; r ./2013.144.05.40.09.0195.IU.COLA.00.BHZ.M.SAC
SAC&amp;gt; rmean&lt;span class="p"&gt;;&lt;/span&gt; rtr&lt;span class="p"&gt;;&lt;/span&gt; taper
SAC&amp;gt; trans from polezero subtype ./SAC_PZs_IU_COLA_BHZ_00 to none freq 0.01 0.05 &lt;span class="m"&gt;5&lt;/span&gt; 7
Using polezero response &lt;span class="k"&gt;for&lt;/span&gt; COLA, BHZ, IU, 00...
Station &lt;span class="o"&gt;(&lt;/span&gt;COLA &lt;span class="o"&gt;)&lt;/span&gt;, Channel &lt;span class="o"&gt;(&lt;/span&gt;BHZ &lt;span class="o"&gt;)&lt;/span&gt;
SAC&amp;gt; w PZ.SAC
SAC&amp;gt; q
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;结果对比&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;对比生成的两个SAC文件，波形很类似。&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;RESP&lt;/span&gt;.&lt;span class="caps"&gt;SAC&lt;/span&gt;&lt;/tt&gt;的最值在10的6次方量级，&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PZ&lt;/span&gt;.&lt;span class="caps"&gt;SAC&lt;/span&gt;&lt;/tt&gt;的最值在10的-3次方量级，这是&lt;strong&gt;单位&lt;/strong&gt;的问题。首先SAC的默认的位移单位为nm。RESP文件中有指定仪器的输入单位为m/s，这行虽然以&lt;tt class="docutils literal"&gt;#&lt;/tt&gt;开头，其在去仪器响应的时候是可以被SAC读取的，因而利用RESP去仪器响应时SAC知道输入的单位是什么，SAC自然也会进行单位的转换。而PZ文件中虽然给出了输入单位为m，但PZ文件中以&lt;tt class="docutils literal"&gt;*&lt;/tt&gt;开头的行是被忽略的，所以SAC其实并不知道仪器的输入单位是什么，直接去仪器响应，得到的波形单位为m，而SAC在不知道单位的情况下“自作聪明”直接将其单位改写成了nm，这就导致了波形振幅量级上的错误。因而&lt;strong&gt;SAC在利用PZ文件去仪器响应的时候要乘以10的9次方进行单位转换&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;对单位进行校正后，对二者做互相关，发现互相关的结果峰值位于0处，这意味着二者不存在时间延迟的问题。PZ文件中没有任何时间延迟的概念，而RESP中在滤波过程中存在时间延迟，并给出了延迟估计和延迟校正。互相关峰值在0处意味着在用RESP做反卷积的时候对数字滤波器做了反卷积，并且对时间问题做了校正。&lt;/li&gt;
&lt;li&gt;对两个相似的波形做差，其差值在10的2次方量级，大概占信号的千分之一，这个误差也许是因为PZ文件没有将全部阶段考虑进去导致的，不过这个影响很小。&lt;/li&gt;
&lt;li&gt;PZ文件中没有考虑FIR滤波器的响应函数，因而在Nyquist频率附近会出现失真。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;小提示&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;SAC的PZ文件中所有以星号开头的行都是注释，基本不起到任何作用。在大量数据批处理的过程中，可以直接用这些PZ文件去仪器响应，也可以先用脚本重新新建一个没有注释行的PZ文件，再去仪器响应。经过非严谨测试，在上千个数据的时候，后者速度可以提升几十倍。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.iris.edu/hq/es_course/content/2009.html"&gt;EarthScope 2009 workshop&lt;/a&gt; Session 2&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-06-29：初稿；&lt;/li&gt;
&lt;li&gt;2013-07-06：修改了“结果对比”中第一点的说明；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="仪器响应"></category></entry><entry><title>仪器响应文件SAC PZ</title><link href="http://seisman.info/simple-analysis-of-sac-pz.html" rel="alternate"></link><updated>2013-06-28T00:13:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-28:simple-analysis-of-sac-pz.html</id><summary type="html">&lt;p&gt;RESP文件是SEED格式默认的仪器响应文件，在上一篇博文《&lt;a class="reference external" href="http://seisman.info/simple-analysis-of-resp.html"&gt;仪器响应文件RESP&lt;/a&gt;》中已经分析了一个例子。RESP响应文件完整地描述了仪器响应的全部信息，与此同时也包含了不少冗余信息。&lt;/p&gt;
&lt;p&gt;SAC对RESP文件进行了简化，仅包含了一些必要信息，这个新的文件格式叫做SAC_PZ。下面给出一个PZ文件的例子，其与上一篇博文中的RESP文件对应同一个台站，因而利用上一篇的RESP文件可以完整推导出本文的PZ文件。&lt;/p&gt;
&lt;pre class="literal-block"&gt;
* **********************************
* NETWORK   (KNETWK): IU
* STATION    (KSTNM): COLA
* LOCATION   (KHOLE): 00
* CHANNEL   (KCMPNM): BHZ
* CREATED           : 2013-06-22T14:12:09
* START             : 2012-09-14T04:00:00
* END               : 2599-12-31T23:59:59
* DESCRIPTION       : College Outpost, Alaska, USA
* LATITUDE          : 64.873599
* LONGITUDE         : -147.861600
* ELEVATION         : 84.0
* DEPTH             : 116.0
* DIP               : 0.0
* AZIMUTH           : 0.0
* SAMPLE RATE       : 20.0
* INPUT UNIT        : M
* OUTPUT UNIT       : COUNTS
* INSTTYPE          : Geotech KS-54000 Borehole Seismometer
* INSTGAIN          : 2.013040e+03 (M/S)
* COMMENT           : N/A
* SENSITIVITY       : 3.377320e+09 (M/S)
* A0                : 8.627050e+04
* **********************************
ZEROS   3
        +0.000000e+00   +0.000000e+00
        +0.000000e+00   +0.000000e+00
        +0.000000e+00   +0.000000e+00
POLES   5
        -5.943130e+01   +0.000000e+00
        -2.271210e+01   +2.710650e+01
        -2.271210e+01   -2.710650e+01
        -4.800400e-03   +0.000000e+00
        -7.384400e-02   +0.000000e+00
CONSTANT        +2.913631e+14
&lt;/pre&gt;
&lt;p&gt;星号部分是注释，其包含了台站的一些信息，这些信息比RESP文件中的内容要更丰富，比如台站名、台网名、location、channel、台站经纬度、高程、输入、输出、放大系数、归一化因子等。&lt;/p&gt;
&lt;p&gt;然后给出了零点和极点的信息，跟RESP比较一下，发现极点信息是对的。零点个数比RESP文件多了一个。&lt;/p&gt;
&lt;p&gt;这是为什么呢？&lt;/p&gt;
&lt;p&gt;Laplace变换有一个很重要的性质：如果&lt;span class="math"&gt;\(f(t)\)&lt;/span&gt;的Laplace变换为&lt;span class="math"&gt;\(F(s)\)&lt;/span&gt;，那么&lt;span class="math"&gt;\(f(t)\)&lt;/span&gt;的一阶时间偏导&lt;span class="math"&gt;\(f&amp;#8217;(t)\)&lt;/span&gt;的Laplace变换为&lt;span class="math"&gt;\(sF(s)\)&lt;/span&gt;，也就是多了一个零点(0.0,0.0)。RESP文件认为仪器的输入是速度，因而其单位是m/s，而PZ文件认为输入为位移，单位为m，因而PZ文件的仪器响应首先要将位移经过一次偏导得到速度，再根据RESP的零极点信息转换为电压信息。一切都是可以合理解释的。这也意味着一个很重要的一点，&lt;strong&gt;利用SAC PZ文件去除仪器响应默认得到的波形是位移场而不是速度场&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;前面已经说过，整个仪器响应可以简化为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(f)=S_{d1} A_0 H_p(s) S_{d2} S_{d3}=S_{d0} A_0 H_p(s)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;所以PZ文件中将所有的放大系数以及归一化因子合并成为一个常数，也就是最后的&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;CONSTANT&lt;/span&gt;&lt;/tt&gt;。&lt;/p&gt;
</summary><category term="仪器响应"></category></entry><entry><title>仪器响应文件RESP</title><link href="http://seisman.info/simple-analysis-of-resp.html" rel="alternate"></link><updated>2013-06-27T13:37:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-27:simple-analysis-of-resp.html</id><summary type="html">
&lt;p&gt;《&lt;a class="reference external" href="http://seisman.info/physical-details-of-instrumental-response.html"&gt;仪器响应的物理细节&lt;/a&gt;》一文中说过，理论上仪器响应是由三个阶段构成的。常用的仪器响应格式包括SEED的RESP文件以及SAC的PZ文件。这里通过阅读一个RESP类型的仪器响应文件，来更进一步的理解仪器响应，顺便熟悉一下SEED格式。&lt;/p&gt;
&lt;p&gt;由于RESP的内容太长，就不在博文中贴出，本文所使用的RESP文件可以在&lt;a class="reference external" href="http://seisman.qiniudn.com/downloads/RESP.IU.COLA.00.BHZ"&gt;这里&lt;/a&gt;下载。&lt;/p&gt;
&lt;p&gt;RESP文件是从SEED文件中解压得到的，因而保留了SEED格式的很多传统。响应文件中Stage sequence number表示阶段号，这个例子中从1到3再到0；在每个stage中，根据SEED格式的要求又分为多个block，每个block分别代表该stage的部分信息。&lt;/p&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;台站信息&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;1-9行包含了台站名、台网名、location、channel、开始时间和结束时间等信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="stage-1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Stage 1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;10-42行给出了第一阶段的信息。这个阶段的功能是将运动信号转换为电压信号。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;10-33行。输入单位为m/s，输出单位为V，归一化因子&lt;span class="math"&gt;\(A_0=86270.5\)&lt;/span&gt;，共有2个零点和5个极点，然后列出了零极点的实部、虚部以及误差。&lt;/li&gt;
&lt;li&gt;34-42行给出了第一阶段的放大系数&lt;span class="math"&gt;\(Sd=2.013040e+03\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="stage-2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Stage 2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;43-73行是第二个阶段，其实现模拟信号到数字信号的转换。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;43-53行指出输入为V，输出为counts&lt;/li&gt;
&lt;li&gt;54-64行给出了模电转换过程中可能存在的减采样信息，这里减采样因子为1，也就是没有减采样。&lt;/li&gt;
&lt;li&gt;65-73行给出了该阶段的放大系数&lt;span class="math"&gt;\(S_d= 1.677720E+06\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="stage-3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;Stage 3&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;74-173行是第三阶段，主要是滤波、减采样等。&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;74-153行指出输入为counts，输出也为counts。这个阶段的响应函数不是通过零极点的方式给出的，而是通过系数给出的，这里包含了67个分子系数和0个分母系数。&lt;/li&gt;
&lt;li&gt;154-164行给出了减采样的信息，并对滤波过程中造成的时间延迟进行估计并做校正。&lt;/li&gt;
&lt;li&gt;165-173给出这个阶段的增益，一般为1.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="stage-0"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;Stage 0&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;174-182行是第0阶段，这个阶段给出了Sensitivity=3.377320E+09。其实际上等于前面三个阶段的放大系数&lt;span class="math"&gt;\(S_d\)&lt;/span&gt;的乘积，这个阶段只是起到了辅助验证的作用。&lt;/p&gt;
&lt;p&gt;有些时候会遇到Stage 0给出的增益并不等于前几个阶段的增益的乘积的情况，此时会报如下错误:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
computed and reported sensitivities differ by more than 5 percent
&lt;/pre&gt;
&lt;p&gt;其中computed sensitivity指的是各个stage的增益的乘积，reported sensitivity指的是stage 0给出的增益，二者之间相差5%以上。&lt;/p&gt;
&lt;p&gt;出现这个错误的可能原因是仪器响应文件有问题。&lt;/p&gt;
&lt;p&gt;官方的答复见： &lt;a class="reference external" href="http://www.iris.washington.edu/pipermail/sac-help/2014-February/001674.html"&gt;http://www.iris.washington.edu/pipermail/sac-help/2014-February/001674.html&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;仪器响应与各个阶段的振幅响应&lt;/a&gt;&lt;/h2&gt;
&lt;div class="figure"&gt;
&lt;img alt="仪器响应与各阶段振幅响应" src="/images/2013062701.png"/&gt;
&lt;p class="caption"&gt;图1：仪器响应与各阶段振幅响应&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;这里主要关注振幅响应，根据图例可以看出，第一个阶段在0.01-5Hz范围内振幅基本相同，在该范围外振幅响应比较小，这是该仪器所关注的部分；第二阶段的响应函数是完美的直线；第三个阶段在一个很长的范围内也是一条直线，在大于7Hz的时候振幅响应开始出现剧烈的变化。理论上在去除仪器响应的时候需要考虑第三阶段的响应函数，但是实际上在我们所关注的频率范围内（也许是0.01-5Hz），因而第三阶段的响应函数也可以不考虑了。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;总结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;与前文总结相同，三个阶段中最重要的是第一个阶段的零极点，还有三个阶段的放大系数。第一个阶段的归一化因子也很重要，在这里好像没有体现出来。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;图1由&lt;a class="reference external" href="http://www.isti2.com/JPlotResp/"&gt;JPlotResp&lt;/a&gt;c绘制得到。&lt;/li&gt;
&lt;li&gt;使用JPlotResp绘制响应函数的时候，将光标放在相应点上，可以看到每个点的横纵轴坐标，在最大振幅以及敏感频率方面与想象的有一点偏差。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="仪器响应"></category></entry><entry><title>仪器响应的物理细节</title><link href="http://seisman.info/physical-details-of-instrumental-response.html" rel="alternate"></link><updated>2013-06-26T22:48:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-26:physical-details-of-instrumental-response.html</id><summary type="html">
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;序言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;地震波的传播会引起地面运动。&lt;/p&gt;
&lt;p&gt;用来表征地面运动的物理量有很多，常见的有速度和加速度，不太常见的还有位移、应变、旋转。这些物理量在被地震仪接收到之后，首先要将其转换为电信号，然后对电信号振幅进行放大以及滤波，再将连续时间序列离散化，最终以我们常见的波形的形式表现出来。概括地说，这个过程分为三个阶段：&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Analog Stages&lt;/li&gt;
&lt;li&gt;Analog-Digital Converter&lt;/li&gt;
&lt;li&gt;Digital Stages&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;地震仪的仪器响应是频率的复数函数，也就是常说的振幅响应和频率响应。上面提到的三个阶段，每个阶段的响应函数都是频率的复数函数，表示为&lt;span class="math"&gt;\(G_i(f)\)&lt;/span&gt;，整个仪器的响应函数是各个阶段响应函数的乘积：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(f)=\prod_i G_i(f)
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;预备知识&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="fir"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;FIR滤波器&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;信号处理没学好，不敢瞎说，姑且翻译重点部分。简单地说，&lt;a class="reference external" href="https://zh.wikipedia.org/wiki/%E6%9C%89%E9%99%90%E8%84%89%E5%86%B2%E5%93%8D%E5%BA%94"&gt;FIR滤波器&lt;/a&gt;就是对一些数据采样点做加权平均，设计不同的加权系数就得到不同的FIR滤波器。FIR滤波器一般设计为振幅响应为方阶跃函数（boxcar），因而其在通带内有较平的振幅响应，在拐角频率处有很尖锐很陡峭的振幅响应变化（一般拐角频率设置为Nyquist频率的70%-90%）。与此同时，滤波器具有线性相位，即具有类似&lt;span class="math"&gt;\(e^{i \omega t}\)&lt;/span&gt;的形式，这个线性相位在时间域代表信号的时间延迟，一般数据采集系统会对这个时间延迟做校正。由此，用户基本不需要考虑FIR滤波器对仪器响应的影响。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;响应函数&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;模拟信号的响应函数用Laplace变换表示：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
H(s)=\int_0^{\infty}h(t)e^{-st}dt
\end{equation*}
&lt;/div&gt;
&lt;p&gt;数字信号的响应函数用Z变换表示：&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
H(z)=\sum_{-\infty}^{+\infty}h_m z^{-m}
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id6"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;归一化&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;频率响应可以表示为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(f)=S_d R(f)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(R(f)\)&lt;/span&gt;是频率的函数。在某个特定的频率&lt;span class="math"&gt;\(f_s\)&lt;/span&gt;，有&lt;span class="math"&gt;\(|R(f_s)|=1.0\)&lt;/span&gt;，即&lt;span class="math"&gt;\(R(f)\)&lt;/span&gt;在频率&lt;span class="math"&gt;\(f_s\)&lt;/span&gt;处进行归一化。&lt;span class="math"&gt;\(S_d\)&lt;/span&gt;是放大系数，也称为Sensitivity或者Gain。&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(R(f)\)&lt;/span&gt;可以表示为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
R(f)=A_0 H_p(s)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(H_p(s)\)&lt;/span&gt;是用零极点表示的transfer函数，一般来说在频率&lt;span class="math"&gt;\(f_s\)&lt;/span&gt;处这个transfer函数的振幅响应不为1，所以需要归一化因子&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="analog-stages"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;Analog Stages&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个阶段的主要功能是将连续的地面运动物理量（比如速度）转换为电压信号，并进行电压放大。因而这个阶段的输入单位是m/s，输出单位是伏特(V)。这个阶段的响应函数可以表示为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(f)=S_d A_0 \frac{\prod (s-r_n)}{\prod (s-p_m)}=S_d A_o H_p(s)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;如前所说，&lt;span class="math"&gt;\(S_d\)&lt;/span&gt;是放大系数，&lt;span class="math"&gt;\(H_p(s)\)&lt;/span&gt;是用零极点表示的transfer函数，这里n和m代表n个零点和m个极点。&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;是归一化因子。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="analog-digital-converter"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;Analog-Digital Converter&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;模电转换器，将上个阶段产生的连续的电压信号转换为离散的电压信号。输入的单位是伏特V，输出单位是counts。（不了解A/D C的细节，大概就是说在离散的时候存在一个非常小的阀值，这个值是离散信号所能识别的最小电压差。）这个过程中，其在所有频段内振幅响应相同，也就是只存在一个放大系数，同时可能存在一个时间延迟。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="digital-stages"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;Digital Stages&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;这个阶段对离散数据进行处理。这个过程包含了三个小部分：离散信号滤波，数据重采样，校正滤波引入的时间延迟。&lt;/p&gt;
&lt;p&gt;离散信号滤波可以采用FIR滤波器，也可以采用IIR滤波器。多数情况下采用FIR滤波器，这意味着这个阶段只需要考虑放大系数&lt;span class="math"&gt;\(S_d\)&lt;/span&gt;，归一化因子&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;不需要考虑，或者可以认为其为1.0。同样，对于数据重采样以及时间校正也不会引入新的响应函数。&lt;/p&gt;
&lt;p&gt;说明：FIR滤波器的响应函数可以近似认为其振幅恒为1，实际情况下，在Nyquist采样率附近会有5%左右的震荡。因而当感兴趣的频率比Nyquist频率小很多时可以不必考虑FIR滤波器的响应函数。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;综上所述，三个阶段中，第一个阶段最为复杂，需要给出放大系数&lt;span class="math"&gt;\(S_{d1}\)&lt;/span&gt;、归一化因子&lt;span class="math"&gt;\(A_0\)&lt;/span&gt;以及多个零极点；第二个阶段以及第三个阶段都只需要给出放大系数&lt;span class="math"&gt;\(S_{d2}\)&lt;/span&gt;和&lt;span class="math"&gt;\(S_{d3}\)&lt;/span&gt;。时间校正由数据采集系统自动完成（mark一下，这话说得没底气）。&lt;/p&gt;
&lt;p&gt;最终得到仪器的响应函数为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(f)=S_{d1} A_0 H_p(s) S_{d2} S_{d3} = S_{d0} A_o H_p(s)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;即需要仪器在第一个阶段的零极点信息、归一化因子&lt;span class="math"&gt;\(A_o\)&lt;/span&gt;以及全部三个阶段的放大系数&lt;span class="math"&gt;\(S_{d0}\)&lt;/span&gt;即可以完全表示地震仪的仪器响应。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;这里描述的是一些基本物理细节，应该足够理解仪器响应。想要了解更多的细节，可以看参考中给出的SEED Reference Manual的指定页。&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;参考&lt;/a&gt;&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.fdsn.org/seed_manual/SEEDManual_V2.4.pdf"&gt;&lt;span class="caps"&gt;SEED&lt;/span&gt; Reference Manual&lt;/a&gt;, Version 2.4, August 2012, P71-P78, P151-169&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.iris.edu/hq/es_course/content/2009.html"&gt;EarthScope 2009 workshop&lt;/a&gt; session2&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-06-26：初稿。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="仪器响应"></category></entry><entry><title>地震学的仪器响应</title><link href="http://seisman.info/instrumental-response-in-seismology.html" rel="alternate"></link><updated>2015-05-11T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-23:instrumental-response-in-seismology.html</id><summary type="html">
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;引言&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;地震仪观测到的地面运动记录可以表示为&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(t)=s(t)*g(t)*i(t)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;其中&lt;span class="math"&gt;\(s(t)\)&lt;/span&gt;代表震源项，&lt;span class="math"&gt;\(g(t)\)&lt;/span&gt;代表路径效应，&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;代表仪器响应，星号代表卷积。&lt;/p&gt;
&lt;p&gt;翻译成中文就是&lt;/p&gt;
&lt;blockquote&gt;
地面运动记录是震源项、路径项以及仪器响应三者卷积得到的。&lt;/blockquote&gt;
&lt;p&gt;四个量中：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;span class="math"&gt;\(u(t)\)&lt;/span&gt;是仪器记录的结果，已知；&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;在仪器设计的时候会给出各种参数，已知；&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(s(t)\)&lt;/span&gt;为震源项，包括震源机制、震源时间函数等，未知；&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(g(t)\)&lt;/span&gt;为地球内部结构，未知。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;震源和结构是地震学研究的两个主要内容。因而理解仪器响应&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;的基本原理并准确地去除仪器响应是研究的关键一步。这篇博文将介绍一下原始地面运动&lt;span class="math"&gt;\(s(t)*g(t)\)&lt;/span&gt;是如何卷积上仪器响应&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;从而变成地震记录&lt;span class="math"&gt;\(u(t)\)&lt;/span&gt;的。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;原始地面运动&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;有很多因素可以导致地面发生运动，比如地震波、长周期潮汐波、背景噪声，因而实际的地面运动是很复杂的。下图给出了COLA台站记录到的持续时间为22000s左右的地面原始运动记录，即&lt;span class="math"&gt;\(s(t)*g(t)\)&lt;/span&gt;所对应的波形：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="原始地面记录" src="/images/2013062301.jpg" style="width: 700px;"/&gt;
&lt;p class="caption"&gt;图 1：原始地面运动；横轴代表时间，纵轴代表振幅。&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;整个地面运动最明显的地方是弯弯曲曲类似正弦的波形，其周期大概在6000s，也就是两个小时，这是潮汐波引起的地面运动&lt;a class="footnote-reference" href="#id11" id="id4"&gt;[*]&lt;/a&gt;。波形的最大振幅大概是&lt;span class="math"&gt;\(2\times10^7\)&lt;/span&gt;。在1000s左右有一个明显的振动信号，这是一个震级为Mw8.3级的大地震的信号，其振幅大概在&lt;span class="math"&gt;\(2\times10^6\)&lt;/span&gt;的量级，比长周期波小了一个量级。&lt;/p&gt;
&lt;p&gt;这就是真实的地面运动，即便是如此大的地震，其引起的地面运动相对来说也是很小的。这样的记录因为有太多其它类型的地面运动的干扰，因而对于地震学来说是没有用处的，所以就需要设计合适的仪器尽量去除其它类型地面运动的干扰，也就是地震仪。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;仪器响应&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;从信号处理的角度来看，仪器本质上就是一个滤波器。每个仪器在出厂时都会提供准确的响应参数，但随着仪器的使用，可能会出现老化或其它偏差，因而仪器的实际响应参数需要定期测定、修改。&lt;/p&gt;
&lt;p&gt;图1中的波形中包含了地震波、潮汐波以及背景噪声的信息，因而从低频到高频都有信号。而低频的潮汐波能量太强，正所谓功高盖主，压制一下还是有必要的。常见的地震仪是一个带通滤波器，可以有效压制超高频和超低频的信息。下图&lt;a class="footnote-reference" href="#id12" id="id6"&gt;[†]&lt;/a&gt;给出了该台站的仪器响应，即&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="仪器响应频谱图" src="/images/2013062302.png" style="width: 700px;"/&gt;
&lt;p class="caption"&gt;图2：仪器响应频谱图。横轴为频率，上图为振幅谱，下图为相位谱。&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;从图2中振幅谱可以看出，频率在0.02Hz到8Hz内的信号具有相同的振幅增益（被增强），而小于0.02Hz、大于8Hz的信号则被压制。图1中的周期为1000s量级的信号被压制到了原来的千分之一。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id7"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;地震仪的真实记录&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;图1中的原始地面运动&lt;span class="math"&gt;\(s(t)*g(t)\)&lt;/span&gt;在经过图2中的仪器响应&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;处理之后，即得到下图。超低频和超高频的信号被压制，留下地震学感兴趣的频段，也就是前面说的&lt;span class="math"&gt;\(u(t)\)&lt;/span&gt;：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="COLA台站的地震记录" src="/images/2013062303.jpg" style="width: 700px;"/&gt;
&lt;p class="caption"&gt;图 3：COLA台站的地震记录&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;与图1相比，长周期的正弦信号没了，地震信号被凸显出来了，最大振幅约为&lt;span class="math"&gt;\(2.4\times10^6\)&lt;/span&gt;。在0-300s内，“地面”很安静，300s左右，强烈的地震信号开始出现，持续了很长一段时间后，又恢复了平静。这里可以很明显地看到“平静-震动-平静”的过程。这才是地震数据处理理想的波形。&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id8"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id18"&gt;小结&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;原始的地面运动&lt;span class="math"&gt;\(s(t)*g(t)\)&lt;/span&gt;（图1）中包含了震源以及介质的信息，当地面运动被仪器感知到之后，地面运动会卷积上仪器响应&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;（图2）,最终得到地震仪的输出&lt;span class="math"&gt;\(u(t)\)&lt;/span&gt;（图3）。&lt;/p&gt;
&lt;p&gt;实际在使用地震数据的时候，我们直接从seed文件中解压得到的是类似图3的波形。由于不同台站的仪器响应可能不同，比如有长周期、短周期、宽频带等等。为了使得波形数据具有可比性，所有台站需要将各自的仪器响应去除（有时候需要将所有台站再卷积上某个特定的仪器响应）。&lt;/p&gt;
&lt;p&gt;去仪器响应一般使用SAC的&lt;tt class="docutils literal"&gt;transfer&lt;/tt&gt;命令，形式为&lt;tt class="docutils literal"&gt;transfer from xxx to none&lt;/tt&gt;。显然，直接从地震仪的真实记录&lt;span class="math"&gt;\(u(t)\)&lt;/span&gt;中去除仪器响应&lt;span class="math"&gt;\(i(t)\)&lt;/span&gt;之后得到的图1（&lt;span class="math"&gt;\(s(t)*g(t)\)&lt;/span&gt;）对用户来说是很糟糕的，毕竟潮汐波所在的周期不是我们地震学所关注的。所以在使用&lt;tt class="docutils literal"&gt;transfer&lt;/tt&gt;命令时通常指定&lt;tt class="docutils literal"&gt;freq&lt;/tt&gt;选项，给定一个地震学所关注的频率段，形如&lt;tt class="docutils literal"&gt;transfer from xxx to none freq 0.05 0.1 10.0 15.0&lt;/tt&gt;。在去仪器响应时，应尽量选择一个较宽的频段，在后期数据处理时可以使用&lt;tt class="docutils literal"&gt;bandpass&lt;/tt&gt;命令进行更窄的滤波。&lt;/p&gt;
&lt;p&gt;最终得到的地震图如下：&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="理想的地震图" src="/images/2013062304.jpg" style="width: 700px;"/&gt;
&lt;p class="caption"&gt;图4：理想的地震图，由原始数据经过transfer之后得到。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id9"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id19"&gt;备注&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;现实情况下，是很难获取地面的原始运动情况的。图1所谓的地面原始记录是通过地震记录图3直接去仪器响应得到的。说图1是地面原始记录只是为了帮助理解，实际上其应该不是真正的地面运动，而是&lt;strong&gt;仪器所能感知到&lt;/strong&gt;的地面运动。&lt;/li&gt;
&lt;li&gt;一般transfer的时候freq选项都会给一个很宽的频带，在后期处理数据的时候可能需要不断的调整滤波频段范围，所以把transfer之后的结果做一个备份是很重要的。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id10"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;脚注&lt;/a&gt;&lt;/h2&gt;
&lt;table class="docutils footnote" frame="void" id="id11" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label"&gt;&lt;/col&gt;&lt;col&gt;&lt;/col&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id4"&gt;[*]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;不确定是不是潮汐波，重力学没好好学，也许是地球自由震荡。不管怎样，至少是周期很长的某波，地震学里一般不太关心。&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="id12" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label"&gt;&lt;/col&gt;&lt;col&gt;&lt;/col&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id6"&gt;[†]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;该图利用&lt;a class="reference external" href="http://www.isti2.com/JPlotResp/"&gt;JPlotResp&lt;/a&gt;根据COLA台站的RESP仪器响应文件生成。&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="section" id="id13"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;修订历史&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;2013-06-23：初稿；&lt;/li&gt;
&lt;li&gt;2013-07-05：修改了备注中关于“地面原始运动记录”的说明；&lt;/li&gt;
&lt;li&gt;2014-02-17：修订了一些语句；&lt;/li&gt;
&lt;li&gt;2014-07-06：修订了一些描述；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="仪器响应"></category></entry><entry><title>一切重新开始</title><link href="http://seisman.info/all-start-again.html" rel="alternate"></link><updated>2014-07-06T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-22:all-start-again.html</id><summary type="html">
&lt;div class="section" id="id2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;前世&lt;/a&gt;&lt;/h2&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;新浪博客&lt;/dt&gt;
&lt;dd&gt;2011年07月25日注册新浪博客，26日写下第一篇博文，至2013年01月03日决定停止更新新浪博客，共计528天。新浪提供了一个很好的写博客的平台，对于想写博客的新手来说还是很友好的。但是有些缺点让我不得不抛弃了它：没有插件功能，无法写出漂亮的代码；非注册用户无法评论，不够开放；审查过于严格，我一个学术博客有什么关键词可审查的；文本编辑器过于简单，无法满足我对排版的需求。基于这些原因，我一直有考虑抛弃新浪投靠更加开放和自由的WP ，正好学校LUG搭建了WP博客平台，在校学生都可以申请。所以很果断的抛弃了新浪，投奔WP的怀抱。&lt;/dd&gt;
&lt;dt&gt;&lt;span class="caps"&gt;USTC&lt;/span&gt; WP博客&lt;/dt&gt;
&lt;dd&gt;2013年01月03日开始启用WP博客，用了三天时间将我觉得有价值的文章从新浪转移到了WP。WP的默认编辑器也没有我想象的功能那么强大，这点有些失望，但是其他都还是不错的。游客可以自由评论，也没有任何关键词审查，还有各种插件支持。博客域名是学校的三级（也许是四级？）域名，是一种身份的象征，但是另一方面也暴露了自己的身份。出于安全性考虑，博客平台禁用了很多功能和函数，无法删除主题、无法删除插件、无法修改代码、无法备份、无法调用某些具体函数。一开始觉得还好，只是写写文章而已，要求那么多干嘛？06月13日夜，给博客安装了一个统计插件，由于插件需要调用一个sql函数，不知道是被禁用了还是怎样，调用失败，出现致命错误。解决办法很简单，登陆主机删除相应插件就好。由于博客平台的安全性考虑，这么简单的事情只能求助平台的管理员了，但是管理员一直没有回应我（管理员也是学生，期末的时间应该一直在忙着自己的事情，这点是可以理解的。）这样一个事情使我深深意识到博客主权完整的重要性，我开始寻找博客的全新替代品。&lt;/dd&gt;
&lt;dt&gt;SeisMan WP博客&lt;/dt&gt;
&lt;dd&gt;想要做一个独立博客，没有想象得那么简单。试用了一天的&lt;a class="reference external" href="http://sae.sina.com.cn/"&gt;&lt;span class="caps"&gt;SAE&lt;/span&gt;&lt;/a&gt;之后，决定自己买独立的域名和主机托管，建立真正意义的独立博客。06月16日（博客出错的第三天），在GoDaddy（Godaddy是世界第一大域名注册商，中文昵称狗爹…）购买了域名 &lt;a class="reference external" href="http://seisman.info"&gt;http://seisman.info&lt;/a&gt; ，在&lt;a class="reference external" href="http://www.hengtian.cc/"&gt;衡天主机&lt;/a&gt;购买了国外的主机。等待域名解析等了一天，然后开始了正式的建站。WordPress版本是3.5.1，主题为suffusion，配置各种选项用了一两天，选择合适的插件以及自定义代码。想要搭建一个独立博客不简单，想要做一个好的站长更不简单。&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;今生&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;目前的博客不再使用&lt;a class="reference external" href="https://wordpress.org"&gt;WordPress&lt;/a&gt;这一动态博客系统，而改为使用静态博客引擎。之所以选择&lt;a class="reference external" href="http://docs.getpelican.com/"&gt;Pelican&lt;/a&gt;而不是更为流行的&lt;a class="reference external" href="http://jekyllrb.com/"&gt;Jekyll&lt;/a&gt;主要是因为相比于Ruby，我对Python更感兴趣，使用&lt;a class="reference external" href="http://docs.getpelican.com/"&gt;Pelican&lt;/a&gt;也给了我足够的动力好好学习Python。&lt;/p&gt;
&lt;p&gt;静态博客的好处在于：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;可以用任何编译器以纯文本方式写博客，不受地点和平台的限制；&lt;/li&gt;
&lt;li&gt;方便源代码版本控制；&lt;/li&gt;
&lt;li&gt;轻量，访问速度更快；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;版权&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;目前国内的独立博客，有如&lt;a class="reference external" href="http://www.solidot.org/"&gt;Solidot&lt;/a&gt;这样保留一切版权的，也有如&lt;a class="reference external" href="http://www.williamlong.info/"&gt;月光博客&lt;/a&gt;这样采用“创作共用版权协议”保留部分版权的，也有如&lt;a class="reference external" href="http://xbeta.info/"&gt;善用佳软&lt;/a&gt;这样采用CC0协议放弃一切版权自动进入公有领域的。国内的博客，版权被践踏的太多，遵守CC协议的读者或者用户也不多，CC协议目前在国内更像是一纸空文。这也是我这几天最大的体会。&lt;/p&gt;
&lt;p&gt;本博客采用&lt;a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en"&gt;&lt;span class="caps"&gt;CC&lt;/span&gt; &lt;span class="caps"&gt;BY&lt;/span&gt;-&lt;span class="caps"&gt;NC&lt;/span&gt;-&lt;span class="caps"&gt;SA&lt;/span&gt; 4.0&lt;/a&gt;版权协议，版权声明如下：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;允许自由分享、修改博文内容；&lt;/strong&gt;修改后博文的解释权归修改者所有。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;转载需保留署名；&lt;/strong&gt;要求在文首或文末给出原文链接及作者信息；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;严禁他人进行商业性使用；&lt;/strong&gt;虽说博客内容貌似没啥值得用于商业行为的，但是我一个穷学生还在入不敷出地写着博文，怎么能允许任何商机被别人利用呢。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;若修改了博文内容，则修改后的博文应以相同方式共享；&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在声明了版权之后，给读者如下建议（只是建议，没有任何法律强制性）：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;不要转载本站任何博文。过多转载导致网络文章重复率太高，不利于他人搜索查找，随手一下Ctrl+C和Ctrl+V只能给整个网络带来更多的垃圾，可以采用网摘、引用或链接的方式；&lt;/li&gt;
&lt;li&gt;如果转载博文，请花点时间保证整个文章的排版正常显示，不要所有的文字挤在一起，乱我心；&lt;/li&gt;
&lt;li&gt;如果转载博文，请在文末给出原文链接，大部分文章会不定时更新和更正，我希望给读者的是我所能提供的最好的。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="id5"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id12"&gt;目标&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;5年之内的目标：&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;学会HTML5、&lt;span class="caps"&gt;CSS3&lt;/span&gt;、JavaScript；&lt;/li&gt;
&lt;li&gt;学会Python；&lt;/li&gt;
&lt;li&gt;维护博客正常运行至少5年，5年之后何去何从还是未知；&lt;/li&gt;
&lt;li&gt;维护SAC帮助文档中文版的更新；&lt;/li&gt;
&lt;li&gt;针对大三和大四学生开设一门相关课程；&lt;/li&gt;
&lt;li&gt;积累经验，制作GMT使用文档（入门教程？高级用法？待定）；&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</summary><category term="博客"></category></entry><entry><title>Hello World!</title><link href="http://seisman.info/hello-world.html" rel="alternate"></link><updated>2014-09-13T00:00:00+08:00</updated><author><name>SeisMan</name></author><id>tag:seisman.info,2013-06-21:hello-world.html</id><summary type="html">&lt;p&gt;Hello&amp;nbsp;World！欢迎来到SeisMan的个人独立博客。&lt;/p&gt;
&lt;p&gt;本博客主要关注地震学的基础知识、地震学相关软件以及一些编程语言与工具。&lt;/p&gt;
&lt;p&gt;本博客使用基于&lt;a class="reference external" href="https://www.python.org"&gt;Python&lt;/a&gt;的&lt;a class="reference external" href="https://github.com/getpelican/pelican"&gt;Pelican&lt;/a&gt;作为静态博客生成器，主题为&lt;a class="reference external" href="https://github.com/talha131/pelican-elegant"&gt;Elegant&lt;/a&gt;，源文件使用&lt;a class="reference external" href="http://docutils.sourceforge.net/rst.html"&gt;reStructuredText&lt;/a&gt;作为标记语言。博客源文件托管在&lt;a class="reference external" href="https://github.com"&gt;GitHub&lt;/a&gt;上，生成的网页文件同时托管在&lt;a class="reference external" href="https://github.com"&gt;GitHub&lt;/a&gt;（供国外用户访问）以及&lt;a class="reference external" href="https://gitcafe.com"&gt;GitCafe&lt;/a&gt;（供国内用户访问）。在此一并对这些开源且免费的服务表示感谢。&lt;/p&gt;
&lt;p&gt;首次访问本博客的读者可能对于博客以及博主的一些信息感兴趣，这些可以在“&lt;a class="reference external" href="http://seisman.info/about.html"&gt;About&lt;/a&gt;”页面中看到，其中还包含了博客的原则、版权以及联系方式。&lt;/p&gt;
&lt;p&gt;如果觉得本博客的内容对你有用，可以进入“&lt;a class="reference external" href="http://seisman.info/donations.html"&gt;Donations&lt;/a&gt;”页面，通过多种方式捐赠本博客。&lt;/p&gt;
&lt;p&gt;欢迎继续关注和支持SeisMan博客。&lt;/p&gt;
</summary><category term="博客"></category></entry></feed>